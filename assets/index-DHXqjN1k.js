(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function vN(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var h_={exports:{}},td={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _b;function g2(){if(_b)return td;_b=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var u in s)u!=="key"&&(a[u]=s[u])}else a=s;return s=a.ref,{$$typeof:n,type:i,key:l,ref:s!==void 0?s:null,props:a}}return td.Fragment=e,td.jsx=t,td.jsxs=t,td}var vb;function y2(){return vb||(vb=1,h_.exports=g2()),h_.exports}var f=y2(),f_={exports:{}},je={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tb;function _2(){if(Tb)return je;Tb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),T=Symbol.for("react.activity"),E=Symbol.iterator;function S(G){return G===null||typeof G!="object"?null:(G=E&&G[E]||G["@@iterator"],typeof G=="function"?G:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,O={};function j(G,le,z){this.props=G,this.context=le,this.refs=O,this.updater=z||k}j.prototype.isReactComponent={},j.prototype.setState=function(G,le){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,le,"setState")},j.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function W(){}W.prototype=j.prototype;function $(G,le,z){this.props=G,this.context=le,this.refs=O,this.updater=z||k}var U=$.prototype=new W;U.constructor=$,V(U,j.prototype),U.isPureReactComponent=!0;var K=Array.isArray;function J(){}var R={H:null,A:null,T:null,S:null},A=Object.prototype.hasOwnProperty;function C(G,le,z){var pe=z.ref;return{$$typeof:n,type:G,key:le,ref:pe!==void 0?pe:null,props:z}}function M(G,le){return C(G.type,le,G.props)}function L(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function F(G){var le={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(z){return le[z]})}var D=/\/+/g;function ye(G,le){return typeof G=="object"&&G!==null&&G.key!=null?F(""+G.key):le.toString(36)}function Oe(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(J,J):(G.status="pending",G.then(function(le){G.status==="pending"&&(G.status="fulfilled",G.value=le)},function(le){G.status==="pending"&&(G.status="rejected",G.reason=le)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function X(G,le,z,pe,we){var Ie=typeof G;(Ie==="undefined"||Ie==="boolean")&&(G=null);var H=!1;if(G===null)H=!0;else switch(Ie){case"bigint":case"string":case"number":H=!0;break;case"object":switch(G.$$typeof){case n:case e:H=!0;break;case _:return H=G._init,X(H(G._payload),le,z,pe,we)}}if(H)return we=we(G),H=pe===""?"."+ye(G,0):pe,K(we)?(z="",H!=null&&(z=H.replace(D,"$&/")+"/"),X(we,le,z,"",function(Le){return Le})):we!=null&&(L(we)&&(we=M(we,z+(we.key==null||G&&G.key===we.key?"":(""+we.key).replace(D,"$&/")+"/")+H)),le.push(we)),1;H=0;var ge=pe===""?".":pe+":";if(K(G))for(var Se=0;Se<G.length;Se++)pe=G[Se],Ie=ge+ye(pe,Se),H+=X(pe,le,z,Ie,we);else if(Se=S(G),typeof Se=="function")for(G=Se.call(G),Se=0;!(pe=G.next()).done;)pe=pe.value,Ie=ge+ye(pe,Se++),H+=X(pe,le,z,Ie,we);else if(Ie==="object"){if(typeof G.then=="function")return X(Oe(G),le,z,pe,we);throw le=String(G),Error("Objects are not valid as a React child (found: "+(le==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":le)+"). If you meant to render a collection of children, use an array instead.")}return H}function fe(G,le,z){if(G==null)return G;var pe=[],we=0;return X(G,pe,"","",function(Ie){return le.call(z,Ie,we++)}),pe}function Re(G){if(G._status===-1){var le=G._result;le=le(),le.then(function(z){(G._status===0||G._status===-1)&&(G._status=1,G._result=z)},function(z){(G._status===0||G._status===-1)&&(G._status=2,G._result=z)}),G._status===-1&&(G._status=0,G._result=le)}if(G._status===1)return G._result.default;throw G._result}var Ke=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var le=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(le))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},nt={map:fe,forEach:function(G,le,z){fe(G,function(){le.apply(this,arguments)},z)},count:function(G){var le=0;return fe(G,function(){le++}),le},toArray:function(G){return fe(G,function(le){return le})||[]},only:function(G){if(!L(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return je.Activity=T,je.Children=nt,je.Component=j,je.Fragment=t,je.Profiler=s,je.PureComponent=$,je.StrictMode=i,je.Suspense=h,je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,je.__COMPILER_RUNTIME={__proto__:null,c:function(G){return R.H.useMemoCache(G)}},je.cache=function(G){return function(){return G.apply(null,arguments)}},je.cacheSignal=function(){return null},je.cloneElement=function(G,le,z){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var pe=V({},G.props),we=G.key;if(le!=null)for(Ie in le.key!==void 0&&(we=""+le.key),le)!A.call(le,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&le.ref===void 0||(pe[Ie]=le[Ie]);var Ie=arguments.length-2;if(Ie===1)pe.children=z;else if(1<Ie){for(var H=Array(Ie),ge=0;ge<Ie;ge++)H[ge]=arguments[ge+2];pe.children=H}return C(G.type,we,pe)},je.createContext=function(G){return G={$$typeof:l,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:a,_context:G},G},je.createElement=function(G,le,z){var pe,we={},Ie=null;if(le!=null)for(pe in le.key!==void 0&&(Ie=""+le.key),le)A.call(le,pe)&&pe!=="key"&&pe!=="__self"&&pe!=="__source"&&(we[pe]=le[pe]);var H=arguments.length-2;if(H===1)we.children=z;else if(1<H){for(var ge=Array(H),Se=0;Se<H;Se++)ge[Se]=arguments[Se+2];we.children=ge}if(G&&G.defaultProps)for(pe in H=G.defaultProps,H)we[pe]===void 0&&(we[pe]=H[pe]);return C(G,Ie,we)},je.createRef=function(){return{current:null}},je.forwardRef=function(G){return{$$typeof:u,render:G}},je.isValidElement=L,je.lazy=function(G){return{$$typeof:_,_payload:{_status:-1,_result:G},_init:Re}},je.memo=function(G,le){return{$$typeof:m,type:G,compare:le===void 0?null:le}},je.startTransition=function(G){var le=R.T,z={};R.T=z;try{var pe=G(),we=R.S;we!==null&&we(z,pe),typeof pe=="object"&&pe!==null&&typeof pe.then=="function"&&pe.then(J,Ke)}catch(Ie){Ke(Ie)}finally{le!==null&&z.types!==null&&(le.types=z.types),R.T=le}},je.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},je.use=function(G){return R.H.use(G)},je.useActionState=function(G,le,z){return R.H.useActionState(G,le,z)},je.useCallback=function(G,le){return R.H.useCallback(G,le)},je.useContext=function(G){return R.H.useContext(G)},je.useDebugValue=function(){},je.useDeferredValue=function(G,le){return R.H.useDeferredValue(G,le)},je.useEffect=function(G,le){return R.H.useEffect(G,le)},je.useEffectEvent=function(G){return R.H.useEffectEvent(G)},je.useId=function(){return R.H.useId()},je.useImperativeHandle=function(G,le,z){return R.H.useImperativeHandle(G,le,z)},je.useInsertionEffect=function(G,le){return R.H.useInsertionEffect(G,le)},je.useLayoutEffect=function(G,le){return R.H.useLayoutEffect(G,le)},je.useMemo=function(G,le){return R.H.useMemo(G,le)},je.useOptimistic=function(G,le){return R.H.useOptimistic(G,le)},je.useReducer=function(G,le,z){return R.H.useReducer(G,le,z)},je.useRef=function(G){return R.H.useRef(G)},je.useState=function(G){return R.H.useState(G)},je.useSyncExternalStore=function(G,le,z){return R.H.useSyncExternalStore(G,le,z)},je.useTransition=function(){return R.H.useTransition()},je.version="19.2.1",je}var xb;function jv(){return xb||(xb=1,f_.exports=_2()),f_.exports}var oe=jv();const Bv=vN(oe);var m_={exports:{}},nd={},p_={exports:{}},g_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eb;function v2(){return Eb||(Eb=1,(function(n){function e(X,fe){var Re=X.length;X.push(fe);e:for(;0<Re;){var Ke=Re-1>>>1,nt=X[Ke];if(0<s(nt,fe))X[Ke]=fe,X[Re]=nt,Re=Ke;else break e}}function t(X){return X.length===0?null:X[0]}function i(X){if(X.length===0)return null;var fe=X[0],Re=X.pop();if(Re!==fe){X[0]=Re;e:for(var Ke=0,nt=X.length,G=nt>>>1;Ke<G;){var le=2*(Ke+1)-1,z=X[le],pe=le+1,we=X[pe];if(0>s(z,Re))pe<nt&&0>s(we,z)?(X[Ke]=we,X[pe]=Re,Ke=pe):(X[Ke]=z,X[le]=Re,Ke=le);else if(pe<nt&&0>s(we,Re))X[Ke]=we,X[pe]=Re,Ke=pe;else break e}}return fe}function s(X,fe){var Re=X.sortIndex-fe.sortIndex;return Re!==0?Re:X.id-fe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var h=[],m=[],_=1,T=null,E=3,S=!1,k=!1,V=!1,O=!1,j=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;function U(X){for(var fe=t(m);fe!==null;){if(fe.callback===null)i(m);else if(fe.startTime<=X)i(m),fe.sortIndex=fe.expirationTime,e(h,fe);else break;fe=t(m)}}function K(X){if(V=!1,U(X),!k)if(t(h)!==null)k=!0,J||(J=!0,F());else{var fe=t(m);fe!==null&&Oe(K,fe.startTime-X)}}var J=!1,R=-1,A=5,C=-1;function M(){return O?!0:!(n.unstable_now()-C<A)}function L(){if(O=!1,J){var X=n.unstable_now();C=X;var fe=!0;try{e:{k=!1,V&&(V=!1,W(R),R=-1),S=!0;var Re=E;try{t:{for(U(X),T=t(h);T!==null&&!(T.expirationTime>X&&M());){var Ke=T.callback;if(typeof Ke=="function"){T.callback=null,E=T.priorityLevel;var nt=Ke(T.expirationTime<=X);if(X=n.unstable_now(),typeof nt=="function"){T.callback=nt,U(X),fe=!0;break t}T===t(h)&&i(h),U(X)}else i(h);T=t(h)}if(T!==null)fe=!0;else{var G=t(m);G!==null&&Oe(K,G.startTime-X),fe=!1}}break e}finally{T=null,E=Re,S=!1}fe=void 0}}finally{fe?F():J=!1}}}var F;if(typeof $=="function")F=function(){$(L)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,ye=D.port2;D.port1.onmessage=L,F=function(){ye.postMessage(null)}}else F=function(){j(L,0)};function Oe(X,fe){R=j(function(){X(n.unstable_now())},fe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_next=function(X){switch(E){case 1:case 2:case 3:var fe=3;break;default:fe=E}var Re=E;E=fe;try{return X()}finally{E=Re}},n.unstable_requestPaint=function(){O=!0},n.unstable_runWithPriority=function(X,fe){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var Re=E;E=X;try{return fe()}finally{E=Re}},n.unstable_scheduleCallback=function(X,fe,Re){var Ke=n.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?Ke+Re:Ke):Re=Ke,X){case 1:var nt=-1;break;case 2:nt=250;break;case 5:nt=1073741823;break;case 4:nt=1e4;break;default:nt=5e3}return nt=Re+nt,X={id:_++,callback:fe,priorityLevel:X,startTime:Re,expirationTime:nt,sortIndex:-1},Re>Ke?(X.sortIndex=Re,e(m,X),t(h)===null&&X===t(m)&&(V?(W(R),R=-1):V=!0,Oe(K,Re-Ke))):(X.sortIndex=nt,e(h,X),k||S||(k=!0,J||(J=!0,F()))),X},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(X){var fe=E;return function(){var Re=E;E=fe;try{return X.apply(this,arguments)}finally{E=Re}}}})(g_)),g_}var wb;function T2(){return wb||(wb=1,p_.exports=v2()),p_.exports}var y_={exports:{}},Mn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bb;function x2(){if(bb)return Mn;bb=1;var n=jv();function e(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(h,m,_){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:T==null?null:""+T,children:h,containerInfo:m,implementation:_}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Mn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Mn.createPortal=function(h,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return a(h,m,null,_)},Mn.flushSync=function(h){var m=l.T,_=i.p;try{if(l.T=null,i.p=2,h)return h()}finally{l.T=m,i.p=_,i.d.f()}},Mn.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(h,m))},Mn.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},Mn.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var _=m.as,T=u(_,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?i.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:T,integrity:E,fetchPriority:S}):_==="script"&&i.d.X(h,{crossOrigin:T,integrity:E,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Mn.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=u(m.as,m.crossOrigin);i.d.M(h,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(h)},Mn.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,T=u(_,m.crossOrigin);i.d.L(h,_,{crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Mn.preloadModule=function(h,m){if(typeof h=="string")if(m){var _=u(m.as,m.crossOrigin);i.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(h)},Mn.requestFormReset=function(h){i.d.r(h)},Mn.unstable_batchedUpdates=function(h,m){return h(m)},Mn.useFormState=function(h,m,_){return l.H.useFormState(h,m,_)},Mn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Mn.version="19.2.1",Mn}var Ib;function E2(){if(Ib)return y_.exports;Ib=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),y_.exports=x2(),y_.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sb;function w2(){if(Sb)return nd;Sb=1;var n=T2(),e=jv(),t=E2();function i(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,c=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(c=o.return),r=o.return;while(r)}return o.tag===3?c:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function u(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function h(r){if(a(r)!==r)throw Error(i(188))}function m(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(i(188));return o!==r?null:r}for(var c=r,d=o;;){var v=c.return;if(v===null)break;var x=v.alternate;if(x===null){if(d=v.return,d!==null){c=d;continue}break}if(v.child===x.child){for(x=v.child;x;){if(x===c)return h(v),r;if(x===d)return h(v),o;x=x.sibling}throw Error(i(188))}if(c.return!==d.return)c=v,d=x;else{for(var b=!1,N=v.child;N;){if(N===c){b=!0,c=v,d=x;break}if(N===d){b=!0,d=v,c=x;break}N=N.sibling}if(!b){for(N=x.child;N;){if(N===c){b=!0,c=x,d=v;break}if(N===d){b=!0,d=x,c=v;break}N=N.sibling}if(!b)throw Error(i(189))}}if(c.alternate!==d)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?r:o}function _(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=_(r),o!==null)return o;r=r.sibling}return null}var T=Object.assign,E=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),k=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),W=Symbol.for("react.consumer"),$=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function F(r){return r===null||typeof r!="object"?null:(r=L&&r[L]||r["@@iterator"],typeof r=="function"?r:null)}var D=Symbol.for("react.client.reference");function ye(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===D?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case V:return"Fragment";case j:return"Profiler";case O:return"StrictMode";case K:return"Suspense";case J:return"SuspenseList";case C:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case k:return"Portal";case $:return r.displayName||"Context";case W:return(r._context.displayName||"Context")+".Consumer";case U:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case R:return o=r.displayName||null,o!==null?o:ye(r.type)||"Memo";case A:o=r._payload,r=r._init;try{return ye(r(o))}catch{}}return null}var Oe=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Re={pending:!1,data:null,method:null,action:null},Ke=[],nt=-1;function G(r){return{current:r}}function le(r){0>nt||(r.current=Ke[nt],Ke[nt]=null,nt--)}function z(r,o){nt++,Ke[nt]=r.current,r.current=o}var pe=G(null),we=G(null),Ie=G(null),H=G(null);function ge(r,o){switch(z(Ie,o),z(we,r),z(pe,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?jw(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=jw(o),r=Bw(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}le(pe),z(pe,r)}function Se(){le(pe),le(we),le(Ie)}function Le(r){r.memoizedState!==null&&z(H,r);var o=pe.current,c=Bw(o,r.type);o!==c&&(z(we,r),z(pe,c))}function qe(r){we.current===r&&(le(pe),le(we)),H.current===r&&(le(H),Wu._currentValue=Re)}var st,$e;function Ot(r){if(st===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);st=o&&o[1]||"",$e=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+st+r+$e}var ai=!1;function cn(r,o){if(!r||ai)return"";ai=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(o){var ue=function(){throw Error()};if(Object.defineProperty(ue.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ue,[])}catch(re){var ne=re}Reflect.construct(r,[],ue)}else{try{ue.call()}catch(re){ne=re}r.call(ue.prototype)}}else{try{throw Error()}catch(re){ne=re}(ue=r())&&typeof ue.catch=="function"&&ue.catch(function(){})}}catch(re){if(re&&ne&&typeof re.stack=="string")return[re.stack,ne.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=d.DetermineComponentFrameRoot(),b=x[0],N=x[1];if(b&&N){var q=b.split(`
`),te=N.split(`
`);for(v=d=0;d<q.length&&!q[d].includes("DetermineComponentFrameRoot");)d++;for(;v<te.length&&!te[v].includes("DetermineComponentFrameRoot");)v++;if(d===q.length||v===te.length)for(d=q.length-1,v=te.length-1;1<=d&&0<=v&&q[d]!==te[v];)v--;for(;1<=d&&0<=v;d--,v--)if(q[d]!==te[v]){if(d!==1||v!==1)do if(d--,v--,0>v||q[d]!==te[v]){var ae=`
`+q[d].replace(" at new "," at ");return r.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",r.displayName)),ae}while(1<=d&&0<=v);break}}}finally{ai=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?Ot(c):""}function Bi(r,o){switch(r.tag){case 26:case 27:case 5:return Ot(r.type);case 16:return Ot("Lazy");case 13:return r.child!==o&&o!==null?Ot("Suspense Fallback"):Ot("Suspense");case 19:return Ot("SuspenseList");case 0:case 15:return cn(r.type,!1);case 11:return cn(r.type.render,!1);case 1:return cn(r.type,!0);case 31:return Ot("Activity");default:return""}}function un(r){try{var o="",c=null;do o+=Bi(r,c),c=r,r=r.return;while(r);return o}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Ct=Object.prototype.hasOwnProperty,dn=n.unstable_scheduleCallback,Ar=n.unstable_cancelCallback,mg=n.unstable_shouldYield,Vh=n.unstable_requestPaint,jn=n.unstable_now,jo=n.unstable_getCurrentPriorityLevel,eu=n.unstable_ImmediatePriority,tu=n.unstable_UserBlockingPriority,Nr=n.unstable_NormalPriority,pg=n.unstable_LowPriority,Lh=n.unstable_IdlePriority,Uh=n.log,Oh=n.unstable_setDisableYieldValue,Gi=null,En=null;function bi(r){if(typeof Uh=="function"&&Oh(r),En&&typeof En.setStrictMode=="function")try{En.setStrictMode(Gi,r)}catch{}}var zt=Math.clz32?Math.clz32:qh,Fh=Math.log,il=Math.LN2;function qh(r){return r>>>=0,r===0?32:31-(Fh(r)/il|0)|0}var as=256,Bo=262144,Wt=4194304;function ls(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function cs(r,o,c){var d=r.pendingLanes;if(d===0)return 0;var v=0,x=r.suspendedLanes,b=r.pingedLanes;r=r.warmLanes;var N=d&134217727;return N!==0?(d=N&~x,d!==0?v=ls(d):(b&=N,b!==0?v=ls(b):c||(c=N&~r,c!==0&&(v=ls(c))))):(N=d&~x,N!==0?v=ls(N):b!==0?v=ls(b):c||(c=d&~r,c!==0&&(v=ls(c)))),v===0?0:o!==0&&o!==v&&(o&x)===0&&(x=v&-v,c=o&-o,x>=c||x===32&&(c&4194048)!==0)?o:v}function zi(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function gg(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jh(){var r=Wt;return Wt<<=1,(Wt&62914560)===0&&(Wt=4194304),r}function us(r){for(var o=[],c=0;31>c;c++)o.push(r);return o}function Go(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function yg(r,o,c,d,v,x){var b=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var N=r.entanglements,q=r.expirationTimes,te=r.hiddenUpdates;for(c=b&~c;0<c;){var ae=31-zt(c),ue=1<<ae;N[ae]=0,q[ae]=-1;var ne=te[ae];if(ne!==null)for(te[ae]=null,ae=0;ae<ne.length;ae++){var re=ne[ae];re!==null&&(re.lane&=-536870913)}c&=~ue}d!==0&&zo(r,d,0),x!==0&&v===0&&r.tag!==0&&(r.suspendedLanes|=x&~(b&~o))}function zo(r,o,c){r.pendingLanes|=o,r.suspendedLanes&=~o;var d=31-zt(o);r.entangledLanes|=o,r.entanglements[d]=r.entanglements[d]|1073741824|c&261930}function nu(r,o){var c=r.entangledLanes|=o;for(r=r.entanglements;c;){var d=31-zt(c),v=1<<d;v&o|r[d]&o&&(r[d]|=o),c&=~v}}function iu(r,o){var c=o&-o;return c=(c&42)!==0?1:Ho(c),(c&(r.suspendedLanes|o))!==0?0:c}function Ho(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Gs(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Bh(){var r=fe.p;return r!==0?r:(r=window.event,r===void 0?32:db(r.type))}function Hi(r,o){var c=fe.p;try{return fe.p=r,o()}finally{fe.p=c}}var $i=Math.random().toString(36).slice(2),Xt="__reactFiber$"+$i,pn="__reactProps$"+$i,ds="__reactContainer$"+$i,sl="__reactEvents$"+$i,_g="__reactListeners$"+$i,Gh="__reactHandles$"+$i,zh="__reactResources$"+$i,hs="__reactMarker$"+$i;function rl(r){delete r[Xt],delete r[pn],delete r[sl],delete r[_g],delete r[Gh]}function fs(r){var o=r[Xt];if(o)return o;for(var c=r.parentNode;c;){if(o=c[ds]||c[Xt]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(r=Jw(r);r!==null;){if(c=r[Xt])return c;r=Jw(r)}return o}r=c,c=r.parentNode}return null}function Ii(r){if(r=r[Xt]||r[ds]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function li(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(i(33))}function ms(r){var o=r[zh];return o||(o=r[zh]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Zt(r){r[hs]=!0}var su=new Set,ru={};function ps(r,o){gs(r,o),gs(r+"Capture",o)}function gs(r,o){for(ru[r]=o,r=0;r<o.length;r++)su.add(o[r])}var ou=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),au={},lu={};function Hh(r){return Ct.call(lu,r)?!0:Ct.call(au,r)?!1:ou.test(r)?lu[r]=!0:(au[r]=!0,!1)}function ol(r,o,c){if(Hh(o))if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var d=o.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+c)}}function ci(r,o,c){if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+c)}}function en(r,o,c,d){if(d===null)r.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(o,c,""+d)}}function gn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Cr(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function cu(r,o,c){var d=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,x=d.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return v.call(this)},set:function(b){c=""+b,x.call(this,b)}}),Object.defineProperty(r,o,{enumerable:d.enumerable}),{getValue:function(){return c},setValue:function(b){c=""+b},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function ht(r){if(!r._valueTracker){var o=Cr(r)?"checked":"value";r._valueTracker=cu(r,o,""+r[o])}}function $o(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var c=o.getValue(),d="";return r&&(d=Cr(r)?r.checked?"true":"false":r.value),r=d,r!==c?(o.setValue(r),!0):!1}function ys(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Ko=/[\n"\\]/g;function Qn(r){return r.replace(Ko,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function al(r,o,c,d,v,x,b,N){r.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?r.type=b:r.removeAttribute("type"),o!=null?b==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+gn(o)):r.value!==""+gn(o)&&(r.value=""+gn(o)):b!=="submit"&&b!=="reset"||r.removeAttribute("value"),o!=null?uu(r,b,gn(o)):c!=null?uu(r,b,gn(c)):d!=null&&r.removeAttribute("value"),v==null&&x!=null&&(r.defaultChecked=!!x),v!=null&&(r.checked=v&&typeof v!="function"&&typeof v!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?r.name=""+gn(N):r.removeAttribute("name")}function $h(r,o,c,d,v,x,b,N){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(r.type=x),o!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||o!=null)){ht(r);return}c=c!=null?""+gn(c):"",o=o!=null?""+gn(o):c,N||o===r.value||(r.value=o),r.defaultValue=o}d=d??v,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=N?r.checked:!!d,r.defaultChecked=!!d,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(r.name=b),ht(r)}function uu(r,o,c){o==="number"&&ys(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function Rr(r,o,c,d){if(r=r.options,o){o={};for(var v=0;v<c.length;v++)o["$"+c[v]]=!0;for(c=0;c<r.length;c++)v=o.hasOwnProperty("$"+r[c].value),r[c].selected!==v&&(r[c].selected=v),v&&d&&(r[c].defaultSelected=!0)}else{for(c=""+gn(c),o=null,v=0;v<r.length;v++){if(r[v].value===c){r[v].selected=!0,d&&(r[v].defaultSelected=!0);return}o!==null||r[v].disabled||(o=r[v])}o!==null&&(o.selected=!0)}}function Kh(r,o,c){if(o!=null&&(o=""+gn(o),o!==r.value&&(r.value=o),c==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=c!=null?""+gn(c):""}function Pr(r,o,c,d){if(o==null){if(d!=null){if(c!=null)throw Error(i(92));if(Oe(d)){if(1<d.length)throw Error(i(93));d=d[0]}c=d}c==null&&(c=""),o=c}c=gn(o),r.defaultValue=c,d=r.textContent,d===c&&d!==""&&d!==null&&(r.value=d),ht(r)}function Wn(r,o){if(o){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=o;return}}r.textContent=o}var Yh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function du(r,o,c){var d=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":d?r.setProperty(o,c):typeof c!="number"||c===0||Yh.has(o)?o==="float"?r.cssFloat=c:r[o]=(""+c).trim():r[o]=c+"px"}function hu(r,o,c){if(o!=null&&typeof o!="object")throw Error(i(62));if(r=r.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||o!=null&&o.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var v in o)d=o[v],o.hasOwnProperty(v)&&c[v]!==d&&du(r,v,d)}else for(var x in o)o.hasOwnProperty(x)&&du(r,x,o[x])}function ll(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Dr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function cl(r){return Dr.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Ki(){}var fu=null;function Si(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Mr=null,_s=null;function Yo(r){var o=Ii(r);if(o&&(r=o.stateNode)){var c=r[pn]||null;e:switch(r=o.stateNode,o.type){case"input":if(al(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Qn(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var d=c[o];if(d!==r&&d.form===r.form){var v=d[pn]||null;if(!v)throw Error(i(90));al(d,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(o=0;o<c.length;o++)d=c[o],d.form===r.form&&$o(d)}break e;case"textarea":Kh(r,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&Rr(r,!!c.multiple,o,!1)}}}var ul=!1;function kr(r,o,c){if(ul)return r(o,c);ul=!0;try{var d=r(o);return d}finally{if(ul=!1,(Mr!==null||_s!==null)&&(Gf(),Mr&&(o=Mr,r=_s,_s=Mr=null,Yo(o),r)))for(o=0;o<r.length;o++)Yo(r[o])}}function Yi(r,o){var c=r.stateNode;if(c===null)return null;var d=c[pn]||null;if(d===null)return null;c=d[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(i(231,o,typeof c));return c}var Ai=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jo=!1;if(Ai)try{var yt={};Object.defineProperty(yt,"passive",{get:function(){Jo=!0}}),window.addEventListener("test",yt,yt),window.removeEventListener("test",yt,yt)}catch{Jo=!1}var vs=null,mu=null,Qo=null;function pu(){if(Qo)return Qo;var r,o=mu,c=o.length,d,v="value"in vs?vs.value:vs.textContent,x=v.length;for(r=0;r<c&&o[r]===v[r];r++);var b=c-r;for(d=1;d<=b&&o[c-d]===v[x-d];d++);return Qo=v.slice(r,1<d?1-d:void 0)}function Wo(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function zs(){return!0}function Ji(){return!1}function wn(r){function o(c,d,v,x,b){this._reactName=c,this._targetInst=v,this.type=d,this.nativeEvent=x,this.target=b,this.currentTarget=null;for(var N in r)r.hasOwnProperty(N)&&(c=r[N],this[N]=c?c(x):x[N]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?zs:Ji,this.isPropagationStopped=Ji,this}return T(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=zs)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=zs)},persist:function(){},isPersistent:zs}),o}var Hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ts=wn(Hs),Vr=T({},Hs,{view:0,detail:0}),gu=wn(Vr),Lr,dl,xs,hl=T({},Vr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ur,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==xs&&(xs&&r.type==="mousemove"?(Lr=r.screenX-xs.screenX,dl=r.screenY-xs.screenY):dl=Lr=0,xs=r),Lr)},movementY:function(r){return"movementY"in r?r.movementY:dl}}),yu=wn(hl),Xo=T({},hl,{dataTransfer:0}),Qh=wn(Xo),Wh=T({},Vr,{relatedTarget:0}),Zo=wn(Wh),_u=T({},Hs,{animationName:0,elapsedTime:0,pseudoElement:0}),Xh=wn(_u),fl=T({},Hs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Zh=wn(fl),ef=T({},Hs,{data:0}),Es=wn(ef),tf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rf(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=sf[r])?!!o[r]:!1}function Ur(){return rf}var Bn=T({},Vr,{key:function(r){if(r.key){var o=tf[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=Wo(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?nf[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ur,charCode:function(r){return r.type==="keypress"?Wo(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Wo(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),of=wn(Bn),af=T({},hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$s=wn(af),y=T({},Vr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ur}),w=wn(y),I=T({},Hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),P=wn(I),Z=T({},hl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),se=wn(Z),_e=T({},Hs,{newState:0,oldState:0}),Be=wn(_e),Ht=[9,13,27,32],ct=Ai&&"CompositionEvent"in window,Rt=null;Ai&&"documentMode"in document&&(Rt=document.documentMode);var Ni=Ai&&"TextEvent"in window&&!Rt,ws=Ai&&(!ct||Rt&&8<Rt&&11>=Rt),Qi=" ",Wi=!1;function ea(r,o){switch(r){case"keyup":return Ht.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ml(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var pl=!1;function qD(r,o){switch(r){case"compositionend":return ml(o);case"keypress":return o.which!==32?null:(Wi=!0,Qi);case"textInput":return r=o.data,r===Qi&&Wi?null:r;default:return null}}function jD(r,o){if(pl)return r==="compositionend"||!ct&&ea(r,o)?(r=pu(),Qo=mu=vs=null,pl=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return ws&&o.locale!=="ko"?null:o.data;default:return null}}var BD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function XT(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!BD[r.type]:o==="textarea"}function ZT(r,o,c,d){Mr?_s?_s.push(d):_s=[d]:Mr=d,o=Qf(o,"onChange"),0<o.length&&(c=new Ts("onChange","change",null,c,d),r.push({event:c,listeners:o}))}var vu=null,Tu=null;function GD(r){Vw(r,0)}function lf(r){var o=li(r);if($o(o))return r}function ex(r,o){if(r==="change")return o}var tx=!1;if(Ai){var vg;if(Ai){var Tg="oninput"in document;if(!Tg){var nx=document.createElement("div");nx.setAttribute("oninput","return;"),Tg=typeof nx.oninput=="function"}vg=Tg}else vg=!1;tx=vg&&(!document.documentMode||9<document.documentMode)}function ix(){vu&&(vu.detachEvent("onpropertychange",sx),Tu=vu=null)}function sx(r){if(r.propertyName==="value"&&lf(Tu)){var o=[];ZT(o,Tu,r,Si(r)),kr(GD,o)}}function zD(r,o,c){r==="focusin"?(ix(),vu=o,Tu=c,vu.attachEvent("onpropertychange",sx)):r==="focusout"&&ix()}function HD(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return lf(Tu)}function $D(r,o){if(r==="click")return lf(o)}function KD(r,o){if(r==="input"||r==="change")return lf(o)}function YD(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var ui=typeof Object.is=="function"?Object.is:YD;function xu(r,o){if(ui(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var c=Object.keys(r),d=Object.keys(o);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var v=c[d];if(!Ct.call(o,v)||!ui(r[v],o[v]))return!1}return!0}function rx(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function ox(r,o){var c=rx(r);r=0;for(var d;c;){if(c.nodeType===3){if(d=r+c.textContent.length,r<=o&&d>=o)return{node:c,offset:o-r};r=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=rx(c)}}function ax(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?ax(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function lx(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=ys(r.document);o instanceof r.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)r=o.contentWindow;else break;o=ys(r.document)}return o}function xg(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var JD=Ai&&"documentMode"in document&&11>=document.documentMode,gl=null,Eg=null,Eu=null,wg=!1;function cx(r,o,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;wg||gl==null||gl!==ys(d)||(d=gl,"selectionStart"in d&&xg(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Eu&&xu(Eu,d)||(Eu=d,d=Qf(Eg,"onSelect"),0<d.length&&(o=new Ts("onSelect","select",null,o,c),r.push({event:o,listeners:d}),o.target=gl)))}function ta(r,o){var c={};return c[r.toLowerCase()]=o.toLowerCase(),c["Webkit"+r]="webkit"+o,c["Moz"+r]="moz"+o,c}var yl={animationend:ta("Animation","AnimationEnd"),animationiteration:ta("Animation","AnimationIteration"),animationstart:ta("Animation","AnimationStart"),transitionrun:ta("Transition","TransitionRun"),transitionstart:ta("Transition","TransitionStart"),transitioncancel:ta("Transition","TransitionCancel"),transitionend:ta("Transition","TransitionEnd")},bg={},ux={};Ai&&(ux=document.createElement("div").style,"AnimationEvent"in window||(delete yl.animationend.animation,delete yl.animationiteration.animation,delete yl.animationstart.animation),"TransitionEvent"in window||delete yl.transitionend.transition);function na(r){if(bg[r])return bg[r];if(!yl[r])return r;var o=yl[r],c;for(c in o)if(o.hasOwnProperty(c)&&c in ux)return bg[r]=o[c];return r}var dx=na("animationend"),hx=na("animationiteration"),fx=na("animationstart"),QD=na("transitionrun"),WD=na("transitionstart"),XD=na("transitioncancel"),mx=na("transitionend"),px=new Map,Ig="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ig.push("scrollEnd");function Xi(r,o){px.set(r,o),ps(o,[r])}var cf=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Ci=[],_l=0,Sg=0;function uf(){for(var r=_l,o=Sg=_l=0;o<r;){var c=Ci[o];Ci[o++]=null;var d=Ci[o];Ci[o++]=null;var v=Ci[o];Ci[o++]=null;var x=Ci[o];if(Ci[o++]=null,d!==null&&v!==null){var b=d.pending;b===null?v.next=v:(v.next=b.next,b.next=v),d.pending=v}x!==0&&gx(c,v,x)}}function df(r,o,c,d){Ci[_l++]=r,Ci[_l++]=o,Ci[_l++]=c,Ci[_l++]=d,Sg|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function Ag(r,o,c,d){return df(r,o,c,d),hf(r)}function ia(r,o){return df(r,null,null,o),hf(r)}function gx(r,o,c){r.lanes|=c;var d=r.alternate;d!==null&&(d.lanes|=c);for(var v=!1,x=r.return;x!==null;)x.childLanes|=c,d=x.alternate,d!==null&&(d.childLanes|=c),x.tag===22&&(r=x.stateNode,r===null||r._visibility&1||(v=!0)),r=x,x=x.return;return r.tag===3?(x=r.stateNode,v&&o!==null&&(v=31-zt(c),r=x.hiddenUpdates,d=r[v],d===null?r[v]=[o]:d.push(o),o.lane=c|536870912),x):null}function hf(r){if(50<zu)throw zu=0,Ly=null,Error(i(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var vl={};function ZD(r,o,c,d){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(r,o,c,d){return new ZD(r,o,c,d)}function Ng(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Ks(r,o){var c=r.alternate;return c===null?(c=di(r.tag,o,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=o,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,o=r.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function yx(r,o){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,o=c.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function ff(r,o,c,d,v,x){var b=0;if(d=r,typeof r=="function")Ng(r)&&(b=1);else if(typeof r=="string")b=s2(r,c,pe.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case C:return r=di(31,c,o,v),r.elementType=C,r.lanes=x,r;case V:return sa(c.children,v,x,o);case O:b=8,v|=24;break;case j:return r=di(12,c,o,v|2),r.elementType=j,r.lanes=x,r;case K:return r=di(13,c,o,v),r.elementType=K,r.lanes=x,r;case J:return r=di(19,c,o,v),r.elementType=J,r.lanes=x,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case $:b=10;break e;case W:b=9;break e;case U:b=11;break e;case R:b=14;break e;case A:b=16,d=null;break e}b=29,c=Error(i(130,r===null?"null":typeof r,"")),d=null}return o=di(b,c,o,v),o.elementType=r,o.type=d,o.lanes=x,o}function sa(r,o,c,d){return r=di(7,r,d,o),r.lanes=c,r}function Cg(r,o,c){return r=di(6,r,null,o),r.lanes=c,r}function _x(r){var o=di(18,null,null,0);return o.stateNode=r,o}function Rg(r,o,c){return o=di(4,r.children!==null?r.children:[],r.key,o),o.lanes=c,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var vx=new WeakMap;function Ri(r,o){if(typeof r=="object"&&r!==null){var c=vx.get(r);return c!==void 0?c:(o={value:r,source:o,stack:un(o)},vx.set(r,o),o)}return{value:r,source:o,stack:un(o)}}var Tl=[],xl=0,mf=null,wu=0,Pi=[],Di=0,Or=null,bs=1,Is="";function Ys(r,o){Tl[xl++]=wu,Tl[xl++]=mf,mf=r,wu=o}function Tx(r,o,c){Pi[Di++]=bs,Pi[Di++]=Is,Pi[Di++]=Or,Or=r;var d=bs;r=Is;var v=32-zt(d)-1;d&=~(1<<v),c+=1;var x=32-zt(o)+v;if(30<x){var b=v-v%5;x=(d&(1<<b)-1).toString(32),d>>=b,v-=b,bs=1<<32-zt(o)+v|c<<v|d,Is=x+r}else bs=1<<x|c<<v|d,Is=r}function Pg(r){r.return!==null&&(Ys(r,1),Tx(r,1,0))}function Dg(r){for(;r===mf;)mf=Tl[--xl],Tl[xl]=null,wu=Tl[--xl],Tl[xl]=null;for(;r===Or;)Or=Pi[--Di],Pi[Di]=null,Is=Pi[--Di],Pi[Di]=null,bs=Pi[--Di],Pi[Di]=null}function xx(r,o){Pi[Di++]=bs,Pi[Di++]=Is,Pi[Di++]=Or,bs=o.id,Is=o.overflow,Or=r}var bn=null,It=null,tt=!1,Fr=null,Mi=!1,Mg=Error(i(519));function qr(r){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bu(Ri(o,r)),Mg}function Ex(r){var o=r.stateNode,c=r.type,d=r.memoizedProps;switch(o[Xt]=r,o[pn]=d,c){case"dialog":Je("cancel",o),Je("close",o);break;case"iframe":case"object":case"embed":Je("load",o);break;case"video":case"audio":for(c=0;c<$u.length;c++)Je($u[c],o);break;case"source":Je("error",o);break;case"img":case"image":case"link":Je("error",o),Je("load",o);break;case"details":Je("toggle",o);break;case"input":Je("invalid",o),$h(o,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":Je("invalid",o);break;case"textarea":Je("invalid",o),Pr(o,d.value,d.defaultValue,d.children)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||d.suppressHydrationWarning===!0||Fw(o.textContent,c)?(d.popover!=null&&(Je("beforetoggle",o),Je("toggle",o)),d.onScroll!=null&&Je("scroll",o),d.onScrollEnd!=null&&Je("scrollend",o),d.onClick!=null&&(o.onclick=Ki),o=!0):o=!1,o||qr(r,!0)}function wx(r){for(bn=r.return;bn;)switch(bn.tag){case 5:case 31:case 13:Mi=!1;return;case 27:case 3:Mi=!0;return;default:bn=bn.return}}function El(r){if(r!==bn)return!1;if(!tt)return wx(r),tt=!0,!1;var o=r.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||Wy(r.type,r.memoizedProps)),c=!c),c&&It&&qr(r),wx(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));It=Yw(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));It=Yw(r)}else o===27?(o=It,eo(r.type)?(r=n_,n_=null,It=r):It=o):It=bn?Vi(r.stateNode.nextSibling):null;return!0}function ra(){It=bn=null,tt=!1}function kg(){var r=Fr;return r!==null&&(ti===null?ti=r:ti.push.apply(ti,r),Fr=null),r}function bu(r){Fr===null?Fr=[r]:Fr.push(r)}var Vg=G(null),oa=null,Js=null;function jr(r,o,c){z(Vg,o._currentValue),o._currentValue=c}function Qs(r){r._currentValue=Vg.current,le(Vg)}function Lg(r,o,c){for(;r!==null;){var d=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,d!==null&&(d.childLanes|=o)):d!==null&&(d.childLanes&o)!==o&&(d.childLanes|=o),r===c)break;r=r.return}}function Ug(r,o,c,d){var v=r.child;for(v!==null&&(v.return=r);v!==null;){var x=v.dependencies;if(x!==null){var b=v.child;x=x.firstContext;e:for(;x!==null;){var N=x;x=v;for(var q=0;q<o.length;q++)if(N.context===o[q]){x.lanes|=c,N=x.alternate,N!==null&&(N.lanes|=c),Lg(x.return,c,r),d||(b=null);break e}x=N.next}}else if(v.tag===18){if(b=v.return,b===null)throw Error(i(341));b.lanes|=c,x=b.alternate,x!==null&&(x.lanes|=c),Lg(b,c,r),b=null}else b=v.child;if(b!==null)b.return=v;else for(b=v;b!==null;){if(b===r){b=null;break}if(v=b.sibling,v!==null){v.return=b.return,b=v;break}b=b.return}v=b}}function wl(r,o,c,d){r=null;for(var v=o,x=!1;v!==null;){if(!x){if((v.flags&524288)!==0)x=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var b=v.alternate;if(b===null)throw Error(i(387));if(b=b.memoizedProps,b!==null){var N=v.type;ui(v.pendingProps.value,b.value)||(r!==null?r.push(N):r=[N])}}else if(v===H.current){if(b=v.alternate,b===null)throw Error(i(387));b.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(r!==null?r.push(Wu):r=[Wu])}v=v.return}r!==null&&Ug(o,r,c,d),o.flags|=262144}function pf(r){for(r=r.firstContext;r!==null;){if(!ui(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function aa(r){oa=r,Js=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function In(r){return bx(oa,r)}function gf(r,o){return oa===null&&aa(r),bx(r,o)}function bx(r,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},Js===null){if(r===null)throw Error(i(308));Js=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else Js=Js.next=o;return c}var eM=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(c,d){r.push(d)}};this.abort=function(){o.aborted=!0,r.forEach(function(c){return c()})}},tM=n.unstable_scheduleCallback,nM=n.unstable_NormalPriority,tn={$$typeof:$,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Og(){return{controller:new eM,data:new Map,refCount:0}}function Iu(r){r.refCount--,r.refCount===0&&tM(nM,function(){r.controller.abort()})}var Su=null,Fg=0,bl=0,Il=null;function iM(r,o){if(Su===null){var c=Su=[];Fg=0,bl=By(),Il={status:"pending",value:void 0,then:function(d){c.push(d)}}}return Fg++,o.then(Ix,Ix),o}function Ix(){if(--Fg===0&&Su!==null){Il!==null&&(Il.status="fulfilled");var r=Su;Su=null,bl=0,Il=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function sM(r,o){var c=[],d={status:"pending",value:null,reason:null,then:function(v){c.push(v)}};return r.then(function(){d.status="fulfilled",d.value=o;for(var v=0;v<c.length;v++)(0,c[v])(o)},function(v){for(d.status="rejected",d.reason=v,v=0;v<c.length;v++)(0,c[v])(void 0)}),d}var Sx=X.S;X.S=function(r,o){cw=jn(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&iM(r,o),Sx!==null&&Sx(r,o)};var la=G(null);function qg(){var r=la.current;return r!==null?r:xt.pooledCache}function yf(r,o){o===null?z(la,la.current):z(la,o.pool)}function Ax(){var r=qg();return r===null?null:{parent:tn._currentValue,pool:r}}var Sl=Error(i(460)),jg=Error(i(474)),_f=Error(i(542)),vf={then:function(){}};function Nx(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Cx(r,o,c){switch(c=r[c],c===void 0?r.push(o):c!==o&&(o.then(Ki,Ki),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Px(r),r;default:if(typeof o.status=="string")o.then(Ki,Ki);else{if(r=xt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=o,r.status="pending",r.then(function(d){if(o.status==="pending"){var v=o;v.status="fulfilled",v.value=d}},function(d){if(o.status==="pending"){var v=o;v.status="rejected",v.reason=d}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Px(r),r}throw ua=o,Sl}}function ca(r){try{var o=r._init;return o(r._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(ua=c,Sl):c}}var ua=null;function Rx(){if(ua===null)throw Error(i(459));var r=ua;return ua=null,r}function Px(r){if(r===Sl||r===_f)throw Error(i(483))}var Al=null,Au=0;function Tf(r){var o=Au;return Au+=1,Al===null&&(Al=[]),Cx(Al,r,o)}function Nu(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function xf(r,o){throw o.$$typeof===E?Error(i(525)):(r=Object.prototype.toString.call(o),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function Dx(r){function o(Y,B){if(r){var ee=Y.deletions;ee===null?(Y.deletions=[B],Y.flags|=16):ee.push(B)}}function c(Y,B){if(!r)return null;for(;B!==null;)o(Y,B),B=B.sibling;return null}function d(Y){for(var B=new Map;Y!==null;)Y.key!==null?B.set(Y.key,Y):B.set(Y.index,Y),Y=Y.sibling;return B}function v(Y,B){return Y=Ks(Y,B),Y.index=0,Y.sibling=null,Y}function x(Y,B,ee){return Y.index=ee,r?(ee=Y.alternate,ee!==null?(ee=ee.index,ee<B?(Y.flags|=67108866,B):ee):(Y.flags|=67108866,B)):(Y.flags|=1048576,B)}function b(Y){return r&&Y.alternate===null&&(Y.flags|=67108866),Y}function N(Y,B,ee,ce){return B===null||B.tag!==6?(B=Cg(ee,Y.mode,ce),B.return=Y,B):(B=v(B,ee),B.return=Y,B)}function q(Y,B,ee,ce){var Me=ee.type;return Me===V?ae(Y,B,ee.props.children,ce,ee.key):B!==null&&(B.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===A&&ca(Me)===B.type)?(B=v(B,ee.props),Nu(B,ee),B.return=Y,B):(B=ff(ee.type,ee.key,ee.props,null,Y.mode,ce),Nu(B,ee),B.return=Y,B)}function te(Y,B,ee,ce){return B===null||B.tag!==4||B.stateNode.containerInfo!==ee.containerInfo||B.stateNode.implementation!==ee.implementation?(B=Rg(ee,Y.mode,ce),B.return=Y,B):(B=v(B,ee.children||[]),B.return=Y,B)}function ae(Y,B,ee,ce,Me){return B===null||B.tag!==7?(B=sa(ee,Y.mode,ce,Me),B.return=Y,B):(B=v(B,ee),B.return=Y,B)}function ue(Y,B,ee){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=Cg(""+B,Y.mode,ee),B.return=Y,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case S:return ee=ff(B.type,B.key,B.props,null,Y.mode,ee),Nu(ee,B),ee.return=Y,ee;case k:return B=Rg(B,Y.mode,ee),B.return=Y,B;case A:return B=ca(B),ue(Y,B,ee)}if(Oe(B)||F(B))return B=sa(B,Y.mode,ee,null),B.return=Y,B;if(typeof B.then=="function")return ue(Y,Tf(B),ee);if(B.$$typeof===$)return ue(Y,gf(Y,B),ee);xf(Y,B)}return null}function ne(Y,B,ee,ce){var Me=B!==null?B.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return Me!==null?null:N(Y,B,""+ee,ce);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case S:return ee.key===Me?q(Y,B,ee,ce):null;case k:return ee.key===Me?te(Y,B,ee,ce):null;case A:return ee=ca(ee),ne(Y,B,ee,ce)}if(Oe(ee)||F(ee))return Me!==null?null:ae(Y,B,ee,ce,null);if(typeof ee.then=="function")return ne(Y,B,Tf(ee),ce);if(ee.$$typeof===$)return ne(Y,B,gf(Y,ee),ce);xf(Y,ee)}return null}function re(Y,B,ee,ce,Me){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return Y=Y.get(ee)||null,N(B,Y,""+ce,Me);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case S:return Y=Y.get(ce.key===null?ee:ce.key)||null,q(B,Y,ce,Me);case k:return Y=Y.get(ce.key===null?ee:ce.key)||null,te(B,Y,ce,Me);case A:return ce=ca(ce),re(Y,B,ee,ce,Me)}if(Oe(ce)||F(ce))return Y=Y.get(ee)||null,ae(B,Y,ce,Me,null);if(typeof ce.then=="function")return re(Y,B,ee,Tf(ce),Me);if(ce.$$typeof===$)return re(Y,B,ee,gf(B,ce),Me);xf(B,ce)}return null}function Ae(Y,B,ee,ce){for(var Me=null,rt=null,Ce=B,He=B=0,Ze=null;Ce!==null&&He<ee.length;He++){Ce.index>He?(Ze=Ce,Ce=null):Ze=Ce.sibling;var ot=ne(Y,Ce,ee[He],ce);if(ot===null){Ce===null&&(Ce=Ze);break}r&&Ce&&ot.alternate===null&&o(Y,Ce),B=x(ot,B,He),rt===null?Me=ot:rt.sibling=ot,rt=ot,Ce=Ze}if(He===ee.length)return c(Y,Ce),tt&&Ys(Y,He),Me;if(Ce===null){for(;He<ee.length;He++)Ce=ue(Y,ee[He],ce),Ce!==null&&(B=x(Ce,B,He),rt===null?Me=Ce:rt.sibling=Ce,rt=Ce);return tt&&Ys(Y,He),Me}for(Ce=d(Ce);He<ee.length;He++)Ze=re(Ce,Y,He,ee[He],ce),Ze!==null&&(r&&Ze.alternate!==null&&Ce.delete(Ze.key===null?He:Ze.key),B=x(Ze,B,He),rt===null?Me=Ze:rt.sibling=Ze,rt=Ze);return r&&Ce.forEach(function(ro){return o(Y,ro)}),tt&&Ys(Y,He),Me}function Ve(Y,B,ee,ce){if(ee==null)throw Error(i(151));for(var Me=null,rt=null,Ce=B,He=B=0,Ze=null,ot=ee.next();Ce!==null&&!ot.done;He++,ot=ee.next()){Ce.index>He?(Ze=Ce,Ce=null):Ze=Ce.sibling;var ro=ne(Y,Ce,ot.value,ce);if(ro===null){Ce===null&&(Ce=Ze);break}r&&Ce&&ro.alternate===null&&o(Y,Ce),B=x(ro,B,He),rt===null?Me=ro:rt.sibling=ro,rt=ro,Ce=Ze}if(ot.done)return c(Y,Ce),tt&&Ys(Y,He),Me;if(Ce===null){for(;!ot.done;He++,ot=ee.next())ot=ue(Y,ot.value,ce),ot!==null&&(B=x(ot,B,He),rt===null?Me=ot:rt.sibling=ot,rt=ot);return tt&&Ys(Y,He),Me}for(Ce=d(Ce);!ot.done;He++,ot=ee.next())ot=re(Ce,Y,He,ot.value,ce),ot!==null&&(r&&ot.alternate!==null&&Ce.delete(ot.key===null?He:ot.key),B=x(ot,B,He),rt===null?Me=ot:rt.sibling=ot,rt=ot);return r&&Ce.forEach(function(p2){return o(Y,p2)}),tt&&Ys(Y,He),Me}function Tt(Y,B,ee,ce){if(typeof ee=="object"&&ee!==null&&ee.type===V&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case S:e:{for(var Me=ee.key;B!==null;){if(B.key===Me){if(Me=ee.type,Me===V){if(B.tag===7){c(Y,B.sibling),ce=v(B,ee.props.children),ce.return=Y,Y=ce;break e}}else if(B.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===A&&ca(Me)===B.type){c(Y,B.sibling),ce=v(B,ee.props),Nu(ce,ee),ce.return=Y,Y=ce;break e}c(Y,B);break}else o(Y,B);B=B.sibling}ee.type===V?(ce=sa(ee.props.children,Y.mode,ce,ee.key),ce.return=Y,Y=ce):(ce=ff(ee.type,ee.key,ee.props,null,Y.mode,ce),Nu(ce,ee),ce.return=Y,Y=ce)}return b(Y);case k:e:{for(Me=ee.key;B!==null;){if(B.key===Me)if(B.tag===4&&B.stateNode.containerInfo===ee.containerInfo&&B.stateNode.implementation===ee.implementation){c(Y,B.sibling),ce=v(B,ee.children||[]),ce.return=Y,Y=ce;break e}else{c(Y,B);break}else o(Y,B);B=B.sibling}ce=Rg(ee,Y.mode,ce),ce.return=Y,Y=ce}return b(Y);case A:return ee=ca(ee),Tt(Y,B,ee,ce)}if(Oe(ee))return Ae(Y,B,ee,ce);if(F(ee)){if(Me=F(ee),typeof Me!="function")throw Error(i(150));return ee=Me.call(ee),Ve(Y,B,ee,ce)}if(typeof ee.then=="function")return Tt(Y,B,Tf(ee),ce);if(ee.$$typeof===$)return Tt(Y,B,gf(Y,ee),ce);xf(Y,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,B!==null&&B.tag===6?(c(Y,B.sibling),ce=v(B,ee),ce.return=Y,Y=ce):(c(Y,B),ce=Cg(ee,Y.mode,ce),ce.return=Y,Y=ce),b(Y)):c(Y,B)}return function(Y,B,ee,ce){try{Au=0;var Me=Tt(Y,B,ee,ce);return Al=null,Me}catch(Ce){if(Ce===Sl||Ce===_f)throw Ce;var rt=di(29,Ce,null,Y.mode);return rt.lanes=ce,rt.return=Y,rt}finally{}}}var da=Dx(!0),Mx=Dx(!1),Br=!1;function Bg(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gg(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Gr(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function zr(r,o,c){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(ut&2)!==0){var v=d.pending;return v===null?o.next=o:(o.next=v.next,v.next=o),d.pending=o,o=hf(r),gx(r,null,c),o}return df(r,d,o,c),hf(r)}function Cu(r,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var d=o.lanes;d&=r.pendingLanes,c|=d,o.lanes=c,nu(r,c)}}function zg(r,o){var c=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var v=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var b={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?v=x=b:x=x.next=b,c=c.next}while(c!==null);x===null?v=x=o:x=x.next=o}else v=x=o;c={baseState:d.baseState,firstBaseUpdate:v,lastBaseUpdate:x,shared:d.shared,callbacks:d.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=o:r.next=o,c.lastBaseUpdate=o}var Hg=!1;function Ru(){if(Hg){var r=Il;if(r!==null)throw r}}function Pu(r,o,c,d){Hg=!1;var v=r.updateQueue;Br=!1;var x=v.firstBaseUpdate,b=v.lastBaseUpdate,N=v.shared.pending;if(N!==null){v.shared.pending=null;var q=N,te=q.next;q.next=null,b===null?x=te:b.next=te,b=q;var ae=r.alternate;ae!==null&&(ae=ae.updateQueue,N=ae.lastBaseUpdate,N!==b&&(N===null?ae.firstBaseUpdate=te:N.next=te,ae.lastBaseUpdate=q))}if(x!==null){var ue=v.baseState;b=0,ae=te=q=null,N=x;do{var ne=N.lane&-536870913,re=ne!==N.lane;if(re?(Xe&ne)===ne:(d&ne)===ne){ne!==0&&ne===bl&&(Hg=!0),ae!==null&&(ae=ae.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var Ae=r,Ve=N;ne=o;var Tt=c;switch(Ve.tag){case 1:if(Ae=Ve.payload,typeof Ae=="function"){ue=Ae.call(Tt,ue,ne);break e}ue=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=Ve.payload,ne=typeof Ae=="function"?Ae.call(Tt,ue,ne):Ae,ne==null)break e;ue=T({},ue,ne);break e;case 2:Br=!0}}ne=N.callback,ne!==null&&(r.flags|=64,re&&(r.flags|=8192),re=v.callbacks,re===null?v.callbacks=[ne]:re.push(ne))}else re={lane:ne,tag:N.tag,payload:N.payload,callback:N.callback,next:null},ae===null?(te=ae=re,q=ue):ae=ae.next=re,b|=ne;if(N=N.next,N===null){if(N=v.shared.pending,N===null)break;re=N,N=re.next,re.next=null,v.lastBaseUpdate=re,v.shared.pending=null}}while(!0);ae===null&&(q=ue),v.baseState=q,v.firstBaseUpdate=te,v.lastBaseUpdate=ae,x===null&&(v.shared.lanes=0),Jr|=b,r.lanes=b,r.memoizedState=ue}}function kx(r,o){if(typeof r!="function")throw Error(i(191,r));r.call(o)}function Vx(r,o){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)kx(c[r],o)}var Nl=G(null),Ef=G(0);function Lx(r,o){r=rr,z(Ef,r),z(Nl,o),rr=r|o.baseLanes}function $g(){z(Ef,rr),z(Nl,Nl.current)}function Kg(){rr=Ef.current,le(Nl),le(Ef)}var hi=G(null),ki=null;function Hr(r){var o=r.alternate;z($t,$t.current&1),z(hi,r),ki===null&&(o===null||Nl.current!==null||o.memoizedState!==null)&&(ki=r)}function Yg(r){z($t,$t.current),z(hi,r),ki===null&&(ki=r)}function Ux(r){r.tag===22?(z($t,$t.current),z(hi,r),ki===null&&(ki=r)):$r()}function $r(){z($t,$t.current),z(hi,hi.current)}function fi(r){le(hi),ki===r&&(ki=null),le($t)}var $t=G(0);function wf(r){for(var o=r;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||e_(c)||t_(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Ws=0,Ge=null,_t=null,nn=null,bf=!1,Cl=!1,ha=!1,If=0,Du=0,Rl=null,rM=0;function Ft(){throw Error(i(321))}function Jg(r,o){if(o===null)return!1;for(var c=0;c<o.length&&c<r.length;c++)if(!ui(r[c],o[c]))return!1;return!0}function Qg(r,o,c,d,v,x){return Ws=x,Ge=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,X.H=r===null||r.memoizedState===null?TE:dy,ha=!1,x=c(d,v),ha=!1,Cl&&(x=Fx(o,c,d,v)),Ox(r),x}function Ox(r){X.H=Vu;var o=_t!==null&&_t.next!==null;if(Ws=0,nn=_t=Ge=null,bf=!1,Du=0,Rl=null,o)throw Error(i(300));r===null||sn||(r=r.dependencies,r!==null&&pf(r)&&(sn=!0))}function Fx(r,o,c,d){Ge=r;var v=0;do{if(Cl&&(Rl=null),Du=0,Cl=!1,25<=v)throw Error(i(301));if(v+=1,nn=_t=null,r.updateQueue!=null){var x=r.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}X.H=xE,x=o(c,d)}while(Cl);return x}function oM(){var r=X.H,o=r.useState()[0];return o=typeof o.then=="function"?Mu(o):o,r=r.useState()[0],(_t!==null?_t.memoizedState:null)!==r&&(Ge.flags|=1024),o}function Wg(){var r=If!==0;return If=0,r}function Xg(r,o,c){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~c}function Zg(r){if(bf){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}bf=!1}Ws=0,nn=_t=Ge=null,Cl=!1,Du=If=0,Rl=null}function Gn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nn===null?Ge.memoizedState=nn=r:nn=nn.next=r,nn}function Kt(){if(_t===null){var r=Ge.alternate;r=r!==null?r.memoizedState:null}else r=_t.next;var o=nn===null?Ge.memoizedState:nn.next;if(o!==null)nn=o,_t=r;else{if(r===null)throw Ge.alternate===null?Error(i(467)):Error(i(310));_t=r,r={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},nn===null?Ge.memoizedState=nn=r:nn=nn.next=r}return nn}function Sf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Mu(r){var o=Du;return Du+=1,Rl===null&&(Rl=[]),r=Cx(Rl,r,o),o=Ge,(nn===null?o.memoizedState:nn.next)===null&&(o=o.alternate,X.H=o===null||o.memoizedState===null?TE:dy),r}function Af(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Mu(r);if(r.$$typeof===$)return In(r)}throw Error(i(438,String(r)))}function ey(r){var o=null,c=Ge.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var d=Ge.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(o={data:d.data.map(function(v){return v.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=Sf(),Ge.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(r),d=0;d<r;d++)c[d]=M;return o.index++,c}function Xs(r,o){return typeof o=="function"?o(r):o}function Nf(r){var o=Kt();return ty(o,_t,r)}function ty(r,o,c){var d=r.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=c;var v=r.baseQueue,x=d.pending;if(x!==null){if(v!==null){var b=v.next;v.next=x.next,x.next=b}o.baseQueue=v=x,d.pending=null}if(x=r.baseState,v===null)r.memoizedState=x;else{o=v.next;var N=b=null,q=null,te=o,ae=!1;do{var ue=te.lane&-536870913;if(ue!==te.lane?(Xe&ue)===ue:(Ws&ue)===ue){var ne=te.revertLane;if(ne===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),ue===bl&&(ae=!0);else if((Ws&ne)===ne){te=te.next,ne===bl&&(ae=!0);continue}else ue={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},q===null?(N=q=ue,b=x):q=q.next=ue,Ge.lanes|=ne,Jr|=ne;ue=te.action,ha&&c(x,ue),x=te.hasEagerState?te.eagerState:c(x,ue)}else ne={lane:ue,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},q===null?(N=q=ne,b=x):q=q.next=ne,Ge.lanes|=ue,Jr|=ue;te=te.next}while(te!==null&&te!==o);if(q===null?b=x:q.next=N,!ui(x,r.memoizedState)&&(sn=!0,ae&&(c=Il,c!==null)))throw c;r.memoizedState=x,r.baseState=b,r.baseQueue=q,d.lastRenderedState=x}return v===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function ny(r){var o=Kt(),c=o.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=r;var d=c.dispatch,v=c.pending,x=o.memoizedState;if(v!==null){c.pending=null;var b=v=v.next;do x=r(x,b.action),b=b.next;while(b!==v);ui(x,o.memoizedState)||(sn=!0),o.memoizedState=x,o.baseQueue===null&&(o.baseState=x),c.lastRenderedState=x}return[x,d]}function qx(r,o,c){var d=Ge,v=Kt(),x=tt;if(x){if(c===void 0)throw Error(i(407));c=c()}else c=o();var b=!ui((_t||v).memoizedState,c);if(b&&(v.memoizedState=c,sn=!0),v=v.queue,ry(Gx.bind(null,d,v,r),[r]),v.getSnapshot!==o||b||nn!==null&&nn.memoizedState.tag&1){if(d.flags|=2048,Pl(9,{destroy:void 0},Bx.bind(null,d,v,c,o),null),xt===null)throw Error(i(349));x||(Ws&127)!==0||jx(d,o,c)}return c}function jx(r,o,c){r.flags|=16384,r={getSnapshot:o,value:c},o=Ge.updateQueue,o===null?(o=Sf(),Ge.updateQueue=o,o.stores=[r]):(c=o.stores,c===null?o.stores=[r]:c.push(r))}function Bx(r,o,c,d){o.value=c,o.getSnapshot=d,zx(o)&&Hx(r)}function Gx(r,o,c){return c(function(){zx(o)&&Hx(r)})}function zx(r){var o=r.getSnapshot;r=r.value;try{var c=o();return!ui(r,c)}catch{return!0}}function Hx(r){var o=ia(r,2);o!==null&&ni(o,r,2)}function iy(r){var o=Gn();if(typeof r=="function"){var c=r;if(r=c(),ha){bi(!0);try{c()}finally{bi(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:r},o}function $x(r,o,c,d){return r.baseState=c,ty(r,_t,typeof d=="function"?d:Xs)}function aM(r,o,c,d,v){if(Pf(r))throw Error(i(485));if(r=o.action,r!==null){var x={payload:v,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){x.listeners.push(b)}};X.T!==null?c(!0):x.isTransition=!1,d(x),c=o.pending,c===null?(x.next=o.pending=x,Kx(o,x)):(x.next=c.next,o.pending=c.next=x)}}function Kx(r,o){var c=o.action,d=o.payload,v=r.state;if(o.isTransition){var x=X.T,b={};X.T=b;try{var N=c(v,d),q=X.S;q!==null&&q(b,N),Yx(r,o,N)}catch(te){sy(r,o,te)}finally{x!==null&&b.types!==null&&(x.types=b.types),X.T=x}}else try{x=c(v,d),Yx(r,o,x)}catch(te){sy(r,o,te)}}function Yx(r,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){Jx(r,o,d)},function(d){return sy(r,o,d)}):Jx(r,o,c)}function Jx(r,o,c){o.status="fulfilled",o.value=c,Qx(o),r.state=c,o=r.pending,o!==null&&(c=o.next,c===o?r.pending=null:(c=c.next,o.next=c,Kx(r,c)))}function sy(r,o,c){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do o.status="rejected",o.reason=c,Qx(o),o=o.next;while(o!==d)}r.action=null}function Qx(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function Wx(r,o){return o}function Xx(r,o){if(tt){var c=xt.formState;if(c!==null){e:{var d=Ge;if(tt){if(It){t:{for(var v=It,x=Mi;v.nodeType!==8;){if(!x){v=null;break t}if(v=Vi(v.nextSibling),v===null){v=null;break t}}x=v.data,v=x==="F!"||x==="F"?v:null}if(v){It=Vi(v.nextSibling),d=v.data==="F!";break e}}qr(d)}d=!1}d&&(o=c[0])}}return c=Gn(),c.memoizedState=c.baseState=o,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wx,lastRenderedState:o},c.queue=d,c=yE.bind(null,Ge,d),d.dispatch=c,d=iy(!1),x=uy.bind(null,Ge,!1,d.queue),d=Gn(),v={state:o,dispatch:null,action:r,pending:null},d.queue=v,c=aM.bind(null,Ge,v,x,c),v.dispatch=c,d.memoizedState=r,[o,c,!1]}function Zx(r){var o=Kt();return eE(o,_t,r)}function eE(r,o,c){if(o=ty(r,o,Wx)[0],r=Nf(Xs)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var d=Mu(o)}catch(b){throw b===Sl?_f:b}else d=o;o=Kt();var v=o.queue,x=v.dispatch;return c!==o.memoizedState&&(Ge.flags|=2048,Pl(9,{destroy:void 0},lM.bind(null,v,c),null)),[d,x,r]}function lM(r,o){r.action=o}function tE(r){var o=Kt(),c=_t;if(c!==null)return eE(o,c,r);Kt(),o=o.memoizedState,c=Kt();var d=c.queue.dispatch;return c.memoizedState=r,[o,d,!1]}function Pl(r,o,c,d){return r={tag:r,create:c,deps:d,inst:o,next:null},o=Ge.updateQueue,o===null&&(o=Sf(),Ge.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=r.next=r:(d=c.next,c.next=r,r.next=d,o.lastEffect=r),r}function nE(){return Kt().memoizedState}function Cf(r,o,c,d){var v=Gn();Ge.flags|=r,v.memoizedState=Pl(1|o,{destroy:void 0},c,d===void 0?null:d)}function Rf(r,o,c,d){var v=Kt();d=d===void 0?null:d;var x=v.memoizedState.inst;_t!==null&&d!==null&&Jg(d,_t.memoizedState.deps)?v.memoizedState=Pl(o,x,c,d):(Ge.flags|=r,v.memoizedState=Pl(1|o,x,c,d))}function iE(r,o){Cf(8390656,8,r,o)}function ry(r,o){Rf(2048,8,r,o)}function cM(r){Ge.flags|=4;var o=Ge.updateQueue;if(o===null)o=Sf(),Ge.updateQueue=o,o.events=[r];else{var c=o.events;c===null?o.events=[r]:c.push(r)}}function sE(r){var o=Kt().memoizedState;return cM({ref:o,nextImpl:r}),function(){if((ut&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function rE(r,o){return Rf(4,2,r,o)}function oE(r,o){return Rf(4,4,r,o)}function aE(r,o){if(typeof o=="function"){r=r();var c=o(r);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function lE(r,o,c){c=c!=null?c.concat([r]):null,Rf(4,4,aE.bind(null,o,r),c)}function oy(){}function cE(r,o){var c=Kt();o=o===void 0?null:o;var d=c.memoizedState;return o!==null&&Jg(o,d[1])?d[0]:(c.memoizedState=[r,o],r)}function uE(r,o){var c=Kt();o=o===void 0?null:o;var d=c.memoizedState;if(o!==null&&Jg(o,d[1]))return d[0];if(d=r(),ha){bi(!0);try{r()}finally{bi(!1)}}return c.memoizedState=[d,o],d}function ay(r,o,c){return c===void 0||(Ws&1073741824)!==0&&(Xe&261930)===0?r.memoizedState=o:(r.memoizedState=c,r=dw(),Ge.lanes|=r,Jr|=r,c)}function dE(r,o,c,d){return ui(c,o)?c:Nl.current!==null?(r=ay(r,c,d),ui(r,o)||(sn=!0),r):(Ws&42)===0||(Ws&1073741824)!==0&&(Xe&261930)===0?(sn=!0,r.memoizedState=c):(r=dw(),Ge.lanes|=r,Jr|=r,o)}function hE(r,o,c,d,v){var x=fe.p;fe.p=x!==0&&8>x?x:8;var b=X.T,N={};X.T=N,uy(r,!1,o,c);try{var q=v(),te=X.S;if(te!==null&&te(N,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var ae=sM(q,d);ku(r,o,ae,gi(r))}else ku(r,o,d,gi(r))}catch(ue){ku(r,o,{then:function(){},status:"rejected",reason:ue},gi())}finally{fe.p=x,b!==null&&N.types!==null&&(b.types=N.types),X.T=b}}function uM(){}function ly(r,o,c,d){if(r.tag!==5)throw Error(i(476));var v=fE(r).queue;hE(r,v,o,Re,c===null?uM:function(){return mE(r),c(d)})}function fE(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:Re,baseState:Re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:Re},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:c},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function mE(r){var o=fE(r);o.next===null&&(o=r.alternate.memoizedState),ku(r,o.next.queue,{},gi())}function cy(){return In(Wu)}function pE(){return Kt().memoizedState}function gE(){return Kt().memoizedState}function dM(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var c=gi();r=Gr(c);var d=zr(o,r,c);d!==null&&(ni(d,o,c),Cu(d,o,c)),o={cache:Og()},r.payload=o;return}o=o.return}}function hM(r,o,c){var d=gi();c={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Pf(r)?_E(o,c):(c=Ag(r,o,c,d),c!==null&&(ni(c,r,d),vE(c,o,d)))}function yE(r,o,c){var d=gi();ku(r,o,c,d)}function ku(r,o,c,d){var v={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Pf(r))_E(o,v);else{var x=r.alternate;if(r.lanes===0&&(x===null||x.lanes===0)&&(x=o.lastRenderedReducer,x!==null))try{var b=o.lastRenderedState,N=x(b,c);if(v.hasEagerState=!0,v.eagerState=N,ui(N,b))return df(r,o,v,0),xt===null&&uf(),!1}catch{}finally{}if(c=Ag(r,o,v,d),c!==null)return ni(c,r,d),vE(c,o,d),!0}return!1}function uy(r,o,c,d){if(d={lane:2,revertLane:By(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},Pf(r)){if(o)throw Error(i(479))}else o=Ag(r,c,d,2),o!==null&&ni(o,r,2)}function Pf(r){var o=r.alternate;return r===Ge||o!==null&&o===Ge}function _E(r,o){Cl=bf=!0;var c=r.pending;c===null?o.next=o:(o.next=c.next,c.next=o),r.pending=o}function vE(r,o,c){if((c&4194048)!==0){var d=o.lanes;d&=r.pendingLanes,c|=d,o.lanes=c,nu(r,c)}}var Vu={readContext:In,use:Af,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useLayoutEffect:Ft,useInsertionEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useSyncExternalStore:Ft,useId:Ft,useHostTransitionStatus:Ft,useFormState:Ft,useActionState:Ft,useOptimistic:Ft,useMemoCache:Ft,useCacheRefresh:Ft};Vu.useEffectEvent=Ft;var TE={readContext:In,use:Af,useCallback:function(r,o){return Gn().memoizedState=[r,o===void 0?null:o],r},useContext:In,useEffect:iE,useImperativeHandle:function(r,o,c){c=c!=null?c.concat([r]):null,Cf(4194308,4,aE.bind(null,o,r),c)},useLayoutEffect:function(r,o){return Cf(4194308,4,r,o)},useInsertionEffect:function(r,o){Cf(4,2,r,o)},useMemo:function(r,o){var c=Gn();o=o===void 0?null:o;var d=r();if(ha){bi(!0);try{r()}finally{bi(!1)}}return c.memoizedState=[d,o],d},useReducer:function(r,o,c){var d=Gn();if(c!==void 0){var v=c(o);if(ha){bi(!0);try{c(o)}finally{bi(!1)}}}else v=o;return d.memoizedState=d.baseState=v,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:v},d.queue=r,r=r.dispatch=hM.bind(null,Ge,r),[d.memoizedState,r]},useRef:function(r){var o=Gn();return r={current:r},o.memoizedState=r},useState:function(r){r=iy(r);var o=r.queue,c=yE.bind(null,Ge,o);return o.dispatch=c,[r.memoizedState,c]},useDebugValue:oy,useDeferredValue:function(r,o){var c=Gn();return ay(c,r,o)},useTransition:function(){var r=iy(!1);return r=hE.bind(null,Ge,r.queue,!0,!1),Gn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,c){var d=Ge,v=Gn();if(tt){if(c===void 0)throw Error(i(407));c=c()}else{if(c=o(),xt===null)throw Error(i(349));(Xe&127)!==0||jx(d,o,c)}v.memoizedState=c;var x={value:c,getSnapshot:o};return v.queue=x,iE(Gx.bind(null,d,x,r),[r]),d.flags|=2048,Pl(9,{destroy:void 0},Bx.bind(null,d,x,c,o),null),c},useId:function(){var r=Gn(),o=xt.identifierPrefix;if(tt){var c=Is,d=bs;c=(d&~(1<<32-zt(d)-1)).toString(32)+c,o="_"+o+"R_"+c,c=If++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=rM++,o="_"+o+"r_"+c.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:cy,useFormState:Xx,useActionState:Xx,useOptimistic:function(r){var o=Gn();o.memoizedState=o.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=uy.bind(null,Ge,!0,c),c.dispatch=o,[r,o]},useMemoCache:ey,useCacheRefresh:function(){return Gn().memoizedState=dM.bind(null,Ge)},useEffectEvent:function(r){var o=Gn(),c={impl:r};return o.memoizedState=c,function(){if((ut&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},dy={readContext:In,use:Af,useCallback:cE,useContext:In,useEffect:ry,useImperativeHandle:lE,useInsertionEffect:rE,useLayoutEffect:oE,useMemo:uE,useReducer:Nf,useRef:nE,useState:function(){return Nf(Xs)},useDebugValue:oy,useDeferredValue:function(r,o){var c=Kt();return dE(c,_t.memoizedState,r,o)},useTransition:function(){var r=Nf(Xs)[0],o=Kt().memoizedState;return[typeof r=="boolean"?r:Mu(r),o]},useSyncExternalStore:qx,useId:pE,useHostTransitionStatus:cy,useFormState:Zx,useActionState:Zx,useOptimistic:function(r,o){var c=Kt();return $x(c,_t,r,o)},useMemoCache:ey,useCacheRefresh:gE};dy.useEffectEvent=sE;var xE={readContext:In,use:Af,useCallback:cE,useContext:In,useEffect:ry,useImperativeHandle:lE,useInsertionEffect:rE,useLayoutEffect:oE,useMemo:uE,useReducer:ny,useRef:nE,useState:function(){return ny(Xs)},useDebugValue:oy,useDeferredValue:function(r,o){var c=Kt();return _t===null?ay(c,r,o):dE(c,_t.memoizedState,r,o)},useTransition:function(){var r=ny(Xs)[0],o=Kt().memoizedState;return[typeof r=="boolean"?r:Mu(r),o]},useSyncExternalStore:qx,useId:pE,useHostTransitionStatus:cy,useFormState:tE,useActionState:tE,useOptimistic:function(r,o){var c=Kt();return _t!==null?$x(c,_t,r,o):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:ey,useCacheRefresh:gE};xE.useEffectEvent=sE;function hy(r,o,c,d){o=r.memoizedState,c=c(d,o),c=c==null?o:T({},o,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var fy={enqueueSetState:function(r,o,c){r=r._reactInternals;var d=gi(),v=Gr(d);v.payload=o,c!=null&&(v.callback=c),o=zr(r,v,d),o!==null&&(ni(o,r,d),Cu(o,r,d))},enqueueReplaceState:function(r,o,c){r=r._reactInternals;var d=gi(),v=Gr(d);v.tag=1,v.payload=o,c!=null&&(v.callback=c),o=zr(r,v,d),o!==null&&(ni(o,r,d),Cu(o,r,d))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var c=gi(),d=Gr(c);d.tag=2,o!=null&&(d.callback=o),o=zr(r,d,c),o!==null&&(ni(o,r,c),Cu(o,r,c))}};function EE(r,o,c,d,v,x,b){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,x,b):o.prototype&&o.prototype.isPureReactComponent?!xu(c,d)||!xu(v,x):!0}function wE(r,o,c,d){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,d),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,d),o.state!==r&&fy.enqueueReplaceState(o,o.state,null)}function fa(r,o){var c=o;if("ref"in o){c={};for(var d in o)d!=="ref"&&(c[d]=o[d])}if(r=r.defaultProps){c===o&&(c=T({},c));for(var v in r)c[v]===void 0&&(c[v]=r[v])}return c}function bE(r){cf(r)}function IE(r){console.error(r)}function SE(r){cf(r)}function Df(r,o){try{var c=r.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(d){setTimeout(function(){throw d})}}function AE(r,o,c){try{var d=r.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function my(r,o,c){return c=Gr(c),c.tag=3,c.payload={element:null},c.callback=function(){Df(r,o)},c}function NE(r){return r=Gr(r),r.tag=3,r}function CE(r,o,c,d){var v=c.type.getDerivedStateFromError;if(typeof v=="function"){var x=d.value;r.payload=function(){return v(x)},r.callback=function(){AE(o,c,d)}}var b=c.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(r.callback=function(){AE(o,c,d),typeof v!="function"&&(Qr===null?Qr=new Set([this]):Qr.add(this));var N=d.stack;this.componentDidCatch(d.value,{componentStack:N!==null?N:""})})}function fM(r,o,c,d,v){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(o=c.alternate,o!==null&&wl(o,c,v,!0),c=hi.current,c!==null){switch(c.tag){case 31:case 13:return ki===null?zf():c.alternate===null&&qt===0&&(qt=3),c.flags&=-257,c.flags|=65536,c.lanes=v,d===vf?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([d]):o.add(d),Fy(r,d,v)),!1;case 22:return c.flags|=65536,d===vf?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([d]):c.add(d)),Fy(r,d,v)),!1}throw Error(i(435,c.tag))}return Fy(r,d,v),zf(),!1}if(tt)return o=hi.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=v,d!==Mg&&(r=Error(i(422),{cause:d}),bu(Ri(r,c)))):(d!==Mg&&(o=Error(i(423),{cause:d}),bu(Ri(o,c))),r=r.current.alternate,r.flags|=65536,v&=-v,r.lanes|=v,d=Ri(d,c),v=my(r.stateNode,d,v),zg(r,v),qt!==4&&(qt=2)),!1;var x=Error(i(520),{cause:d});if(x=Ri(x,c),Gu===null?Gu=[x]:Gu.push(x),qt!==4&&(qt=2),o===null)return!0;d=Ri(d,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,r=v&-v,c.lanes|=r,r=my(c.stateNode,d,r),zg(c,r),!1;case 1:if(o=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Qr===null||!Qr.has(x))))return c.flags|=65536,v&=-v,c.lanes|=v,v=NE(v),CE(v,r,c,d),zg(c,v),!1}c=c.return}while(c!==null);return!1}var py=Error(i(461)),sn=!1;function Sn(r,o,c,d){o.child=r===null?Mx(o,null,c,d):da(o,r.child,c,d)}function RE(r,o,c,d,v){c=c.render;var x=o.ref;if("ref"in d){var b={};for(var N in d)N!=="ref"&&(b[N]=d[N])}else b=d;return aa(o),d=Qg(r,o,c,b,x,v),N=Wg(),r!==null&&!sn?(Xg(r,o,v),Zs(r,o,v)):(tt&&N&&Pg(o),o.flags|=1,Sn(r,o,d,v),o.child)}function PE(r,o,c,d,v){if(r===null){var x=c.type;return typeof x=="function"&&!Ng(x)&&x.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=x,DE(r,o,x,d,v)):(r=ff(c.type,null,d,o,o.mode,v),r.ref=o.ref,r.return=o,o.child=r)}if(x=r.child,!wy(r,v)){var b=x.memoizedProps;if(c=c.compare,c=c!==null?c:xu,c(b,d)&&r.ref===o.ref)return Zs(r,o,v)}return o.flags|=1,r=Ks(x,d),r.ref=o.ref,r.return=o,o.child=r}function DE(r,o,c,d,v){if(r!==null){var x=r.memoizedProps;if(xu(x,d)&&r.ref===o.ref)if(sn=!1,o.pendingProps=d=x,wy(r,v))(r.flags&131072)!==0&&(sn=!0);else return o.lanes=r.lanes,Zs(r,o,v)}return gy(r,o,c,d,v)}function ME(r,o,c,d){var v=d.children,x=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((o.flags&128)!==0){if(x=x!==null?x.baseLanes|c:c,r!==null){for(d=o.child=r.child,v=0;d!==null;)v=v|d.lanes|d.childLanes,d=d.sibling;d=v&~x}else d=0,o.child=null;return kE(r,o,x,c,d)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&yf(o,x!==null?x.cachePool:null),x!==null?Lx(o,x):$g(),Ux(o);else return d=o.lanes=536870912,kE(r,o,x!==null?x.baseLanes|c:c,c,d)}else x!==null?(yf(o,x.cachePool),Lx(o,x),$r(),o.memoizedState=null):(r!==null&&yf(o,null),$g(),$r());return Sn(r,o,v,c),o.child}function Lu(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function kE(r,o,c,d,v){var x=qg();return x=x===null?null:{parent:tn._currentValue,pool:x},o.memoizedState={baseLanes:c,cachePool:x},r!==null&&yf(o,null),$g(),Ux(o),r!==null&&wl(r,o,d,!0),o.childLanes=v,null}function Mf(r,o){return o=Vf({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function VE(r,o,c){return da(o,r.child,null,c),r=Mf(o,o.pendingProps),r.flags|=2,fi(o),o.memoizedState=null,r}function mM(r,o,c){var d=o.pendingProps,v=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(tt){if(d.mode==="hidden")return r=Mf(o,d),o.lanes=536870912,Lu(null,r);if(Yg(o),(r=It)?(r=Kw(r,Mi),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Or!==null?{id:bs,overflow:Is}:null,retryLane:536870912,hydrationErrors:null},c=_x(r),c.return=o,o.child=c,bn=o,It=null)):r=null,r===null)throw qr(o);return o.lanes=536870912,null}return Mf(o,d)}var x=r.memoizedState;if(x!==null){var b=x.dehydrated;if(Yg(o),v)if(o.flags&256)o.flags&=-257,o=VE(r,o,c);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(i(558));else if(sn||wl(r,o,c,!1),v=(c&r.childLanes)!==0,sn||v){if(d=xt,d!==null&&(b=iu(d,c),b!==0&&b!==x.retryLane))throw x.retryLane=b,ia(r,b),ni(d,r,b),py;zf(),o=VE(r,o,c)}else r=x.treeContext,It=Vi(b.nextSibling),bn=o,tt=!0,Fr=null,Mi=!1,r!==null&&xx(o,r),o=Mf(o,d),o.flags|=4096;return o}return r=Ks(r.child,{mode:d.mode,children:d.children}),r.ref=o.ref,o.child=r,r.return=o,r}function kf(r,o){var c=o.ref;if(c===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(r===null||r.ref!==c)&&(o.flags|=4194816)}}function gy(r,o,c,d,v){return aa(o),c=Qg(r,o,c,d,void 0,v),d=Wg(),r!==null&&!sn?(Xg(r,o,v),Zs(r,o,v)):(tt&&d&&Pg(o),o.flags|=1,Sn(r,o,c,v),o.child)}function LE(r,o,c,d,v,x){return aa(o),o.updateQueue=null,c=Fx(o,d,c,v),Ox(r),d=Wg(),r!==null&&!sn?(Xg(r,o,x),Zs(r,o,x)):(tt&&d&&Pg(o),o.flags|=1,Sn(r,o,c,x),o.child)}function UE(r,o,c,d,v){if(aa(o),o.stateNode===null){var x=vl,b=c.contextType;typeof b=="object"&&b!==null&&(x=In(b)),x=new c(d,x),o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=fy,o.stateNode=x,x._reactInternals=o,x=o.stateNode,x.props=d,x.state=o.memoizedState,x.refs={},Bg(o),b=c.contextType,x.context=typeof b=="object"&&b!==null?In(b):vl,x.state=o.memoizedState,b=c.getDerivedStateFromProps,typeof b=="function"&&(hy(o,c,b,d),x.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(b=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),b!==x.state&&fy.enqueueReplaceState(x,x.state,null),Pu(o,d,x,v),Ru(),x.state=o.memoizedState),typeof x.componentDidMount=="function"&&(o.flags|=4194308),d=!0}else if(r===null){x=o.stateNode;var N=o.memoizedProps,q=fa(c,N);x.props=q;var te=x.context,ae=c.contextType;b=vl,typeof ae=="object"&&ae!==null&&(b=In(ae));var ue=c.getDerivedStateFromProps;ae=typeof ue=="function"||typeof x.getSnapshotBeforeUpdate=="function",N=o.pendingProps!==N,ae||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(N||te!==b)&&wE(o,x,d,b),Br=!1;var ne=o.memoizedState;x.state=ne,Pu(o,d,x,v),Ru(),te=o.memoizedState,N||ne!==te||Br?(typeof ue=="function"&&(hy(o,c,ue,d),te=o.memoizedState),(q=Br||EE(o,c,q,d,ne,te,b))?(ae||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(o.flags|=4194308)):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=d,o.memoizedState=te),x.props=d,x.state=te,x.context=b,d=q):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),d=!1)}else{x=o.stateNode,Gg(r,o),b=o.memoizedProps,ae=fa(c,b),x.props=ae,ue=o.pendingProps,ne=x.context,te=c.contextType,q=vl,typeof te=="object"&&te!==null&&(q=In(te)),N=c.getDerivedStateFromProps,(te=typeof N=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(b!==ue||ne!==q)&&wE(o,x,d,q),Br=!1,ne=o.memoizedState,x.state=ne,Pu(o,d,x,v),Ru();var re=o.memoizedState;b!==ue||ne!==re||Br||r!==null&&r.dependencies!==null&&pf(r.dependencies)?(typeof N=="function"&&(hy(o,c,N,d),re=o.memoizedState),(ae=Br||EE(o,c,ae,d,ne,re,q)||r!==null&&r.dependencies!==null&&pf(r.dependencies))?(te||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(d,re,q),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(d,re,q)),typeof x.componentDidUpdate=="function"&&(o.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof x.componentDidUpdate!="function"||b===r.memoizedProps&&ne===r.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||b===r.memoizedProps&&ne===r.memoizedState||(o.flags|=1024),o.memoizedProps=d,o.memoizedState=re),x.props=d,x.state=re,x.context=q,d=ae):(typeof x.componentDidUpdate!="function"||b===r.memoizedProps&&ne===r.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||b===r.memoizedProps&&ne===r.memoizedState||(o.flags|=1024),d=!1)}return x=d,kf(r,o),d=(o.flags&128)!==0,x||d?(x=o.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:x.render(),o.flags|=1,r!==null&&d?(o.child=da(o,r.child,null,v),o.child=da(o,null,c,v)):Sn(r,o,c,v),o.memoizedState=x.state,r=o.child):r=Zs(r,o,v),r}function OE(r,o,c,d){return ra(),o.flags|=256,Sn(r,o,c,d),o.child}var yy={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function _y(r){return{baseLanes:r,cachePool:Ax()}}function vy(r,o,c){return r=r!==null?r.childLanes&~c:0,o&&(r|=pi),r}function FE(r,o,c){var d=o.pendingProps,v=!1,x=(o.flags&128)!==0,b;if((b=x)||(b=r!==null&&r.memoizedState===null?!1:($t.current&2)!==0),b&&(v=!0,o.flags&=-129),b=(o.flags&32)!==0,o.flags&=-33,r===null){if(tt){if(v?Hr(o):$r(),(r=It)?(r=Kw(r,Mi),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Or!==null?{id:bs,overflow:Is}:null,retryLane:536870912,hydrationErrors:null},c=_x(r),c.return=o,o.child=c,bn=o,It=null)):r=null,r===null)throw qr(o);return t_(r)?o.lanes=32:o.lanes=536870912,null}var N=d.children;return d=d.fallback,v?($r(),v=o.mode,N=Vf({mode:"hidden",children:N},v),d=sa(d,v,c,null),N.return=o,d.return=o,N.sibling=d,o.child=N,d=o.child,d.memoizedState=_y(c),d.childLanes=vy(r,b,c),o.memoizedState=yy,Lu(null,d)):(Hr(o),Ty(o,N))}var q=r.memoizedState;if(q!==null&&(N=q.dehydrated,N!==null)){if(x)o.flags&256?(Hr(o),o.flags&=-257,o=xy(r,o,c)):o.memoizedState!==null?($r(),o.child=r.child,o.flags|=128,o=null):($r(),N=d.fallback,v=o.mode,d=Vf({mode:"visible",children:d.children},v),N=sa(N,v,c,null),N.flags|=2,d.return=o,N.return=o,d.sibling=N,o.child=d,da(o,r.child,null,c),d=o.child,d.memoizedState=_y(c),d.childLanes=vy(r,b,c),o.memoizedState=yy,o=Lu(null,d));else if(Hr(o),t_(N)){if(b=N.nextSibling&&N.nextSibling.dataset,b)var te=b.dgst;b=te,d=Error(i(419)),d.stack="",d.digest=b,bu({value:d,source:null,stack:null}),o=xy(r,o,c)}else if(sn||wl(r,o,c,!1),b=(c&r.childLanes)!==0,sn||b){if(b=xt,b!==null&&(d=iu(b,c),d!==0&&d!==q.retryLane))throw q.retryLane=d,ia(r,d),ni(b,r,d),py;e_(N)||zf(),o=xy(r,o,c)}else e_(N)?(o.flags|=192,o.child=r.child,o=null):(r=q.treeContext,It=Vi(N.nextSibling),bn=o,tt=!0,Fr=null,Mi=!1,r!==null&&xx(o,r),o=Ty(o,d.children),o.flags|=4096);return o}return v?($r(),N=d.fallback,v=o.mode,q=r.child,te=q.sibling,d=Ks(q,{mode:"hidden",children:d.children}),d.subtreeFlags=q.subtreeFlags&65011712,te!==null?N=Ks(te,N):(N=sa(N,v,c,null),N.flags|=2),N.return=o,d.return=o,d.sibling=N,o.child=d,Lu(null,d),d=o.child,N=r.child.memoizedState,N===null?N=_y(c):(v=N.cachePool,v!==null?(q=tn._currentValue,v=v.parent!==q?{parent:q,pool:q}:v):v=Ax(),N={baseLanes:N.baseLanes|c,cachePool:v}),d.memoizedState=N,d.childLanes=vy(r,b,c),o.memoizedState=yy,Lu(r.child,d)):(Hr(o),c=r.child,r=c.sibling,c=Ks(c,{mode:"visible",children:d.children}),c.return=o,c.sibling=null,r!==null&&(b=o.deletions,b===null?(o.deletions=[r],o.flags|=16):b.push(r)),o.child=c,o.memoizedState=null,c)}function Ty(r,o){return o=Vf({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function Vf(r,o){return r=di(22,r,null,o),r.lanes=0,r}function xy(r,o,c){return da(o,r.child,null,c),r=Ty(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function qE(r,o,c){r.lanes|=o;var d=r.alternate;d!==null&&(d.lanes|=o),Lg(r.return,o,c)}function Ey(r,o,c,d,v,x){var b=r.memoizedState;b===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:v,treeForkCount:x}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=d,b.tail=c,b.tailMode=v,b.treeForkCount=x)}function jE(r,o,c){var d=o.pendingProps,v=d.revealOrder,x=d.tail;d=d.children;var b=$t.current,N=(b&2)!==0;if(N?(b=b&1|2,o.flags|=128):b&=1,z($t,b),Sn(r,o,d,c),d=tt?wu:0,!N&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&qE(r,c,o);else if(r.tag===19)qE(r,c,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(v){case"forwards":for(c=o.child,v=null;c!==null;)r=c.alternate,r!==null&&wf(r)===null&&(v=c),c=c.sibling;c=v,c===null?(v=o.child,o.child=null):(v=c.sibling,c.sibling=null),Ey(o,!1,v,c,x,d);break;case"backwards":case"unstable_legacy-backwards":for(c=null,v=o.child,o.child=null;v!==null;){if(r=v.alternate,r!==null&&wf(r)===null){o.child=v;break}r=v.sibling,v.sibling=c,c=v,v=r}Ey(o,!0,c,null,x,d);break;case"together":Ey(o,!1,null,null,void 0,d);break;default:o.memoizedState=null}return o.child}function Zs(r,o,c){if(r!==null&&(o.dependencies=r.dependencies),Jr|=o.lanes,(c&o.childLanes)===0)if(r!==null){if(wl(r,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(i(153));if(o.child!==null){for(r=o.child,c=Ks(r,r.pendingProps),o.child=c,c.return=o;r.sibling!==null;)r=r.sibling,c=c.sibling=Ks(r,r.pendingProps),c.return=o;c.sibling=null}return o.child}function wy(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&pf(r)))}function pM(r,o,c){switch(o.tag){case 3:ge(o,o.stateNode.containerInfo),jr(o,tn,r.memoizedState.cache),ra();break;case 27:case 5:Le(o);break;case 4:ge(o,o.stateNode.containerInfo);break;case 10:jr(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Yg(o),null;break;case 13:var d=o.memoizedState;if(d!==null)return d.dehydrated!==null?(Hr(o),o.flags|=128,null):(c&o.child.childLanes)!==0?FE(r,o,c):(Hr(o),r=Zs(r,o,c),r!==null?r.sibling:null);Hr(o);break;case 19:var v=(r.flags&128)!==0;if(d=(c&o.childLanes)!==0,d||(wl(r,o,c,!1),d=(c&o.childLanes)!==0),v){if(d)return jE(r,o,c);o.flags|=128}if(v=o.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),z($t,$t.current),d)break;return null;case 22:return o.lanes=0,ME(r,o,c,o.pendingProps);case 24:jr(o,tn,r.memoizedState.cache)}return Zs(r,o,c)}function BE(r,o,c){if(r!==null)if(r.memoizedProps!==o.pendingProps)sn=!0;else{if(!wy(r,c)&&(o.flags&128)===0)return sn=!1,pM(r,o,c);sn=(r.flags&131072)!==0}else sn=!1,tt&&(o.flags&1048576)!==0&&Tx(o,wu,o.index);switch(o.lanes=0,o.tag){case 16:e:{var d=o.pendingProps;if(r=ca(o.elementType),o.type=r,typeof r=="function")Ng(r)?(d=fa(r,d),o.tag=1,o=UE(null,o,r,d,c)):(o.tag=0,o=gy(null,o,r,d,c));else{if(r!=null){var v=r.$$typeof;if(v===U){o.tag=11,o=RE(null,o,r,d,c);break e}else if(v===R){o.tag=14,o=PE(null,o,r,d,c);break e}}throw o=ye(r)||r,Error(i(306,o,""))}}return o;case 0:return gy(r,o,o.type,o.pendingProps,c);case 1:return d=o.type,v=fa(d,o.pendingProps),UE(r,o,d,v,c);case 3:e:{if(ge(o,o.stateNode.containerInfo),r===null)throw Error(i(387));d=o.pendingProps;var x=o.memoizedState;v=x.element,Gg(r,o),Pu(o,d,null,c);var b=o.memoizedState;if(d=b.cache,jr(o,tn,d),d!==x.cache&&Ug(o,[tn],c,!0),Ru(),d=b.element,x.isDehydrated)if(x={element:d,isDehydrated:!1,cache:b.cache},o.updateQueue.baseState=x,o.memoizedState=x,o.flags&256){o=OE(r,o,d,c);break e}else if(d!==v){v=Ri(Error(i(424)),o),bu(v),o=OE(r,o,d,c);break e}else{switch(r=o.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(It=Vi(r.firstChild),bn=o,tt=!0,Fr=null,Mi=!0,c=Mx(o,null,d,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(ra(),d===v){o=Zs(r,o,c);break e}Sn(r,o,d,c)}o=o.child}return o;case 26:return kf(r,o),r===null?(c=Zw(o.type,null,o.pendingProps,null))?o.memoizedState=c:tt||(c=o.type,r=o.pendingProps,d=Wf(Ie.current).createElement(c),d[Xt]=o,d[pn]=r,An(d,c,r),Zt(d),o.stateNode=d):o.memoizedState=Zw(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Le(o),r===null&&tt&&(d=o.stateNode=Qw(o.type,o.pendingProps,Ie.current),bn=o,Mi=!0,v=It,eo(o.type)?(n_=v,It=Vi(d.firstChild)):It=v),Sn(r,o,o.pendingProps.children,c),kf(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&tt&&((v=d=It)&&(d=HM(d,o.type,o.pendingProps,Mi),d!==null?(o.stateNode=d,bn=o,It=Vi(d.firstChild),Mi=!1,v=!0):v=!1),v||qr(o)),Le(o),v=o.type,x=o.pendingProps,b=r!==null?r.memoizedProps:null,d=x.children,Wy(v,x)?d=null:b!==null&&Wy(v,b)&&(o.flags|=32),o.memoizedState!==null&&(v=Qg(r,o,oM,null,null,c),Wu._currentValue=v),kf(r,o),Sn(r,o,d,c),o.child;case 6:return r===null&&tt&&((r=c=It)&&(c=$M(c,o.pendingProps,Mi),c!==null?(o.stateNode=c,bn=o,It=null,r=!0):r=!1),r||qr(o)),null;case 13:return FE(r,o,c);case 4:return ge(o,o.stateNode.containerInfo),d=o.pendingProps,r===null?o.child=da(o,null,d,c):Sn(r,o,d,c),o.child;case 11:return RE(r,o,o.type,o.pendingProps,c);case 7:return Sn(r,o,o.pendingProps,c),o.child;case 8:return Sn(r,o,o.pendingProps.children,c),o.child;case 12:return Sn(r,o,o.pendingProps.children,c),o.child;case 10:return d=o.pendingProps,jr(o,o.type,d.value),Sn(r,o,d.children,c),o.child;case 9:return v=o.type._context,d=o.pendingProps.children,aa(o),v=In(v),d=d(v),o.flags|=1,Sn(r,o,d,c),o.child;case 14:return PE(r,o,o.type,o.pendingProps,c);case 15:return DE(r,o,o.type,o.pendingProps,c);case 19:return jE(r,o,c);case 31:return mM(r,o,c);case 22:return ME(r,o,c,o.pendingProps);case 24:return aa(o),d=In(tn),r===null?(v=qg(),v===null&&(v=xt,x=Og(),v.pooledCache=x,x.refCount++,x!==null&&(v.pooledCacheLanes|=c),v=x),o.memoizedState={parent:d,cache:v},Bg(o),jr(o,tn,v)):((r.lanes&c)!==0&&(Gg(r,o),Pu(o,null,null,c),Ru()),v=r.memoizedState,x=o.memoizedState,v.parent!==d?(v={parent:d,cache:d},o.memoizedState=v,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=v),jr(o,tn,d)):(d=x.cache,jr(o,tn,d),d!==v.cache&&Ug(o,[tn],c,!0))),Sn(r,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function er(r){r.flags|=4}function by(r,o,c,d,v){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(v&335544128)===v)if(r.stateNode.complete)r.flags|=8192;else if(pw())r.flags|=8192;else throw ua=vf,jg}else r.flags&=-16777217}function GE(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!sb(o))if(pw())r.flags|=8192;else throw ua=vf,jg}function Lf(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?jh():536870912,r.lanes|=o,Vl|=o)}function Uu(r,o){if(!tt)switch(r.tailMode){case"hidden":o=r.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function St(r){var o=r.alternate!==null&&r.alternate.child===r.child,c=0,d=0;if(o)for(var v=r.child;v!==null;)c|=v.lanes|v.childLanes,d|=v.subtreeFlags&65011712,d|=v.flags&65011712,v.return=r,v=v.sibling;else for(v=r.child;v!==null;)c|=v.lanes|v.childLanes,d|=v.subtreeFlags,d|=v.flags,v.return=r,v=v.sibling;return r.subtreeFlags|=d,r.childLanes=c,o}function gM(r,o,c){var d=o.pendingProps;switch(Dg(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(o),null;case 1:return St(o),null;case 3:return c=o.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),Qs(tn),Se(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(El(o)?er(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,kg())),St(o),null;case 26:var v=o.type,x=o.memoizedState;return r===null?(er(o),x!==null?(St(o),GE(o,x)):(St(o),by(o,v,null,d,c))):x?x!==r.memoizedState?(er(o),St(o),GE(o,x)):(St(o),o.flags&=-16777217):(r=r.memoizedProps,r!==d&&er(o),St(o),by(o,v,r,d,c)),null;case 27:if(qe(o),c=Ie.current,v=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==d&&er(o);else{if(!d){if(o.stateNode===null)throw Error(i(166));return St(o),null}r=pe.current,El(o)?Ex(o):(r=Qw(v,d,c),o.stateNode=r,er(o))}return St(o),null;case 5:if(qe(o),v=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==d&&er(o);else{if(!d){if(o.stateNode===null)throw Error(i(166));return St(o),null}if(x=pe.current,El(o))Ex(o);else{var b=Wf(Ie.current);switch(x){case 1:x=b.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:x=b.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":x=b.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":x=b.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":x=b.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof d.is=="string"?b.createElement("select",{is:d.is}):b.createElement("select"),d.multiple?x.multiple=!0:d.size&&(x.size=d.size);break;default:x=typeof d.is=="string"?b.createElement(v,{is:d.is}):b.createElement(v)}}x[Xt]=o,x[pn]=d;e:for(b=o.child;b!==null;){if(b.tag===5||b.tag===6)x.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===o)break e;for(;b.sibling===null;){if(b.return===null||b.return===o)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}o.stateNode=x;e:switch(An(x,v,d),v){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&er(o)}}return St(o),by(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,c),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==d&&er(o);else{if(typeof d!="string"&&o.stateNode===null)throw Error(i(166));if(r=Ie.current,El(o)){if(r=o.stateNode,c=o.memoizedProps,d=null,v=bn,v!==null)switch(v.tag){case 27:case 5:d=v.memoizedProps}r[Xt]=o,r=!!(r.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||Fw(r.nodeValue,c)),r||qr(o,!0)}else r=Wf(r).createTextNode(d),r[Xt]=o,o.stateNode=r}return St(o),null;case 31:if(c=o.memoizedState,r===null||r.memoizedState!==null){if(d=El(o),c!==null){if(r===null){if(!d)throw Error(i(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Xt]=o}else ra(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;St(o),r=!1}else c=kg(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=c),r=!0;if(!r)return o.flags&256?(fi(o),o):(fi(o),null);if((o.flags&128)!==0)throw Error(i(558))}return St(o),null;case 13:if(d=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(v=El(o),d!==null&&d.dehydrated!==null){if(r===null){if(!v)throw Error(i(318));if(v=o.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(i(317));v[Xt]=o}else ra(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;St(o),v=!1}else v=kg(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=v),v=!0;if(!v)return o.flags&256?(fi(o),o):(fi(o),null)}return fi(o),(o.flags&128)!==0?(o.lanes=c,o):(c=d!==null,r=r!==null&&r.memoizedState!==null,c&&(d=o.child,v=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(v=d.alternate.memoizedState.cachePool.pool),x=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),x!==v&&(d.flags|=2048)),c!==r&&c&&(o.child.flags|=8192),Lf(o,o.updateQueue),St(o),null);case 4:return Se(),r===null&&$y(o.stateNode.containerInfo),St(o),null;case 10:return Qs(o.type),St(o),null;case 19:if(le($t),d=o.memoizedState,d===null)return St(o),null;if(v=(o.flags&128)!==0,x=d.rendering,x===null)if(v)Uu(d,!1);else{if(qt!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(x=wf(r),x!==null){for(o.flags|=128,Uu(d,!1),r=x.updateQueue,o.updateQueue=r,Lf(o,r),o.subtreeFlags=0,r=c,c=o.child;c!==null;)yx(c,r),c=c.sibling;return z($t,$t.current&1|2),tt&&Ys(o,d.treeForkCount),o.child}r=r.sibling}d.tail!==null&&jn()>jf&&(o.flags|=128,v=!0,Uu(d,!1),o.lanes=4194304)}else{if(!v)if(r=wf(x),r!==null){if(o.flags|=128,v=!0,r=r.updateQueue,o.updateQueue=r,Lf(o,r),Uu(d,!0),d.tail===null&&d.tailMode==="hidden"&&!x.alternate&&!tt)return St(o),null}else 2*jn()-d.renderingStartTime>jf&&c!==536870912&&(o.flags|=128,v=!0,Uu(d,!1),o.lanes=4194304);d.isBackwards?(x.sibling=o.child,o.child=x):(r=d.last,r!==null?r.sibling=x:o.child=x,d.last=x)}return d.tail!==null?(r=d.tail,d.rendering=r,d.tail=r.sibling,d.renderingStartTime=jn(),r.sibling=null,c=$t.current,z($t,v?c&1|2:c&1),tt&&Ys(o,d.treeForkCount),r):(St(o),null);case 22:case 23:return fi(o),Kg(),d=o.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(o.flags|=8192):d&&(o.flags|=8192),d?(c&536870912)!==0&&(o.flags&128)===0&&(St(o),o.subtreeFlags&6&&(o.flags|=8192)):St(o),c=o.updateQueue,c!==null&&Lf(o,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),d=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(d=o.memoizedState.cachePool.pool),d!==c&&(o.flags|=2048),r!==null&&le(la),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),Qs(tn),St(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function yM(r,o){switch(Dg(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Qs(tn),Se(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return qe(o),null;case 31:if(o.memoizedState!==null){if(fi(o),o.alternate===null)throw Error(i(340));ra()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(fi(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(i(340));ra()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return le($t),null;case 4:return Se(),null;case 10:return Qs(o.type),null;case 22:case 23:return fi(o),Kg(),r!==null&&le(la),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return Qs(tn),null;case 25:return null;default:return null}}function zE(r,o){switch(Dg(o),o.tag){case 3:Qs(tn),Se();break;case 26:case 27:case 5:qe(o);break;case 4:Se();break;case 31:o.memoizedState!==null&&fi(o);break;case 13:fi(o);break;case 19:le($t);break;case 10:Qs(o.type);break;case 22:case 23:fi(o),Kg(),r!==null&&le(la);break;case 24:Qs(tn)}}function Ou(r,o){try{var c=o.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var v=d.next;c=v;do{if((c.tag&r)===r){d=void 0;var x=c.create,b=c.inst;d=x(),b.destroy=d}c=c.next}while(c!==v)}}catch(N){mt(o,o.return,N)}}function Kr(r,o,c){try{var d=o.updateQueue,v=d!==null?d.lastEffect:null;if(v!==null){var x=v.next;d=x;do{if((d.tag&r)===r){var b=d.inst,N=b.destroy;if(N!==void 0){b.destroy=void 0,v=o;var q=c,te=N;try{te()}catch(ae){mt(v,q,ae)}}}d=d.next}while(d!==x)}}catch(ae){mt(o,o.return,ae)}}function HE(r){var o=r.updateQueue;if(o!==null){var c=r.stateNode;try{Vx(o,c)}catch(d){mt(r,r.return,d)}}}function $E(r,o,c){c.props=fa(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(d){mt(r,o,d)}}function Fu(r,o){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof c=="function"?r.refCleanup=c(d):c.current=d}}catch(v){mt(r,o,v)}}function Ss(r,o){var c=r.ref,d=r.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(v){mt(r,o,v)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(v){mt(r,o,v)}else c.current=null}function KE(r){var o=r.type,c=r.memoizedProps,d=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(v){mt(r,r.return,v)}}function Iy(r,o,c){try{var d=r.stateNode;FM(d,r.type,c,o),d[pn]=o}catch(v){mt(r,r.return,v)}}function YE(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&eo(r.type)||r.tag===4}function Sy(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||YE(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&eo(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Ay(r,o,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(r),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Ki));else if(d!==4&&(d===27&&eo(r.type)&&(c=r.stateNode,o=null),r=r.child,r!==null))for(Ay(r,o,c),r=r.sibling;r!==null;)Ay(r,o,c),r=r.sibling}function Uf(r,o,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,o?c.insertBefore(r,o):c.appendChild(r);else if(d!==4&&(d===27&&eo(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(Uf(r,o,c),r=r.sibling;r!==null;)Uf(r,o,c),r=r.sibling}function JE(r){var o=r.stateNode,c=r.memoizedProps;try{for(var d=r.type,v=o.attributes;v.length;)o.removeAttributeNode(v[0]);An(o,d,c),o[Xt]=r,o[pn]=c}catch(x){mt(r,r.return,x)}}var tr=!1,rn=!1,Ny=!1,QE=typeof WeakSet=="function"?WeakSet:Set,yn=null;function _M(r,o){if(r=r.containerInfo,Jy=sm,r=lx(r),xg(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var v=d.anchorOffset,x=d.focusNode;d=d.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var b=0,N=-1,q=-1,te=0,ae=0,ue=r,ne=null;t:for(;;){for(var re;ue!==c||v!==0&&ue.nodeType!==3||(N=b+v),ue!==x||d!==0&&ue.nodeType!==3||(q=b+d),ue.nodeType===3&&(b+=ue.nodeValue.length),(re=ue.firstChild)!==null;)ne=ue,ue=re;for(;;){if(ue===r)break t;if(ne===c&&++te===v&&(N=b),ne===x&&++ae===d&&(q=b),(re=ue.nextSibling)!==null)break;ue=ne,ne=ue.parentNode}ue=re}c=N===-1||q===-1?null:{start:N,end:q}}else c=null}c=c||{start:0,end:0}}else c=null;for(Qy={focusedElem:r,selectionRange:c},sm=!1,yn=o;yn!==null;)if(o=yn,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,yn=r;else for(;yn!==null;){switch(o=yn,x=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(c=0;c<r.length;c++)v=r[c],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&x!==null){r=void 0,c=o,v=x.memoizedProps,x=x.memoizedState,d=c.stateNode;try{var Ae=fa(c.type,v);r=d.getSnapshotBeforeUpdate(Ae,x),d.__reactInternalSnapshotBeforeUpdate=r}catch(Ve){mt(c,c.return,Ve)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,c=r.nodeType,c===9)Zy(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Zy(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=o.sibling,r!==null){r.return=o.return,yn=r;break}yn=o.return}}function WE(r,o,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:ir(r,c),d&4&&Ou(5,c);break;case 1:if(ir(r,c),d&4)if(r=c.stateNode,o===null)try{r.componentDidMount()}catch(b){mt(c,c.return,b)}else{var v=fa(c.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(v,o,r.__reactInternalSnapshotBeforeUpdate)}catch(b){mt(c,c.return,b)}}d&64&&HE(c),d&512&&Fu(c,c.return);break;case 3:if(ir(r,c),d&64&&(r=c.updateQueue,r!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{Vx(r,o)}catch(b){mt(c,c.return,b)}}break;case 27:o===null&&d&4&&JE(c);case 26:case 5:ir(r,c),o===null&&d&4&&KE(c),d&512&&Fu(c,c.return);break;case 12:ir(r,c);break;case 31:ir(r,c),d&4&&ew(r,c);break;case 13:ir(r,c),d&4&&tw(r,c),d&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=AM.bind(null,c),KM(r,c))));break;case 22:if(d=c.memoizedState!==null||tr,!d){o=o!==null&&o.memoizedState!==null||rn,v=tr;var x=rn;tr=d,(rn=o)&&!x?sr(r,c,(c.subtreeFlags&8772)!==0):ir(r,c),tr=v,rn=x}break;case 30:break;default:ir(r,c)}}function XE(r){var o=r.alternate;o!==null&&(r.alternate=null,XE(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&rl(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Pt=null,Xn=!1;function nr(r,o,c){for(c=c.child;c!==null;)ZE(r,o,c),c=c.sibling}function ZE(r,o,c){if(En&&typeof En.onCommitFiberUnmount=="function")try{En.onCommitFiberUnmount(Gi,c)}catch{}switch(c.tag){case 26:rn||Ss(c,o),nr(r,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:rn||Ss(c,o);var d=Pt,v=Xn;eo(c.type)&&(Pt=c.stateNode,Xn=!1),nr(r,o,c),Yu(c.stateNode),Pt=d,Xn=v;break;case 5:rn||Ss(c,o);case 6:if(d=Pt,v=Xn,Pt=null,nr(r,o,c),Pt=d,Xn=v,Pt!==null)if(Xn)try{(Pt.nodeType===9?Pt.body:Pt.nodeName==="HTML"?Pt.ownerDocument.body:Pt).removeChild(c.stateNode)}catch(x){mt(c,o,x)}else try{Pt.removeChild(c.stateNode)}catch(x){mt(c,o,x)}break;case 18:Pt!==null&&(Xn?(r=Pt,Hw(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),Gl(r)):Hw(Pt,c.stateNode));break;case 4:d=Pt,v=Xn,Pt=c.stateNode.containerInfo,Xn=!0,nr(r,o,c),Pt=d,Xn=v;break;case 0:case 11:case 14:case 15:Kr(2,c,o),rn||Kr(4,c,o),nr(r,o,c);break;case 1:rn||(Ss(c,o),d=c.stateNode,typeof d.componentWillUnmount=="function"&&$E(c,o,d)),nr(r,o,c);break;case 21:nr(r,o,c);break;case 22:rn=(d=rn)||c.memoizedState!==null,nr(r,o,c),rn=d;break;default:nr(r,o,c)}}function ew(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Gl(r)}catch(c){mt(o,o.return,c)}}}function tw(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Gl(r)}catch(c){mt(o,o.return,c)}}function vM(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new QE),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new QE),o;default:throw Error(i(435,r.tag))}}function Of(r,o){var c=vM(r);o.forEach(function(d){if(!c.has(d)){c.add(d);var v=NM.bind(null,r,d);d.then(v,v)}})}function Zn(r,o){var c=o.deletions;if(c!==null)for(var d=0;d<c.length;d++){var v=c[d],x=r,b=o,N=b;e:for(;N!==null;){switch(N.tag){case 27:if(eo(N.type)){Pt=N.stateNode,Xn=!1;break e}break;case 5:Pt=N.stateNode,Xn=!1;break e;case 3:case 4:Pt=N.stateNode.containerInfo,Xn=!0;break e}N=N.return}if(Pt===null)throw Error(i(160));ZE(x,b,v),Pt=null,Xn=!1,x=v.alternate,x!==null&&(x.return=null),v.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)nw(o,r),o=o.sibling}var Zi=null;function nw(r,o){var c=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Zn(o,r),ei(r),d&4&&(Kr(3,r,r.return),Ou(3,r),Kr(5,r,r.return));break;case 1:Zn(o,r),ei(r),d&512&&(rn||c===null||Ss(c,c.return)),d&64&&tr&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var v=Zi;if(Zn(o,r),ei(r),d&512&&(rn||c===null||Ss(c,c.return)),d&4){var x=c!==null?c.memoizedState:null;if(d=r.memoizedState,c===null)if(d===null)if(r.stateNode===null){e:{d=r.type,c=r.memoizedProps,v=v.ownerDocument||v;t:switch(d){case"title":x=v.getElementsByTagName("title")[0],(!x||x[hs]||x[Xt]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=v.createElement(d),v.head.insertBefore(x,v.querySelector("head > title"))),An(x,d,c),x[Xt]=r,Zt(x),d=x;break e;case"link":var b=nb("link","href",v).get(d+(c.href||""));if(b){for(var N=0;N<b.length;N++)if(x=b[N],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){b.splice(N,1);break t}}x=v.createElement(d),An(x,d,c),v.head.appendChild(x);break;case"meta":if(b=nb("meta","content",v).get(d+(c.content||""))){for(N=0;N<b.length;N++)if(x=b[N],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){b.splice(N,1);break t}}x=v.createElement(d),An(x,d,c),v.head.appendChild(x);break;default:throw Error(i(468,d))}x[Xt]=r,Zt(x),d=x}r.stateNode=d}else ib(v,r.type,r.stateNode);else r.stateNode=tb(v,d,r.memoizedProps);else x!==d?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,d===null?ib(v,r.type,r.stateNode):tb(v,d,r.memoizedProps)):d===null&&r.stateNode!==null&&Iy(r,r.memoizedProps,c.memoizedProps)}break;case 27:Zn(o,r),ei(r),d&512&&(rn||c===null||Ss(c,c.return)),c!==null&&d&4&&Iy(r,r.memoizedProps,c.memoizedProps);break;case 5:if(Zn(o,r),ei(r),d&512&&(rn||c===null||Ss(c,c.return)),r.flags&32){v=r.stateNode;try{Wn(v,"")}catch(Ae){mt(r,r.return,Ae)}}d&4&&r.stateNode!=null&&(v=r.memoizedProps,Iy(r,v,c!==null?c.memoizedProps:v)),d&1024&&(Ny=!0);break;case 6:if(Zn(o,r),ei(r),d&4){if(r.stateNode===null)throw Error(i(162));d=r.memoizedProps,c=r.stateNode;try{c.nodeValue=d}catch(Ae){mt(r,r.return,Ae)}}break;case 3:if(em=null,v=Zi,Zi=Xf(o.containerInfo),Zn(o,r),Zi=v,ei(r),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Gl(o.containerInfo)}catch(Ae){mt(r,r.return,Ae)}Ny&&(Ny=!1,iw(r));break;case 4:d=Zi,Zi=Xf(r.stateNode.containerInfo),Zn(o,r),ei(r),Zi=d;break;case 12:Zn(o,r),ei(r);break;case 31:Zn(o,r),ei(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Of(r,d)));break;case 13:Zn(o,r),ei(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(qf=jn()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Of(r,d)));break;case 22:v=r.memoizedState!==null;var q=c!==null&&c.memoizedState!==null,te=tr,ae=rn;if(tr=te||v,rn=ae||q,Zn(o,r),rn=ae,tr=te,ei(r),d&8192)e:for(o=r.stateNode,o._visibility=v?o._visibility&-2:o._visibility|1,v&&(c===null||q||tr||rn||ma(r)),c=null,o=r;;){if(o.tag===5||o.tag===26){if(c===null){q=c=o;try{if(x=q.stateNode,v)b=x.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{N=q.stateNode;var ue=q.memoizedProps.style,ne=ue!=null&&ue.hasOwnProperty("display")?ue.display:null;N.style.display=ne==null||typeof ne=="boolean"?"":(""+ne).trim()}}catch(Ae){mt(q,q.return,Ae)}}}else if(o.tag===6){if(c===null){q=o;try{q.stateNode.nodeValue=v?"":q.memoizedProps}catch(Ae){mt(q,q.return,Ae)}}}else if(o.tag===18){if(c===null){q=o;try{var re=q.stateNode;v?$w(re,!0):$w(q.stateNode,!1)}catch(Ae){mt(q,q.return,Ae)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}d&4&&(d=r.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,Of(r,c))));break;case 19:Zn(o,r),ei(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Of(r,d)));break;case 30:break;case 21:break;default:Zn(o,r),ei(r)}}function ei(r){var o=r.flags;if(o&2){try{for(var c,d=r.return;d!==null;){if(YE(d)){c=d;break}d=d.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var v=c.stateNode,x=Sy(r);Uf(r,x,v);break;case 5:var b=c.stateNode;c.flags&32&&(Wn(b,""),c.flags&=-33);var N=Sy(r);Uf(r,N,b);break;case 3:case 4:var q=c.stateNode.containerInfo,te=Sy(r);Ay(r,te,q);break;default:throw Error(i(161))}}catch(ae){mt(r,r.return,ae)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function iw(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;iw(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function ir(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)WE(r,o.alternate,o),o=o.sibling}function ma(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:Kr(4,o,o.return),ma(o);break;case 1:Ss(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&$E(o,o.return,c),ma(o);break;case 27:Yu(o.stateNode);case 26:case 5:Ss(o,o.return),ma(o);break;case 22:o.memoizedState===null&&ma(o);break;case 30:ma(o);break;default:ma(o)}r=r.sibling}}function sr(r,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var d=o.alternate,v=r,x=o,b=x.flags;switch(x.tag){case 0:case 11:case 15:sr(v,x,c),Ou(4,x);break;case 1:if(sr(v,x,c),d=x,v=d.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(te){mt(d,d.return,te)}if(d=x,v=d.updateQueue,v!==null){var N=d.stateNode;try{var q=v.shared.hiddenCallbacks;if(q!==null)for(v.shared.hiddenCallbacks=null,v=0;v<q.length;v++)kx(q[v],N)}catch(te){mt(d,d.return,te)}}c&&b&64&&HE(x),Fu(x,x.return);break;case 27:JE(x);case 26:case 5:sr(v,x,c),c&&d===null&&b&4&&KE(x),Fu(x,x.return);break;case 12:sr(v,x,c);break;case 31:sr(v,x,c),c&&b&4&&ew(v,x);break;case 13:sr(v,x,c),c&&b&4&&tw(v,x);break;case 22:x.memoizedState===null&&sr(v,x,c),Fu(x,x.return);break;case 30:break;default:sr(v,x,c)}o=o.sibling}}function Cy(r,o){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&Iu(c))}function Ry(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Iu(r))}function es(r,o,c,d){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)sw(r,o,c,d),o=o.sibling}function sw(r,o,c,d){var v=o.flags;switch(o.tag){case 0:case 11:case 15:es(r,o,c,d),v&2048&&Ou(9,o);break;case 1:es(r,o,c,d);break;case 3:es(r,o,c,d),v&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Iu(r)));break;case 12:if(v&2048){es(r,o,c,d),r=o.stateNode;try{var x=o.memoizedProps,b=x.id,N=x.onPostCommit;typeof N=="function"&&N(b,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(q){mt(o,o.return,q)}}else es(r,o,c,d);break;case 31:es(r,o,c,d);break;case 13:es(r,o,c,d);break;case 23:break;case 22:x=o.stateNode,b=o.alternate,o.memoizedState!==null?x._visibility&2?es(r,o,c,d):qu(r,o):x._visibility&2?es(r,o,c,d):(x._visibility|=2,Dl(r,o,c,d,(o.subtreeFlags&10256)!==0||!1)),v&2048&&Cy(b,o);break;case 24:es(r,o,c,d),v&2048&&Ry(o.alternate,o);break;default:es(r,o,c,d)}}function Dl(r,o,c,d,v){for(v=v&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var x=r,b=o,N=c,q=d,te=b.flags;switch(b.tag){case 0:case 11:case 15:Dl(x,b,N,q,v),Ou(8,b);break;case 23:break;case 22:var ae=b.stateNode;b.memoizedState!==null?ae._visibility&2?Dl(x,b,N,q,v):qu(x,b):(ae._visibility|=2,Dl(x,b,N,q,v)),v&&te&2048&&Cy(b.alternate,b);break;case 24:Dl(x,b,N,q,v),v&&te&2048&&Ry(b.alternate,b);break;default:Dl(x,b,N,q,v)}o=o.sibling}}function qu(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=r,d=o,v=d.flags;switch(d.tag){case 22:qu(c,d),v&2048&&Cy(d.alternate,d);break;case 24:qu(c,d),v&2048&&Ry(d.alternate,d);break;default:qu(c,d)}o=o.sibling}}var ju=8192;function Ml(r,o,c){if(r.subtreeFlags&ju)for(r=r.child;r!==null;)rw(r,o,c),r=r.sibling}function rw(r,o,c){switch(r.tag){case 26:Ml(r,o,c),r.flags&ju&&r.memoizedState!==null&&r2(c,Zi,r.memoizedState,r.memoizedProps);break;case 5:Ml(r,o,c);break;case 3:case 4:var d=Zi;Zi=Xf(r.stateNode.containerInfo),Ml(r,o,c),Zi=d;break;case 22:r.memoizedState===null&&(d=r.alternate,d!==null&&d.memoizedState!==null?(d=ju,ju=16777216,Ml(r,o,c),ju=d):Ml(r,o,c));break;default:Ml(r,o,c)}}function ow(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Bu(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];yn=d,lw(d,r)}ow(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)aw(r),r=r.sibling}function aw(r){switch(r.tag){case 0:case 11:case 15:Bu(r),r.flags&2048&&Kr(9,r,r.return);break;case 3:Bu(r);break;case 12:Bu(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,Ff(r)):Bu(r);break;default:Bu(r)}}function Ff(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];yn=d,lw(d,r)}ow(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:Kr(8,o,o.return),Ff(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,Ff(o));break;default:Ff(o)}r=r.sibling}}function lw(r,o){for(;yn!==null;){var c=yn;switch(c.tag){case 0:case 11:case 15:Kr(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Iu(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,yn=d;else e:for(c=r;yn!==null;){d=yn;var v=d.sibling,x=d.return;if(XE(d),d===c){yn=null;break e}if(v!==null){v.return=x,yn=v;break e}yn=x}}}var TM={getCacheForType:function(r){var o=In(tn),c=o.data.get(r);return c===void 0&&(c=r(),o.data.set(r,c)),c},cacheSignal:function(){return In(tn).controller.signal}},xM=typeof WeakMap=="function"?WeakMap:Map,ut=0,xt=null,Ye=null,Xe=0,ft=0,mi=null,Yr=!1,kl=!1,Py=!1,rr=0,qt=0,Jr=0,pa=0,Dy=0,pi=0,Vl=0,Gu=null,ti=null,My=!1,qf=0,cw=0,jf=1/0,Bf=null,Qr=null,hn=0,Wr=null,Ll=null,or=0,ky=0,Vy=null,uw=null,zu=0,Ly=null;function gi(){return(ut&2)!==0&&Xe!==0?Xe&-Xe:X.T!==null?By():Bh()}function dw(){if(pi===0)if((Xe&536870912)===0||tt){var r=Bo;Bo<<=1,(Bo&3932160)===0&&(Bo=262144),pi=r}else pi=536870912;return r=hi.current,r!==null&&(r.flags|=32),pi}function ni(r,o,c){(r===xt&&(ft===2||ft===9)||r.cancelPendingCommit!==null)&&(Ul(r,0),Xr(r,Xe,pi,!1)),Go(r,c),((ut&2)===0||r!==xt)&&(r===xt&&((ut&2)===0&&(pa|=c),qt===4&&Xr(r,Xe,pi,!1)),As(r))}function hw(r,o,c){if((ut&6)!==0)throw Error(i(327));var d=!c&&(o&127)===0&&(o&r.expiredLanes)===0||zi(r,o),v=d?bM(r,o):Oy(r,o,!0),x=d;do{if(v===0){kl&&!d&&Xr(r,o,0,!1);break}else{if(c=r.current.alternate,x&&!EM(c)){v=Oy(r,o,!1),x=!1;continue}if(v===2){if(x=o,r.errorRecoveryDisabledLanes&x)var b=0;else b=r.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){o=b;e:{var N=r;v=Gu;var q=N.current.memoizedState.isDehydrated;if(q&&(Ul(N,b).flags|=256),b=Oy(N,b,!1),b!==2){if(Py&&!q){N.errorRecoveryDisabledLanes|=x,pa|=x,v=4;break e}x=ti,ti=v,x!==null&&(ti===null?ti=x:ti.push.apply(ti,x))}v=b}if(x=!1,v!==2)continue}}if(v===1){Ul(r,0),Xr(r,o,0,!0);break}e:{switch(d=r,x=v,x){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:Xr(d,o,pi,!Yr);break e;case 2:ti=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(v=qf+300-jn(),10<v)){if(Xr(d,o,pi,!Yr),cs(d,0,!0)!==0)break e;or=o,d.timeoutHandle=Gw(fw.bind(null,d,c,ti,Bf,My,o,pi,pa,Vl,Yr,x,"Throttled",-0,0),v);break e}fw(d,c,ti,Bf,My,o,pi,pa,Vl,Yr,x,null,-0,0)}}break}while(!0);As(r)}function fw(r,o,c,d,v,x,b,N,q,te,ae,ue,ne,re){if(r.timeoutHandle=-1,ue=o.subtreeFlags,ue&8192||(ue&16785408)===16785408){ue={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ki},rw(o,x,ue);var Ae=(x&62914560)===x?qf-jn():(x&4194048)===x?cw-jn():0;if(Ae=o2(ue,Ae),Ae!==null){or=x,r.cancelPendingCommit=Ae(xw.bind(null,r,o,x,c,d,v,b,N,q,ae,ue,null,ne,re)),Xr(r,x,b,!te);return}}xw(r,o,x,c,d,v,b,N,q)}function EM(r){for(var o=r;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var v=c[d],x=v.getSnapshot;v=v.value;try{if(!ui(x(),v))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Xr(r,o,c,d){o&=~Dy,o&=~pa,r.suspendedLanes|=o,r.pingedLanes&=~o,d&&(r.warmLanes|=o),d=r.expirationTimes;for(var v=o;0<v;){var x=31-zt(v),b=1<<x;d[x]=-1,v&=~b}c!==0&&zo(r,c,o)}function Gf(){return(ut&6)===0?(Hu(0),!1):!0}function Uy(){if(Ye!==null){if(ft===0)var r=Ye.return;else r=Ye,Js=oa=null,Zg(r),Al=null,Au=0,r=Ye;for(;r!==null;)zE(r.alternate,r),r=r.return;Ye=null}}function Ul(r,o){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,BM(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),or=0,Uy(),xt=r,Ye=c=Ks(r.current,null),Xe=o,ft=0,mi=null,Yr=!1,kl=zi(r,o),Py=!1,Vl=pi=Dy=pa=Jr=qt=0,ti=Gu=null,My=!1,(o&8)!==0&&(o|=o&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=o;0<d;){var v=31-zt(d),x=1<<v;o|=r[v],d&=~x}return rr=o,uf(),c}function mw(r,o){Ge=null,X.H=Vu,o===Sl||o===_f?(o=Rx(),ft=3):o===jg?(o=Rx(),ft=4):ft=o===py?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,mi=o,Ye===null&&(qt=1,Df(r,Ri(o,r.current)))}function pw(){var r=hi.current;return r===null?!0:(Xe&4194048)===Xe?ki===null:(Xe&62914560)===Xe||(Xe&536870912)!==0?r===ki:!1}function gw(){var r=X.H;return X.H=Vu,r===null?Vu:r}function yw(){var r=X.A;return X.A=TM,r}function zf(){qt=4,Yr||(Xe&4194048)!==Xe&&hi.current!==null||(kl=!0),(Jr&134217727)===0&&(pa&134217727)===0||xt===null||Xr(xt,Xe,pi,!1)}function Oy(r,o,c){var d=ut;ut|=2;var v=gw(),x=yw();(xt!==r||Xe!==o)&&(Bf=null,Ul(r,o)),o=!1;var b=qt;e:do try{if(ft!==0&&Ye!==null){var N=Ye,q=mi;switch(ft){case 8:Uy(),b=6;break e;case 3:case 2:case 9:case 6:hi.current===null&&(o=!0);var te=ft;if(ft=0,mi=null,Ol(r,N,q,te),c&&kl){b=0;break e}break;default:te=ft,ft=0,mi=null,Ol(r,N,q,te)}}wM(),b=qt;break}catch(ae){mw(r,ae)}while(!0);return o&&r.shellSuspendCounter++,Js=oa=null,ut=d,X.H=v,X.A=x,Ye===null&&(xt=null,Xe=0,uf()),b}function wM(){for(;Ye!==null;)_w(Ye)}function bM(r,o){var c=ut;ut|=2;var d=gw(),v=yw();xt!==r||Xe!==o?(Bf=null,jf=jn()+500,Ul(r,o)):kl=zi(r,o);e:do try{if(ft!==0&&Ye!==null){o=Ye;var x=mi;t:switch(ft){case 1:ft=0,mi=null,Ol(r,o,x,1);break;case 2:case 9:if(Nx(x)){ft=0,mi=null,vw(o);break}o=function(){ft!==2&&ft!==9||xt!==r||(ft=7),As(r)},x.then(o,o);break e;case 3:ft=7;break e;case 4:ft=5;break e;case 7:Nx(x)?(ft=0,mi=null,vw(o)):(ft=0,mi=null,Ol(r,o,x,7));break;case 5:var b=null;switch(Ye.tag){case 26:b=Ye.memoizedState;case 5:case 27:var N=Ye;if(b?sb(b):N.stateNode.complete){ft=0,mi=null;var q=N.sibling;if(q!==null)Ye=q;else{var te=N.return;te!==null?(Ye=te,Hf(te)):Ye=null}break t}}ft=0,mi=null,Ol(r,o,x,5);break;case 6:ft=0,mi=null,Ol(r,o,x,6);break;case 8:Uy(),qt=6;break e;default:throw Error(i(462))}}IM();break}catch(ae){mw(r,ae)}while(!0);return Js=oa=null,X.H=d,X.A=v,ut=c,Ye!==null?0:(xt=null,Xe=0,uf(),qt)}function IM(){for(;Ye!==null&&!mg();)_w(Ye)}function _w(r){var o=BE(r.alternate,r,rr);r.memoizedProps=r.pendingProps,o===null?Hf(r):Ye=o}function vw(r){var o=r,c=o.alternate;switch(o.tag){case 15:case 0:o=LE(c,o,o.pendingProps,o.type,void 0,Xe);break;case 11:o=LE(c,o,o.pendingProps,o.type.render,o.ref,Xe);break;case 5:Zg(o);default:zE(c,o),o=Ye=yx(o,rr),o=BE(c,o,rr)}r.memoizedProps=r.pendingProps,o===null?Hf(r):Ye=o}function Ol(r,o,c,d){Js=oa=null,Zg(o),Al=null,Au=0;var v=o.return;try{if(fM(r,v,o,c,Xe)){qt=1,Df(r,Ri(c,r.current)),Ye=null;return}}catch(x){if(v!==null)throw Ye=v,x;qt=1,Df(r,Ri(c,r.current)),Ye=null;return}o.flags&32768?(tt||d===1?r=!0:kl||(Xe&536870912)!==0?r=!1:(Yr=r=!0,(d===2||d===9||d===3||d===6)&&(d=hi.current,d!==null&&d.tag===13&&(d.flags|=16384))),Tw(o,r)):Hf(o)}function Hf(r){var o=r;do{if((o.flags&32768)!==0){Tw(o,Yr);return}r=o.return;var c=gM(o.alternate,o,rr);if(c!==null){Ye=c;return}if(o=o.sibling,o!==null){Ye=o;return}Ye=o=r}while(o!==null);qt===0&&(qt=5)}function Tw(r,o){do{var c=yM(r.alternate,r);if(c!==null){c.flags&=32767,Ye=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(r=r.sibling,r!==null)){Ye=r;return}Ye=r=c}while(r!==null);qt=6,Ye=null}function xw(r,o,c,d,v,x,b,N,q){r.cancelPendingCommit=null;do $f();while(hn!==0);if((ut&6)!==0)throw Error(i(327));if(o!==null){if(o===r.current)throw Error(i(177));if(x=o.lanes|o.childLanes,x|=Sg,yg(r,c,x,b,N,q),r===xt&&(Ye=xt=null,Xe=0),Ll=o,Wr=r,or=c,ky=x,Vy=v,uw=d,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,CM(Nr,function(){return Sw(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||d){d=X.T,X.T=null,v=fe.p,fe.p=2,b=ut,ut|=4;try{_M(r,o,c)}finally{ut=b,fe.p=v,X.T=d}}hn=1,Ew(),ww(),bw()}}function Ew(){if(hn===1){hn=0;var r=Wr,o=Ll,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=X.T,X.T=null;var d=fe.p;fe.p=2;var v=ut;ut|=4;try{nw(o,r);var x=Qy,b=lx(r.containerInfo),N=x.focusedElem,q=x.selectionRange;if(b!==N&&N&&N.ownerDocument&&ax(N.ownerDocument.documentElement,N)){if(q!==null&&xg(N)){var te=q.start,ae=q.end;if(ae===void 0&&(ae=te),"selectionStart"in N)N.selectionStart=te,N.selectionEnd=Math.min(ae,N.value.length);else{var ue=N.ownerDocument||document,ne=ue&&ue.defaultView||window;if(ne.getSelection){var re=ne.getSelection(),Ae=N.textContent.length,Ve=Math.min(q.start,Ae),Tt=q.end===void 0?Ve:Math.min(q.end,Ae);!re.extend&&Ve>Tt&&(b=Tt,Tt=Ve,Ve=b);var Y=ox(N,Ve),B=ox(N,Tt);if(Y&&B&&(re.rangeCount!==1||re.anchorNode!==Y.node||re.anchorOffset!==Y.offset||re.focusNode!==B.node||re.focusOffset!==B.offset)){var ee=ue.createRange();ee.setStart(Y.node,Y.offset),re.removeAllRanges(),Ve>Tt?(re.addRange(ee),re.extend(B.node,B.offset)):(ee.setEnd(B.node,B.offset),re.addRange(ee))}}}}for(ue=[],re=N;re=re.parentNode;)re.nodeType===1&&ue.push({element:re,left:re.scrollLeft,top:re.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<ue.length;N++){var ce=ue[N];ce.element.scrollLeft=ce.left,ce.element.scrollTop=ce.top}}sm=!!Jy,Qy=Jy=null}finally{ut=v,fe.p=d,X.T=c}}r.current=o,hn=2}}function ww(){if(hn===2){hn=0;var r=Wr,o=Ll,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=X.T,X.T=null;var d=fe.p;fe.p=2;var v=ut;ut|=4;try{WE(r,o.alternate,o)}finally{ut=v,fe.p=d,X.T=c}}hn=3}}function bw(){if(hn===4||hn===3){hn=0,Vh();var r=Wr,o=Ll,c=or,d=uw;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?hn=5:(hn=0,Ll=Wr=null,Iw(r,r.pendingLanes));var v=r.pendingLanes;if(v===0&&(Qr=null),Gs(c),o=o.stateNode,En&&typeof En.onCommitFiberRoot=="function")try{En.onCommitFiberRoot(Gi,o,void 0,(o.current.flags&128)===128)}catch{}if(d!==null){o=X.T,v=fe.p,fe.p=2,X.T=null;try{for(var x=r.onRecoverableError,b=0;b<d.length;b++){var N=d[b];x(N.value,{componentStack:N.stack})}}finally{X.T=o,fe.p=v}}(or&3)!==0&&$f(),As(r),v=r.pendingLanes,(c&261930)!==0&&(v&42)!==0?r===Ly?zu++:(zu=0,Ly=r):zu=0,Hu(0)}}function Iw(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,Iu(o)))}function $f(){return Ew(),ww(),bw(),Sw()}function Sw(){if(hn!==5)return!1;var r=Wr,o=ky;ky=0;var c=Gs(or),d=X.T,v=fe.p;try{fe.p=32>c?32:c,X.T=null,c=Vy,Vy=null;var x=Wr,b=or;if(hn=0,Ll=Wr=null,or=0,(ut&6)!==0)throw Error(i(331));var N=ut;if(ut|=4,aw(x.current),sw(x,x.current,b,c),ut=N,Hu(0,!1),En&&typeof En.onPostCommitFiberRoot=="function")try{En.onPostCommitFiberRoot(Gi,x)}catch{}return!0}finally{fe.p=v,X.T=d,Iw(r,o)}}function Aw(r,o,c){o=Ri(c,o),o=my(r.stateNode,o,2),r=zr(r,o,2),r!==null&&(Go(r,2),As(r))}function mt(r,o,c){if(r.tag===3)Aw(r,r,c);else for(;o!==null;){if(o.tag===3){Aw(o,r,c);break}else if(o.tag===1){var d=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Qr===null||!Qr.has(d))){r=Ri(c,r),c=NE(2),d=zr(o,c,2),d!==null&&(CE(c,d,o,r),Go(d,2),As(d));break}}o=o.return}}function Fy(r,o,c){var d=r.pingCache;if(d===null){d=r.pingCache=new xM;var v=new Set;d.set(o,v)}else v=d.get(o),v===void 0&&(v=new Set,d.set(o,v));v.has(c)||(Py=!0,v.add(c),r=SM.bind(null,r,o,c),o.then(r,r))}function SM(r,o,c){var d=r.pingCache;d!==null&&d.delete(o),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,xt===r&&(Xe&c)===c&&(qt===4||qt===3&&(Xe&62914560)===Xe&&300>jn()-qf?(ut&2)===0&&Ul(r,0):Dy|=c,Vl===Xe&&(Vl=0)),As(r)}function Nw(r,o){o===0&&(o=jh()),r=ia(r,o),r!==null&&(Go(r,o),As(r))}function AM(r){var o=r.memoizedState,c=0;o!==null&&(c=o.retryLane),Nw(r,c)}function NM(r,o){var c=0;switch(r.tag){case 31:case 13:var d=r.stateNode,v=r.memoizedState;v!==null&&(c=v.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(o),Nw(r,c)}function CM(r,o){return dn(r,o)}var Kf=null,Fl=null,qy=!1,Yf=!1,jy=!1,Zr=0;function As(r){r!==Fl&&r.next===null&&(Fl===null?Kf=Fl=r:Fl=Fl.next=r),Yf=!0,qy||(qy=!0,PM())}function Hu(r,o){if(!jy&&Yf){jy=!0;do for(var c=!1,d=Kf;d!==null;){if(r!==0){var v=d.pendingLanes;if(v===0)var x=0;else{var b=d.suspendedLanes,N=d.pingedLanes;x=(1<<31-zt(42|r)+1)-1,x&=v&~(b&~N),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,Dw(d,x))}else x=Xe,x=cs(d,d===xt?x:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(x&3)===0||zi(d,x)||(c=!0,Dw(d,x));d=d.next}while(c);jy=!1}}function RM(){Cw()}function Cw(){Yf=qy=!1;var r=0;Zr!==0&&jM()&&(r=Zr);for(var o=jn(),c=null,d=Kf;d!==null;){var v=d.next,x=Rw(d,o);x===0?(d.next=null,c===null?Kf=v:c.next=v,v===null&&(Fl=c)):(c=d,(r!==0||(x&3)!==0)&&(Yf=!0)),d=v}hn!==0&&hn!==5||Hu(r),Zr!==0&&(Zr=0)}function Rw(r,o){for(var c=r.suspendedLanes,d=r.pingedLanes,v=r.expirationTimes,x=r.pendingLanes&-62914561;0<x;){var b=31-zt(x),N=1<<b,q=v[b];q===-1?((N&c)===0||(N&d)!==0)&&(v[b]=gg(N,o)):q<=o&&(r.expiredLanes|=N),x&=~N}if(o=xt,c=Xe,c=cs(r,r===o?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,c===0||r===o&&(ft===2||ft===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&Ar(d),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||zi(r,c)){if(o=c&-c,o===r.callbackPriority)return o;switch(d!==null&&Ar(d),Gs(c)){case 2:case 8:c=tu;break;case 32:c=Nr;break;case 268435456:c=Lh;break;default:c=Nr}return d=Pw.bind(null,r),c=dn(c,d),r.callbackPriority=o,r.callbackNode=c,o}return d!==null&&d!==null&&Ar(d),r.callbackPriority=2,r.callbackNode=null,2}function Pw(r,o){if(hn!==0&&hn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if($f()&&r.callbackNode!==c)return null;var d=Xe;return d=cs(r,r===xt?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(hw(r,d,o),Rw(r,jn()),r.callbackNode!=null&&r.callbackNode===c?Pw.bind(null,r):null)}function Dw(r,o){if($f())return null;hw(r,o,!0)}function PM(){GM(function(){(ut&6)!==0?dn(eu,RM):Cw()})}function By(){if(Zr===0){var r=bl;r===0&&(r=as,as<<=1,(as&261888)===0&&(as=256)),Zr=r}return Zr}function Mw(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:cl(""+r)}function kw(r,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,r.id&&c.setAttribute("form",r.id),o.parentNode.insertBefore(c,o),r=new FormData(r),c.parentNode.removeChild(c),r}function DM(r,o,c,d,v){if(o==="submit"&&c&&c.stateNode===v){var x=Mw((v[pn]||null).action),b=d.submitter;b&&(o=(o=b[pn]||null)?Mw(o.formAction):b.getAttribute("formAction"),o!==null&&(x=o,b=null));var N=new Ts("action","action",null,d,v);r.push({event:N,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Zr!==0){var q=b?kw(v,b):new FormData(v);ly(c,{pending:!0,data:q,method:v.method,action:x},null,q)}}else typeof x=="function"&&(N.preventDefault(),q=b?kw(v,b):new FormData(v),ly(c,{pending:!0,data:q,method:v.method,action:x},x,q))},currentTarget:v}]})}}for(var Gy=0;Gy<Ig.length;Gy++){var zy=Ig[Gy],MM=zy.toLowerCase(),kM=zy[0].toUpperCase()+zy.slice(1);Xi(MM,"on"+kM)}Xi(dx,"onAnimationEnd"),Xi(hx,"onAnimationIteration"),Xi(fx,"onAnimationStart"),Xi("dblclick","onDoubleClick"),Xi("focusin","onFocus"),Xi("focusout","onBlur"),Xi(QD,"onTransitionRun"),Xi(WD,"onTransitionStart"),Xi(XD,"onTransitionCancel"),Xi(mx,"onTransitionEnd"),gs("onMouseEnter",["mouseout","mouseover"]),gs("onMouseLeave",["mouseout","mouseover"]),gs("onPointerEnter",["pointerout","pointerover"]),gs("onPointerLeave",["pointerout","pointerover"]),ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ps("onBeforeInput",["compositionend","keypress","textInput","paste"]),ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VM=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($u));function Vw(r,o){o=(o&4)!==0;for(var c=0;c<r.length;c++){var d=r[c],v=d.event;d=d.listeners;e:{var x=void 0;if(o)for(var b=d.length-1;0<=b;b--){var N=d[b],q=N.instance,te=N.currentTarget;if(N=N.listener,q!==x&&v.isPropagationStopped())break e;x=N,v.currentTarget=te;try{x(v)}catch(ae){cf(ae)}v.currentTarget=null,x=q}else for(b=0;b<d.length;b++){if(N=d[b],q=N.instance,te=N.currentTarget,N=N.listener,q!==x&&v.isPropagationStopped())break e;x=N,v.currentTarget=te;try{x(v)}catch(ae){cf(ae)}v.currentTarget=null,x=q}}}}function Je(r,o){var c=o[sl];c===void 0&&(c=o[sl]=new Set);var d=r+"__bubble";c.has(d)||(Lw(o,r,2,!1),c.add(d))}function Hy(r,o,c){var d=0;o&&(d|=4),Lw(c,r,d,o)}var Jf="_reactListening"+Math.random().toString(36).slice(2);function $y(r){if(!r[Jf]){r[Jf]=!0,su.forEach(function(c){c!=="selectionchange"&&(VM.has(c)||Hy(c,!1,r),Hy(c,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[Jf]||(o[Jf]=!0,Hy("selectionchange",!1,o))}}function Lw(r,o,c,d){switch(db(o)){case 2:var v=c2;break;case 8:v=u2;break;default:v=a_}c=v.bind(null,o,c,r),v=void 0,!Jo||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(v=!0),d?v!==void 0?r.addEventListener(o,c,{capture:!0,passive:v}):r.addEventListener(o,c,!0):v!==void 0?r.addEventListener(o,c,{passive:v}):r.addEventListener(o,c,!1)}function Ky(r,o,c,d,v){var x=d;if((o&1)===0&&(o&2)===0&&d!==null)e:for(;;){if(d===null)return;var b=d.tag;if(b===3||b===4){var N=d.stateNode.containerInfo;if(N===v)break;if(b===4)for(b=d.return;b!==null;){var q=b.tag;if((q===3||q===4)&&b.stateNode.containerInfo===v)return;b=b.return}for(;N!==null;){if(b=fs(N),b===null)return;if(q=b.tag,q===5||q===6||q===26||q===27){d=x=b;continue e}N=N.parentNode}}d=d.return}kr(function(){var te=x,ae=Si(c),ue=[];e:{var ne=px.get(r);if(ne!==void 0){var re=Ts,Ae=r;switch(r){case"keypress":if(Wo(c)===0)break e;case"keydown":case"keyup":re=of;break;case"focusin":Ae="focus",re=Zo;break;case"focusout":Ae="blur",re=Zo;break;case"beforeblur":case"afterblur":re=Zo;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":re=yu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":re=Qh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":re=w;break;case dx:case hx:case fx:re=Xh;break;case mx:re=P;break;case"scroll":case"scrollend":re=gu;break;case"wheel":re=se;break;case"copy":case"cut":case"paste":re=Zh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":re=$s;break;case"toggle":case"beforetoggle":re=Be}var Ve=(o&4)!==0,Tt=!Ve&&(r==="scroll"||r==="scrollend"),Y=Ve?ne!==null?ne+"Capture":null:ne;Ve=[];for(var B=te,ee;B!==null;){var ce=B;if(ee=ce.stateNode,ce=ce.tag,ce!==5&&ce!==26&&ce!==27||ee===null||Y===null||(ce=Yi(B,Y),ce!=null&&Ve.push(Ku(B,ce,ee))),Tt)break;B=B.return}0<Ve.length&&(ne=new re(ne,Ae,null,c,ae),ue.push({event:ne,listeners:Ve}))}}if((o&7)===0){e:{if(ne=r==="mouseover"||r==="pointerover",re=r==="mouseout"||r==="pointerout",ne&&c!==fu&&(Ae=c.relatedTarget||c.fromElement)&&(fs(Ae)||Ae[ds]))break e;if((re||ne)&&(ne=ae.window===ae?ae:(ne=ae.ownerDocument)?ne.defaultView||ne.parentWindow:window,re?(Ae=c.relatedTarget||c.toElement,re=te,Ae=Ae?fs(Ae):null,Ae!==null&&(Tt=a(Ae),Ve=Ae.tag,Ae!==Tt||Ve!==5&&Ve!==27&&Ve!==6)&&(Ae=null)):(re=null,Ae=te),re!==Ae)){if(Ve=yu,ce="onMouseLeave",Y="onMouseEnter",B="mouse",(r==="pointerout"||r==="pointerover")&&(Ve=$s,ce="onPointerLeave",Y="onPointerEnter",B="pointer"),Tt=re==null?ne:li(re),ee=Ae==null?ne:li(Ae),ne=new Ve(ce,B+"leave",re,c,ae),ne.target=Tt,ne.relatedTarget=ee,ce=null,fs(ae)===te&&(Ve=new Ve(Y,B+"enter",Ae,c,ae),Ve.target=ee,Ve.relatedTarget=Tt,ce=Ve),Tt=ce,re&&Ae)t:{for(Ve=LM,Y=re,B=Ae,ee=0,ce=Y;ce;ce=Ve(ce))ee++;ce=0;for(var Me=B;Me;Me=Ve(Me))ce++;for(;0<ee-ce;)Y=Ve(Y),ee--;for(;0<ce-ee;)B=Ve(B),ce--;for(;ee--;){if(Y===B||B!==null&&Y===B.alternate){Ve=Y;break t}Y=Ve(Y),B=Ve(B)}Ve=null}else Ve=null;re!==null&&Uw(ue,ne,re,Ve,!1),Ae!==null&&Tt!==null&&Uw(ue,Tt,Ae,Ve,!0)}}e:{if(ne=te?li(te):window,re=ne.nodeName&&ne.nodeName.toLowerCase(),re==="select"||re==="input"&&ne.type==="file")var rt=ex;else if(XT(ne))if(tx)rt=KD;else{rt=HD;var Ce=zD}else re=ne.nodeName,!re||re.toLowerCase()!=="input"||ne.type!=="checkbox"&&ne.type!=="radio"?te&&ll(te.elementType)&&(rt=ex):rt=$D;if(rt&&(rt=rt(r,te))){ZT(ue,rt,c,ae);break e}Ce&&Ce(r,ne,te),r==="focusout"&&te&&ne.type==="number"&&te.memoizedProps.value!=null&&uu(ne,"number",ne.value)}switch(Ce=te?li(te):window,r){case"focusin":(XT(Ce)||Ce.contentEditable==="true")&&(gl=Ce,Eg=te,Eu=null);break;case"focusout":Eu=Eg=gl=null;break;case"mousedown":wg=!0;break;case"contextmenu":case"mouseup":case"dragend":wg=!1,cx(ue,c,ae);break;case"selectionchange":if(JD)break;case"keydown":case"keyup":cx(ue,c,ae)}var He;if(ct)e:{switch(r){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else pl?ea(r,c)&&(Ze="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(Ze="onCompositionStart");Ze&&(ws&&c.locale!=="ko"&&(pl||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&pl&&(He=pu()):(vs=ae,mu="value"in vs?vs.value:vs.textContent,pl=!0)),Ce=Qf(te,Ze),0<Ce.length&&(Ze=new Es(Ze,r,null,c,ae),ue.push({event:Ze,listeners:Ce}),He?Ze.data=He:(He=ml(c),He!==null&&(Ze.data=He)))),(He=Ni?qD(r,c):jD(r,c))&&(Ze=Qf(te,"onBeforeInput"),0<Ze.length&&(Ce=new Es("onBeforeInput","beforeinput",null,c,ae),ue.push({event:Ce,listeners:Ze}),Ce.data=He)),DM(ue,r,te,c,ae)}Vw(ue,o)})}function Ku(r,o,c){return{instance:r,listener:o,currentTarget:c}}function Qf(r,o){for(var c=o+"Capture",d=[];r!==null;){var v=r,x=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||x===null||(v=Yi(r,c),v!=null&&d.unshift(Ku(r,v,x)),v=Yi(r,o),v!=null&&d.push(Ku(r,v,x))),r.tag===3)return d;r=r.return}return[]}function LM(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Uw(r,o,c,d,v){for(var x=o._reactName,b=[];c!==null&&c!==d;){var N=c,q=N.alternate,te=N.stateNode;if(N=N.tag,q!==null&&q===d)break;N!==5&&N!==26&&N!==27||te===null||(q=te,v?(te=Yi(c,x),te!=null&&b.unshift(Ku(c,te,q))):v||(te=Yi(c,x),te!=null&&b.push(Ku(c,te,q)))),c=c.return}b.length!==0&&r.push({event:o,listeners:b})}var UM=/\r\n?/g,OM=/\u0000|\uFFFD/g;function Ow(r){return(typeof r=="string"?r:""+r).replace(UM,`
`).replace(OM,"")}function Fw(r,o){return o=Ow(o),Ow(r)===o}function vt(r,o,c,d,v,x){switch(c){case"children":typeof d=="string"?o==="body"||o==="textarea"&&d===""||Wn(r,d):(typeof d=="number"||typeof d=="bigint")&&o!=="body"&&Wn(r,""+d);break;case"className":ci(r,"class",d);break;case"tabIndex":ci(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":ci(r,c,d);break;case"style":hu(r,d,x);break;case"data":if(o!=="object"){ci(r,"data",d);break}case"src":case"href":if(d===""&&(o!=="a"||c!=="href")){r.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=cl(""+d),r.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(o!=="input"&&vt(r,o,"name",v.name,v,null),vt(r,o,"formEncType",v.formEncType,v,null),vt(r,o,"formMethod",v.formMethod,v,null),vt(r,o,"formTarget",v.formTarget,v,null)):(vt(r,o,"encType",v.encType,v,null),vt(r,o,"method",v.method,v,null),vt(r,o,"target",v.target,v,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=cl(""+d),r.setAttribute(c,d);break;case"onClick":d!=null&&(r.onclick=Ki);break;case"onScroll":d!=null&&Je("scroll",r);break;case"onScrollEnd":d!=null&&Je("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(c=d.__html,c!=null){if(v.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}c=cl(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""+d):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":d===!0?r.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,d):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(c,d):r.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(c):r.setAttribute(c,d);break;case"popover":Je("beforetoggle",r),Je("toggle",r),ol(r,"popover",d);break;case"xlinkActuate":en(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":en(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":en(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":en(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":en(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":en(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":en(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":en(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":en(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":ol(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Jh.get(c)||c,ol(r,c,d))}}function Yy(r,o,c,d,v,x){switch(c){case"style":hu(r,d,x);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(c=d.__html,c!=null){if(v.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"children":typeof d=="string"?Wn(r,d):(typeof d=="number"||typeof d=="bigint")&&Wn(r,""+d);break;case"onScroll":d!=null&&Je("scroll",r);break;case"onScrollEnd":d!=null&&Je("scrollend",r);break;case"onClick":d!=null&&(r.onclick=Ki);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ru.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(v=c.endsWith("Capture"),o=c.slice(2,v?c.length-7:void 0),x=r[pn]||null,x=x!=null?x[c]:null,typeof x=="function"&&r.removeEventListener(o,x,v),typeof d=="function")){typeof x!="function"&&x!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(o,d,v);break e}c in r?r[c]=d:d===!0?r.setAttribute(c,""):ol(r,c,d)}}}function An(r,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Je("error",r),Je("load",r);var d=!1,v=!1,x;for(x in c)if(c.hasOwnProperty(x)){var b=c[x];if(b!=null)switch(x){case"src":d=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:vt(r,o,x,b,c,null)}}v&&vt(r,o,"srcSet",c.srcSet,c,null),d&&vt(r,o,"src",c.src,c,null);return;case"input":Je("invalid",r);var N=x=b=v=null,q=null,te=null;for(d in c)if(c.hasOwnProperty(d)){var ae=c[d];if(ae!=null)switch(d){case"name":v=ae;break;case"type":b=ae;break;case"checked":q=ae;break;case"defaultChecked":te=ae;break;case"value":x=ae;break;case"defaultValue":N=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(i(137,o));break;default:vt(r,o,d,ae,c,null)}}$h(r,x,N,q,te,b,v,!1);return;case"select":Je("invalid",r),d=b=x=null;for(v in c)if(c.hasOwnProperty(v)&&(N=c[v],N!=null))switch(v){case"value":x=N;break;case"defaultValue":b=N;break;case"multiple":d=N;default:vt(r,o,v,N,c,null)}o=x,c=b,r.multiple=!!d,o!=null?Rr(r,!!d,o,!1):c!=null&&Rr(r,!!d,c,!0);return;case"textarea":Je("invalid",r),x=v=d=null;for(b in c)if(c.hasOwnProperty(b)&&(N=c[b],N!=null))switch(b){case"value":d=N;break;case"defaultValue":v=N;break;case"children":x=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:vt(r,o,b,N,c,null)}Pr(r,d,v,x);return;case"option":for(q in c)if(c.hasOwnProperty(q)&&(d=c[q],d!=null))switch(q){case"selected":r.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:vt(r,o,q,d,c,null)}return;case"dialog":Je("beforetoggle",r),Je("toggle",r),Je("cancel",r),Je("close",r);break;case"iframe":case"object":Je("load",r);break;case"video":case"audio":for(d=0;d<$u.length;d++)Je($u[d],r);break;case"image":Je("error",r),Je("load",r);break;case"details":Je("toggle",r);break;case"embed":case"source":case"link":Je("error",r),Je("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in c)if(c.hasOwnProperty(te)&&(d=c[te],d!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:vt(r,o,te,d,c,null)}return;default:if(ll(o)){for(ae in c)c.hasOwnProperty(ae)&&(d=c[ae],d!==void 0&&Yy(r,o,ae,d,c,void 0));return}}for(N in c)c.hasOwnProperty(N)&&(d=c[N],d!=null&&vt(r,o,N,d,c,null))}function FM(r,o,c,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,x=null,b=null,N=null,q=null,te=null,ae=null;for(re in c){var ue=c[re];if(c.hasOwnProperty(re)&&ue!=null)switch(re){case"checked":break;case"value":break;case"defaultValue":q=ue;default:d.hasOwnProperty(re)||vt(r,o,re,null,d,ue)}}for(var ne in d){var re=d[ne];if(ue=c[ne],d.hasOwnProperty(ne)&&(re!=null||ue!=null))switch(ne){case"type":x=re;break;case"name":v=re;break;case"checked":te=re;break;case"defaultChecked":ae=re;break;case"value":b=re;break;case"defaultValue":N=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(i(137,o));break;default:re!==ue&&vt(r,o,ne,re,d,ue)}}al(r,b,N,q,te,ae,x,v);return;case"select":re=b=N=ne=null;for(x in c)if(q=c[x],c.hasOwnProperty(x)&&q!=null)switch(x){case"value":break;case"multiple":re=q;default:d.hasOwnProperty(x)||vt(r,o,x,null,d,q)}for(v in d)if(x=d[v],q=c[v],d.hasOwnProperty(v)&&(x!=null||q!=null))switch(v){case"value":ne=x;break;case"defaultValue":N=x;break;case"multiple":b=x;default:x!==q&&vt(r,o,v,x,d,q)}o=N,c=b,d=re,ne!=null?Rr(r,!!c,ne,!1):!!d!=!!c&&(o!=null?Rr(r,!!c,o,!0):Rr(r,!!c,c?[]:"",!1));return;case"textarea":re=ne=null;for(N in c)if(v=c[N],c.hasOwnProperty(N)&&v!=null&&!d.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:vt(r,o,N,null,d,v)}for(b in d)if(v=d[b],x=c[b],d.hasOwnProperty(b)&&(v!=null||x!=null))switch(b){case"value":ne=v;break;case"defaultValue":re=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(i(91));break;default:v!==x&&vt(r,o,b,v,d,x)}Kh(r,ne,re);return;case"option":for(var Ae in c)if(ne=c[Ae],c.hasOwnProperty(Ae)&&ne!=null&&!d.hasOwnProperty(Ae))switch(Ae){case"selected":r.selected=!1;break;default:vt(r,o,Ae,null,d,ne)}for(q in d)if(ne=d[q],re=c[q],d.hasOwnProperty(q)&&ne!==re&&(ne!=null||re!=null))switch(q){case"selected":r.selected=ne&&typeof ne!="function"&&typeof ne!="symbol";break;default:vt(r,o,q,ne,d,re)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ve in c)ne=c[Ve],c.hasOwnProperty(Ve)&&ne!=null&&!d.hasOwnProperty(Ve)&&vt(r,o,Ve,null,d,ne);for(te in d)if(ne=d[te],re=c[te],d.hasOwnProperty(te)&&ne!==re&&(ne!=null||re!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(i(137,o));break;default:vt(r,o,te,ne,d,re)}return;default:if(ll(o)){for(var Tt in c)ne=c[Tt],c.hasOwnProperty(Tt)&&ne!==void 0&&!d.hasOwnProperty(Tt)&&Yy(r,o,Tt,void 0,d,ne);for(ae in d)ne=d[ae],re=c[ae],!d.hasOwnProperty(ae)||ne===re||ne===void 0&&re===void 0||Yy(r,o,ae,ne,d,re);return}}for(var Y in c)ne=c[Y],c.hasOwnProperty(Y)&&ne!=null&&!d.hasOwnProperty(Y)&&vt(r,o,Y,null,d,ne);for(ue in d)ne=d[ue],re=c[ue],!d.hasOwnProperty(ue)||ne===re||ne==null&&re==null||vt(r,o,ue,ne,d,re)}function qw(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function qM(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,c=performance.getEntriesByType("resource"),d=0;d<c.length;d++){var v=c[d],x=v.transferSize,b=v.initiatorType,N=v.duration;if(x&&N&&qw(b)){for(b=0,N=v.responseEnd,d+=1;d<c.length;d++){var q=c[d],te=q.startTime;if(te>N)break;var ae=q.transferSize,ue=q.initiatorType;ae&&qw(ue)&&(q=q.responseEnd,b+=ae*(q<N?1:(N-te)/(q-te)))}if(--d,o+=8*(x+b)/(v.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Jy=null,Qy=null;function Wf(r){return r.nodeType===9?r:r.ownerDocument}function jw(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Bw(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function Wy(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Xy=null;function jM(){var r=window.event;return r&&r.type==="popstate"?r===Xy?!1:(Xy=r,!0):(Xy=null,!1)}var Gw=typeof setTimeout=="function"?setTimeout:void 0,BM=typeof clearTimeout=="function"?clearTimeout:void 0,zw=typeof Promise=="function"?Promise:void 0,GM=typeof queueMicrotask=="function"?queueMicrotask:typeof zw<"u"?function(r){return zw.resolve(null).then(r).catch(zM)}:Gw;function zM(r){setTimeout(function(){throw r})}function eo(r){return r==="head"}function Hw(r,o){var c=o,d=0;do{var v=c.nextSibling;if(r.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"||c==="/&"){if(d===0){r.removeChild(v),Gl(o);return}d--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")d++;else if(c==="html")Yu(r.ownerDocument.documentElement);else if(c==="head"){c=r.ownerDocument.head,Yu(c);for(var x=c.firstChild;x;){var b=x.nextSibling,N=x.nodeName;x[hs]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&x.rel.toLowerCase()==="stylesheet"||c.removeChild(x),x=b}}else c==="body"&&Yu(r.ownerDocument.body);c=v}while(c);Gl(o)}function $w(r,o){var c=r;r=0;do{var d=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),d&&d.nodeType===8)if(c=d.data,c==="/$"){if(r===0)break;r--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||r++;c=d}while(c)}function Zy(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Zy(c),rl(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function HM(r,o,c,d){for(;r.nodeType===1;){var v=c;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[hs])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(x=r.getAttribute("rel"),x==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(x!==v.rel||r.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||r.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||r.getAttribute("title")!==(v.title==null?null:v.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(x=r.getAttribute("src"),(x!==(v.src==null?null:v.src)||r.getAttribute("type")!==(v.type==null?null:v.type)||r.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&x&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var x=v.name==null?null:""+v.name;if(v.type==="hidden"&&r.getAttribute("name")===x)return r}else return r;if(r=Vi(r.nextSibling),r===null)break}return null}function $M(r,o,c){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=Vi(r.nextSibling),r===null))return null;return r}function Kw(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Vi(r.nextSibling),r===null))return null;return r}function e_(r){return r.data==="$?"||r.data==="$~"}function t_(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function KM(r,o){var c=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||c.readyState!=="loading")o();else{var d=function(){o(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function Vi(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var n_=null;function Yw(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"||c==="/&"){if(o===0)return Vi(r.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}r=r.nextSibling}return null}function Jw(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return r;o--}else c!=="/$"&&c!=="/&"||o++}r=r.previousSibling}return null}function Qw(r,o,c){switch(o=Wf(c),r){case"html":if(r=o.documentElement,!r)throw Error(i(452));return r;case"head":if(r=o.head,!r)throw Error(i(453));return r;case"body":if(r=o.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Yu(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);rl(r)}var Li=new Map,Ww=new Set;function Xf(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var ar=fe.d;fe.d={f:YM,r:JM,D:QM,C:WM,L:XM,m:ZM,X:t2,S:e2,M:n2};function YM(){var r=ar.f(),o=Gf();return r||o}function JM(r){var o=Ii(r);o!==null&&o.tag===5&&o.type==="form"?mE(o):ar.r(r)}var ql=typeof document>"u"?null:document;function Xw(r,o,c){var d=ql;if(d&&typeof o=="string"&&o){var v=Qn(o);v='link[rel="'+r+'"][href="'+v+'"]',typeof c=="string"&&(v+='[crossorigin="'+c+'"]'),Ww.has(v)||(Ww.add(v),r={rel:r,crossOrigin:c,href:o},d.querySelector(v)===null&&(o=d.createElement("link"),An(o,"link",r),Zt(o),d.head.appendChild(o)))}}function QM(r){ar.D(r),Xw("dns-prefetch",r,null)}function WM(r,o){ar.C(r,o),Xw("preconnect",r,o)}function XM(r,o,c){ar.L(r,o,c);var d=ql;if(d&&r&&o){var v='link[rel="preload"][as="'+Qn(o)+'"]';o==="image"&&c&&c.imageSrcSet?(v+='[imagesrcset="'+Qn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(v+='[imagesizes="'+Qn(c.imageSizes)+'"]')):v+='[href="'+Qn(r)+'"]';var x=v;switch(o){case"style":x=jl(r);break;case"script":x=Bl(r)}Li.has(x)||(r=T({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:r,as:o},c),Li.set(x,r),d.querySelector(v)!==null||o==="style"&&d.querySelector(Ju(x))||o==="script"&&d.querySelector(Qu(x))||(o=d.createElement("link"),An(o,"link",r),Zt(o),d.head.appendChild(o)))}}function ZM(r,o){ar.m(r,o);var c=ql;if(c&&r){var d=o&&typeof o.as=="string"?o.as:"script",v='link[rel="modulepreload"][as="'+Qn(d)+'"][href="'+Qn(r)+'"]',x=v;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Bl(r)}if(!Li.has(x)&&(r=T({rel:"modulepreload",href:r},o),Li.set(x,r),c.querySelector(v)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Qu(x)))return}d=c.createElement("link"),An(d,"link",r),Zt(d),c.head.appendChild(d)}}}function e2(r,o,c){ar.S(r,o,c);var d=ql;if(d&&r){var v=ms(d).hoistableStyles,x=jl(r);o=o||"default";var b=v.get(x);if(!b){var N={loading:0,preload:null};if(b=d.querySelector(Ju(x)))N.loading=5;else{r=T({rel:"stylesheet",href:r,"data-precedence":o},c),(c=Li.get(x))&&i_(r,c);var q=b=d.createElement("link");Zt(q),An(q,"link",r),q._p=new Promise(function(te,ae){q.onload=te,q.onerror=ae}),q.addEventListener("load",function(){N.loading|=1}),q.addEventListener("error",function(){N.loading|=2}),N.loading|=4,Zf(b,o,d)}b={type:"stylesheet",instance:b,count:1,state:N},v.set(x,b)}}}function t2(r,o){ar.X(r,o);var c=ql;if(c&&r){var d=ms(c).hoistableScripts,v=Bl(r),x=d.get(v);x||(x=c.querySelector(Qu(v)),x||(r=T({src:r,async:!0},o),(o=Li.get(v))&&s_(r,o),x=c.createElement("script"),Zt(x),An(x,"link",r),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},d.set(v,x))}}function n2(r,o){ar.M(r,o);var c=ql;if(c&&r){var d=ms(c).hoistableScripts,v=Bl(r),x=d.get(v);x||(x=c.querySelector(Qu(v)),x||(r=T({src:r,async:!0,type:"module"},o),(o=Li.get(v))&&s_(r,o),x=c.createElement("script"),Zt(x),An(x,"link",r),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},d.set(v,x))}}function Zw(r,o,c,d){var v=(v=Ie.current)?Xf(v):null;if(!v)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=jl(c.href),c=ms(v).hoistableStyles,d=c.get(o),d||(d={type:"style",instance:null,count:0,state:null},c.set(o,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=jl(c.href);var x=ms(v).hoistableStyles,b=x.get(r);if(b||(v=v.ownerDocument||v,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(r,b),(x=v.querySelector(Ju(r)))&&!x._p&&(b.instance=x,b.state.loading=5),Li.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Li.set(r,c),x||i2(v,r,c,b.state))),o&&d===null)throw Error(i(528,""));return b}if(o&&d!==null)throw Error(i(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Bl(c),c=ms(v).hoistableScripts,d=c.get(o),d||(d={type:"script",instance:null,count:0,state:null},c.set(o,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function jl(r){return'href="'+Qn(r)+'"'}function Ju(r){return'link[rel="stylesheet"]['+r+"]"}function eb(r){return T({},r,{"data-precedence":r.precedence,precedence:null})}function i2(r,o,c,d){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?d.loading=1:(o=r.createElement("link"),d.preload=o,o.addEventListener("load",function(){return d.loading|=1}),o.addEventListener("error",function(){return d.loading|=2}),An(o,"link",c),Zt(o),r.head.appendChild(o))}function Bl(r){return'[src="'+Qn(r)+'"]'}function Qu(r){return"script[async]"+r}function tb(r,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var d=r.querySelector('style[data-href~="'+Qn(c.href)+'"]');if(d)return o.instance=d,Zt(d),d;var v=T({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),Zt(d),An(d,"style",v),Zf(d,c.precedence,r),o.instance=d;case"stylesheet":v=jl(c.href);var x=r.querySelector(Ju(v));if(x)return o.state.loading|=4,o.instance=x,Zt(x),x;d=eb(c),(v=Li.get(v))&&i_(d,v),x=(r.ownerDocument||r).createElement("link"),Zt(x);var b=x;return b._p=new Promise(function(N,q){b.onload=N,b.onerror=q}),An(x,"link",d),o.state.loading|=4,Zf(x,c.precedence,r),o.instance=x;case"script":return x=Bl(c.src),(v=r.querySelector(Qu(x)))?(o.instance=v,Zt(v),v):(d=c,(v=Li.get(x))&&(d=T({},c),s_(d,v)),r=r.ownerDocument||r,v=r.createElement("script"),Zt(v),An(v,"link",d),r.head.appendChild(v),o.instance=v);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(d=o.instance,o.state.loading|=4,Zf(d,c.precedence,r));return o.instance}function Zf(r,o,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=d.length?d[d.length-1]:null,x=v,b=0;b<d.length;b++){var N=d[b];if(N.dataset.precedence===o)x=N;else if(x!==v)break}x?x.parentNode.insertBefore(r,x.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(r,o.firstChild))}function i_(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function s_(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var em=null;function nb(r,o,c){if(em===null){var d=new Map,v=em=new Map;v.set(c,d)}else v=em,d=v.get(c),d||(d=new Map,v.set(c,d));if(d.has(r))return d;for(d.set(r,null),c=c.getElementsByTagName(r),v=0;v<c.length;v++){var x=c[v];if(!(x[hs]||x[Xt]||r==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var b=x.getAttribute(o)||"";b=r+b;var N=d.get(b);N?N.push(x):d.set(b,[x])}}return d}function ib(r,o,c){r=r.ownerDocument||r,r.head.insertBefore(c,o==="title"?r.querySelector("head > title"):null)}function s2(r,o,c){if(c===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function sb(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function r2(r,o,c,d){if(c.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var v=jl(d.href),x=o.querySelector(Ju(v));if(x){o=x._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=tm.bind(r),o.then(r,r)),c.state.loading|=4,c.instance=x,Zt(x);return}x=o.ownerDocument||o,d=eb(d),(v=Li.get(v))&&i_(d,v),x=x.createElement("link"),Zt(x);var b=x;b._p=new Promise(function(N,q){b.onload=N,b.onerror=q}),An(x,"link",d),c.instance=x}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(r.count++,c=tm.bind(r),o.addEventListener("load",c),o.addEventListener("error",c))}}var r_=0;function o2(r,o){return r.stylesheets&&r.count===0&&im(r,r.stylesheets),0<r.count||0<r.imgCount?function(c){var d=setTimeout(function(){if(r.stylesheets&&im(r,r.stylesheets),r.unsuspend){var x=r.unsuspend;r.unsuspend=null,x()}},6e4+o);0<r.imgBytes&&r_===0&&(r_=62500*qM());var v=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&im(r,r.stylesheets),r.unsuspend)){var x=r.unsuspend;r.unsuspend=null,x()}},(r.imgBytes>r_?50:800)+o);return r.unsuspend=c,function(){r.unsuspend=null,clearTimeout(d),clearTimeout(v)}}:null}function tm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)im(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var nm=null;function im(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,nm=new Map,o.forEach(a2,r),nm=null,tm.call(r))}function a2(r,o){if(!(o.state.loading&4)){var c=nm.get(r);if(c)var d=c.get(null);else{c=new Map,nm.set(r,c);for(var v=r.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<v.length;x++){var b=v[x];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(c.set(b.dataset.precedence,b),d=b)}d&&c.set(null,d)}v=o.instance,b=v.getAttribute("data-precedence"),x=c.get(b)||d,x===d&&c.set(null,v),c.set(b,v),this.count++,d=tm.bind(this),v.addEventListener("load",d),v.addEventListener("error",d),x?x.parentNode.insertBefore(v,x.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(v,r.firstChild)),o.state.loading|=4}}var Wu={$$typeof:$,Provider:null,Consumer:null,_currentValue:Re,_currentValue2:Re,_threadCount:0};function l2(r,o,c,d,v,x,b,N,q){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=us(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=us(0),this.hiddenUpdates=us(null),this.identifierPrefix=d,this.onUncaughtError=v,this.onCaughtError=x,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function rb(r,o,c,d,v,x,b,N,q,te,ae,ue){return r=new l2(r,o,c,b,q,te,ae,ue,N),o=1,x===!0&&(o|=24),x=di(3,null,null,o),r.current=x,x.stateNode=r,o=Og(),o.refCount++,r.pooledCache=o,o.refCount++,x.memoizedState={element:d,isDehydrated:c,cache:o},Bg(x),r}function ob(r){return r?(r=vl,r):vl}function ab(r,o,c,d,v,x){v=ob(v),d.context===null?d.context=v:d.pendingContext=v,d=Gr(o),d.payload={element:c},x=x===void 0?null:x,x!==null&&(d.callback=x),c=zr(r,d,o),c!==null&&(ni(c,r,o),Cu(c,r,o))}function lb(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<o?c:o}}function o_(r,o){lb(r,o),(r=r.alternate)&&lb(r,o)}function cb(r){if(r.tag===13||r.tag===31){var o=ia(r,67108864);o!==null&&ni(o,r,67108864),o_(r,67108864)}}function ub(r){if(r.tag===13||r.tag===31){var o=gi();o=Ho(o);var c=ia(r,o);c!==null&&ni(c,r,o),o_(r,o)}}var sm=!0;function c2(r,o,c,d){var v=X.T;X.T=null;var x=fe.p;try{fe.p=2,a_(r,o,c,d)}finally{fe.p=x,X.T=v}}function u2(r,o,c,d){var v=X.T;X.T=null;var x=fe.p;try{fe.p=8,a_(r,o,c,d)}finally{fe.p=x,X.T=v}}function a_(r,o,c,d){if(sm){var v=l_(d);if(v===null)Ky(r,o,d,rm,c),hb(r,d);else if(h2(v,r,o,c,d))d.stopPropagation();else if(hb(r,d),o&4&&-1<d2.indexOf(r)){for(;v!==null;){var x=Ii(v);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var b=ls(x.pendingLanes);if(b!==0){var N=x;for(N.pendingLanes|=2,N.entangledLanes|=2;b;){var q=1<<31-zt(b);N.entanglements[1]|=q,b&=~q}As(x),(ut&6)===0&&(jf=jn()+500,Hu(0))}}break;case 31:case 13:N=ia(x,2),N!==null&&ni(N,x,2),Gf(),o_(x,2)}if(x=l_(d),x===null&&Ky(r,o,d,rm,c),x===v)break;v=x}v!==null&&d.stopPropagation()}else Ky(r,o,d,null,c)}}function l_(r){return r=Si(r),c_(r)}var rm=null;function c_(r){if(rm=null,r=fs(r),r!==null){var o=a(r);if(o===null)r=null;else{var c=o.tag;if(c===13){if(r=l(o),r!==null)return r;r=null}else if(c===31){if(r=u(o),r!==null)return r;r=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return rm=r,null}function db(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(jo()){case eu:return 2;case tu:return 8;case Nr:case pg:return 32;case Lh:return 268435456;default:return 32}default:return 32}}var u_=!1,to=null,no=null,io=null,Xu=new Map,Zu=new Map,so=[],d2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function hb(r,o){switch(r){case"focusin":case"focusout":to=null;break;case"dragenter":case"dragleave":no=null;break;case"mouseover":case"mouseout":io=null;break;case"pointerover":case"pointerout":Xu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zu.delete(o.pointerId)}}function ed(r,o,c,d,v,x){return r===null||r.nativeEvent!==x?(r={blockedOn:o,domEventName:c,eventSystemFlags:d,nativeEvent:x,targetContainers:[v]},o!==null&&(o=Ii(o),o!==null&&cb(o)),r):(r.eventSystemFlags|=d,o=r.targetContainers,v!==null&&o.indexOf(v)===-1&&o.push(v),r)}function h2(r,o,c,d,v){switch(o){case"focusin":return to=ed(to,r,o,c,d,v),!0;case"dragenter":return no=ed(no,r,o,c,d,v),!0;case"mouseover":return io=ed(io,r,o,c,d,v),!0;case"pointerover":var x=v.pointerId;return Xu.set(x,ed(Xu.get(x)||null,r,o,c,d,v)),!0;case"gotpointercapture":return x=v.pointerId,Zu.set(x,ed(Zu.get(x)||null,r,o,c,d,v)),!0}return!1}function fb(r){var o=fs(r.target);if(o!==null){var c=a(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){r.blockedOn=o,Hi(r.priority,function(){ub(c)});return}}else if(o===31){if(o=u(c),o!==null){r.blockedOn=o,Hi(r.priority,function(){ub(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function om(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var c=l_(r.nativeEvent);if(c===null){c=r.nativeEvent;var d=new c.constructor(c.type,c);fu=d,c.target.dispatchEvent(d),fu=null}else return o=Ii(c),o!==null&&cb(o),r.blockedOn=c,!1;o.shift()}return!0}function mb(r,o,c){om(r)&&c.delete(o)}function f2(){u_=!1,to!==null&&om(to)&&(to=null),no!==null&&om(no)&&(no=null),io!==null&&om(io)&&(io=null),Xu.forEach(mb),Zu.forEach(mb)}function am(r,o){r.blockedOn===o&&(r.blockedOn=null,u_||(u_=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,f2)))}var lm=null;function pb(r){lm!==r&&(lm=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){lm===r&&(lm=null);for(var o=0;o<r.length;o+=3){var c=r[o],d=r[o+1],v=r[o+2];if(typeof d!="function"){if(c_(d||c)===null)continue;break}var x=Ii(c);x!==null&&(r.splice(o,3),o-=3,ly(x,{pending:!0,data:v,method:c.method,action:d},d,v))}}))}function Gl(r){function o(q){return am(q,r)}to!==null&&am(to,r),no!==null&&am(no,r),io!==null&&am(io,r),Xu.forEach(o),Zu.forEach(o);for(var c=0;c<so.length;c++){var d=so[c];d.blockedOn===r&&(d.blockedOn=null)}for(;0<so.length&&(c=so[0],c.blockedOn===null);)fb(c),c.blockedOn===null&&so.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var v=c[d],x=c[d+1],b=v[pn]||null;if(typeof x=="function")b||pb(c);else if(b){var N=null;if(x&&x.hasAttribute("formAction")){if(v=x,b=x[pn]||null)N=b.formAction;else if(c_(v)!==null)continue}else N=b.action;typeof N=="function"?c[d+1]=N:(c.splice(d,3),d-=3),pb(c)}}}function gb(){function r(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(b){return v=b})},focusReset:"manual",scroll:"manual"})}function o(){v!==null&&(v(),v=null),d||setTimeout(c,20)}function c(){if(!d&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,v=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){d=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),v!==null&&(v(),v=null)}}}function d_(r){this._internalRoot=r}cm.prototype.render=d_.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(i(409));var c=o.current,d=gi();ab(c,d,r,o,null,null)},cm.prototype.unmount=d_.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;ab(r.current,2,null,r,null,null),Gf(),o[ds]=null}};function cm(r){this._internalRoot=r}cm.prototype.unstable_scheduleHydration=function(r){if(r){var o=Bh();r={blockedOn:null,target:r,priority:o};for(var c=0;c<so.length&&o!==0&&o<so[c].priority;c++);so.splice(c,0,r),c===0&&fb(r)}};var yb=e.version;if(yb!=="19.2.1")throw Error(i(527,yb,"19.2.1"));fe.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=m(o),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var m2={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var um=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!um.isDisabled&&um.supportsFiber)try{Gi=um.inject(m2),En=um}catch{}}return nd.createRoot=function(r,o){if(!s(r))throw Error(i(299));var c=!1,d="",v=bE,x=IE,b=SE;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onUncaughtError!==void 0&&(v=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(b=o.onRecoverableError)),o=rb(r,1,!1,null,null,c,d,null,v,x,b,gb),r[ds]=o.current,$y(r),new d_(o)},nd.hydrateRoot=function(r,o,c){if(!s(r))throw Error(i(299));var d=!1,v="",x=bE,b=IE,N=SE,q=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(b=c.onCaughtError),c.onRecoverableError!==void 0&&(N=c.onRecoverableError),c.formState!==void 0&&(q=c.formState)),o=rb(r,1,!0,o,c??null,d,v,q,x,b,N,gb),o.context=ob(null),c=o.current,d=gi(),d=Ho(d),v=Gr(d),v.callback=null,zr(c,v,d),c=d,o.current.lanes=c,Go(o,c),As(o),r[ds]=o.current,$y(r),new cm(o)},nd.version="19.2.1",nd}var Ab;function b2(){if(Ab)return m_.exports;Ab=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),m_.exports=w2(),m_.exports}var I2=b2();const S2=vN(I2),A2=()=>{};var Nb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TN=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},N2=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const a=n[t++];e[i++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=n[t++],l=n[t++],u=n[t++],h=((s&7)<<18|(a&63)<<12|(l&63)<<6|u&63)-65536;e[i++]=String.fromCharCode(55296+(h>>10)),e[i++]=String.fromCharCode(56320+(h&1023))}else{const a=n[t++],l=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return e.join("")},xN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const a=n[s],l=s+1<n.length,u=l?n[s+1]:0,h=s+2<n.length,m=h?n[s+2]:0,_=a>>2,T=(a&3)<<4|u>>4;let E=(u&15)<<2|m>>6,S=m&63;h||(S=64,l||(E=64)),i.push(t[_],t[T],t[E],t[S])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(TN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):N2(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const a=t[n.charAt(s++)],u=s<n.length?t[n.charAt(s)]:0;++s;const m=s<n.length?t[n.charAt(s)]:64;++s;const T=s<n.length?t[n.charAt(s)]:64;if(++s,a==null||u==null||m==null||T==null)throw new C2;const E=a<<2|u>>4;if(i.push(E),m!==64){const S=u<<4&240|m>>2;if(i.push(S),T!==64){const k=m<<6&192|T;i.push(k)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class C2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const R2=function(n){const e=TN(n);return xN.encodeByteArray(e,!0)},Um=function(n){return R2(n).replace(/\./g,"")},Gv=function(n){try{return xN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Om(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!P2(t)||(n[t]=Om(n[t],e[t]));return n}function P2(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D2=()=>zv().__FIREBASE_DEFAULTS__,M2=()=>{if(typeof process>"u"||typeof Nb>"u")return;const n=Nb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},k2=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Gv(n[1]);return e&&JSON.parse(e)},Hv=()=>{try{return A2()||D2()||M2()||k2()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},$v=()=>{var n;return(n=Hv())==null?void 0:n.config},V2=n=>{var e;return(e=Hv())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uc(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function EN(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Um(JSON.stringify(t)),Um(JSON.stringify(l)),""].join(".")}const Ed={};function O2(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ed))Ed[e]?n.emulator.push(e):n.prod.push(e);return n}function F2(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Cb=!1;function wN(n,e){if(typeof window>"u"||typeof document>"u"||!Uc(window.location.host)||Ed[n]===e||Ed[n]||Cb)return;Ed[n]=e;function t(E){return`__firebase__banner__${E}`}const i="__firebase__banner",a=O2().prod.length>0;function l(){const E=document.getElementById(i);E&&E.remove()}function u(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function h(E,S){E.setAttribute("width","24"),E.setAttribute("id",S),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function m(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Cb=!0,l()},E}function _(E,S){E.setAttribute("id",S),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function T(){const E=F2(i),S=t("text"),k=document.getElementById(S)||document.createElement("span"),V=t("learnmore"),O=document.getElementById(V)||document.createElement("a"),j=t("preprendIcon"),W=document.getElementById(j)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const $=E.element;u($),_(O,V);const U=m();h(W,j),$.append(W,k,O,U),document.body.appendChild($)}a?(k.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function q2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Lt())}function gp(){var e;const n=(e=Hv())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function j2(){return typeof window<"u"||bN()}function bN(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function B2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function yp(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Kv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function IN(){const n=Lt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function SN(){return!gp()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function AN(){return!gp()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Va(){try{return typeof indexedDB=="object"}catch{return!1}}function Yv(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var a;e(((a=s.error)==null?void 0:a.message)||"")}}catch(t){e(t)}})}function NN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G2="FirebaseError";class Rn extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=G2,Object.setPrototypeOf(this,Rn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_r.prototype.create)}}class _r{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],l=a?z2(a,i):"Error",u=`${this.serviceName}: ${l} (${s}).`;return new Rn(s,u,i)}}function z2(n,e){return n.replace(H2,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const H2=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rb(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function $2(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Eo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const a=n[s],l=e[s];if(Pb(a)&&Pb(l)){if(!Eo(a,l))return!1}else if(a!==l)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function Pb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oc(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function nc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,a]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function fd(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function CN(n,e){const t=new K2(n,e);return t.subscribe.bind(t)}class K2{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Y2(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=__),s.error===void 0&&(s.error=__),s.complete===void 0&&(s.complete=__);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Y2(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function __(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J2=1e3,Q2=2,W2=14400*1e3,X2=.5;function Db(n,e=J2,t=Q2){const i=e*Math.pow(t,n),s=Math.round(X2*i*(Math.random()-.5)*2);return Math.min(W2,i+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(n){return n&&n._delegate?n._delegate:n}class Yn{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ya="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new L2;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tk(e))try{this.getOrInitializeService({instanceIdentifier:ya})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});i.resolve(a)}catch{}}}}clearInstance(e=ya){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ya){return this.instances.has(e)}getOptions(e=ya){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[a,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(a);i===u&&l.resolve(s)}return s}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(i)??new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:ek(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ya){return this.component?this.component.multipleInstances?e:ya:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ek(n){return n===ya?void 0:n}function tk(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Z2(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jv=[];var Qe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Qe||(Qe={}));const PN={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},nk=Qe.INFO,ik={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},sk=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=ik[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class uh{constructor(e){this.name=e,this._logLevel=nk,this._logHandler=sk,this._userLogHandler=null,Jv.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...e),this._logHandler(this,Qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...e),this._logHandler(this,Qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...e),this._logHandler(this,Qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...e),this._logHandler(this,Qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...e),this._logHandler(this,Qe.ERROR,...e)}}function rk(n){Jv.forEach(e=>{e.setLogLevel(n)})}function ok(n,e){for(const t of Jv){let i=null;e&&e.level&&(i=PN[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(s,a,...l)=>{const u=l.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");a>=(i??s.logLevel)&&n({level:Qe[a].toLowerCase(),message:u,args:l,type:s.name})}}}const ak=(n,e)=>e.some(t=>n instanceof t);let Mb,kb;function lk(){return Mb||(Mb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ck(){return kb||(kb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const DN=new WeakMap,q_=new WeakMap,MN=new WeakMap,v_=new WeakMap,Qv=new WeakMap;function uk(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(yo(n.result)),s()},l=()=>{i(n.error),s()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&DN.set(t,n)}).catch(()=>{}),Qv.set(e,n),e}function dk(n){if(q_.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),s()},l=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});q_.set(n,e)}let j_={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return q_.get(n);if(e==="objectStoreNames")return n.objectStoreNames||MN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return yo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function hk(n){j_=n(j_)}function fk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(T_(this),e,...t);return MN.set(i,e.sort?e.sort():[e]),yo(i)}:ck().includes(n)?function(...e){return n.apply(T_(this),e),yo(DN.get(this))}:function(...e){return yo(n.apply(T_(this),e))}}function mk(n){return typeof n=="function"?fk(n):(n instanceof IDBTransaction&&dk(n),ak(n,lk())?new Proxy(n,j_):n)}function yo(n){if(n instanceof IDBRequest)return uk(n);if(v_.has(n))return v_.get(n);const e=mk(n);return e!==n&&(v_.set(n,e),Qv.set(e,n)),e}const T_=n=>Qv.get(n);function kN(n,e,{blocked:t,upgrade:i,blocking:s,terminated:a}={}){const l=indexedDB.open(n,e),u=yo(l);return i&&l.addEventListener("upgradeneeded",h=>{i(yo(l.result),h.oldVersion,h.newVersion,yo(l.transaction),h)}),t&&l.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{a&&h.addEventListener("close",()=>a()),s&&h.addEventListener("versionchange",m=>s(m.oldVersion,m.newVersion,m))}).catch(()=>{}),u}const pk=["get","getKey","getAll","getAllKeys","count"],gk=["put","add","delete","clear"],x_=new Map;function Vb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(x_.get(e))return x_.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=gk.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||pk.includes(t)))return;const a=async function(l,...u){const h=this.transaction(l,s?"readwrite":"readonly");let m=h.store;return i&&(m=m.index(u.shift())),(await Promise.all([m[t](...u),s&&h.done]))[0]};return x_.set(e,a),a}hk(n=>({...n,get:(e,t,i)=>Vb(e,t)||n.get(e,t,i),has:(e,t)=>!!Vb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(_k(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function _k(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Fm="@firebase/app",B_="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr=new uh("@firebase/app"),vk="@firebase/app-compat",Tk="@firebase/analytics-compat",xk="@firebase/analytics",Ek="@firebase/app-check-compat",wk="@firebase/app-check",bk="@firebase/auth",Ik="@firebase/auth-compat",Sk="@firebase/database",Ak="@firebase/data-connect",Nk="@firebase/database-compat",Ck="@firebase/functions",Rk="@firebase/functions-compat",Pk="@firebase/installations",Dk="@firebase/installations-compat",Mk="@firebase/messaging",kk="@firebase/messaging-compat",Vk="@firebase/performance",Lk="@firebase/performance-compat",Uk="@firebase/remote-config",Ok="@firebase/remote-config-compat",Fk="@firebase/storage",qk="@firebase/storage-compat",jk="@firebase/firestore",Bk="@firebase/ai",Gk="@firebase/firestore-compat",zk="firebase",Hk="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo="[DEFAULT]",$k={[Fm]:"fire-core",[vk]:"fire-core-compat",[xk]:"fire-analytics",[Tk]:"fire-analytics-compat",[wk]:"fire-app-check",[Ek]:"fire-app-check-compat",[bk]:"fire-auth",[Ik]:"fire-auth-compat",[Sk]:"fire-rtdb",[Ak]:"fire-data-connect",[Nk]:"fire-rtdb-compat",[Ck]:"fire-fn",[Rk]:"fire-fn-compat",[Pk]:"fire-iid",[Dk]:"fire-iid-compat",[Mk]:"fire-fcm",[kk]:"fire-fcm-compat",[Vk]:"fire-perf",[Lk]:"fire-perf-compat",[Uk]:"fire-rc",[Ok]:"fire-rc-compat",[Fk]:"fire-gcs",[qk]:"fire-gcs-compat",[jk]:"fire-fst",[Gk]:"fire-fst-compat",[Bk]:"fire-vertex","fire-js":"fire-js",[zk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bo=new Map,fc=new Map,mc=new Map;function qd(n,e){try{n.container.addComponent(e)}catch(t){fr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function VN(n,e){n.container.addOrOverwriteComponent(e)}function qi(n){const e=n.name;if(mc.has(e))return fr.debug(`There were multiple attempts to register component ${e}.`),!1;mc.set(e,n);for(const t of bo.values())qd(t,n);for(const t of fc.values())qd(t,n);return!0}function _p(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Kk(n,e,t=wo){_p(n,e).clearInstance(t)}function Wv(n){return n.options!==void 0}function LN(n){return Wv(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function Mt(n){return n==null?!1:n.settings!==void 0}function Yk(){mc.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ti=new _r("app","Firebase",Jk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let UN=class{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Yn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ti.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lb(n,e){const t=Gv(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const s=JSON.parse(t).exp*1e3,a=new Date().getTime();s-a<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class Qk extends UN{constructor(e,t,i,s){const a=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,l={name:i,automaticDataCollectionEnabled:a};if(e.apiKey!==void 0)super(e,l,s);else{const u=e;super(u.options,l,s)}this._serverConfig={automaticDataCollectionEnabled:a,...t},this._serverConfig.authIdToken&&Lb(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&Lb(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,$n(Fm,B_,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Zv(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Ti.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mo=Hk;function Xv(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:wo,automaticDataCollectionEnabled:!0,...e},s=i.name;if(typeof s!="string"||!s)throw Ti.create("bad-app-name",{appName:String(s)});if(t||(t=$v()),!t)throw Ti.create("no-options");const a=bo.get(s);if(a){if(Eo(t,a.options)&&Eo(i,a.config))return a;throw Ti.create("duplicate-app",{appName:s})}const l=new RN(s);for(const h of mc.values())l.addComponent(h);const u=new UN(t,i,l);return bo.set(s,u),u}function Wk(n,e={}){if(j2()&&!bN())throw Ti.create("invalid-server-app-environment");let t,i=e||{};if(n&&(Wv(n)?t=n.options:LN(n)?i=n:t=n),i.automaticDataCollectionEnabled===void 0&&(i.automaticDataCollectionEnabled=!0),t||(t=$v()),!t)throw Ti.create("no-options");const s={...i,...t};s.releaseOnDeref!==void 0&&delete s.releaseOnDeref;const a=_=>[..._].reduce((T,E)=>Math.imul(31,T)+E.charCodeAt(0)|0,0);if(i.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Ti.create("finalization-registry-not-supported",{});const l=""+a(JSON.stringify(s)),u=fc.get(l);if(u)return u.incRefCount(i.releaseOnDeref),u;const h=new RN(l);for(const _ of mc.values())h.addComponent(_);const m=new Qk(t,i,l,h);return fc.set(l,m),m}function Xk(n=wo){const e=bo.get(n);if(!e&&n===wo&&$v())return Xv();if(!e)throw Ti.create("no-app",{appName:n});return e}function Zk(){return Array.from(bo.values())}async function Zv(n){let e=!1;const t=n.name;bo.has(t)?(e=!0,bo.delete(t)):fc.has(t)&&n.decRefCount()<=0&&(fc.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(i=>i.delete())),n.isDeleted=!0)}function $n(n,e,t){let i=$k[n]??n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fr.warn(l.join(" "));return}qi(new Yn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function ON(n,e){if(n!==null&&typeof n!="function")throw Ti.create("invalid-log-argument");ok(n,e)}function FN(n){rk(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eV="firebase-heartbeat-database",tV=1,jd="firebase-heartbeat-store";let E_=null;function qN(){return E_||(E_=kN(eV,tV,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(jd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ti.create("idb-open",{originalErrorMessage:n.message})})),E_}async function nV(n){try{const t=(await qN()).transaction(jd),i=await t.objectStore(jd).get(jN(n));return await t.done,i}catch(e){if(e instanceof Rn)fr.warn(e.message);else{const t=Ti.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});fr.warn(t.message)}}}async function Ub(n,e){try{const i=(await qN()).transaction(jd,"readwrite");await i.objectStore(jd).put(e,jN(n)),await i.done}catch(t){if(t instanceof Rn)fr.warn(t.message);else{const i=Ti.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});fr.warn(i.message)}}}function jN(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iV=1024,sV=30;class rV{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new aV(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Ob();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>sV){const l=lV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){fr.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Ob(),{heartbeatsToSend:i,unsentEntries:s}=oV(this._heartbeatsCache.heartbeats),a=Um(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return fr.warn(t),""}}}function Ob(){return new Date().toISOString().substring(0,10)}function oV(n,e=iV){const t=[];let i=n.slice();for(const s of n){const a=t.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),Fb(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Fb(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class aV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Va()?Yv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await nV(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Ub(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Ub(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Fb(n){return Um(JSON.stringify({version:2,heartbeats:n})).length}function lV(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cV(n){qi(new Yn("platform-logger",e=>new yk(e),"PRIVATE")),qi(new Yn("heartbeat",e=>new rV(e),"PRIVATE")),$n(Fm,B_,n),$n(Fm,B_,"esm2020"),$n("fire-js","")}cV("");const uV=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Rn,SDK_VERSION:Mo,_DEFAULT_ENTRY_NAME:wo,_addComponent:qd,_addOrOverwriteComponent:VN,_apps:bo,_clearComponents:Yk,_components:mc,_getProvider:_p,_isFirebaseApp:Wv,_isFirebaseServerApp:Mt,_isFirebaseServerAppSettings:LN,_registerComponent:qi,_removeServiceInstance:Kk,_serverApps:fc,deleteApp:Zv,getApp:Xk,getApps:Zk,initializeApp:Xv,initializeServerApp:Wk,onLog:ON,registerVersion:$n,setLogLevel:FN},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{constructor(e,t){this._delegate=e,this.firebase=t,qd(e,new Yn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Zv(this._delegate)))}_getService(e,t=wo){var s;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((s=i.getComponent())==null?void 0:s.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=wo){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){qd(this._delegate,e)}_addOrOverwriteComponent(e){VN(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hV={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},qb=new _r("app-compat","Firebase",hV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fV(n){const e={},t={__esModule:!0,initializeApp:a,app:s,registerVersion:$n,setLogLevel:FN,onLog:ON,apps:null,SDK_VERSION:Mo,INTERNAL:{registerComponent:u,removeApp:i,useAsService:h,modularAPIs:uV}};t.default=t,Object.defineProperty(t,"apps",{get:l});function i(m){delete e[m]}function s(m){if(m=m||wo,!Rb(e,m))throw qb.create("no-app",{appName:m});return e[m]}s.App=n;function a(m,_={}){const T=Xv(m,_);if(Rb(e,T.name))return e[T.name];const E=new n(T,t);return e[T.name]=E,E}function l(){return Object.keys(e).map(m=>e[m])}function u(m){const _=m.name,T=_.replace("-compat","");if(qi(m)&&m.type==="PUBLIC"){const E=(S=s())=>{if(typeof S[T]!="function")throw qb.create("invalid-app-argument",{appName:_});return S[T]()};m.serviceProps!==void 0&&Om(E,m.serviceProps),t[T]=E,n.prototype[T]=function(...S){return this._getService.bind(this,_).apply(this,m.multipleInstances?S:[])}}return m.type==="PUBLIC"?t[T]:null}function h(m,_){return _==="serverAuth"?null:_}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BN(){const n=fV(dV);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:BN,extendNamespace:e,createSubscribe:CN,ErrorFactory:_r,deepExtend:Om};function e(t){Om(n,t)}return n}const mV=BN();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jb=new uh("@firebase/app-compat"),pV="@firebase/app-compat",gV="0.5.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yV(n){$n(pV,gV,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=zv();if(n.firebase!==void 0){jb.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&jb.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const ke=mV;yV();var _V="firebase",vV="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ke.registerVersion(_V,vV,"app-compat");const id={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},zl={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TV(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function GN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const xV=TV,EV=GN,zN=new _r("auth","Firebase",GN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qm=new uh("@firebase/auth");function wV(n,...e){qm.logLevel<=Qe.WARN&&qm.warn(`Auth (${Mo}): ${n}`,...e)}function vm(n,...e){qm.logLevel<=Qe.ERROR&&qm.error(`Auth (${Mo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(n,...e){throw t0(n,...e)}function fn(n,...e){return t0(n,...e)}function e0(n,e,t){const i={...EV(),[e]:t};return new _r("auth","Firebase",i).create(e,{appName:n.name})}function Tn(n){return e0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Fc(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Dn(n,"argument-error"),e0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function t0(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return zN.create(n,...e)}function me(n,e,...t){if(!n)throw t0(e,...t)}function ks(n){const e="INTERNAL ASSERTION FAILED: "+n;throw vm(e),new Error(e)}function rs(n,e){n||ks(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bd(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function n0(){return Bb()==="http:"||Bb()==="https:"}function Bb(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(n0()||yp()||"connection"in navigator)?navigator.onLine:!0}function IV(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e,t){this.shortDelay=e,this.longDelay=t,rs(t>e,"Short delay should be less than long delay!"),this.isMobile=q2()||Kv()}get(){return bV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i0(n,e){rs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ks("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ks("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ks("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],NV=new dh(3e4,6e4);function Bt(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Gt(n,e,t,i,s={}){return $N(n,s,async()=>{let a={},l={};i&&(e==="GET"?l=i:a={body:JSON.stringify(i)});const u=Oc({key:n.config.apiKey,...l}).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const m={method:e,headers:h,...a};return B2()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&Uc(n.emulatorConfig.host)&&(m.credentials="include"),HN.fetch()(await KN(n,n.config.apiHost,t,u),m)})}async function $N(n,e,t){n._canInitEmulator=!1;const i={...SV,...e};try{const s=new RV(n),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw md(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const u=a.ok?l.errorMessage:l.error.message,[h,m]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw md(n,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw md(n,"email-already-in-use",l);if(h==="USER_DISABLED")throw md(n,"user-disabled",l);const _=i[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw e0(n,_,m);Dn(n,_)}}catch(s){if(s instanceof Rn)throw s;Dn(n,"network-request-failed",{message:String(s)})}}async function vr(n,e,t,i,s={}){const a=await Gt(n,e,t,i,s);return"mfaPendingCredential"in a&&Dn(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function KN(n,e,t,i){const s=`${e}${t}?${i}`,a=n,l=a.config.emulator?i0(n.config,s):`${n.config.apiScheme}://${s}`;return AV.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function CV(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class RV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(fn(this.auth,"network-request-failed")),NV.get())})}}function md(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=fn(n,e,i);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gb(n){return n!==void 0&&n.getResponse!==void 0}function zb(n){return n!==void 0&&n.enterprise!==void 0}class YN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return CV(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PV(n){return(await Gt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function JN(n,e){return Gt(n,"GET","/v2/recaptchaConfig",Bt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DV(n,e){return Gt(n,"POST","/v1/accounts:delete",e)}async function MV(n,e){return Gt(n,"POST","/v1/accounts:update",e)}async function jm(n,e){return Gt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function kV(n,e=!1){const t=De(n),i=await t.getIdToken(e),s=vp(i);me(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:s,token:i,authTime:wd(w_(s.auth_time)),issuedAtTime:wd(w_(s.iat)),expirationTime:wd(w_(s.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function w_(n){return Number(n)*1e3}function vp(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return vm("JWT malformed, contained fewer than 3 sections"),null;try{const s=Gv(t);return s?JSON.parse(s):(vm("Failed to decode base64 JWT payload"),null)}catch(s){return vm("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Hb(n){const e=vp(n);return me(e,"internal-error"),me(typeof e.exp<"u","internal-error"),me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mr(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Rn&&VV(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function VV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=wd(this.lastLoginAt),this.creationTime=wd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gd(n){var T;const e=n.auth,t=await n.getIdToken(),i=await mr(n,jm(e,{idToken:t}));me(i==null?void 0:i.users.length,e,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const a=(T=s.providerUserInfo)!=null&&T.length?QN(s.providerUserInfo):[],l=OV(n.providerData,a),u=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),m=u?h:!1,_={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new G_(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(n,_)}async function UV(n){const e=De(n);await Gd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function OV(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function QN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FV(n,e){const t=await $N(n,{},async()=>{const i=Oc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=n.config,l=await KN(n,s,"/v1/token",`key=${a}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:i};return n.emulatorConfig&&Uc(n.emulatorConfig.host)&&(h.credentials="include"),HN.fetch()(l,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function qV(n,e){return Gt(n,"POST","/v2/accounts:revokeToken",Bt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){me(e.idToken,"internal-error"),me(typeof e.idToken<"u","internal-error"),me(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Hb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){me(e.length!==0,"internal-error");const t=Hb(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:a}=await FV(e,t);this.updateTokensAndExpiration(i,s,Number(a))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:a}=t,l=new sc;return i&&(me(typeof i=="string","internal-error",{appName:e}),l.refreshToken=i),s&&(me(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),a&&(me(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new sc,this.toJSON())}_performRefresh(){return ks("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oo(n,e){me(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ns{constructor({uid:e,auth:t,stsTokenManager:i,...s}){this.providerId="firebase",this.proactiveRefresh=new LV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new G_(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await mr(this,this.stsTokenManager.getToken(this.auth,e));return me(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return kV(this,e)}reload(){return UV(this)}_assign(e){this!==e&&(me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ns({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Gd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mt(this.auth.app))return Promise.reject(Tn(this.auth));const e=await this.getIdToken();return await mr(this,DV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,s=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,u=t.tenantId??void 0,h=t._redirectEventId??void 0,m=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:T,emailVerified:E,isAnonymous:S,providerData:k,stsTokenManager:V}=t;me(T&&V,e,"internal-error");const O=sc.fromJSON(this.name,V);me(typeof T=="string",e,"internal-error"),oo(i,e.name),oo(s,e.name),me(typeof E=="boolean",e,"internal-error"),me(typeof S=="boolean",e,"internal-error"),oo(a,e.name),oo(l,e.name),oo(u,e.name),oo(h,e.name),oo(m,e.name),oo(_,e.name);const j=new ns({uid:T,auth:e,email:s,emailVerified:E,displayName:i,isAnonymous:S,photoURL:l,phoneNumber:a,tenantId:u,stsTokenManager:O,createdAt:m,lastLoginAt:_});return k&&Array.isArray(k)&&(j.providerData=k.map(W=>({...W}))),h&&(j._redirectEventId=h),j}static async _fromIdTokenResponse(e,t,i=!1){const s=new sc;s.updateFromServerResponse(t);const a=new ns({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await Gd(a),a}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];me(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?QN(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),u=new sc;u.updateFromIdToken(i);const h=new ns({uid:s.localId,auth:e,stsTokenManager:u,isAnonymous:l}),m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new G_(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(h,m),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b=new Map;function vi(n){rs(n instanceof Function,"Expected a class definition");let e=$b.get(n);return e?(rs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,$b.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}WN.type="NONE";const pc=WN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pa(n,e,t){return`firebase:${n}:${e}:${t}`}class rc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:a}=this.auth;this.fullUserKey=Pa(this.userKey,s.apiKey,a),this.fullPersistenceKey=Pa("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await jm(this.auth,{idToken:e}).catch(()=>{});return t?ns._fromGetAccountInfoResponse(this.auth,t,e):null}return ns._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new rc(vi(pc),e,i);const s=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let a=s[0]||vi(pc);const l=Pa(i,e.config.apiKey,e.name);let u=null;for(const m of t)try{const _=await m._get(l);if(_){let T;if(typeof _=="string"){const E=await jm(e,{idToken:_}).catch(()=>{});if(!E)break;T=await ns._fromGetAccountInfoResponse(e,E,_)}else T=ns._fromJSON(e,_);m!==a&&(u=T),a=m;break}}catch{}const h=s.filter(m=>m._shouldAllowMigration);return!a._shouldAllowMigration||!h.length?new rc(a,e,i):(a=h[0],u&&await a._set(l,u.toJSON()),await Promise.all(t.map(async m=>{if(m!==a)try{await m._remove(l)}catch{}})),new rc(a,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kb(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(tC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(XN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(nC(e))return"Blackberry";if(iC(e))return"Webos";if(ZN(e))return"Safari";if((e.includes("chrome/")||eC(e))&&!e.includes("edge/"))return"Chrome";if(hh(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function XN(n=Lt()){return/firefox\//i.test(n)}function ZN(n=Lt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function eC(n=Lt()){return/crios\//i.test(n)}function tC(n=Lt()){return/iemobile/i.test(n)}function hh(n=Lt()){return/android/i.test(n)}function nC(n=Lt()){return/blackberry/i.test(n)}function iC(n=Lt()){return/webos/i.test(n)}function fh(n=Lt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function jV(n=Lt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function BV(n=Lt()){var e;return fh(n)&&!!((e=window.navigator)!=null&&e.standalone)}function GV(){return IN()&&document.documentMode===10}function sC(n=Lt()){return fh(n)||hh(n)||iC(n)||nC(n)||/windows phone/i.test(n)||tC(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rC(n,e=[]){let t;switch(n){case"Browser":t=Kb(Lt());break;case"Worker":t=`${Kb(Lt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Mo}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=a=>new Promise((l,u)=>{try{const h=e(a);l(h)}catch(h){u(h)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HV(n,e={}){return Gt(n,"GET","/v2/passwordPolicy",Bt(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V=6;class KV{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??$V,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Yb(this),this.idTokenSubscription=new Yb(this),this.beforeStateQueue=new zV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=zN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=vi(t)),this._initializationPromise=this.queue(async()=>{var i,s,a;if(!this._deleted&&(this.persistenceManager=await rc.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await jm(this,{idToken:e}),i=await ns._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(Mt(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(a=this.redirectUser)==null?void 0:a._redirectEventId,u=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===u)&&(h!=null&&h.user)&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Gd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=IV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mt(this.app))return Promise.reject(Tn(this));const t=e?De(e):null;return t&&me(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mt(this.app)?Promise.reject(Tn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mt(this.app)?Promise.reject(Tn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(vi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await HV(this),t=new KV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new _r("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await qV(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&vi(e)||this._popupRedirectResolver;me(t,this,"argument-error"),this.redirectPersistenceManager=await rc.create(this,[vi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(me(u,this,"internal-error"),u.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,i,s);return()=>{l=!0,h()}}else{const h=e.addObserver(t);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=rC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(Mt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&wV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ut(n){return De(n)}class Yb{constructor(e){this.auth=e,this.observer=null,this.addObserver=CN(t=>this.observer=t)}get next(){return me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function JV(n){mh=n}function s0(n){return mh.loadJS(n)}function QV(){return mh.recaptchaV2Script}function WV(){return mh.recaptchaEnterpriseScript}function XV(){return mh.gapiScript}function oC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZV=500,e4=6e4,dm=1e12;class t4{constructor(e){this.auth=e,this.counter=dm,this._widgets=new Map}render(e,t){const i=this.counter;return this._widgets.set(i,new s4(e,this.auth.name,t||{})),this.counter++,i}reset(e){var i;const t=e||dm;(i=this._widgets.get(t))==null||i.delete(),this._widgets.delete(t)}getResponse(e){var i;const t=e||dm;return((i=this._widgets.get(t))==null?void 0:i.getResponse())||""}async execute(e){var i;const t=e||dm;return(i=this._widgets.get(t))==null||i.execute(),""}}class n4{constructor(){this.enterprise=new i4}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class i4{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class s4{constructor(e,t,i){this.params=i,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;me(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=r4(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},e4)},ZV))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function r4(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<n;i++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const o4="recaptcha-enterprise",bd="NO_RECAPTCHA";class aC{constructor(e){this.type=o4,this.auth=Ut(e)}async verify(e="verify",t=!1){async function i(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,u)=>{JN(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const m=new YN(h);return a.tenantId==null?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,l(m.siteKey)}}).catch(h=>{u(h)})})}function s(a,l,u){const h=window.grecaptcha;zb(h)?h.enterprise.ready(()=>{h.enterprise.execute(a,{action:e}).then(m=>{l(m)}).catch(()=>{l(bd)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new n4().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{i(this.auth).then(u=>{if(!t&&zb(window.grecaptcha))s(u,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=WV();h.length!==0&&(h+=u),s0(h).then(()=>{s(u,a,l)}).catch(m=>{l(m)})}}).catch(u=>{l(u)})})}}async function sd(n,e,t,i=!1,s=!1){const a=new aC(n);let l;if(s)l=bd;else try{l=await a.verify(t)}catch{l=await a.verify(t,!0)}const u={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const h=u.phoneEnrollmentInfo.phoneNumber,m=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:m,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return i?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function _o(n,e,t,i,s){var a,l;if(s==="EMAIL_PASSWORD_PROVIDER")if((a=n._getRecaptchaConfig())!=null&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await sd(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await sd(n,e,t,t==="getOobCode");return i(n,h)}else return Promise.reject(u)});else if(s==="PHONE_PROVIDER")if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("PHONE_PROVIDER")){const u=await sd(n,e,t);return i(n,u).catch(async h=>{var m;if(((m=n._getRecaptchaConfig())==null?void 0:m.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(h.code==="auth/missing-recaptcha-token"||h.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const _=await sd(n,e,t,!1,!0);return i(n,_)}return Promise.reject(h)})}else{const u=await sd(n,e,t,!1,!0);return i(n,u)}else return Promise.reject(s+" provider is not supported.")}async function a4(n){const e=Ut(n),t=await JN(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),i=new YN(t);e.tenantId==null?e._agentRecaptchaConfig=i:e._tenantRecaptchaConfigs[e.tenantId]=i,i.isAnyProviderEnabled()&&new aC(e).verify()}function l4(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(vi);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function c4(n,e,t){const i=Ut(n);me(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),a=lC(e),{host:l,port:u}=u4(e),h=u===null?"":`:${u}`,m={url:`${a}//${l}${h}/`},_=Object.freeze({host:l,port:u,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){me(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),me(Eo(m,i.config.emulator)&&Eo(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=m,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,Uc(l)?(EN(`${a}//${l}${h}`),wN("Auth",!0)):s||d4()}function lC(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function u4(n){const e=lC(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const a=s[1];return{host:a,port:Jb(i.substr(a.length+1))}}else{const[a,l]=i.split(":");return{host:a,port:Jb(l)}}}function Jb(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function d4(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ks("not implemented")}_getIdTokenResponse(e){return ks("not implemented")}_linkToIdToken(e,t){return ks("not implemented")}_getReauthenticationResolver(e){return ks("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cC(n,e){return Gt(n,"POST","/v1/accounts:resetPassword",Bt(n,e))}async function h4(n,e){return Gt(n,"POST","/v1/accounts:update",e)}async function f4(n,e){return Gt(n,"POST","/v1/accounts:signUp",e)}async function m4(n,e){return Gt(n,"POST","/v1/accounts:update",Bt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p4(n,e){return vr(n,"POST","/v1/accounts:signInWithPassword",Bt(n,e))}async function Tp(n,e){return Gt(n,"POST","/v1/accounts:sendOobCode",Bt(n,e))}async function g4(n,e){return Tp(n,e)}async function y4(n,e){return Tp(n,e)}async function _4(n,e){return Tp(n,e)}async function v4(n,e){return Tp(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T4(n,e){return vr(n,"POST","/v1/accounts:signInWithEmailLink",Bt(n,e))}async function x4(n,e){return vr(n,"POST","/v1/accounts:signInWithEmailLink",Bt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd extends qc{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new zd(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new zd(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _o(e,t,"signInWithPassword",p4,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return T4(e,{email:this._email,oobCode:this._password});default:Dn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _o(e,i,"signUpPassword",f4,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return x4(e,{idToken:t,email:this._email,oobCode:this._password});default:Dn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dr(n,e){return vr(n,"POST","/v1/accounts:signInWithIdp",Bt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E4="http://localhost";class qs extends qc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new qs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Dn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s,...a}=t;if(!i||!s)return null;const l=new qs(i,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return dr(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,dr(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,dr(e,t)}buildRequest(){const e={requestUri:E4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Oc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qb(n,e){return Gt(n,"POST","/v1/accounts:sendVerificationCode",Bt(n,e))}async function w4(n,e){return vr(n,"POST","/v1/accounts:signInWithPhoneNumber",Bt(n,e))}async function b4(n,e){const t=await vr(n,"POST","/v1/accounts:signInWithPhoneNumber",Bt(n,e));if(t.temporaryProof)throw md(n,"account-exists-with-different-credential",t);return t}const I4={USER_NOT_FOUND:"user-not-found"};async function S4(n,e){const t={...e,operation:"REAUTH"};return vr(n,"POST","/v1/accounts:signInWithPhoneNumber",Bt(n,t),I4)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da extends qc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Da({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Da({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return w4(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return b4(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return S4(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:i,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:i,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:i,phoneNumber:s,temporaryProof:a}=e;return!i&&!t&&!s&&!a?null:new Da({verificationId:t,verificationCode:i,phoneNumber:s,temporaryProof:a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A4(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function N4(n){const e=nc(fd(n)).link,t=e?nc(fd(e)).deep_link_id:null,i=nc(fd(n)).deep_link_id;return(i?nc(fd(i)).link:null)||i||t||e||n}class xp{constructor(e){const t=nc(fd(e)),i=t.apiKey??null,s=t.oobCode??null,a=A4(t.mode??null);me(i&&s&&a,"argument-error"),this.apiKey=i,this.operation=a,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=N4(e);try{return new xp(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(){this.providerId=ko.PROVIDER_ID}static credential(e,t){return zd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=xp.parseLink(t);return me(i,"argument-error"),zd._fromEmailAndCode(e,i.code,i.tenantId)}}ko.PROVIDER_ID="password";ko.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ko.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc extends Tr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class oc extends jc{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return me("providerId"in t&&"signInMethod"in t,"argument-error"),qs._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return me(e.idToken||e.accessToken,"argument-error"),qs._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return oc.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return oc.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:a,nonce:l,providerId:u}=e;if(!i&&!s&&!t&&!a||!u)return null;try{return new oc(u)._credential({idToken:t,accessToken:i,nonce:l,pendingToken:a})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs extends jc{constructor(){super("facebook.com")}static credential(e){return qs._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rs.credential(e.oauthAccessToken)}catch{return null}}}Rs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Rs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps extends jc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return qs._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ps.credential(t,i)}catch{return null}}}Ps.GOOGLE_SIGN_IN_METHOD="google.com";Ps.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds extends jc{constructor(){super("github.com")}static credential(e){return qs._fromParams({providerId:Ds.PROVIDER_ID,signInMethod:Ds.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ds.credentialFromTaggedObject(e)}static credentialFromError(e){return Ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ds.credential(e.oauthAccessToken)}catch{return null}}}Ds.GITHUB_SIGN_IN_METHOD="github.com";Ds.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4="http://localhost";class gc extends qc{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return dr(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,dr(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,dr(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s,pendingToken:a}=t;return!i||!s||!a||i!==s?null:new gc(i,a)}static _create(e,t){return new gc(e,t)}buildRequest(){return{requestUri:C4,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4="saml.";class Bm extends Tr{constructor(e){me(e.startsWith(R4),"argument-error"),super(e)}static credentialFromResult(e){return Bm.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Bm.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=gc.fromJSON(e);return me(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:i}=e;if(!t||!i)return null;try{return gc._create(i,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms extends jc{constructor(){super("twitter.com")}static credential(e,t){return qs._fromParams({providerId:Ms.PROVIDER_ID,signInMethod:Ms.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ms.credentialFromTaggedObject(e)}static credentialFromError(e){return Ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ms.credential(t,i)}catch{return null}}}Ms.TWITTER_SIGN_IN_METHOD="twitter.com";Ms.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uC(n,e){return vr(n,"POST","/v1/accounts:signUp",Bt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const a=await ns._fromIdTokenResponse(e,i,s),l=Wb(i);return new ji({user:a,providerId:l,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=Wb(i);return new ji({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function Wb(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P4(n){var s;if(Mt(n.app))return Promise.reject(Tn(n));const e=Ut(n);if(await e._initializationPromise,(s=e.currentUser)!=null&&s.isAnonymous)return new ji({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await uC(e,{returnSecureToken:!0}),i=await ji._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm extends Rn{constructor(e,t,i,s){super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,Gm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new Gm(e,t,i,s)}}function dC(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Gm._fromErrorAndOperation(n,a,e,i):a})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hC(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D4(n,e){const t=De(n);await Ep(!0,t,e);const{providerUserInfo:i}=await MV(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=hC(i||[]);return t.providerData=t.providerData.filter(a=>s.has(a.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function r0(n,e,t=!1){const i=await mr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ji._forOperation(n,"link",i)}async function Ep(n,e,t){await Gd(e);const i=hC(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";me(i.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fC(n,e,t=!1){const{auth:i}=n;if(Mt(i.app))return Promise.reject(Tn(i));const s="reauthenticate";try{const a=await mr(n,dC(i,s,e,n),t);me(a.idToken,i,"internal-error");const l=vp(a.idToken);me(l,i,"internal-error");const{sub:u}=l;return me(n.uid===u,i,"user-mismatch"),ji._forOperation(n,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Dn(i,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mC(n,e,t=!1){if(Mt(n.app))return Promise.reject(Tn(n));const i="signIn",s=await dC(n,i,e),a=await ji._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(a.user),a}async function wp(n,e){return mC(Ut(n),e)}async function pC(n,e){const t=De(n);return await Ep(!1,t,e.providerId),r0(t,e)}async function gC(n,e){return fC(De(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M4(n,e){return vr(n,"POST","/v1/accounts:signInWithCustomToken",Bt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k4(n,e){if(Mt(n.app))return Promise.reject(Tn(n));const t=Ut(n),i=await M4(t,{token:e,returnSecureToken:!0}),s=await ji._fromIdTokenResponse(t,"signIn",i);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?o0._fromServerResponse(e,t):"totpInfo"in t?a0._fromServerResponse(e,t):Dn(e,"internal-error")}}class o0 extends ph{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new o0(t)}}class a0 extends ph{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new a0(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(n,e,t){var i;me(((i=t.url)==null?void 0:i.length)>0,n,"invalid-continue-uri"),me(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),me(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(me(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(me(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l0(n){const e=Ut(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function V4(n,e,t){const i=Ut(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&bp(i,s,t),await _o(i,s,"getOobCode",y4,"EMAIL_PASSWORD_PROVIDER")}async function L4(n,e,t){await cC(De(n),{oobCode:e,newPassword:t}).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&l0(n),i})}async function U4(n,e){await m4(De(n),{oobCode:e})}async function yC(n,e){const t=De(n),i=await cC(t,{oobCode:e}),s=i.requestType;switch(me(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":me(i.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":me(i.mfaInfo,t,"internal-error");default:me(i.email,t,"internal-error")}let a=null;return i.mfaInfo&&(a=ph._fromServerResponse(Ut(t),i.mfaInfo)),{data:{email:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.newEmail:i.email)||null,previousEmail:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.email:i.newEmail)||null,multiFactorInfo:a},operation:s}}async function O4(n,e){const{data:t}=await yC(De(n),e);return t.email}async function F4(n,e,t){if(Mt(n.app))return Promise.reject(Tn(n));const i=Ut(n),l=await _o(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",uC,"EMAIL_PASSWORD_PROVIDER").catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&l0(n),h}),u=await ji._fromIdTokenResponse(i,"signIn",l);return await i._updateCurrentUser(u.user),u}function q4(n,e,t){return Mt(n.app)?Promise.reject(Tn(n)):wp(De(n),ko.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&l0(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j4(n,e,t){const i=Ut(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function a(l,u){me(u.handleCodeInApp,i,"argument-error"),u&&bp(i,l,u)}a(s,t),await _o(i,s,"getOobCode",_4,"EMAIL_PASSWORD_PROVIDER")}function B4(n,e){const t=xp.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function G4(n,e,t){if(Mt(n.app))return Promise.reject(Tn(n));const i=De(n),s=ko.credentialWithLink(e,t||Bd());return me(s._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),wp(i,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z4(n,e){return Gt(n,"POST","/v1/accounts:createAuthUri",Bt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H4(n,e){const t=n0()?Bd():"http://localhost",i={identifier:e,continueUri:t},{signinMethods:s}=await z4(De(n),i);return s||[]}async function $4(n,e){const t=De(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&bp(t.auth,s,e);const{email:a}=await g4(t.auth,s);a!==n.email&&await n.reload()}async function K4(n,e,t){const i=De(n),a={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&bp(i.auth,a,t);const{email:l}=await v4(i.auth,a);l!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y4(n,e){return Gt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J4(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=De(n),a={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await mr(i,Y4(i.auth,a));i.displayName=l.displayName||null,i.photoURL=l.photoUrl||null;const u=i.providerData.find(({providerId:h})=>h==="password");u&&(u.displayName=i.displayName,u.photoURL=i.photoURL),await i._updateTokensIfNecessary(l)}function Q4(n,e){const t=De(n);return Mt(t.auth.app)?Promise.reject(Tn(t.auth)):_C(t,e,null)}function W4(n,e){return _C(De(n),null,e)}async function _C(n,e,t){const{auth:i}=n,a={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(a.email=e),t&&(a.password=t);const l=await mr(n,h4(i,a));await n._updateTokensIfNecessary(l,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X4(n){var s,a;if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},i=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(n!=null&&n.idToken)){const l=(a=(s=vp(n.idToken))==null?void 0:s.firebase)==null?void 0:a.sign_in_provider;if(l){const u=l!=="anonymous"&&l!=="custom"?l:null;return new ac(i,u)}}if(!e)return null;switch(e){case"facebook.com":return new Z4(i,t);case"github.com":return new eL(i,t);case"google.com":return new tL(i,t);case"twitter.com":return new nL(i,t,n.screenName||null);case"custom":case"anonymous":return new ac(i,null);default:return new ac(i,e,t)}}class ac{constructor(e,t,i={}){this.isNewUser=e,this.providerId=t,this.profile=i}}class vC extends ac{constructor(e,t,i,s){super(e,t,i),this.username=s}}class Z4 extends ac{constructor(e,t){super(e,"facebook.com",t)}}class eL extends vC{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class tL extends ac{constructor(e,t){super(e,"google.com",t)}}class nL extends vC{constructor(e,t,i){super(e,"twitter.com",t,i)}}function iL(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:X4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e,t,i){this.type=e,this.credential=t,this.user=i}static _fromIdtoken(e,t){return new Sa("enroll",e,t)}static _fromMfaPendingCredential(e){return new Sa("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,i;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return Sa._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((i=e.multiFactorSession)!=null&&i.idToken)return Sa._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(e,t,i){this.session=e,this.hints=t,this.signInResolver=i}static _fromError(e,t){const i=Ut(e),s=t.customData._serverResponse,a=(s.mfaInfo||[]).map(u=>ph._fromServerResponse(i,u));me(s.mfaPendingCredential,i,"internal-error");const l=Sa._fromMfaPendingCredential(s.mfaPendingCredential);return new c0(l,a,async u=>{const h=await u._process(i,l);delete s.mfaInfo,delete s.mfaPendingCredential;const m={...s,idToken:h.idToken,refreshToken:h.refreshToken};switch(t.operationType){case"signIn":const _=await ji._fromIdTokenResponse(i,t.operationType,m);return await i._updateCurrentUser(_.user),_;case"reauthenticate":return me(t.user,i,"internal-error"),ji._forOperation(t.user,t.operationType,m);default:Dn(i,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function sL(n,e){var s;const t=De(n),i=e;return me(e.customData.operationType,t,"argument-error"),me((s=i.customData._serverResponse)==null?void 0:s.mfaPendingCredential,t,"argument-error"),c0._fromError(t,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(n,e){return Gt(n,"POST","/v2/accounts/mfaEnrollment:start",Bt(n,e))}function rL(n,e){return Gt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Bt(n,e))}function oL(n,e){return Gt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Bt(n,e))}class u0{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(i=>ph._fromServerResponse(e.auth,i)))})}static _fromUser(e){return new u0(e)}async getSession(){return Sa._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const i=e,s=await this.getSession(),a=await mr(this.user,i._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(a),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,i=await this.user.getIdToken();try{const s=await mr(this.user,oL(this.user.auth,{idToken:i,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:a})=>a!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const b_=new WeakMap;function aL(n){const e=De(n);return b_.has(e)||b_.set(e,u0._fromUser(e)),b_.get(e)}const zm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(zm,"1"),this.storage.removeItem(zm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lL=1e3,cL=10;class xC extends TC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=sC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,u,h)=>{this.notifyListeners(l,h)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(i);!t&&this.localCache[i]===l||this.notifyListeners(i,l)},a=this.storage.getItem(i);GV()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,cL):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},lL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xC.type="LOCAL";const d0=xC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC extends TC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}EC.type="SESSION";const La=EC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uL(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new Ip(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:a}=t.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const u=Array.from(l).map(async m=>m(t.origin,a)),h=await uL(u);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ip.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((u,h)=>{const m=gh("",20);s.port1.start();const _=setTimeout(()=>{h(new Error("unsupported_event"))},i);l={messageChannel:s,onMessage(T){const E=T;if(E.data.eventId===m)switch(E.data.status){case"ack":clearTimeout(_),a=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),u(E.data.response);break;default:clearTimeout(_),clearTimeout(a),h(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(){return window}function hL(n){an().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h0(){return typeof an().WorkerGlobalScope<"u"&&typeof an().importScripts=="function"}async function fL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function mL(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function pL(){return h0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wC="firebaseLocalStorageDb",gL=1,Hm="firebaseLocalStorage",bC="fbase_key";class yh{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Sp(n,e){return n.transaction([Hm],e?"readwrite":"readonly").objectStore(Hm)}function yL(){const n=indexedDB.deleteDatabase(wC);return new yh(n).toPromise()}function z_(){const n=indexedDB.open(wC,gL);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Hm,{keyPath:bC})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Hm)?e(i):(i.close(),await yL(),e(await z_()))})})}async function Zb(n,e,t){const i=Sp(n,!0).put({[bC]:e,value:t});return new yh(i).toPromise()}async function _L(n,e){const t=Sp(n,!1).get(e),i=await new yh(t).toPromise();return i===void 0?null:i.value}function eI(n,e){const t=Sp(n,!0).delete(e);return new yh(t).toPromise()}const vL=800,TL=3;class IC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await z_(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>TL)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return h0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ip._getInstance(pL()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await fL(),!this.activeServiceWorker)return;this.sender=new dL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||mL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await z_();return await Zb(e,zm,"1"),await eI(e,zm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Zb(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>_L(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>eI(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=Sp(s,!1).getAll();return new yh(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),vL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IC.type="LOCAL";const Hd=IC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tI(n,e){return Gt(n,"POST","/v2/accounts/mfaSignIn:start",Bt(n,e))}function xL(n,e){return Gt(n,"POST","/v2/accounts/mfaSignIn:finalize",Bt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I_=oC("rcb"),EL=new dh(3e4,6e4);class wL{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=an().grecaptcha)!=null&&e.render)}load(e,t=""){return me(bL(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Gb(an().grecaptcha)?Promise.resolve(an().grecaptcha):new Promise((i,s)=>{const a=an().setTimeout(()=>{s(fn(e,"network-request-failed"))},EL.get());an()[I_]=()=>{an().clearTimeout(a),delete an()[I_];const u=an().grecaptcha;if(!u||!Gb(u)){s(fn(e,"internal-error"));return}const h=u.render;u.render=(m,_)=>{const T=h(m,_);return this.counter++,T},this.hostLanguage=t,i(u)};const l=`${QV()}?${Oc({onload:I_,render:"explicit",hl:t})}`;s0(l).catch(()=>{clearTimeout(a),s(fn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=an().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function bL(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class IL{async load(e){return new t4(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Id="recaptcha",SL={theme:"light",type:"image"};let AL=class{constructor(e,t,i={...SL}){this.parameters=i,this.type=Id,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ut(e),this.isInvisible=this.parameters.size==="invisible",me(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;me(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new IL:new wL,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),i=t.getResponse(e);return i||new Promise(s=>{const a=l=>{l&&(this.tokenChangeListeners.delete(a),s(l))};this.tokenChangeListeners.add(a),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){me(!this.parameters.sitekey,this.auth,"argument-error"),me(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),me(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(i=>i(t)),typeof e=="function")e(t);else if(typeof e=="string"){const i=an()[e];typeof i=="function"&&i(t)}}}assertNotDestroyed(){me(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){me(n0()&&!h0(),this.auth,"internal-error"),await NL(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await PV(this.auth);me(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return me(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function NL(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Da._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function CL(n,e,t){if(Mt(n.app))return Promise.reject(Tn(n));const i=Ut(n),s=await Ap(i,e,De(t));return new f0(s,a=>wp(i,a))}async function RL(n,e,t){const i=De(n);await Ep(!1,i,"phone");const s=await Ap(i.auth,e,De(t));return new f0(s,a=>pC(i,a))}async function PL(n,e,t){const i=De(n);if(Mt(i.auth.app))return Promise.reject(Tn(i.auth));const s=await Ap(i.auth,e,De(t));return new f0(s,a=>gC(i,a))}async function Ap(n,e,t){var i;if(!n._getRecaptchaConfig())try{await a4(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const a=s.session;if("phoneNumber"in s){me(a.type==="enroll",n,"internal-error");const l={idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await _o(n,l,"mfaSmsEnrollment",async(_,T)=>{if(T.phoneEnrollmentInfo.captchaResponse===bd){me((t==null?void 0:t.type)===Id,_,"argument-error");const E=await S_(_,T,t);return Xb(_,E)}return Xb(_,T)},"PHONE_PROVIDER").catch(_=>Promise.reject(_))).phoneSessionInfo.sessionInfo}else{me(a.type==="signin",n,"internal-error");const l=((i=s.multiFactorHint)==null?void 0:i.uid)||s.multiFactorUid;me(l,n,"missing-multi-factor-info");const u={mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await _o(n,u,"mfaSmsSignIn",async(T,E)=>{if(E.phoneSignInInfo.captchaResponse===bd){me((t==null?void 0:t.type)===Id,T,"argument-error");const S=await S_(T,E,t);return tI(T,S)}return tI(T,E)},"PHONE_PROVIDER").catch(T=>Promise.reject(T))).phoneResponseInfo.sessionInfo}}else{const a={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await _o(n,a,"sendVerificationCode",async(m,_)=>{if(_.captchaResponse===bd){me((t==null?void 0:t.type)===Id,m,"argument-error");const T=await S_(m,_,t);return Qb(m,T)}return Qb(m,_)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).sessionInfo}}finally{t==null||t._reset()}}async function DL(n,e){const t=De(n);if(Mt(t.auth.app))return Promise.reject(Tn(t.auth));await r0(t,e)}async function S_(n,e,t){me(t.type===Id,n,"argument-error");const i=await t.verify();me(typeof i=="string",n,"argument-error");const s={...e};if("phoneEnrollmentInfo"in s){const a=s.phoneEnrollmentInfo.phoneNumber,l=s.phoneEnrollmentInfo.captchaResponse,u=s.phoneEnrollmentInfo.clientType,h=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:i,captchaResponse:l,clientType:u,recaptchaVersion:h}}),s}else if("phoneSignInInfo"in s){const a=s.phoneSignInInfo.captchaResponse,l=s.phoneSignInInfo.clientType,u=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:i,captchaResponse:a,clientType:l,recaptchaVersion:u}}),s}else return Object.assign(s,{recaptchaToken:i}),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ua=class Tm{constructor(e){this.providerId=Tm.PROVIDER_ID,this.auth=Ut(e)}verifyPhoneNumber(e,t){return Ap(this.auth,e,De(t))}static credential(e,t){return Da._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Tm.credentialFromTaggedObject(t)}static credentialFromError(e){return Tm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:i}=e;return t&&i?Da._fromTokenResponse(t,i):null}};Ua.PROVIDER_ID="phone";Ua.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wa(n,e){return e?vi(e):(me(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0 extends qc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return dr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return dr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return dr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ML(n){return mC(n.auth,new m0(n),n.bypassAuthState)}function kL(n){const{auth:e,user:t}=n;return me(t,e,"internal-error"),fC(t,new m0(n),n.bypassAuthState)}async function VL(n){const{auth:e,user:t}=n;return me(t,e,"internal-error"),r0(t,new m0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e,t,i,s,a=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:a,error:l,type:u}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:t,sessionId:i,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ML;case"linkViaPopup":case"linkViaRedirect":return VL;case"reauthViaPopup":case"reauthViaRedirect":return kL;default:Dn(this.auth,"internal-error")}}resolve(e){rs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){rs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LL=new dh(2e3,1e4);async function UL(n,e,t){if(Mt(n.app))return Promise.reject(fn(n,"operation-not-supported-in-this-environment"));const i=Ut(n);Fc(n,e,Tr);const s=Wa(i,t);return new lr(i,"signInViaPopup",e,s).executeNotNull()}async function OL(n,e,t){const i=De(n);if(Mt(i.auth.app))return Promise.reject(fn(i.auth,"operation-not-supported-in-this-environment"));Fc(i.auth,e,Tr);const s=Wa(i.auth,t);return new lr(i.auth,"reauthViaPopup",e,s,i).executeNotNull()}async function FL(n,e,t){const i=De(n);Fc(i.auth,e,Tr);const s=Wa(i.auth,t);return new lr(i.auth,"linkViaPopup",e,s,i).executeNotNull()}class lr extends SC{constructor(e,t,i,s,a){super(e,t,s,a),this.provider=i,this.authWindow=null,this.pollId=null,lr.currentPopupAction&&lr.currentPopupAction.cancel(),lr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return me(e,this.auth,"internal-error"),e}async onExecution(){rs(this.filter.length===1,"Popup operations only handle one event");const e=gh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(fn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(fn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,lr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,LL.get())};e()}}lr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL="pendingRedirect",Sd=new Map;class jL extends SC{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Sd.get(this.auth._key());if(!e){try{const i=await BL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Sd.set(this.auth._key(),e)}return this.bypassAuthState||Sd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function BL(n,e){const t=NC(e),i=AC(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}async function p0(n,e){return AC(n)._set(NC(e),"true")}function GL(){Sd.clear()}function g0(n,e){Sd.set(n._key(),e)}function AC(n){return vi(n._redirectPersistence)}function NC(n){return Pa(qL,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zL(n,e,t){return HL(n,e,t)}async function HL(n,e,t){if(Mt(n.app))return Promise.reject(Tn(n));const i=Ut(n);Fc(n,e,Tr),await i._initializationPromise;const s=Wa(i,t);return await p0(s,i),s._openRedirect(i,e,"signInViaRedirect")}function $L(n,e,t){return KL(n,e,t)}async function KL(n,e,t){const i=De(n);if(Fc(i.auth,e,Tr),Mt(i.auth.app))return Promise.reject(Tn(i.auth));await i.auth._initializationPromise;const s=Wa(i.auth,t);await p0(s,i.auth);const a=await CC(i);return s._openRedirect(i.auth,e,"reauthViaRedirect",a)}function YL(n,e,t){return JL(n,e,t)}async function JL(n,e,t){const i=De(n);Fc(i.auth,e,Tr),await i.auth._initializationPromise;const s=Wa(i.auth,t);await Ep(!1,i,e.providerId),await p0(s,i.auth);const a=await CC(i);return s._openRedirect(i.auth,e,"linkViaRedirect",a)}async function QL(n,e){return await Ut(n)._initializationPromise,Np(n,e,!1)}async function Np(n,e,t=!1){if(Mt(n.app))return Promise.reject(Tn(n));const i=Ut(n),s=Wa(i,e),l=await new jL(i,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await i._persistUserIfCurrent(l.user),await i._setRedirectUser(null,e)),l}async function CC(n){const e=gh(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL=600*1e3;class RC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!XL(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!PC(e)){const s=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(fn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WL&&this.cachedEventUids.clear(),this.cachedEventUids.has(nI(e))}saveEventToCache(e){this.cachedEventUids.add(nI(e)),this.lastProcessedEventTime=Date.now()}}function nI(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function PC({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function XL(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PC(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DC(n,e={}){return Gt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,eU=/^https?/;async function tU(n){if(n.config.emulator)return;const{authorizedDomains:e}=await DC(n);for(const t of e)try{if(nU(t))return}catch{}Dn(n,"unauthorized-domain")}function nU(n){const e=Bd(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===i}if(!eU.test(t))return!1;if(ZL.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iU=new dh(3e4,6e4);function iI(){const n=an().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function sU(n){return new Promise((e,t)=>{var s,a,l;function i(){iI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iI(),t(fn(n,"network-request-failed"))},timeout:iU.get()})}if((a=(s=an().gapi)==null?void 0:s.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((l=an().gapi)!=null&&l.load)i();else{const u=oC("iframefcb");return an()[u]=()=>{gapi.load?i():t(fn(n,"network-request-failed"))},s0(`${XV()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw xm=null,e})}let xm=null;function rU(n){return xm=xm||sU(n),xm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oU=new dh(5e3,15e3),aU="__/auth/iframe",lU="emulator/auth/iframe",cU={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},uU=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function dU(n){const e=n.config;me(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?i0(e,lU):`https://${n.config.authDomain}/${aU}`,i={apiKey:e.apiKey,appName:n.name,v:Mo},s=uU.get(n.config.apiHost);s&&(i.eid=s);const a=n._getFrameworks();return a.length&&(i.fw=a.join(",")),`${t}?${Oc(i).slice(1)}`}async function hU(n){const e=await rU(n),t=an().gapi;return me(t,n,"internal-error"),e.open({where:document.body,url:dU(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cU,dontclear:!0},i=>new Promise(async(s,a)=>{await i.restyle({setHideOnLeave:!1});const l=fn(n,"network-request-failed"),u=an().setTimeout(()=>{a(l)},oU.get());function h(){an().clearTimeout(u),s(i)}i.ping(h).then(h,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fU={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},mU=500,pU=600,gU="_blank",yU="http://localhost";class sI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _U(n,e,t,i=mU,s=pU){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-i)/2,0).toString();let u="";const h={...fU,width:i.toString(),height:s.toString(),top:a,left:l},m=Lt().toLowerCase();t&&(u=eC(m)?gU:t),XN(m)&&(e=e||yU,h.scrollbars="yes");const _=Object.entries(h).reduce((E,[S,k])=>`${E}${S}=${k},`,"");if(BV(m)&&u!=="_self")return vU(e||"",u),new sI(null);const T=window.open(e||"",u,_);me(T,n,"popup-blocked");try{T.focus()}catch{}return new sI(T)}function vU(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TU="__/auth/handler",xU="emulator/auth/handler",EU=encodeURIComponent("fac");async function H_(n,e,t,i,s,a){me(n.config.authDomain,n,"auth-domain-config-required"),me(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Mo,eventId:s};if(e instanceof Tr){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",$2(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,T]of Object.entries(a||{}))l[_]=T}if(e instanceof jc){const _=e.getScopes().filter(T=>T!=="");_.length>0&&(l.scopes=_.join(","))}n.tenantId&&(l.tid=n.tenantId);const u=l;for(const _ of Object.keys(u))u[_]===void 0&&delete u[_];const h=await n._getAppCheckToken(),m=h?`#${EU}=${encodeURIComponent(h)}`:"";return`${wU(n)}?${Oc(u).slice(1)}${m}`}function wU({config:n}){return n.emulator?i0(n,xU):`https://${n.authDomain}/${TU}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_="webStorageSupport";class bU{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=La,this._completeRedirectFn=Np,this._overrideRedirectResult=g0}async _openPopup(e,t,i,s){var l;rs((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const a=await H_(e,t,i,Bd(),s);return _U(e,a,gh())}async _openRedirect(e,t,i,s){await this._originValidation(e);const a=await H_(e,t,i,Bd(),s);return hL(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(rs(a,"If manager is not set, promise should be"),a)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await hU(e),i=new RC(e);return t.register("authEvent",s=>(me(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(A_,{type:A_},s=>{var l;const a=(l=s==null?void 0:s[0])==null?void 0:l[A_];a!==void 0&&t(!!a),Dn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=tU(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return sC()||ZN()||fh()}}const IU=bU;class SU{constructor(e){this.factorId=e}_process(e,t,i){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,i);case"signin":return this._finalizeSignIn(e,t.credential);default:return ks("unexpected MultiFactorSessionType")}}}class y0 extends SU{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new y0(e)}_finalizeEnroll(e,t,i){return rL(e,{idToken:t,displayName:i,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return xL(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class MC{constructor(){}static assertion(e){return y0._fromCredential(e)}}MC.FACTOR_ID="phone";var rI="@firebase/auth",oI="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NU(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function CU(n){qi(new Yn("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=i.options;me(l&&!l.includes(":"),"invalid-api-key",{appName:i.name});const h={apiKey:l,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:rC(n)},m=new YV(i,s,a,h);return l4(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),qi(new Yn("auth-internal",e=>{const t=Ut(e.getProvider("auth").getImmediate());return(i=>new AU(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),$n(rI,oI,NU(n)),$n(rI,oI,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RU=300;V2("authIdTokenMaxAge");function PU(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}JV({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const a=fn("internal-error");a.customData=s,t(a)},i.type="text/javascript",i.charset="UTF-8",PU().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});CU("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oa(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DU=2e3;async function MU(n,e,t){const{BuildInfo:i}=Oa();rs(e.sessionId,"AuthEvent did not contain a session ID");const s=await OU(e.sessionId),a={};return fh()?a.ibi=i.packageName:hh()?a.apn=i.packageName:Dn(n,"operation-not-supported-in-this-environment"),i.displayName&&(a.appDisplayName=i.displayName),a.sessionId=s,H_(n,t,e.type,void 0,e.eventId??void 0,a)}async function kU(n){const{BuildInfo:e}=Oa(),t={};fh()?t.iosBundleId=e.packageName:hh()?t.androidPackageName=e.packageName:Dn(n,"operation-not-supported-in-this-environment"),await DC(n,t)}function VU(n){const{cordova:e}=Oa();return new Promise(t=>{e.plugins.browsertab.isAvailable(i=>{let s=null;i?e.plugins.browsertab.openUrl(n):s=e.InAppBrowser.open(n,jV()?"_blank":"_system","location=yes"),t(s)})})}async function LU(n,e,t){const{cordova:i}=Oa();let s=()=>{};try{await new Promise((a,l)=>{let u=null;function h(){var E;a();const T=(E=i.plugins.browsertab)==null?void 0:E.close;typeof T=="function"&&T(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function m(){u||(u=window.setTimeout(()=>{l(fn(n,"redirect-cancelled-by-user"))},DU))}function _(){(document==null?void 0:document.visibilityState)==="visible"&&m()}e.addPassiveListener(h),document.addEventListener("resume",m,!1),hh()&&document.addEventListener("visibilitychange",_,!1),s=()=>{e.removePassiveListener(h),document.removeEventListener("resume",m,!1),document.removeEventListener("visibilitychange",_,!1),u&&window.clearTimeout(u)}})}finally{s()}}function UU(n){var t,i,s,a,l,u,h,m,_,T;const e=Oa();me(typeof((t=e==null?void 0:e.universalLinks)==null?void 0:t.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),me(typeof((i=e==null?void 0:e.BuildInfo)==null?void 0:i.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),me(typeof((l=(a=(s=e==null?void 0:e.cordova)==null?void 0:s.plugins)==null?void 0:a.browsertab)==null?void 0:l.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),me(typeof((m=(h=(u=e==null?void 0:e.cordova)==null?void 0:u.plugins)==null?void 0:h.browsertab)==null?void 0:m.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),me(typeof((T=(_=e==null?void 0:e.cordova)==null?void 0:_.InAppBrowser)==null?void 0:T.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function OU(n){const e=FU(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(s=>s.toString(16).padStart(2,"0")).join("")}function FU(n){if(rs(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let i=0;i<n.length;i++)t[i]=n.charCodeAt(i);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qU=20;class jU extends RC{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function BU(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:HU(),postBody:null,tenantId:n.tenantId,error:fn(n,"no-auth-event")}}function GU(n,e){return $_()._set(K_(n),e)}async function aI(n){const e=await $_()._get(K_(n));return e&&await $_()._remove(K_(n)),e}function zU(n,e){var i,s;const t=KU(e);if(t.includes("/__/auth/callback")){const a=Em(t),l=a.firebaseError?$U(decodeURIComponent(a.firebaseError)):null,u=(s=(i=l==null?void 0:l.code)==null?void 0:i.split("auth/"))==null?void 0:s[1],h=u?fn(u):null;return h?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:h,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function HU(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<qU;t++){const i=Math.floor(Math.random()*e.length);n.push(e.charAt(i))}return n.join("")}function $_(){return vi(d0)}function K_(n){return Pa("authEvent",n.config.apiKey,n.name)}function $U(n){try{return JSON.parse(n)}catch{return null}}function KU(n){const e=Em(n),t=e.link?decodeURIComponent(e.link):void 0,i=Em(t).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Em(s).link||s||i||t||n}function Em(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return nc(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YU=500;class JU{constructor(){this._redirectPersistence=La,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Np,this._overrideRedirectResult=g0}async _initialize(e){const t=e._key();let i=this.eventManagers.get(t);return i||(i=new jU(e),this.eventManagers.set(t,i),this.attachCallbackListeners(e,i)),i}_openPopup(e){Dn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,i,s){UU(e);const a=await this._initialize(e);await a.initialized(),a.resetRedirect(),GL(),await this._originValidation(e);const l=BU(e,i,s);await GU(e,l);const u=await MU(e,l,t),h=await VU(u);return LU(e,a,h)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=kU(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:i,handleOpenURL:s,BuildInfo:a}=Oa(),l=setTimeout(async()=>{await aI(e),t.onEvent(lI())},YU),u=async _=>{clearTimeout(l);const T=await aI(e);let E=null;T&&(_!=null&&_.url)&&(E=zU(T,_.url)),t.onEvent(E||lI())};typeof i<"u"&&typeof i.subscribe=="function"&&i.subscribe(null,u);const h=s,m=`${a.packageName.toLowerCase()}://`;Oa().handleOpenURL=async _=>{if(_.toLowerCase().startsWith(m)&&u({url:_}),typeof h=="function")try{h(_)}catch(T){console.error(T)}}}}const QU=JU;function lI(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:fn("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WU(n,e){Ut(n)._logFramework(e)}var XU="@firebase/auth-compat",ZU="0.6.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eO=1e3;function Ad(){var n;return((n=self==null?void 0:self.location)==null?void 0:n.protocol)||null}function tO(){return Ad()==="http:"||Ad()==="https:"}function kC(n=Lt()){return!!((Ad()==="file:"||Ad()==="ionic:"||Ad()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function nO(){return Kv()||gp()}function iO(){return IN()&&(document==null?void 0:document.documentMode)===11}function sO(n=Lt()){return/Edge\/\d+/.test(n)}function rO(n=Lt()){return iO()||sO(n)}function VC(){try{const n=self.localStorage,e=gh();if(n)return n.setItem(e,"1"),n.removeItem(e),rO()?Va():!0}catch{return _0()&&Va()}return!1}function _0(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function N_(){return(tO()||yp()||kC())&&!nO()&&VC()&&!_0()}function LC(){return kC()&&typeof document<"u"}async function oO(){return LC()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},eO);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function aO(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i={LOCAL:"local",NONE:"none",SESSION:"session"},rd=me,UC="persistence";function lO(n,e){if(rd(Object.values(_i).includes(e),n,"invalid-persistence-type"),Kv()){rd(e!==_i.SESSION,n,"unsupported-persistence-type");return}if(gp()){rd(e===_i.NONE,n,"unsupported-persistence-type");return}if(_0()){rd(e===_i.NONE||e===_i.LOCAL&&Va(),n,"unsupported-persistence-type");return}rd(e===_i.NONE||VC(),n,"unsupported-persistence-type")}async function Y_(n){await n._initializationPromise;const e=OC(),t=Pa(UC,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function cO(n,e){const t=OC();if(!t)return[];const i=Pa(UC,n,e);switch(t.getItem(i)){case _i.NONE:return[pc];case _i.LOCAL:return[Hd,La];case _i.SESSION:return[La];default:return[]}}function OC(){var n;try{return((n=aO())==null?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO=me;class fo{constructor(){this.browserResolver=vi(IU),this.cordovaResolver=vi(QU),this.underlyingResolver=null,this._redirectPersistence=La,this._completeRedirectFn=Np,this._overrideRedirectResult=g0}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,i,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,i,s)}async _openRedirect(e,t,i,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,i,s)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return LC()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return uO(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await oO();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FC(n){return n.unwrap()}function dO(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hO(n){return qC(n)}function fO(n,e){var i;const t=(i=e.customData)==null?void 0:i._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const s=e;s.resolver=new mO(n,sL(n,e))}else if(t){const s=qC(e),a=e;s&&(a.credential=s,a.tenantId=t.tenantId||void 0,a.email=t.email||void 0,a.phoneNumber=t.phoneNumber||void 0)}}function qC(n){const{_tokenResponse:e}=n instanceof Rn?n.customData:n;if(!e)return null;if(!(n instanceof Rn)&&"temporaryProof"in e&&"phoneNumber"in e)return Ua.credentialFromResult(n);const t=e.providerId;if(!t||t===id.PASSWORD)return null;let i;switch(t){case id.GOOGLE:i=Ps;break;case id.FACEBOOK:i=Rs;break;case id.GITHUB:i=Ds;break;case id.TWITTER:i=Ms;break;default:const{oauthIdToken:s,oauthAccessToken:a,oauthTokenSecret:l,pendingToken:u,nonce:h}=e;return!a&&!l&&!s&&!u?null:u?t.startsWith("saml.")?gc._create(t,u):qs._fromParams({providerId:t,signInMethod:t,pendingToken:u,idToken:s,accessToken:a}):new oc(t).credential({idToken:s,accessToken:a,rawNonce:h})}return n instanceof Rn?i.credentialFromError(n):i.credentialFromResult(n)}function ii(n,e){return e.catch(t=>{throw t instanceof Rn&&fO(n,t),t}).then(t=>{const i=t.operationType,s=t.user;return{operationType:i,credential:hO(t),additionalUserInfo:iL(t),user:Cp.getOrCreate(s)}})}async function J_(n,e){const t=await e;return{verificationId:t.verificationId,confirm:i=>ii(n,t.confirm(i))}}class mO{constructor(e,t){this.resolver=t,this.auth=dO(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return ii(FC(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cp=class pd{constructor(e){this._delegate=e,this.multiFactor=aL(e)}static getOrCreate(e){return pd.USER_MAP.has(e)||pd.USER_MAP.set(e,new pd(e)),pd.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return ii(this.auth,pC(this._delegate,e))}async linkWithPhoneNumber(e,t){return J_(this.auth,RL(this._delegate,e,t))}async linkWithPopup(e){return ii(this.auth,FL(this._delegate,e,fo))}async linkWithRedirect(e){return await Y_(Ut(this.auth)),YL(this._delegate,e,fo)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return ii(this.auth,gC(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return J_(this.auth,PL(this._delegate,e,t))}reauthenticateWithPopup(e){return ii(this.auth,OL(this._delegate,e,fo))}async reauthenticateWithRedirect(e){return await Y_(Ut(this.auth)),$L(this._delegate,e,fo)}sendEmailVerification(e){return $4(this._delegate,e)}async unlink(e){return await D4(this._delegate,e),this}updateEmail(e){return Q4(this._delegate,e)}updatePassword(e){return W4(this._delegate,e)}updatePhoneNumber(e){return DL(this._delegate,e)}updateProfile(e){return J4(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return K4(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Cp.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const od=me;class Q_{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:i}=e.options;od(i,"invalid-api-key",{appName:e.name}),od(i,"invalid-api-key",{appName:e.name});const s=typeof window<"u"?fo:void 0;this._delegate=t.initialize({options:{persistence:pO(i,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(xV),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Cp.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){c4(this._delegate,e,t)}applyActionCode(e){return U4(this._delegate,e)}checkActionCode(e){return yC(this._delegate,e)}confirmPasswordReset(e,t){return L4(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return ii(this._delegate,F4(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return H4(this._delegate,e)}isSignInWithEmailLink(e){return B4(this._delegate,e)}async getRedirectResult(){od(N_(),this._delegate,"operation-not-supported-in-this-environment");const e=await QL(this._delegate,fo);return e?ii(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){WU(this._delegate,e)}onAuthStateChanged(e,t,i){const{next:s,error:a,complete:l}=cI(e,t,i);return this._delegate.onAuthStateChanged(s,a,l)}onIdTokenChanged(e,t,i){const{next:s,error:a,complete:l}=cI(e,t,i);return this._delegate.onIdTokenChanged(s,a,l)}sendSignInLinkToEmail(e,t){return j4(this._delegate,e,t)}sendPasswordResetEmail(e,t){return V4(this._delegate,e,t||void 0)}async setPersistence(e){lO(this._delegate,e);let t;switch(e){case _i.SESSION:t=La;break;case _i.LOCAL:t=await vi(Hd)._isAvailable()?Hd:d0;break;case _i.NONE:t=pc;break;default:return Dn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return ii(this._delegate,P4(this._delegate))}signInWithCredential(e){return ii(this._delegate,wp(this._delegate,e))}signInWithCustomToken(e){return ii(this._delegate,k4(this._delegate,e))}signInWithEmailAndPassword(e,t){return ii(this._delegate,q4(this._delegate,e,t))}signInWithEmailLink(e,t){return ii(this._delegate,G4(this._delegate,e,t))}signInWithPhoneNumber(e,t){return J_(this._delegate,CL(this._delegate,e,t))}async signInWithPopup(e){return od(N_(),this._delegate,"operation-not-supported-in-this-environment"),ii(this._delegate,UL(this._delegate,e,fo))}async signInWithRedirect(e){return od(N_(),this._delegate,"operation-not-supported-in-this-environment"),await Y_(this._delegate),zL(this._delegate,e,fo)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return O4(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Q_.Persistence=_i;function cI(n,e,t){let i=n;typeof n!="function"&&({next:i,error:e,complete:t}=n);const s=i;return{next:l=>s(l&&Cp.getOrCreate(l)),error:e,complete:t}}function pO(n,e){const t=cO(n,e);if(typeof self<"u"&&!t.includes(Hd)&&t.push(Hd),typeof window<"u")for(const i of[d0,La])t.includes(i)||t.push(i);return t.includes(pc)||t.push(pc),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{static credential(e,t){return Ua.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new Ua(FC(ke.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}v0.PHONE_SIGN_IN_METHOD=Ua.PHONE_SIGN_IN_METHOD;v0.PROVIDER_ID=Ua.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gO=me;class yO{constructor(e,t,i=ke.app()){var s;gO((s=i.options)==null?void 0:s.apiKey,"invalid-api-key",{appName:i.name}),this._delegate=new AL(i.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _O="auth-compat";function vO(n){n.INTERNAL.registerComponent(new Yn(_O,e=>{const t=e.getProvider("app-compat").getImmediate(),i=e.getProvider("auth");return new Q_(t,i)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:zl.EMAIL_SIGNIN,PASSWORD_RESET:zl.PASSWORD_RESET,RECOVER_EMAIL:zl.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:zl.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:zl.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:zl.VERIFY_EMAIL}},EmailAuthProvider:ko,FacebookAuthProvider:Rs,GithubAuthProvider:Ds,GoogleAuthProvider:Ps,OAuthProvider:oc,SAMLAuthProvider:Bm,PhoneAuthProvider:v0,PhoneMultiFactorGenerator:MC,RecaptchaVerifier:yO,TwitterAuthProvider:Ms,Auth:Q_,AuthCredential:qc,Error:Rn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(XU,ZU)}vO(ke);var uI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var vo,jC;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,A){function C(){}C.prototype=A.prototype,R.F=A.prototype,R.prototype=new C,R.prototype.constructor=R,R.D=function(M,L,F){for(var D=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)D[ye-2]=arguments[ye];return A.prototype[L].apply(M,D)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(R,A,C){C||(C=0);const M=Array(16);if(typeof A=="string")for(var L=0;L<16;++L)M[L]=A.charCodeAt(C++)|A.charCodeAt(C++)<<8|A.charCodeAt(C++)<<16|A.charCodeAt(C++)<<24;else for(L=0;L<16;++L)M[L]=A[C++]|A[C++]<<8|A[C++]<<16|A[C++]<<24;A=R.g[0],C=R.g[1],L=R.g[2];let F=R.g[3],D;D=A+(F^C&(L^F))+M[0]+3614090360&4294967295,A=C+(D<<7&4294967295|D>>>25),D=F+(L^A&(C^L))+M[1]+3905402710&4294967295,F=A+(D<<12&4294967295|D>>>20),D=L+(C^F&(A^C))+M[2]+606105819&4294967295,L=F+(D<<17&4294967295|D>>>15),D=C+(A^L&(F^A))+M[3]+3250441966&4294967295,C=L+(D<<22&4294967295|D>>>10),D=A+(F^C&(L^F))+M[4]+4118548399&4294967295,A=C+(D<<7&4294967295|D>>>25),D=F+(L^A&(C^L))+M[5]+1200080426&4294967295,F=A+(D<<12&4294967295|D>>>20),D=L+(C^F&(A^C))+M[6]+2821735955&4294967295,L=F+(D<<17&4294967295|D>>>15),D=C+(A^L&(F^A))+M[7]+4249261313&4294967295,C=L+(D<<22&4294967295|D>>>10),D=A+(F^C&(L^F))+M[8]+1770035416&4294967295,A=C+(D<<7&4294967295|D>>>25),D=F+(L^A&(C^L))+M[9]+2336552879&4294967295,F=A+(D<<12&4294967295|D>>>20),D=L+(C^F&(A^C))+M[10]+4294925233&4294967295,L=F+(D<<17&4294967295|D>>>15),D=C+(A^L&(F^A))+M[11]+2304563134&4294967295,C=L+(D<<22&4294967295|D>>>10),D=A+(F^C&(L^F))+M[12]+1804603682&4294967295,A=C+(D<<7&4294967295|D>>>25),D=F+(L^A&(C^L))+M[13]+4254626195&4294967295,F=A+(D<<12&4294967295|D>>>20),D=L+(C^F&(A^C))+M[14]+2792965006&4294967295,L=F+(D<<17&4294967295|D>>>15),D=C+(A^L&(F^A))+M[15]+1236535329&4294967295,C=L+(D<<22&4294967295|D>>>10),D=A+(L^F&(C^L))+M[1]+4129170786&4294967295,A=C+(D<<5&4294967295|D>>>27),D=F+(C^L&(A^C))+M[6]+3225465664&4294967295,F=A+(D<<9&4294967295|D>>>23),D=L+(A^C&(F^A))+M[11]+643717713&4294967295,L=F+(D<<14&4294967295|D>>>18),D=C+(F^A&(L^F))+M[0]+3921069994&4294967295,C=L+(D<<20&4294967295|D>>>12),D=A+(L^F&(C^L))+M[5]+3593408605&4294967295,A=C+(D<<5&4294967295|D>>>27),D=F+(C^L&(A^C))+M[10]+38016083&4294967295,F=A+(D<<9&4294967295|D>>>23),D=L+(A^C&(F^A))+M[15]+3634488961&4294967295,L=F+(D<<14&4294967295|D>>>18),D=C+(F^A&(L^F))+M[4]+3889429448&4294967295,C=L+(D<<20&4294967295|D>>>12),D=A+(L^F&(C^L))+M[9]+568446438&4294967295,A=C+(D<<5&4294967295|D>>>27),D=F+(C^L&(A^C))+M[14]+3275163606&4294967295,F=A+(D<<9&4294967295|D>>>23),D=L+(A^C&(F^A))+M[3]+4107603335&4294967295,L=F+(D<<14&4294967295|D>>>18),D=C+(F^A&(L^F))+M[8]+1163531501&4294967295,C=L+(D<<20&4294967295|D>>>12),D=A+(L^F&(C^L))+M[13]+2850285829&4294967295,A=C+(D<<5&4294967295|D>>>27),D=F+(C^L&(A^C))+M[2]+4243563512&4294967295,F=A+(D<<9&4294967295|D>>>23),D=L+(A^C&(F^A))+M[7]+1735328473&4294967295,L=F+(D<<14&4294967295|D>>>18),D=C+(F^A&(L^F))+M[12]+2368359562&4294967295,C=L+(D<<20&4294967295|D>>>12),D=A+(C^L^F)+M[5]+4294588738&4294967295,A=C+(D<<4&4294967295|D>>>28),D=F+(A^C^L)+M[8]+2272392833&4294967295,F=A+(D<<11&4294967295|D>>>21),D=L+(F^A^C)+M[11]+1839030562&4294967295,L=F+(D<<16&4294967295|D>>>16),D=C+(L^F^A)+M[14]+4259657740&4294967295,C=L+(D<<23&4294967295|D>>>9),D=A+(C^L^F)+M[1]+2763975236&4294967295,A=C+(D<<4&4294967295|D>>>28),D=F+(A^C^L)+M[4]+1272893353&4294967295,F=A+(D<<11&4294967295|D>>>21),D=L+(F^A^C)+M[7]+4139469664&4294967295,L=F+(D<<16&4294967295|D>>>16),D=C+(L^F^A)+M[10]+3200236656&4294967295,C=L+(D<<23&4294967295|D>>>9),D=A+(C^L^F)+M[13]+681279174&4294967295,A=C+(D<<4&4294967295|D>>>28),D=F+(A^C^L)+M[0]+3936430074&4294967295,F=A+(D<<11&4294967295|D>>>21),D=L+(F^A^C)+M[3]+3572445317&4294967295,L=F+(D<<16&4294967295|D>>>16),D=C+(L^F^A)+M[6]+76029189&4294967295,C=L+(D<<23&4294967295|D>>>9),D=A+(C^L^F)+M[9]+3654602809&4294967295,A=C+(D<<4&4294967295|D>>>28),D=F+(A^C^L)+M[12]+3873151461&4294967295,F=A+(D<<11&4294967295|D>>>21),D=L+(F^A^C)+M[15]+530742520&4294967295,L=F+(D<<16&4294967295|D>>>16),D=C+(L^F^A)+M[2]+3299628645&4294967295,C=L+(D<<23&4294967295|D>>>9),D=A+(L^(C|~F))+M[0]+4096336452&4294967295,A=C+(D<<6&4294967295|D>>>26),D=F+(C^(A|~L))+M[7]+1126891415&4294967295,F=A+(D<<10&4294967295|D>>>22),D=L+(A^(F|~C))+M[14]+2878612391&4294967295,L=F+(D<<15&4294967295|D>>>17),D=C+(F^(L|~A))+M[5]+4237533241&4294967295,C=L+(D<<21&4294967295|D>>>11),D=A+(L^(C|~F))+M[12]+1700485571&4294967295,A=C+(D<<6&4294967295|D>>>26),D=F+(C^(A|~L))+M[3]+2399980690&4294967295,F=A+(D<<10&4294967295|D>>>22),D=L+(A^(F|~C))+M[10]+4293915773&4294967295,L=F+(D<<15&4294967295|D>>>17),D=C+(F^(L|~A))+M[1]+2240044497&4294967295,C=L+(D<<21&4294967295|D>>>11),D=A+(L^(C|~F))+M[8]+1873313359&4294967295,A=C+(D<<6&4294967295|D>>>26),D=F+(C^(A|~L))+M[15]+4264355552&4294967295,F=A+(D<<10&4294967295|D>>>22),D=L+(A^(F|~C))+M[6]+2734768916&4294967295,L=F+(D<<15&4294967295|D>>>17),D=C+(F^(L|~A))+M[13]+1309151649&4294967295,C=L+(D<<21&4294967295|D>>>11),D=A+(L^(C|~F))+M[4]+4149444226&4294967295,A=C+(D<<6&4294967295|D>>>26),D=F+(C^(A|~L))+M[11]+3174756917&4294967295,F=A+(D<<10&4294967295|D>>>22),D=L+(A^(F|~C))+M[2]+718787259&4294967295,L=F+(D<<15&4294967295|D>>>17),D=C+(F^(L|~A))+M[9]+3951481745&4294967295,R.g[0]=R.g[0]+A&4294967295,R.g[1]=R.g[1]+(L+(D<<21&4294967295|D>>>11))&4294967295,R.g[2]=R.g[2]+L&4294967295,R.g[3]=R.g[3]+F&4294967295}i.prototype.v=function(R,A){A===void 0&&(A=R.length);const C=A-this.blockSize,M=this.C;let L=this.h,F=0;for(;F<A;){if(L==0)for(;F<=C;)s(this,R,F),F+=this.blockSize;if(typeof R=="string"){for(;F<A;)if(M[L++]=R.charCodeAt(F++),L==this.blockSize){s(this,M),L=0;break}}else for(;F<A;)if(M[L++]=R[F++],L==this.blockSize){s(this,M),L=0;break}}this.h=L,this.o+=A},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var A=1;A<R.length-8;++A)R[A]=0;A=this.o*8;for(var C=R.length-8;C<R.length;++C)R[C]=A&255,A/=256;for(this.v(R),R=Array(16),A=0,C=0;C<4;++C)for(let M=0;M<32;M+=8)R[A++]=this.g[C]>>>M&255;return R};function a(R,A){var C=u;return Object.prototype.hasOwnProperty.call(C,R)?C[R]:C[R]=A(R)}function l(R,A){this.h=A;const C=[];let M=!0;for(let L=R.length-1;L>=0;L--){const F=R[L]|0;M&&F==A||(C[L]=F,M=!1)}this.g=C}var u={};function h(R){return-128<=R&&R<128?a(R,function(A){return new l([A|0],A<0?-1:0)}):new l([R|0],R<0?-1:0)}function m(R){if(isNaN(R)||!isFinite(R))return T;if(R<0)return O(m(-R));const A=[];let C=1;for(let M=0;R>=C;M++)A[M]=R/C|0,C*=4294967296;return new l(A,0)}function _(R,A){if(R.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(R.charAt(0)=="-")return O(_(R.substring(1),A));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=m(Math.pow(A,8));let M=T;for(let F=0;F<R.length;F+=8){var L=Math.min(8,R.length-F);const D=parseInt(R.substring(F,F+L),A);L<8?(L=m(Math.pow(A,L)),M=M.j(L).add(m(D))):(M=M.j(C),M=M.add(m(D)))}return M}var T=h(0),E=h(1),S=h(16777216);n=l.prototype,n.m=function(){if(V(this))return-O(this).m();let R=0,A=1;for(let C=0;C<this.g.length;C++){const M=this.i(C);R+=(M>=0?M:4294967296+M)*A,A*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(k(this))return"0";if(V(this))return"-"+O(this).toString(R);const A=m(Math.pow(R,6));var C=this;let M="";for(;;){const L=U(C,A).g;C=j(C,L.j(A));let F=((C.g.length>0?C.g[0]:C.h)>>>0).toString(R);if(C=L,k(C))return F+M;for(;F.length<6;)F="0"+F;M=F+M}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function k(R){if(R.h!=0)return!1;for(let A=0;A<R.g.length;A++)if(R.g[A]!=0)return!1;return!0}function V(R){return R.h==-1}n.l=function(R){return R=j(this,R),V(R)?-1:k(R)?0:1};function O(R){const A=R.g.length,C=[];for(let M=0;M<A;M++)C[M]=~R.g[M];return new l(C,~R.h).add(E)}n.abs=function(){return V(this)?O(this):this},n.add=function(R){const A=Math.max(this.g.length,R.g.length),C=[];let M=0;for(let L=0;L<=A;L++){let F=M+(this.i(L)&65535)+(R.i(L)&65535),D=(F>>>16)+(this.i(L)>>>16)+(R.i(L)>>>16);M=D>>>16,F&=65535,D&=65535,C[L]=D<<16|F}return new l(C,C[C.length-1]&-2147483648?-1:0)};function j(R,A){return R.add(O(A))}n.j=function(R){if(k(this)||k(R))return T;if(V(this))return V(R)?O(this).j(O(R)):O(O(this).j(R));if(V(R))return O(this.j(O(R)));if(this.l(S)<0&&R.l(S)<0)return m(this.m()*R.m());const A=this.g.length+R.g.length,C=[];for(var M=0;M<2*A;M++)C[M]=0;for(M=0;M<this.g.length;M++)for(let L=0;L<R.g.length;L++){const F=this.i(M)>>>16,D=this.i(M)&65535,ye=R.i(L)>>>16,Oe=R.i(L)&65535;C[2*M+2*L]+=D*Oe,W(C,2*M+2*L),C[2*M+2*L+1]+=F*Oe,W(C,2*M+2*L+1),C[2*M+2*L+1]+=D*ye,W(C,2*M+2*L+1),C[2*M+2*L+2]+=F*ye,W(C,2*M+2*L+2)}for(R=0;R<A;R++)C[R]=C[2*R+1]<<16|C[2*R];for(R=A;R<2*A;R++)C[R]=0;return new l(C,0)};function W(R,A){for(;(R[A]&65535)!=R[A];)R[A+1]+=R[A]>>>16,R[A]&=65535,A++}function $(R,A){this.g=R,this.h=A}function U(R,A){if(k(A))throw Error("division by zero");if(k(R))return new $(T,T);if(V(R))return A=U(O(R),A),new $(O(A.g),O(A.h));if(V(A))return A=U(R,O(A)),new $(O(A.g),A.h);if(R.g.length>30){if(V(R)||V(A))throw Error("slowDivide_ only works with positive integers.");for(var C=E,M=A;M.l(R)<=0;)C=K(C),M=K(M);var L=J(C,1),F=J(M,1);for(M=J(M,2),C=J(C,2);!k(M);){var D=F.add(M);D.l(R)<=0&&(L=L.add(C),F=D),M=J(M,1),C=J(C,1)}return A=j(R,L.j(A)),new $(L,A)}for(L=T;R.l(A)>=0;){for(C=Math.max(1,Math.floor(R.m()/A.m())),M=Math.ceil(Math.log(C)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),F=m(C),D=F.j(A);V(D)||D.l(R)>0;)C-=M,F=m(C),D=F.j(A);k(F)&&(F=E),L=L.add(F),R=j(R,D)}return new $(L,R)}n.B=function(R){return U(this,R).h},n.and=function(R){const A=Math.max(this.g.length,R.g.length),C=[];for(let M=0;M<A;M++)C[M]=this.i(M)&R.i(M);return new l(C,this.h&R.h)},n.or=function(R){const A=Math.max(this.g.length,R.g.length),C=[];for(let M=0;M<A;M++)C[M]=this.i(M)|R.i(M);return new l(C,this.h|R.h)},n.xor=function(R){const A=Math.max(this.g.length,R.g.length),C=[];for(let M=0;M<A;M++)C[M]=this.i(M)^R.i(M);return new l(C,this.h^R.h)};function K(R){const A=R.g.length+1,C=[];for(let M=0;M<A;M++)C[M]=R.i(M)<<1|R.i(M-1)>>>31;return new l(C,R.h)}function J(R,A){const C=A>>5;A%=32;const M=R.g.length-C,L=[];for(let F=0;F<M;F++)L[F]=A>0?R.i(F+C)>>>A|R.i(F+C+1)<<32-A:R.i(F+C);return new l(L,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,jC=i,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=m,l.fromString=_,vo=l}).apply(typeof uI<"u"?uI:typeof self<"u"?self:typeof window<"u"?window:{});var hm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var BC,gd,GC,wm,W_,zC,HC,$C;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof hm=="object"&&hm];for(var w=0;w<y.length;++w){var I=y[w];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var i=t(this);function s(y,w){if(w)e:{var I=i;y=y.split(".");for(var P=0;P<y.length-1;P++){var Z=y[P];if(!(Z in I))break e;I=I[Z]}y=y[y.length-1],P=I[y],w=w(P),w!=P&&w!=null&&e(I,y,{configurable:!0,writable:!0,value:w})}}s("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(y){return y||function(w){var I=[],P;for(P in w)Object.prototype.hasOwnProperty.call(w,P)&&I.push([P,w[P]]);return I}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(y){var w=typeof y;return w=="object"&&y!=null||w=="function"}function h(y,w,I){return y.call.apply(y.bind,arguments)}function m(y,w,I){return m=h,m.apply(null,arguments)}function _(y,w){var I=Array.prototype.slice.call(arguments,1);return function(){var P=I.slice();return P.push.apply(P,arguments),y.apply(this,P)}}function T(y,w){function I(){}I.prototype=w.prototype,y.Z=w.prototype,y.prototype=new I,y.prototype.constructor=y,y.Ob=function(P,Z,se){for(var _e=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)_e[Be-2]=arguments[Be];return w.prototype[Z].apply(P,_e)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function S(y){const w=y.length;if(w>0){const I=Array(w);for(let P=0;P<w;P++)I[P]=y[P];return I}return[]}function k(y,w){for(let P=1;P<arguments.length;P++){const Z=arguments[P];var I=typeof Z;if(I=I!="object"?I:Z?Array.isArray(Z)?"array":I:"null",I=="array"||I=="object"&&typeof Z.length=="number"){I=y.length||0;const se=Z.length||0;y.length=I+se;for(let _e=0;_e<se;_e++)y[I+_e]=Z[_e]}else y.push(Z)}}class V{constructor(w,I){this.i=w,this.j=I,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function O(y){l.setTimeout(()=>{throw y},0)}function j(){var y=R;let w=null;return y.g&&(w=y.g,y.g=y.g.next,y.g||(y.h=null),w.next=null),w}class W{constructor(){this.h=this.g=null}add(w,I){const P=$.get();P.set(w,I),this.h?this.h.next=P:this.g=P,this.h=P}}var $=new V(()=>new U,y=>y.reset());class U{constructor(){this.next=this.g=this.h=null}set(w,I){this.h=w,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let K,J=!1,R=new W,A=()=>{const y=Promise.resolve(void 0);K=()=>{y.then(C)}};function C(){for(var y;y=j();){try{y.h.call(y.g)}catch(I){O(I)}var w=$;w.j(y),w.h<100&&(w.h++,y.next=w.g,w.g=y)}J=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(y,w){this.type=y,this.g=this.target=w,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,w=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const I=()=>{};l.addEventListener("test",I,w),l.removeEventListener("test",I,w)}catch{}return y})();function D(y){return/^[\s\xa0]*$/.test(y)}function ye(y,w){L.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,w)}T(ye,L),ye.prototype.init=function(y,w){const I=this.type=y.type,P=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=w,w=y.relatedTarget,w||(I=="mouseover"?w=y.fromElement:I=="mouseout"&&(w=y.toElement)),this.relatedTarget=w,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&ye.Z.h.call(this)},ye.prototype.h=function(){ye.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var Oe="closure_listenable_"+(Math.random()*1e6|0),X=0;function fe(y,w,I,P,Z){this.listener=y,this.proxy=null,this.src=w,this.type=I,this.capture=!!P,this.ha=Z,this.key=++X,this.da=this.fa=!1}function Re(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function Ke(y,w,I){for(const P in y)w.call(I,y[P],P,y)}function nt(y,w){for(const I in y)w.call(void 0,y[I],I,y)}function G(y){const w={};for(const I in y)w[I]=y[I];return w}const le="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function z(y,w){let I,P;for(let Z=1;Z<arguments.length;Z++){P=arguments[Z];for(I in P)y[I]=P[I];for(let se=0;se<le.length;se++)I=le[se],Object.prototype.hasOwnProperty.call(P,I)&&(y[I]=P[I])}}function pe(y){this.src=y,this.g={},this.h=0}pe.prototype.add=function(y,w,I,P,Z){const se=y.toString();y=this.g[se],y||(y=this.g[se]=[],this.h++);const _e=Ie(y,w,P,Z);return _e>-1?(w=y[_e],I||(w.fa=!1)):(w=new fe(w,this.src,se,!!P,Z),w.fa=I,y.push(w)),w};function we(y,w){const I=w.type;if(I in y.g){var P=y.g[I],Z=Array.prototype.indexOf.call(P,w,void 0),se;(se=Z>=0)&&Array.prototype.splice.call(P,Z,1),se&&(Re(w),y.g[I].length==0&&(delete y.g[I],y.h--))}}function Ie(y,w,I,P){for(let Z=0;Z<y.length;++Z){const se=y[Z];if(!se.da&&se.listener==w&&se.capture==!!I&&se.ha==P)return Z}return-1}var H="closure_lm_"+(Math.random()*1e6|0),ge={};function Se(y,w,I,P,Z){if(Array.isArray(w)){for(let se=0;se<w.length;se++)Se(y,w[se],I,P,Z);return null}return I=un(I),y&&y[Oe]?y.J(w,I,u(P)?!!P.capture:!1,Z):Le(y,w,I,!1,P,Z)}function Le(y,w,I,P,Z,se){if(!w)throw Error("Invalid event type");const _e=u(Z)?!!Z.capture:!!Z;let Be=cn(y);if(Be||(y[H]=Be=new pe(y)),I=Be.add(w,I,P,_e,se),I.proxy)return I;if(P=qe(),I.proxy=P,P.src=y,P.listener=I,y.addEventListener)F||(Z=_e),Z===void 0&&(Z=!1),y.addEventListener(w.toString(),P,Z);else if(y.attachEvent)y.attachEvent(Ot(w.toString()),P);else if(y.addListener&&y.removeListener)y.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return I}function qe(){function y(I){return w.call(y.src,y.listener,I)}const w=ai;return y}function st(y,w,I,P,Z){if(Array.isArray(w))for(var se=0;se<w.length;se++)st(y,w[se],I,P,Z);else P=u(P)?!!P.capture:!!P,I=un(I),y&&y[Oe]?(y=y.i,se=String(w).toString(),se in y.g&&(w=y.g[se],I=Ie(w,I,P,Z),I>-1&&(Re(w[I]),Array.prototype.splice.call(w,I,1),w.length==0&&(delete y.g[se],y.h--)))):y&&(y=cn(y))&&(w=y.g[w.toString()],y=-1,w&&(y=Ie(w,I,P,Z)),(I=y>-1?w[y]:null)&&$e(I))}function $e(y){if(typeof y!="number"&&y&&!y.da){var w=y.src;if(w&&w[Oe])we(w.i,y);else{var I=y.type,P=y.proxy;w.removeEventListener?w.removeEventListener(I,P,y.capture):w.detachEvent?w.detachEvent(Ot(I),P):w.addListener&&w.removeListener&&w.removeListener(P),(I=cn(w))?(we(I,y),I.h==0&&(I.src=null,w[H]=null)):Re(y)}}}function Ot(y){return y in ge?ge[y]:ge[y]="on"+y}function ai(y,w){if(y.da)y=!0;else{w=new ye(w,this);const I=y.listener,P=y.ha||y.src;y.fa&&$e(y),y=I.call(P,w)}return y}function cn(y){return y=y[H],y instanceof pe?y:null}var Bi="__closure_events_fn_"+(Math.random()*1e9>>>0);function un(y){return typeof y=="function"?y:(y[Bi]||(y[Bi]=function(w){return y.handleEvent(w)}),y[Bi])}function Ct(){M.call(this),this.i=new pe(this),this.M=this,this.G=null}T(Ct,M),Ct.prototype[Oe]=!0,Ct.prototype.removeEventListener=function(y,w,I,P){st(this,y,w,I,P)};function dn(y,w){var I,P=y.G;if(P)for(I=[];P;P=P.G)I.push(P);if(y=y.M,P=w.type||w,typeof w=="string")w=new L(w,y);else if(w instanceof L)w.target=w.target||y;else{var Z=w;w=new L(P,y),z(w,Z)}Z=!0;let se,_e;if(I)for(_e=I.length-1;_e>=0;_e--)se=w.g=I[_e],Z=Ar(se,P,!0,w)&&Z;if(se=w.g=y,Z=Ar(se,P,!0,w)&&Z,Z=Ar(se,P,!1,w)&&Z,I)for(_e=0;_e<I.length;_e++)se=w.g=I[_e],Z=Ar(se,P,!1,w)&&Z}Ct.prototype.N=function(){if(Ct.Z.N.call(this),this.i){var y=this.i;for(const w in y.g){const I=y.g[w];for(let P=0;P<I.length;P++)Re(I[P]);delete y.g[w],y.h--}}this.G=null},Ct.prototype.J=function(y,w,I,P){return this.i.add(String(y),w,!1,I,P)},Ct.prototype.K=function(y,w,I,P){return this.i.add(String(y),w,!0,I,P)};function Ar(y,w,I,P){if(w=y.i.g[String(w)],!w)return!0;w=w.concat();let Z=!0;for(let se=0;se<w.length;++se){const _e=w[se];if(_e&&!_e.da&&_e.capture==I){const Be=_e.listener,Ht=_e.ha||_e.src;_e.fa&&we(y.i,_e),Z=Be.call(Ht,P)!==!1&&Z}}return Z&&!P.defaultPrevented}function mg(y,w){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=m(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:l.setTimeout(y,w||0)}function Vh(y){y.g=mg(()=>{y.g=null,y.i&&(y.i=!1,Vh(y))},y.l);const w=y.h;y.h=null,y.m.apply(null,w)}class jn extends M{constructor(w,I){super(),this.m=w,this.l=I,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:Vh(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function jo(y){M.call(this),this.h=y,this.g={}}T(jo,M);var eu=[];function tu(y){Ke(y.g,function(w,I){this.g.hasOwnProperty(I)&&$e(w)},y),y.g={}}jo.prototype.N=function(){jo.Z.N.call(this),tu(this)},jo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Nr=l.JSON.stringify,pg=l.JSON.parse,Lh=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function Uh(){}function Oh(){}var Gi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function En(){L.call(this,"d")}T(En,L);function bi(){L.call(this,"c")}T(bi,L);var zt={},Fh=null;function il(){return Fh=Fh||new Ct}zt.Ia="serverreachability";function qh(y){L.call(this,zt.Ia,y)}T(qh,L);function as(y){const w=il();dn(w,new qh(w))}zt.STAT_EVENT="statevent";function Bo(y,w){L.call(this,zt.STAT_EVENT,y),this.stat=w}T(Bo,L);function Wt(y){const w=il();dn(w,new Bo(w,y))}zt.Ja="timingevent";function ls(y,w){L.call(this,zt.Ja,y),this.size=w}T(ls,L);function cs(y,w){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},w)}function zi(){this.g=!0}zi.prototype.ua=function(){this.g=!1};function gg(y,w,I,P,Z,se){y.info(function(){if(y.g)if(se){var _e="",Be=se.split("&");for(let ct=0;ct<Be.length;ct++){var Ht=Be[ct].split("=");if(Ht.length>1){const Rt=Ht[0];Ht=Ht[1];const Ni=Rt.split("_");_e=Ni.length>=2&&Ni[1]=="type"?_e+(Rt+"="+Ht+"&"):_e+(Rt+"=redacted&")}}}else _e=null;else _e=se;return"XMLHTTP REQ ("+P+") [attempt "+Z+"]: "+w+`
`+I+`
`+_e})}function jh(y,w,I,P,Z,se,_e){y.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+Z+"]: "+w+`
`+I+`
`+se+" "+_e})}function us(y,w,I,P){y.info(function(){return"XMLHTTP TEXT ("+w+"): "+yg(y,I)+(P?" "+P:"")})}function Go(y,w){y.info(function(){return"TIMEOUT: "+w})}zi.prototype.info=function(){};function yg(y,w){if(!y.g)return w;if(!w)return null;try{const se=JSON.parse(w);if(se){for(y=0;y<se.length;y++)if(Array.isArray(se[y])){var I=se[y];if(!(I.length<2)){var P=I[1];if(Array.isArray(P)&&!(P.length<1)){var Z=P[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(let _e=1;_e<P.length;_e++)P[_e]=""}}}}return Nr(se)}catch{return w}}var zo={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},nu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},iu;function Ho(){}T(Ho,Uh),Ho.prototype.g=function(){return new XMLHttpRequest},iu=new Ho;function Gs(y){return encodeURIComponent(String(y))}function Bh(y){var w=1;y=y.split(":");const I=[];for(;w>0&&y.length;)I.push(y.shift()),w--;return y.length&&I.push(y.join(":")),I}function Hi(y,w,I,P){this.j=y,this.i=w,this.l=I,this.S=P||1,this.V=new jo(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new $i}function $i(){this.i=null,this.g="",this.h=!1}var Xt={},pn={};function ds(y,w,I){y.M=1,y.A=$o(en(w)),y.u=I,y.R=!0,sl(y,null)}function sl(y,w){y.F=Date.now(),hs(y),y.B=en(y.A);var I=y.B,P=y.S;Array.isArray(P)||(P=[String(P)]),ll(I.i,"t",P),y.C=0,I=y.j.L,y.h=new $i,y.g=sf(y.j,I?w:null,!y.u),y.P>0&&(y.O=new jn(m(y.Y,y,y.g),y.P)),w=y.V,I=y.g,P=y.ba;var Z="readystatechange";Array.isArray(Z)||(Z&&(eu[0]=Z.toString()),Z=eu);for(let se=0;se<Z.length;se++){const _e=Se(I,Z[se],P||w.handleEvent,!1,w.h||w);if(!_e)break;w.g[_e.key]=_e}w=y.J?G(y.J):{},y.u?(y.v||(y.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,w)):(y.v="GET",y.g.ea(y.B,y.v,null,w)),as(),gg(y.i,y.v,y.B,y.l,y.S,y.u)}Hi.prototype.ba=function(y){y=y.target;const w=this.O;w&&Ji(y)==3?w.j():this.Y(y)},Hi.prototype.Y=function(y){try{if(y==this.g)e:{const Be=Ji(this.g),Ht=this.g.ya(),ct=this.g.ca();if(!(Be<3)&&(Be!=3||this.g&&(this.h.h||this.g.la()||wn(this.g)))){this.K||Be!=4||Ht==7||(Ht==8||ct<=0?as(3):as(2)),fs(this);var w=this.g.ca();this.X=w;var I=_g(this);if(this.o=w==200,jh(this.i,this.v,this.B,this.l,this.S,Be,w),this.o){if(this.U&&!this.L){t:{if(this.g){var P,Z=this.g;if((P=Z.g?Z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(P)){var se=P;break t}}se=null}if(y=se)us(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ms(this,y);else{this.o=!1,this.m=3,Wt(12),li(this),Ii(this);break e}}if(this.R){y=!0;let Rt;for(;!this.K&&this.C<I.length;)if(Rt=zh(this,I),Rt==pn){Be==4&&(this.m=4,Wt(14),y=!1),us(this.i,this.l,null,"[Incomplete Response]");break}else if(Rt==Xt){this.m=4,Wt(15),us(this.i,this.l,I,"[Invalid Chunk]"),y=!1;break}else us(this.i,this.l,Rt,null),ms(this,Rt);if(Gh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Be!=4||I.length!=0||this.h.h||(this.m=1,Wt(16),y=!1),this.o=this.o&&y,!y)us(this.i,this.l,I,"[Invalid Chunked Response]"),li(this),Ii(this);else if(I.length>0&&!this.W){this.W=!0;var _e=this.j;_e.g==this&&_e.aa&&!_e.P&&(_e.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),_u(_e),_e.P=!0,Wt(11))}}else us(this.i,this.l,I,null),ms(this,I);Be==4&&li(this),this.o&&!this.K&&(Be==4?Zh(this.j,this):(this.o=!1,hs(this)))}else Hs(this.g),w==400&&I.indexOf("Unknown SID")>0?(this.m=3,Wt(12)):(this.m=0,Wt(13)),li(this),Ii(this)}}}catch{}finally{}};function _g(y){if(!Gh(y))return y.g.la();const w=wn(y.g);if(w==="")return"";let I="";const P=w.length,Z=Ji(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return li(y),Ii(y),"";y.h.i=new l.TextDecoder}for(let se=0;se<P;se++)y.h.h=!0,I+=y.h.i.decode(w[se],{stream:!(Z&&se==P-1)});return w.length=0,y.h.g+=I,y.C=0,y.h.g}function Gh(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function zh(y,w){var I=y.C,P=w.indexOf(`
`,I);return P==-1?pn:(I=Number(w.substring(I,P)),isNaN(I)?Xt:(P+=1,P+I>w.length?pn:(w=w.slice(P,P+I),y.C=P+I,w)))}Hi.prototype.cancel=function(){this.K=!0,li(this)};function hs(y){y.T=Date.now()+y.H,rl(y,y.H)}function rl(y,w){if(y.D!=null)throw Error("WatchDog timer not null");y.D=cs(m(y.aa,y),w)}function fs(y){y.D&&(l.clearTimeout(y.D),y.D=null)}Hi.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(Go(this.i,this.B),this.M!=2&&(as(),Wt(17)),li(this),this.m=2,Ii(this)):rl(this,this.T-y)};function Ii(y){y.j.I==0||y.K||Zh(y.j,y)}function li(y){fs(y);var w=y.O;w&&typeof w.dispose=="function"&&w.dispose(),y.O=null,tu(y.V),y.g&&(w=y.g,y.g=null,w.abort(),w.dispose())}function ms(y,w){try{var I=y.j;if(I.I!=0&&(I.g==y||gs(I.h,y))){if(!y.L&&gs(I.h,y)&&I.I==3){try{var P=I.Ba.g.parse(w)}catch{P=null}if(Array.isArray(P)&&P.length==3){var Z=P;if(Z[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<y.F)fl(I),Lr(I);else break e;Zo(I),Wt(18)}}else I.xa=Z[1],0<I.xa-I.K&&Z[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=cs(m(I.Va,I),6e3));ps(I.h)<=1&&I.ta&&(I.ta=void 0)}else Es(I,11)}else if((y.L||I.g==y)&&fl(I),!D(w))for(Z=I.Ba.g.parse(w),w=0;w<Z.length;w++){let ct=Z[w];const Rt=ct[0];if(!(Rt<=I.K))if(I.K=Rt,ct=ct[1],I.I==2)if(ct[0]=="c"){I.M=ct[1],I.ba=ct[2];const Ni=ct[3];Ni!=null&&(I.ka=Ni,I.j.info("VER="+I.ka));const ws=ct[4];ws!=null&&(I.za=ws,I.j.info("SVER="+I.za));const Qi=ct[5];Qi!=null&&typeof Qi=="number"&&Qi>0&&(P=1.5*Qi,I.O=P,I.j.info("backChannelRequestTimeoutMs_="+P)),P=I;const Wi=y.g;if(Wi){const ea=Wi.g?Wi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ea){var se=P.h;se.g||ea.indexOf("spdy")==-1&&ea.indexOf("quic")==-1&&ea.indexOf("h2")==-1||(se.j=se.l,se.g=new Set,se.h&&(ou(se,se.h),se.h=null))}if(P.G){const ml=Wi.g?Wi.g.getResponseHeader("X-HTTP-Session-Id"):null;ml&&(P.wa=ml,ht(P.J,P.G,ml))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-y.F,I.j.info("Handshake RTT: "+I.T+"ms")),P=I;var _e=y;if(P.na=nf(P,P.L?P.ba:null,P.W),_e.L){au(P.h,_e);var Be=_e,Ht=P.O;Ht&&(Be.H=Ht),Be.D&&(fs(Be),hs(Be)),P.g=_e}else Wh(P);I.i.length>0&&xs(I)}else ct[0]!="stop"&&ct[0]!="close"||Es(I,7);else I.I==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?Es(I,7):gu(I):ct[0]!="noop"&&I.l&&I.l.qa(ct),I.A=0)}}as(4)}catch{}}var Zt=class{constructor(y,w){this.g=y,this.map=w}};function su(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ru(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function ps(y){return y.h?1:y.g?y.g.size:0}function gs(y,w){return y.h?y.h==w:y.g?y.g.has(w):!1}function ou(y,w){y.g?y.g.add(w):y.h=w}function au(y,w){y.h&&y.h==w?y.h=null:y.g&&y.g.has(w)&&y.g.delete(w)}su.prototype.cancel=function(){if(this.i=lu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function lu(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let w=y.i;for(const I of y.g.values())w=w.concat(I.G);return w}return S(y.i)}var Hh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ol(y,w){if(y){y=y.split("&");for(let I=0;I<y.length;I++){const P=y[I].indexOf("=");let Z,se=null;P>=0?(Z=y[I].substring(0,P),se=y[I].substring(P+1)):Z=y[I],w(Z,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function ci(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;y instanceof ci?(this.l=y.l,gn(this,y.j),this.o=y.o,this.g=y.g,Cr(this,y.u),this.h=y.h,cu(this,Jh(y.i)),this.m=y.m):y&&(w=String(y).match(Hh))?(this.l=!1,gn(this,w[1]||"",!0),this.o=ys(w[2]||""),this.g=ys(w[3]||"",!0),Cr(this,w[4]),this.h=ys(w[5]||"",!0),cu(this,w[6]||"",!0),this.m=ys(w[7]||"")):(this.l=!1,this.i=new Pr(null,this.l))}ci.prototype.toString=function(){const y=[];var w=this.j;w&&y.push(Ko(w,al,!0),":");var I=this.g;return(I||w=="file")&&(y.push("//"),(w=this.o)&&y.push(Ko(w,al,!0),"@"),y.push(Gs(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&y.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&y.push("/"),y.push(Ko(I,I.charAt(0)=="/"?uu:$h,!0))),(I=this.i.toString())&&y.push("?",I),(I=this.m)&&y.push("#",Ko(I,Kh)),y.join("")},ci.prototype.resolve=function(y){const w=en(this);let I=!!y.j;I?gn(w,y.j):I=!!y.o,I?w.o=y.o:I=!!y.g,I?w.g=y.g:I=y.u!=null;var P=y.h;if(I)Cr(w,y.u);else if(I=!!y.h){if(P.charAt(0)!="/")if(this.g&&!this.h)P="/"+P;else{var Z=w.h.lastIndexOf("/");Z!=-1&&(P=w.h.slice(0,Z+1)+P)}if(Z=P,Z==".."||Z==".")P="";else if(Z.indexOf("./")!=-1||Z.indexOf("/.")!=-1){P=Z.lastIndexOf("/",0)==0,Z=Z.split("/");const se=[];for(let _e=0;_e<Z.length;){const Be=Z[_e++];Be=="."?P&&_e==Z.length&&se.push(""):Be==".."?((se.length>1||se.length==1&&se[0]!="")&&se.pop(),P&&_e==Z.length&&se.push("")):(se.push(Be),P=!0)}P=se.join("/")}else P=Z}return I?w.h=P:I=y.i.toString()!=="",I?cu(w,Jh(y.i)):I=!!y.m,I&&(w.m=y.m),w};function en(y){return new ci(y)}function gn(y,w,I){y.j=I?ys(w,!0):w,y.j&&(y.j=y.j.replace(/:$/,""))}function Cr(y,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);y.u=w}else y.u=null}function cu(y,w,I){w instanceof Pr?(y.i=w,cl(y.i,y.l)):(I||(w=Ko(w,Rr)),y.i=new Pr(w,y.l))}function ht(y,w,I){y.i.set(w,I)}function $o(y){return ht(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function ys(y,w){return y?w?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Ko(y,w,I){return typeof y=="string"?(y=encodeURI(y).replace(w,Qn),I&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Qn(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var al=/[#\/\?@]/g,$h=/[#\?:]/g,uu=/[#\?]/g,Rr=/[#\?@]/g,Kh=/#/g;function Pr(y,w){this.h=this.g=null,this.i=y||null,this.j=!!w}function Wn(y){y.g||(y.g=new Map,y.h=0,y.i&&ol(y.i,function(w,I){y.add(decodeURIComponent(w.replace(/\+/g," ")),I)}))}n=Pr.prototype,n.add=function(y,w){Wn(this),this.i=null,y=Dr(this,y);let I=this.g.get(y);return I||this.g.set(y,I=[]),I.push(w),this.h+=1,this};function Yh(y,w){Wn(y),w=Dr(y,w),y.g.has(w)&&(y.i=null,y.h-=y.g.get(w).length,y.g.delete(w))}function du(y,w){return Wn(y),w=Dr(y,w),y.g.has(w)}n.forEach=function(y,w){Wn(this),this.g.forEach(function(I,P){I.forEach(function(Z){y.call(w,Z,P,this)},this)},this)};function hu(y,w){Wn(y);let I=[];if(typeof w=="string")du(y,w)&&(I=I.concat(y.g.get(Dr(y,w))));else for(y=Array.from(y.g.values()),w=0;w<y.length;w++)I=I.concat(y[w]);return I}n.set=function(y,w){return Wn(this),this.i=null,y=Dr(this,y),du(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[w]),this.h+=1,this},n.get=function(y,w){return y?(y=hu(this,y),y.length>0?String(y[0]):w):w};function ll(y,w,I){Yh(y,w),I.length>0&&(y.i=null,y.g.set(Dr(y,w),S(I)),y.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],w=Array.from(this.g.keys());for(let P=0;P<w.length;P++){var I=w[P];const Z=Gs(I);I=hu(this,I);for(let se=0;se<I.length;se++){let _e=Z;I[se]!==""&&(_e+="="+Gs(I[se])),y.push(_e)}}return this.i=y.join("&")};function Jh(y){const w=new Pr;return w.i=y.i,y.g&&(w.g=new Map(y.g),w.h=y.h),w}function Dr(y,w){return w=String(w),y.j&&(w=w.toLowerCase()),w}function cl(y,w){w&&!y.j&&(Wn(y),y.i=null,y.g.forEach(function(I,P){const Z=P.toLowerCase();P!=Z&&(Yh(this,P),ll(this,Z,I))},y)),y.j=w}function Ki(y,w){const I=new zi;if(l.Image){const P=new Image;P.onload=_(Si,I,"TestLoadImage: loaded",!0,w,P),P.onerror=_(Si,I,"TestLoadImage: error",!1,w,P),P.onabort=_(Si,I,"TestLoadImage: abort",!1,w,P),P.ontimeout=_(Si,I,"TestLoadImage: timeout",!1,w,P),l.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=y}else w(!1)}function fu(y,w){const I=new zi,P=new AbortController,Z=setTimeout(()=>{P.abort(),Si(I,"TestPingServer: timeout",!1,w)},1e4);fetch(y,{signal:P.signal}).then(se=>{clearTimeout(Z),se.ok?Si(I,"TestPingServer: ok",!0,w):Si(I,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(Z),Si(I,"TestPingServer: error",!1,w)})}function Si(y,w,I,P,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),P(I)}catch{}}function Mr(){this.g=new Lh}function _s(y){this.i=y.Sb||null,this.h=y.ab||!1}T(_s,Uh),_s.prototype.g=function(){return new Yo(this.i,this.h)};function Yo(y,w){Ct.call(this),this.H=y,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}T(Yo,Ct),n=Yo.prototype,n.open=function(y,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=w,this.readyState=1,Yi(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(w.body=y),(this.H||l).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,kr(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Yi(this)),this.g&&(this.readyState=3,Yi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ul(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function ul(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var w=y.value?y.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!y.done}))&&(this.response=this.responseText+=w)}y.done?kr(this):Yi(this),this.readyState==3&&ul(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,kr(this))},n.Na=function(y){this.g&&(this.response=y,kr(this))},n.ga=function(){this.g&&kr(this)};function kr(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Yi(y)}n.setRequestHeader=function(y,w){this.A.append(y,w)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],w=this.h.entries();for(var I=w.next();!I.done;)I=I.value,y.push(I[0]+": "+I[1]),I=w.next();return y.join(`\r
`)};function Yi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Yo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Ai(y){let w="";return Ke(y,function(I,P){w+=P,w+=":",w+=I,w+=`\r
`}),w}function Jo(y,w,I){e:{for(P in I){var P=!1;break e}P=!0}P||(I=Ai(I),typeof y=="string"?I!=null&&Gs(I):ht(y,w,I))}function yt(y){Ct.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}T(yt,Ct);var vs=/^https?$/i,mu=["POST","PUT"];n=yt.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,w,I,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);w=w?w.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():iu.g(),this.g.onreadystatechange=E(m(this.Ca,this));try{this.B=!0,this.g.open(w,String(y),!0),this.B=!1}catch(se){Qo(this,se);return}if(y=I||"",I=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var Z in P)I.set(Z,P[Z]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const se of P.keys())I.set(se,P.get(se));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(I.keys()).find(se=>se.toLowerCase()=="content-type"),Z=l.FormData&&y instanceof l.FormData,!(Array.prototype.indexOf.call(mu,w,void 0)>=0)||P||Z||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[se,_e]of I)this.g.setRequestHeader(se,_e);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(se){Qo(this,se)}};function Qo(y,w){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=w,y.o=5,pu(y),zs(y)}function pu(y){y.A||(y.A=!0,dn(y,"complete"),dn(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,dn(this,"complete"),dn(this,"abort"),zs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zs(this,!0)),yt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Wo(this):this.Xa())},n.Xa=function(){Wo(this)};function Wo(y){if(y.h&&typeof a<"u"){if(y.v&&Ji(y)==4)setTimeout(y.Ca.bind(y),0);else if(dn(y,"readystatechange"),Ji(y)==4){y.h=!1;try{const se=y.ca();e:switch(se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var I;if(!(I=w)){var P;if(P=se===0){let _e=String(y.D).match(Hh)[1]||null;!_e&&l.self&&l.self.location&&(_e=l.self.location.protocol.slice(0,-1)),P=!vs.test(_e?_e.toLowerCase():"")}I=P}if(I)dn(y,"complete"),dn(y,"success");else{y.o=6;try{var Z=Ji(y)>2?y.g.statusText:""}catch{Z=""}y.l=Z+" ["+y.ca()+"]",pu(y)}}finally{zs(y)}}}}function zs(y,w){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const I=y.g;y.g=null,w||dn(y,"ready");try{I.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ji(y){return y.g?y.g.readyState:0}n.ca=function(){try{return Ji(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var w=this.g.responseText;return y&&w.indexOf(y)==0&&(w=w.substring(y.length)),pg(w)}};function wn(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function Hs(y){const w={};y=(y.g&&Ji(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<y.length;P++){if(D(y[P]))continue;var I=Bh(y[P]);const Z=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const se=w[Z]||[];w[Z]=se,se.push(I)}nt(w,function(P){return P.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ts(y,w,I){return I&&I.internalChannelParams&&I.internalChannelParams[y]||w}function Vr(y){this.za=0,this.i=[],this.j=new zi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ts("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ts("baseRetryDelayMs",5e3,y),this.Za=Ts("retryDelaySeedMs",1e4,y),this.Ta=Ts("forwardChannelMaxRetries",2,y),this.va=Ts("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new su(y&&y.concurrentRequestLimit),this.Ba=new Mr,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Vr.prototype,n.ka=8,n.I=1,n.connect=function(y,w,I,P){Wt(0),this.W=y,this.H=w||{},I&&P!==void 0&&(this.H.OSID=I,this.H.OAID=P),this.F=this.X,this.J=nf(this,null,this.W),xs(this)};function gu(y){if(dl(y),y.I==3){var w=y.V++,I=en(y.J);if(ht(I,"SID",y.M),ht(I,"RID",w),ht(I,"TYPE","terminate"),Xo(y,I),w=new Hi(y,y.j,w),w.M=2,w.A=$o(en(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(w.A.toString(),"")}catch{}!I&&l.Image&&(new Image().src=w.A,I=!0),I||(w.g=sf(w.j,null),w.g.ea(w.A)),w.F=Date.now(),hs(w)}tf(y)}function Lr(y){y.g&&(_u(y),y.g.cancel(),y.g=null)}function dl(y){Lr(y),y.v&&(l.clearTimeout(y.v),y.v=null),fl(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&l.clearTimeout(y.m),y.m=null)}function xs(y){if(!ru(y.h)&&!y.m){y.m=!0;var w=y.Ea;K||A(),J||(K(),J=!0),R.add(w,y),y.D=0}}function hl(y,w){return ps(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=w.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=cs(m(y.Ea,y,w),ef(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const Z=new Hi(this,this.j,y);let se=this.o;if(this.U&&(se?(se=G(se),z(se,this.U)):se=this.U),this.u!==null||this.R||(Z.J=se,se=null),this.S)e:{for(var w=0,I=0;I<this.i.length;I++){t:{var P=this.i[I];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(w+=P,w>4096){w=I;break e}if(w===4096||I===this.i.length-1){w=I+1;break e}}w=1e3}else w=1e3;w=Qh(this,Z,w),I=en(this.J),ht(I,"RID",y),ht(I,"CVER",22),this.G&&ht(I,"X-HTTP-Session-Id",this.G),Xo(this,I),se&&(this.R?w="headers="+Gs(Ai(se))+"&"+w:this.u&&Jo(I,this.u,se)),ou(this.h,Z),this.Ra&&ht(I,"TYPE","init"),this.S?(ht(I,"$req",w),ht(I,"SID","null"),Z.U=!0,ds(Z,I,null)):ds(Z,I,w),this.I=2}}else this.I==3&&(y?yu(this,y):this.i.length==0||ru(this.h)||yu(this))};function yu(y,w){var I;w?I=w.l:I=y.V++;const P=en(y.J);ht(P,"SID",y.M),ht(P,"RID",I),ht(P,"AID",y.K),Xo(y,P),y.u&&y.o&&Jo(P,y.u,y.o),I=new Hi(y,y.j,I,y.D+1),y.u===null&&(I.J=y.o),w&&(y.i=w.G.concat(y.i)),w=Qh(y,I,1e3),I.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),ou(y.h,I),ds(I,P,w)}function Xo(y,w){y.H&&Ke(y.H,function(I,P){ht(w,P,I)}),y.l&&Ke({},function(I,P){ht(w,P,I)})}function Qh(y,w,I){I=Math.min(y.i.length,I);const P=y.l?m(y.l.Ka,y.l,y):null;e:{var Z=y.i;let Be=-1;for(;;){const Ht=["count="+I];Be==-1?I>0?(Be=Z[0].g,Ht.push("ofs="+Be)):Be=0:Ht.push("ofs="+Be);let ct=!0;for(let Rt=0;Rt<I;Rt++){var se=Z[Rt].g;const Ni=Z[Rt].map;if(se-=Be,se<0)Be=Math.max(0,Z[Rt].g-100),ct=!1;else try{se="req"+se+"_"||"";try{var _e=Ni instanceof Map?Ni:Object.entries(Ni);for(const[ws,Qi]of _e){let Wi=Qi;u(Qi)&&(Wi=Nr(Qi)),Ht.push(se+ws+"="+encodeURIComponent(Wi))}}catch(ws){throw Ht.push(se+"type="+encodeURIComponent("_badmap")),ws}}catch{P&&P(Ni)}}if(ct){_e=Ht.join("&");break e}}_e=void 0}return y=y.i.splice(0,I),w.G=y,_e}function Wh(y){if(!y.g&&!y.v){y.Y=1;var w=y.Da;K||A(),J||(K(),J=!0),R.add(w,y),y.A=0}}function Zo(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=cs(m(y.Da,y),ef(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,Xh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=cs(m(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Wt(10),Lr(this),Xh(this))};function _u(y){y.B!=null&&(l.clearTimeout(y.B),y.B=null)}function Xh(y){y.g=new Hi(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var w=en(y.na);ht(w,"RID","rpc"),ht(w,"SID",y.M),ht(w,"AID",y.K),ht(w,"CI",y.F?"0":"1"),!y.F&&y.ia&&ht(w,"TO",y.ia),ht(w,"TYPE","xmlhttp"),Xo(y,w),y.u&&y.o&&Jo(w,y.u,y.o),y.O&&(y.g.H=y.O);var I=y.g;y=y.ba,I.M=1,I.A=$o(en(w)),I.u=null,I.R=!0,sl(I,y)}n.Va=function(){this.C!=null&&(this.C=null,Lr(this),Zo(this),Wt(19))};function fl(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function Zh(y,w){var I=null;if(y.g==w){fl(y),_u(y),y.g=null;var P=2}else if(gs(y.h,w))I=w.G,au(y.h,w),P=1;else return;if(y.I!=0){if(w.o)if(P==1){I=w.u?w.u.length:0,w=Date.now()-w.F;var Z=y.D;P=il(),dn(P,new ls(P,I)),xs(y)}else Wh(y);else if(Z=w.m,Z==3||Z==0&&w.X>0||!(P==1&&hl(y,w)||P==2&&Zo(y)))switch(I&&I.length>0&&(w=y.h,w.i=w.i.concat(I)),Z){case 1:Es(y,5);break;case 4:Es(y,10);break;case 3:Es(y,6);break;default:Es(y,2)}}}function ef(y,w){let I=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(I*=2),I*w}function Es(y,w){if(y.j.info("Error code "+w),w==2){var I=m(y.bb,y),P=y.Ua;const Z=!P;P=new ci(P||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||gn(P,"https"),$o(P),Z?Ki(P.toString(),I):fu(P.toString(),I)}else Wt(2);y.I=0,y.l&&y.l.pa(w),tf(y),dl(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),Wt(2)):(this.j.info("Failed to ping google.com"),Wt(1))};function tf(y){if(y.I=0,y.ja=[],y.l){const w=lu(y.h);(w.length!=0||y.i.length!=0)&&(k(y.ja,w),k(y.ja,y.i),y.h.i.length=0,S(y.i),y.i.length=0),y.l.oa()}}function nf(y,w,I){var P=I instanceof ci?en(I):new ci(I);if(P.g!="")w&&(P.g=w+"."+P.g),Cr(P,P.u);else{var Z=l.location;P=Z.protocol,w=w?w+"."+Z.hostname:Z.hostname,Z=+Z.port;const se=new ci(null);P&&gn(se,P),w&&(se.g=w),Z&&Cr(se,Z),I&&(se.h=I),P=se}return I=y.G,w=y.wa,I&&w&&ht(P,I,w),ht(P,"VER",y.ka),Xo(y,P),P}function sf(y,w,I){if(w&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=y.Aa&&!y.ma?new yt(new _s({ab:I})):new yt(y.ma),w.Fa(y.L),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function rf(){}n=rf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ur(){}Ur.prototype.g=function(y,w){return new Bn(y,w)};function Bn(y,w){Ct.call(this),this.g=new Vr(w),this.l=y,this.h=w&&w.messageUrlParams||null,y=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(y?y["X-WebChannel-Content-Type"]=w.messageContentType:y={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(y?y["X-WebChannel-Client-Profile"]=w.sa:y={"X-WebChannel-Client-Profile":w.sa}),this.g.U=y,(y=w&&w.Qb)&&!D(y)&&(this.g.u=y),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!D(w)&&(this.g.G=w,y=this.h,y!==null&&w in y&&(y=this.h,w in y&&delete y[w])),this.j=new $s(this)}T(Bn,Ct),Bn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Bn.prototype.close=function(){gu(this.g)},Bn.prototype.o=function(y){var w=this.g;if(typeof y=="string"){var I={};I.__data__=y,y=I}else this.v&&(I={},I.__data__=Nr(y),y=I);w.i.push(new Zt(w.Ya++,y)),w.I==3&&xs(w)},Bn.prototype.N=function(){this.g.l=null,delete this.j,gu(this.g),delete this.g,Bn.Z.N.call(this)};function of(y){En.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var w=y.__sm__;if(w){e:{for(const I in w){y=I;break e}y=void 0}(this.i=y)&&(y=this.i,w=w!==null&&y in w?w[y]:void 0),this.data=w}else this.data=y}T(of,En);function af(){bi.call(this),this.status=1}T(af,bi);function $s(y){this.g=y}T($s,rf),$s.prototype.ra=function(){dn(this.g,"a")},$s.prototype.qa=function(y){dn(this.g,new of(y))},$s.prototype.pa=function(y){dn(this.g,new af)},$s.prototype.oa=function(){dn(this.g,"b")},Ur.prototype.createWebChannel=Ur.prototype.g,Bn.prototype.send=Bn.prototype.o,Bn.prototype.open=Bn.prototype.m,Bn.prototype.close=Bn.prototype.close,$C=function(){return new Ur},HC=function(){return il()},zC=zt,W_={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},zo.NO_ERROR=0,zo.TIMEOUT=8,zo.HTTP_ERROR=6,wm=zo,nu.COMPLETE="complete",GC=nu,Oh.EventType=Gi,Gi.OPEN="a",Gi.CLOSE="b",Gi.ERROR="c",Gi.MESSAGE="d",Ct.prototype.listen=Ct.prototype.J,gd=Oh,yt.prototype.listenOnce=yt.prototype.K,yt.prototype.getLastError=yt.prototype.Ha,yt.prototype.getLastErrorCode=yt.prototype.ya,yt.prototype.getStatus=yt.prototype.ca,yt.prototype.getResponseJson=yt.prototype.La,yt.prototype.getResponseText=yt.prototype.la,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Fa,BC=yt}).apply(typeof hm<"u"?hm:typeof self<"u"?self:typeof window<"u"?window:{});const dI="@firebase/firestore",hI="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};vn.UNAUTHENTICATED=new vn(null),vn.GOOGLE_CREDENTIALS=new vn("google-credentials-uid"),vn.FIRST_PARTY=new vn("first-party-uid"),vn.MOCK_USER=new vn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bc="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Io=new uh("@firebase/firestore");function Wl(){return Io.logLevel}function TO(n){Io.setLogLevel(n)}function he(n,...e){if(Io.logLevel<=Qe.DEBUG){const t=e.map(T0);Io.debug(`Firestore (${Bc}): ${n}`,...t)}}function Yt(n,...e){if(Io.logLevel<=Qe.ERROR){const t=e.map(T0);Io.error(`Firestore (${Bc}): ${n}`,...t)}}function js(n,...e){if(Io.logLevel<=Qe.WARN){const t=e.map(T0);Io.warn(`Firestore (${Bc}): ${n}`,...t)}}function T0(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function be(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,KC(n,i,t)}function KC(n,e,t){let i=`FIRESTORE (${Bc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Yt(i),new Error(i)}function Ne(n,e,t,i){let s="Unexpected state";typeof t=="string"?s=t:i=t,n||KC(e,s,i)}function xO(n,e){n||be(57014,e)}function xe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class de extends Rn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class EO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(vn.UNAUTHENTICATED)))}shutdown(){}}class wO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class bO{constructor(e){this.t=e,this.currentUser=vn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ne(this.o===void 0,42304);let i=this.i;const s=h=>this.i!==i?(i=this.i,t(h)):Promise.resolve();let a=new Pn;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Pn,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const h=a;e.enqueueRetryable((async()=>{await h.promise,await s(this.currentUser)}))},u=h=>{he("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(he("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Pn)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(he("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ne(typeof i.accessToken=="string",31837,{l:i}),new YC(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ne(e===null||typeof e=="string",2055,{h:e}),new vn(e)}}class IO{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=vn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class SO{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new IO(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(vn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class fI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class AO{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ne(this.o===void 0,3512);const i=a=>{a.error!=null&&he("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,he("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>i(a)))};const s=a=>{he("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):he("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new fI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ne(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new fI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=NO(40);for(let a=0;a<s.length;++a)i.length<20&&s[a]<t&&(i+=e.charAt(s[a]%62))}return i}}function Fe(n,e){return n<e?-1:n>e?1:0}function X_(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const s=n.charAt(i),a=e.charAt(i);if(s!==a)return C_(s)===C_(a)?Fe(s,a):C_(s)?1:-1}return Fe(n.length,e.length)}const CO=55296,RO=57343;function C_(n){const e=n.charCodeAt(0);return e>=CO&&e<=RO}function yc(n,e,t){return n.length===e.length&&n.every(((i,s)=>t(i,e[s])))}function JC(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI="__name__";class Ns{constructor(e,t,i){t===void 0?t=0:t>e.length&&be(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&be(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ns.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ns?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const a=Ns.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return Fe(e.length,t.length)}static compareSegments(e,t){const i=Ns.isNumericId(e),s=Ns.isNumericId(t);return i&&!s?-1:!i&&s?1:i&&s?Ns.extractNumericId(e).compare(Ns.extractNumericId(t)):X_(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return vo.fromString(e.substring(4,e.length-2))}}class We extends Ns{construct(e,t,i){return new We(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new de(ie.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((s=>s.length>0)))}return new We(t)}static emptyPath(){return new We([])}}const PO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kt extends Ns{construct(e,t,i){return new kt(e,t,i)}static isValidIdentifier(e){return PO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===mI}static keyField(){return new kt([mI])}static fromServerFormat(e){const t=[];let i="",s=0;const a=()=>{if(i.length===0)throw new de(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let l=!1;for(;s<e.length;){const u=e[s];if(u==="\\"){if(s+1===e.length)throw new de(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[s+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new de(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=h,s+=2}else u==="`"?(l=!l,s++):u!=="."||l?(i+=u,s++):(a(),s++)}if(a(),l)throw new de(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kt(t)}static emptyPath(){return new kt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.path=e}static fromPath(e){return new ve(We.fromString(e))}static fromName(e){return new ve(We.fromString(e).popFirst(5))}static empty(){return new ve(We.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&We.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return We.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ve(new We(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(n,e,t){if(!t)throw new de(ie.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function QC(n,e,t,i){if(e===!0&&i===!0)throw new de(ie.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pI(n){if(!ve.isDocumentKey(n))throw new de(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function gI(n){if(ve.isDocumentKey(n))throw new de(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function WC(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Rp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":be(12329,{type:typeof n})}function at(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new de(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Rp(n);throw new de(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function XC(n,e){if(e<=0)throw new de(ie.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ln(n,e){const t={typeString:n};return e&&(t.value=e),t}function _h(n,e){if(!WC(n))throw new de(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const s=e[i].typeString,a="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const l=n[i];if(s&&typeof l!==s){t=`JSON field '${i}' must be a ${s}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${i}' field to equal '${a.value}'`;break}}if(t)throw new de(ie.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI=-62135596800,_I=1e6;class dt{static now(){return dt.fromMillis(Date.now())}static fromDate(e){return dt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*_I);return new dt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new de(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new de(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<yI)throw new de(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new de(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_I}_compareTo(e){return this.seconds===e.seconds?Fe(this.nanoseconds,e.nanoseconds):Fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:dt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(_h(e,dt._jsonSchema))return new dt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-yI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}dt._jsonSchemaVersion="firestore/timestamp/1.0",dt._jsonSchema={type:ln("string",dt._jsonSchemaVersion),seconds:ln("number"),nanoseconds:ln("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{static fromTimestamp(e){return new Pe(e)}static min(){return new Pe(new dt(0,0))}static max(){return new Pe(new dt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _c=-1;class $m{constructor(e,t,i,s){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=s}}function Z_(n){return n.fields.find((e=>e.kind===2))}function _a(n){return n.fields.filter((e=>e.kind!==2))}$m.UNKNOWN_ID=-1;class bm{constructor(e,t){this.fieldPath=e,this.kind=t}}class $d{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new $d(0,wi.min())}}function ZC(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=Pe.fromTimestamp(i===1e9?new dt(t+1,0):new dt(t,i));return new wi(s,ve.empty(),e)}function eR(n){return new wi(n.readTime,n.key,_c)}class wi{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new wi(Pe.min(),ve.empty(),_c)}static max(){return new wi(Pe.max(),ve.empty(),_c)}}function w0(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ve.comparator(n.documentKey,e.documentKey),t!==0?t:Fe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vo(n){if(n.code!==ie.FAILED_PRECONDITION||n.message!==tR)throw n;he("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&be(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Q(((i,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(i,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(i,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Q?t:Q.resolve(t)}catch(t){return Q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Q.reject(t)}static resolve(e){return new Q(((t,i)=>{t(e)}))}static reject(e){return new Q(((t,i)=>{i(e)}))}static waitFor(e){return new Q(((t,i)=>{let s=0,a=0,l=!1;e.forEach((u=>{++s,u.next((()=>{++a,l&&a===s&&t()}),(h=>i(h)))})),l=!0,a===s&&t()}))}static or(e){let t=Q.resolve(!1);for(const i of e)t=t.next((s=>s?Q.resolve(s):i()));return t}static forEach(e,t){const i=[];return e.forEach(((s,a)=>{i.push(t.call(this,s,a))})),this.waitFor(i)}static mapArray(e,t){return new Q(((i,s)=>{const a=e.length,l=new Array(a);let u=0;for(let h=0;h<a;h++){const m=h;t(e[m]).next((_=>{l[m]=_,++u,u===a&&i(l)}),(_=>s(_)))}}))}static doWhile(e,t){return new Q(((i,s)=>{const a=()=>{e()===!0?t().next((()=>{a()}),s):i()};a()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi="SimpleDb";class Pp{static open(e,t,i,s){try{return new Pp(t,e.transaction(s,i))}catch(a){throw new Nd(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Pn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Nd(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const s=b0(i.target.error);this.S.reject(new Nd(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(he(yi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new MO(t)}}class Us{static delete(e){return he(yi,"Removing database:",e),Ta(zv().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Va())return!1;if(Us.F())return!0;const e=Lt(),t=Us.M(e),i=0<t&&t<10,s=iR(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Us.M(Lt())===12.2&&Yt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(he(yi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const l=a.target.result;t(l)},s.onblocked=()=>{i(new Nd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const l=a.target.error;l.name==="VersionError"?i(new de(ie.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?i(new de(ie.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):i(new Nd(e,l))},s.onupgradeneeded=a=>{he(yi,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;this.N.k(l,s.transaction,a.oldVersion,this.version).next((()=>{he(yi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,s){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const u=Pp.open(this.db,e,a?"readonly":"readwrite",i),h=s(u).next((m=>(u.C(),m))).catch((m=>(u.abort(m),Q.reject(m)))).toPromise();return h.catch((()=>{})),await u.D,h}catch(u){const h=u,m=h.name!=="FirebaseError"&&l<3;if(he(yi,"Transaction failed with error:",h.message,"Retrying:",m),this.close(),!m)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function iR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class DO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ta(this.U.delete())}}class Nd extends de{constructor(e,t){super(ie.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Lo(n){return n.name==="IndexedDbTransactionError"}class MO{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(he(yi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(he(yi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ta(i)}add(e){return he(yi,"ADD",this.store.name,e,e),Ta(this.store.add(e))}get(e){return Ta(this.store.get(e)).next((t=>(t===void 0&&(t=null),he(yi,"GET",this.store.name,e,t),t)))}delete(e){return he(yi,"DELETE",this.store.name,e),Ta(this.store.delete(e))}count(){return he(yi,"COUNT",this.store.name),Ta(this.store.count())}J(e,t){const i=this.options(e,t),s=i.index?this.store.index(i.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(i.range);return new Q(((l,u)=>{a.onerror=h=>{u(h.target.error)},a.onsuccess=h=>{l(h.target.result)}}))}{const a=this.cursor(i),l=[];return this.H(a,((u,h)=>{l.push(h)})).next((()=>l))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Q(((s,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{s(l.target.result)}}))}Z(e,t){he(yi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const s=this.cursor(i);return this.H(s,((a,l,u)=>u.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const s=this.cursor(i);return this.H(s,t)}te(e){const t=this.cursor({});return new Q(((i,s)=>{t.onerror=a=>{const l=b0(a.target.error);s(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((u=>{u?l.continue():i()})):i()}}))}H(e,t){const i=[];return new Q(((s,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const u=l.target.result;if(!u)return void s();const h=new DO(u),m=t(u.primaryKey,u.value,h);if(m instanceof Q){const _=m.catch((T=>(h.done(),Q.reject(T))));i.push(_)}h.isDone?s():h.G===null?u.continue():u.continue(h.G)}})).next((()=>Q.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ta(n){return new Q(((e,t)=>{n.onsuccess=i=>{const s=i.target.result;e(s)},n.onerror=i=>{const s=b0(i.target.error);t(s)}}))}let vI=!1;function b0(n){const e=Us.M(Lt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new de("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return vI||(vI=!0,setTimeout((()=>{throw i}),0)),i}}return n}const Cd="IndexBackfiller";class kO{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){he(Cd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();he(Cd,`Documents written: ${t}`)}catch(t){Lo(t)?he(Cd,"Ignoring IndexedDB error during index backfill: ",t):await Vo(t)}await this.re(6e4)}))}}class VO{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let s=t,a=!0;return Q.doWhile((()=>a===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!i.has(l))return he(Cd,`Processing collection: ${l}`),this.oe(e,l,s).next((u=>{s-=u,i.add(l)}));a=!1})))).next((()=>t-s))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,i).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(s,a))).next((u=>(he(Cd,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u)))).next((()=>l.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((s,a)=>{const l=eR(a);w0(l,i)>0&&(i=l)})),new wi(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}si.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To=-1;function vh(n){return n==null}function Kd(n){return n===0&&1/n==-1/0}function sR(n){return typeof n=="number"&&Number.isInteger(n)&&!Kd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km="";function Fn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=TI(e)),e=LO(n.get(t),e);return TI(e)}function LO(n,e){let t=e;const i=n.length;for(let s=0;s<i;s++){const a=n.charAt(s);switch(a){case"\0":t+="";break;case Km:t+="";break;default:t+=a}}return t}function TI(n){return n+Km+""}function Vs(n){const e=n.length;if(Ne(e>=2,64408,{path:n}),e===2)return Ne(n.charAt(0)===Km&&n.charAt(1)==="",56145,{path:n}),We.emptyPath();const t=e-2,i=[];let s="";for(let a=0;a<e;){const l=n.indexOf(Km,a);switch((l<0||l>t)&&be(50515,{path:n}),n.charAt(l+1)){case"":const u=n.substring(a,l);let h;s.length===0?h=u:(s+=u,h=s,s=""),i.push(h);break;case"":s+=n.substring(a,l),s+="\0";break;case"":s+=n.substring(a,l+1);break;default:be(61167,{path:n})}a=l+2}return new We(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va="remoteDocuments",Th="owner",Hl="owner",Yd="mutationQueues",UO="userId",ts="mutations",xI="batchId",Aa="userMutationsIndex",EI=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(n,e){return[n,Fn(e)]}function rR(n,e,t){return[n,Fn(e),t]}const OO={},vc="documentMutations",Ym="remoteDocumentsV14",FO=["prefixPath","collectionGroup","readTime","documentId"],Sm="documentKeyIndex",qO=["prefixPath","collectionGroup","documentId"],oR="collectionGroupIndex",jO=["collectionGroup","readTime","prefixPath","documentId"],Jd="remoteDocumentGlobal",ev="remoteDocumentGlobalKey",Tc="targets",aR="queryTargetsIndex",BO=["canonicalId","targetId"],xc="targetDocuments",GO=["targetId","path"],I0="documentTargetsIndex",zO=["path","targetId"],Jm="targetGlobalKey",Ma="targetGlobal",Qd="collectionParents",HO=["collectionId","parent"],Ec="clientMetadata",$O="clientId",Dp="bundles",KO="bundleId",Mp="namedQueries",YO="name",S0="indexConfiguration",JO="indexId",tv="collectionGroupIndex",QO="collectionGroup",Rd="indexState",WO=["indexId","uid"],lR="sequenceNumberIndex",XO=["uid","sequenceNumber"],Pd="indexEntries",ZO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],cR="documentKeyIndex",e5=["indexId","uid","orderedDocumentKey"],kp="documentOverlays",t5=["userId","collectionPath","documentId"],nv="collectionPathOverlayIndex",n5=["userId","collectionPath","largestBatchId"],uR="collectionGroupOverlayIndex",i5=["userId","collectionGroup","largestBatchId"],A0="globals",s5="name",dR=[Yd,ts,vc,va,Tc,Th,Ma,xc,Ec,Jd,Qd,Dp,Mp],r5=[...dR,kp],hR=[Yd,ts,vc,Ym,Tc,Th,Ma,xc,Ec,Jd,Qd,Dp,Mp,kp],fR=hR,N0=[...fR,S0,Rd,Pd],o5=N0,mR=[...N0,A0],a5=mR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv extends nR{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function mn(n,e){const t=xe(n);return Us.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Uo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function pR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e,t){this.comparator=e,this.root=t||Nn.EMPTY}insert(e,t){return new bt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Nn.BLACK,null,null))}remove(e){return new bt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fm(this.root,e,this.comparator,!1)}getReverseIterator(){return new fm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fm(this.root,e,this.comparator,!0)}}class fm{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?i(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Nn{constructor(e,t,i,s,a){this.key=e,this.value=t,this.color=i??Nn.RED,this.left=s??Nn.EMPTY,this.right=a??Nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,a){return new Nn(e??this.key,t??this.value,i??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const a=i(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,i),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Nn.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw be(43730,{key:this.key,value:this.value});if(this.right.isRed())throw be(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw be(27949);return e+(this.isRed()?0:1)}}Nn.EMPTY=null,Nn.RED=!0,Nn.BLACK=!1;Nn.EMPTY=new class{constructor(){this.size=0}get key(){throw be(57766)}get value(){throw be(16141)}get color(){throw be(16727)}get left(){throw be(29726)}get right(){throw be(36894)}copy(e,t,i,s,a){return this}insert(e,t,i){return new Nn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this.comparator=e,this.data=new bt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new bI(this.data.getIterator())}getIteratorFrom(e){return new bI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof gt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=i.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new gt(this.comparator);return t.data=e,t}}class bI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function $l(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.fields=e,e.sort(kt.comparator)}static empty(){return new ri([])}unionWith(e){let t=new gt(kt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ri(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return yc(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l5(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new gR("Invalid base64 string: "+a):a}})(e);return new jt(t)}static fromUint8Array(e){const t=(function(s){let a="";for(let l=0;l<s.length;++l)a+=String.fromCharCode(s[l]);return a})(e);return new jt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jt.EMPTY_BYTE_STRING=new jt("");const c5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pr(n){if(Ne(!!n,39018),typeof n=="string"){let e=0;const t=c5.exec(n);if(Ne(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Dt(n.seconds),nanos:Dt(n.nanos)}}function Dt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function gr(n){return typeof n=="string"?jt.fromBase64String(n):jt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yR="server_timestamp",_R="__type__",vR="__previous_value__",TR="__local_write_time__";function Vp(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[_R])==null?void 0:i.stringValue)===yR}function Lp(n){const e=n.mapValue.fields[vR];return Vp(e)?Lp(e):e}function Wd(n){const e=pr(n.mapValue.fields[TR].timestampValue);return new dt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u5{constructor(e,t,i,s,a,l,u,h,m,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=m,this.isUsingEmulator=_}}const sv="(default)";class So{constructor(e,t){this.projectId=e,this.database=t||sv}static empty(){return new So("","")}get isDefaultDatabase(){return this.database===sv}isEqual(e){return e instanceof So&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0="__type__",xR="__max__",mo={mapValue:{fields:{__type__:{stringValue:xR}}}},R0="__vector__",wc="value",Am={nullValue:"NULL_VALUE"};function Ao(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Vp(n)?4:ER(n)?9007199254740991:Up(n)?10:11:be(28295,{value:n})}function Bs(n,e){if(n===e)return!0;const t=Ao(n);if(t!==Ao(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Wd(n).isEqual(Wd(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const l=pr(s.timestampValue),u=pr(a.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,a){return gr(s.bytesValue).isEqual(gr(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,a){return Dt(s.geoPointValue.latitude)===Dt(a.geoPointValue.latitude)&&Dt(s.geoPointValue.longitude)===Dt(a.geoPointValue.longitude)})(n,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return Dt(s.integerValue)===Dt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const l=Dt(s.doubleValue),u=Dt(a.doubleValue);return l===u?Kd(l)===Kd(u):isNaN(l)&&isNaN(u)}return!1})(n,e);case 9:return yc(n.arrayValue.values||[],e.arrayValue.values||[],Bs);case 10:case 11:return(function(s,a){const l=s.mapValue.fields||{},u=a.mapValue.fields||{};if(wI(l)!==wI(u))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(u[h]===void 0||!Bs(l[h],u[h])))return!1;return!0})(n,e);default:return be(52216,{left:n})}}function Xd(n,e){return(n.values||[]).find((t=>Bs(t,e)))!==void 0}function No(n,e){if(n===e)return 0;const t=Ao(n),i=Ao(e);if(t!==i)return Fe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Fe(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const u=Dt(a.integerValue||a.doubleValue),h=Dt(l.integerValue||l.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(n,e);case 3:return II(n.timestampValue,e.timestampValue);case 4:return II(Wd(n),Wd(e));case 5:return X_(n.stringValue,e.stringValue);case 6:return(function(a,l){const u=gr(a),h=gr(l);return u.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const u=a.split("/"),h=l.split("/");for(let m=0;m<u.length&&m<h.length;m++){const _=Fe(u[m],h[m]);if(_!==0)return _}return Fe(u.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const u=Fe(Dt(a.latitude),Dt(l.latitude));return u!==0?u:Fe(Dt(a.longitude),Dt(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return SI(n.arrayValue,e.arrayValue);case 10:return(function(a,l){var E,S,k,V;const u=a.fields||{},h=l.fields||{},m=(E=u[wc])==null?void 0:E.arrayValue,_=(S=h[wc])==null?void 0:S.arrayValue,T=Fe(((k=m==null?void 0:m.values)==null?void 0:k.length)||0,((V=_==null?void 0:_.values)==null?void 0:V.length)||0);return T!==0?T:SI(m,_)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===mo.mapValue&&l===mo.mapValue)return 0;if(a===mo.mapValue)return 1;if(l===mo.mapValue)return-1;const u=a.fields||{},h=Object.keys(u),m=l.fields||{},_=Object.keys(m);h.sort(),_.sort();for(let T=0;T<h.length&&T<_.length;++T){const E=X_(h[T],_[T]);if(E!==0)return E;const S=No(u[h[T]],m[_[T]]);if(S!==0)return S}return Fe(h.length,_.length)})(n.mapValue,e.mapValue);default:throw be(23264,{he:t})}}function II(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Fe(n,e);const t=pr(n),i=pr(e),s=Fe(t.seconds,i.seconds);return s!==0?s:Fe(t.nanos,i.nanos)}function SI(n,e){const t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const a=No(t[s],i[s]);if(a)return a}return Fe(t.length,i.length)}function bc(n){return rv(n)}function rv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=pr(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return gr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ve.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",s=!0;for(const a of t.values||[])s?s=!1:i+=",",i+=rv(a);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const l of i)a?a=!1:s+=",",s+=`${l}:${rv(t.fields[l])}`;return s+"}"})(n.mapValue):be(61005,{value:n})}function Nm(n){switch(Ao(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Lp(n);return e?16+Nm(e):16;case 5:return 2*n.stringValue.length;case 6:return gr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((s,a)=>s+Nm(a)),0)})(n.arrayValue);case 10:case 11:return(function(i){let s=0;return Uo(i.fields,((a,l)=>{s+=a.length+Nm(l)})),s})(n.mapValue);default:throw be(13486,{value:n})}}function Fa(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ov(n){return!!n&&"integerValue"in n}function Zd(n){return!!n&&"arrayValue"in n}function AI(n){return!!n&&"nullValue"in n}function NI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Cm(n){return!!n&&"mapValue"in n}function Up(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[C0])==null?void 0:i.stringValue)===R0}function Dd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Uo(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Dd(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Dd(n.arrayValue.values[t]);return e}return{...n}}function ER(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===xR}const wR={mapValue:{fields:{[C0]:{stringValue:R0},[wc]:{arrayValue:{}}}}};function d5(n){return"nullValue"in n?Am:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Fa(So.empty(),ve.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Up(n)?wR:{mapValue:{}}:be(35942,{value:n})}function h5(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Fa(So.empty(),ve.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?wR:"mapValue"in n?Up(n)?{mapValue:{}}:mo:be(61959,{value:n})}function CI(n,e){const t=No(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function RI(n,e){const t=No(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.value=e}static empty(){return new Cn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Cm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dd(t)}setAll(e){let t=kt.emptyPath(),i={},s=[];e.forEach(((l,u)=>{if(!t.isImmediateParentOf(u)){const h=this.getFieldsMap(t);this.applyChanges(h,i,s),i={},s=[],t=u.popLast()}l?i[u.lastSegment()]=Dd(l):s.push(u.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,i,s)}delete(e){const t=this.field(e.popLast());Cm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Bs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];Cm(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){Uo(t,((s,a)=>e[s]=a));for(const s of i)delete e[s]}clone(){return new Cn(Dd(this.value))}}function bR(n){const e=[];return Uo(n.fields,((t,i)=>{const s=new kt([t]);if(Cm(i)){const a=bR(i.mapValue).fields;if(a.length===0)e.push(s);else for(const l of a)e.push(s.child(l))}else e.push(s)})),new ri(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,t,i,s,a,l,u){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=a,this.data=l,this.documentState=u}static newInvalidDocument(e){return new Nt(e,0,Pe.min(),Pe.min(),Pe.min(),Cn.empty(),0)}static newFoundDocument(e,t,i,s){return new Nt(e,1,t,Pe.min(),i,s,0)}static newNoDocument(e,t){return new Nt(e,2,t,Pe.min(),Pe.min(),Cn.empty(),0)}static newUnknownDocument(e,t){return new Nt(e,3,t,Pe.min(),Pe.min(),Cn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Cn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Cn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,t){this.position=e,this.inclusive=t}}function PI(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const a=e[s],l=n.position[s];if(a.field.isKeyField()?i=ve.comparator(ve.fromName(l.referenceValue),t.key):i=No(l,t.data.field(a.field)),a.dir==="desc"&&(i*=-1),i!==0)break}return i}function DI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Bs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(e,t="asc"){this.field=e,this.dir=t}}function f5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{}class et extends IR{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new m5(e,t,i):t==="array-contains"?new y5(e,i):t==="in"?new PR(e,i):t==="not-in"?new _5(e,i):t==="array-contains-any"?new v5(e,i):new et(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new p5(e,i):new g5(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(No(t,this.value)):t!==null&&Ao(this.value)===Ao(t)&&this.matchesComparison(No(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return be(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pt extends IR{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new pt(e,t)}matches(e){return Ic(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ic(n){return n.op==="and"}function av(n){return n.op==="or"}function P0(n){return SR(n)&&Ic(n)}function SR(n){for(const e of n.filters)if(e instanceof pt)return!1;return!0}function lv(n){if(n instanceof et)return n.field.canonicalString()+n.op.toString()+bc(n.value);if(P0(n))return n.filters.map((e=>lv(e))).join(",");{const e=n.filters.map((t=>lv(t))).join(",");return`${n.op}(${e})`}}function AR(n,e){return n instanceof et?(function(i,s){return s instanceof et&&i.op===s.op&&i.field.isEqual(s.field)&&Bs(i.value,s.value)})(n,e):n instanceof pt?(function(i,s){return s instanceof pt&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((a,l,u)=>a&&AR(l,s.filters[u])),!0):!1})(n,e):void be(19439)}function NR(n,e){const t=n.filters.concat(e);return pt.create(t,n.op)}function CR(n){return n instanceof et?(function(t){return`${t.field.canonicalString()} ${t.op} ${bc(t.value)}`})(n):n instanceof pt?(function(t){return t.op.toString()+" {"+t.getFilters().map(CR).join(" ,")+"}"})(n):"Filter"}class m5 extends et{constructor(e,t,i){super(e,t,i),this.key=ve.fromName(i.referenceValue)}matches(e){const t=ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class p5 extends et{constructor(e,t){super(e,"in",t),this.keys=RR("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class g5 extends et{constructor(e,t){super(e,"not-in",t),this.keys=RR("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function RR(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>ve.fromName(i.referenceValue)))}class y5 extends et{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zd(t)&&Xd(t.arrayValue,this.value)}}class PR extends et{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xd(this.value.arrayValue,t)}}class _5 extends et{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Xd(this.value.arrayValue,t)}}class v5 extends et{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Xd(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T5{constructor(e,t=null,i=[],s=[],a=null,l=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=a,this.startAt=l,this.endAt=u,this.Te=null}}function cv(n,e=null,t=[],i=[],s=null,a=null,l=null){return new T5(n,e,t,i,s,a,l)}function qa(n){const e=xe(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>lv(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(a){return a.field.canonicalString()+a.dir})(i))).join(","),vh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>bc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>bc(i))).join(",")),e.Te=t}return e.Te}function xh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!f5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!AR(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!DI(n.startAt,e.startAt)&&DI(n.endAt,e.endAt)}function Qm(n){return ve.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Wm(n,e){return n.filters.filter((t=>t instanceof et&&t.field.isEqual(e)))}function MI(n,e,t){let i=Am,s=!0;for(const a of Wm(n,e)){let l=Am,u=!0;switch(a.op){case"<":case"<=":l=d5(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,u=!1;break;case"!=":case"not-in":l=Am}CI({value:i,inclusive:s},{value:l,inclusive:u})<0&&(i=l,s=u)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];CI({value:i,inclusive:s},{value:l,inclusive:t.inclusive})<0&&(i=l,s=t.inclusive);break}}return{value:i,inclusive:s}}function kI(n,e,t){let i=mo,s=!0;for(const a of Wm(n,e)){let l=mo,u=!0;switch(a.op){case">=":case">":l=h5(a.value),u=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,u=!1;break;case"!=":case"not-in":l=mo}RI({value:i,inclusive:s},{value:l,inclusive:u})>0&&(i=l,s=u)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];RI({value:i,inclusive:s},{value:l,inclusive:t.inclusive})>0&&(i=l,s=t.inclusive);break}}return{value:i,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,t=null,i=[],s=[],a=null,l="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=a,this.limitType=l,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function DR(n,e,t,i,s,a,l,u){return new xr(n,e,t,i,s,a,l,u)}function Gc(n){return new xr(n)}function VI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function D0(n){return n.collectionGroup!==null}function lc(n){const e=xe(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new gt(kt.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((m=>{m.isInequality()&&(u=u.add(m.field))}))})),u})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new eh(a,i))})),t.has(kt.keyField().canonicalString())||e.Ie.push(new eh(kt.keyField(),i))}return e.Ie}function Kn(n){const e=xe(n);return e.Ee||(e.Ee=x5(e,lc(n))),e.Ee}function x5(n,e){if(n.limitType==="F")return cv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new eh(s.field,a)}));const t=n.endAt?new Co(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Co(n.startAt.position,n.startAt.inclusive):null;return cv(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function uv(n,e){const t=n.filters.concat([e]);return new xr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Xm(n,e,t){return new xr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Eh(n,e){return xh(Kn(n),Kn(e))&&n.limitType===e.limitType}function MR(n){return`${qa(Kn(n))}|lt:${n.limitType}`}function Xl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((s=>CR(s))).join(", ")}]`),vh(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((s=>bc(s))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((s=>bc(s))).join(",")),`Target(${i})`})(Kn(n))}; limitType=${n.limitType})`}function wh(n,e){return e.isFoundDocument()&&(function(i,s){const a=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(a):ve.isDocumentKey(i.path)?i.path.isEqual(a):i.path.isImmediateParentOf(a)})(n,e)&&(function(i,s){for(const a of lc(i))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(i,s){for(const a of i.filters)if(!a.matches(s))return!1;return!0})(n,e)&&(function(i,s){return!(i.startAt&&!(function(l,u,h){const m=PI(l,u,h);return l.inclusive?m<=0:m<0})(i.startAt,lc(i),s)||i.endAt&&!(function(l,u,h){const m=PI(l,u,h);return l.inclusive?m>=0:m>0})(i.endAt,lc(i),s))})(n,e)}function kR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function VR(n){return(e,t)=>{let i=!1;for(const s of lc(n)){const a=E5(s,e,t);if(a!==0)return a;i=i||s.field.isKeyField()}return 0}}function E5(n,e,t){const i=n.field.isKeyField()?ve.comparator(e.key,t.key):(function(a,l,u){const h=l.data.field(a),m=u.data.field(a);return h!==null&&m!==null?No(h,m):be(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return be(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,a]of i)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Uo(this.inner,((t,i)=>{for(const[s,a]of i)e(s,a)}))}isEmpty(){return pR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w5=new bt(ve.comparator);function oi(){return w5}const LR=new bt(ve.comparator);function yd(...n){let e=LR;for(const t of n)e=e.insert(t.key,t);return e}function UR(n){let e=LR;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Ls(){return Md()}function OR(){return Md()}function Md(){return new Er((n=>n.toString()),((n,e)=>n.isEqual(e)))}const b5=new bt(ve.comparator),I5=new gt(ve.comparator);function ze(...n){let e=I5;for(const t of n)e=e.add(t);return e}const S5=new gt(Fe);function M0(){return S5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Kd(e)?"-0":e}}function FR(n){return{integerValue:""+n}}function qR(n,e){return sR(e)?FR(e):k0(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(){this._=void 0}}function A5(n,e,t){return n instanceof Sc?(function(s,a){const l={fields:{[_R]:{stringValue:yR},[TR]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&Vp(a)&&(a=Lp(a)),a&&(l.fields[vR]=a),{mapValue:l}})(t,e):n instanceof ja?BR(n,e):n instanceof Ba?GR(n,e):(function(s,a){const l=jR(s,a),u=LI(l)+LI(s.Ae);return ov(l)&&ov(s.Ae)?FR(u):k0(s.serializer,u)})(n,e)}function N5(n,e,t){return n instanceof ja?BR(n,e):n instanceof Ba?GR(n,e):t}function jR(n,e){return n instanceof Ac?(function(i){return ov(i)||(function(a){return!!a&&"doubleValue"in a})(i)})(e)?e:{integerValue:0}:null}class Sc extends Op{}class ja extends Op{constructor(e){super(),this.elements=e}}function BR(n,e){const t=zR(e);for(const i of n.elements)t.some((s=>Bs(s,i)))||t.push(i);return{arrayValue:{values:t}}}class Ba extends Op{constructor(e){super(),this.elements=e}}function GR(n,e){let t=zR(e);for(const i of n.elements)t=t.filter((s=>!Bs(s,i)));return{arrayValue:{values:t}}}class Ac extends Op{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function LI(n){return Dt(n.integerValue||n.doubleValue)}function zR(n){return Zd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,t){this.field=e,this.transform=t}}function C5(n,e){return n.field.isEqual(e.field)&&(function(i,s){return i instanceof ja&&s instanceof ja||i instanceof Ba&&s instanceof Ba?yc(i.elements,s.elements,Bs):i instanceof Ac&&s instanceof Ac?Bs(i.Ae,s.Ae):i instanceof Sc&&s instanceof Sc})(n.transform,e.transform)}class R5{constructor(e,t){this.version=e,this.transformResults=t}}class Vt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Vt}static exists(e){return new Vt(void 0,e)}static updateTime(e){return new Vt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Rm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Fp{}function HR(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Hc(n.key,Vt.none()):new zc(n.key,n.data,Vt.none());{const t=n.data,i=Cn.empty();let s=new gt(kt.comparator);for(let a of e.fields)if(!s.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?i.delete(a):i.set(a,l),s=s.add(a)}return new wr(n.key,i,new ri(s.toArray()),Vt.none())}}function P5(n,e,t){n instanceof zc?(function(s,a,l){const u=s.value.clone(),h=OI(s.fieldTransforms,a,l.transformResults);u.setAll(h),a.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(n,e,t):n instanceof wr?(function(s,a,l){if(!Rm(s.precondition,a))return void a.convertToUnknownDocument(l.version);const u=OI(s.fieldTransforms,a,l.transformResults),h=a.data;h.setAll($R(s)),h.setAll(u),a.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(n,e,t):(function(s,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function kd(n,e,t,i){return n instanceof zc?(function(a,l,u,h){if(!Rm(a.precondition,l))return u;const m=a.value.clone(),_=FI(a.fieldTransforms,h,l);return m.setAll(_),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null})(n,e,t,i):n instanceof wr?(function(a,l,u,h){if(!Rm(a.precondition,l))return u;const m=FI(a.fieldTransforms,h,l),_=l.data;return _.setAll($R(a)),_.setAll(m),l.convertToFoundDocument(l.version,_).setHasLocalMutations(),u===null?null:u.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((T=>T.field)))})(n,e,t,i):(function(a,l,u){return Rm(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(n,e,t)}function D5(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),a=jR(i.transform,s||null);a!=null&&(t===null&&(t=Cn.empty()),t.set(i.field,a))}return t||null}function UI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&yc(i,s,((a,l)=>C5(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class zc extends Fp{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class wr extends Fp{constructor(e,t,i,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function $R(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function OI(n,e,t){const i=new Map;Ne(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const a=n[s],l=a.transform,u=e.data.field(a.field);i.set(a.field,N5(l,u,t[s]))}return i}function FI(n,e,t){const i=new Map;for(const s of n){const a=s.transform,l=t.data.field(s.field);i.set(s.field,A5(a,l,e))}return i}class Hc extends Fp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class V0 extends Fp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&P5(a,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=kd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=kd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=OR();return this.mutations.forEach((s=>{const a=e.get(s.key),l=a.overlayedDocument;let u=this.applyToLocalView(l,a.mutatedFields);u=t.has(s.key)?null:u;const h=HR(l,u);h!==null&&i.set(s.key,h),l.isValidDocument()||l.convertToNoDocument(Pe.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ze())}isEqual(e){return this.batchId===e.batchId&&yc(this.mutations,e.mutations,((t,i)=>UI(t,i)))&&yc(this.baseMutations,e.baseMutations,((t,i)=>UI(t,i)))}}class U0{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){Ne(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let s=(function(){return b5})();const a=e.mutations;for(let l=0;l<a.length;l++)s=s.insert(a[l].key,i[l].version);return new U0(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var on,it;function KR(n){switch(n){case ie.OK:return be(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return be(15467,{code:n})}}function YR(n){if(n===void 0)return Yt("GRPC error has no .code"),ie.UNKNOWN;switch(n){case on.OK:return ie.OK;case on.CANCELLED:return ie.CANCELLED;case on.UNKNOWN:return ie.UNKNOWN;case on.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case on.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case on.INTERNAL:return ie.INTERNAL;case on.UNAVAILABLE:return ie.UNAVAILABLE;case on.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case on.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case on.NOT_FOUND:return ie.NOT_FOUND;case on.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case on.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case on.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case on.ABORTED:return ie.ABORTED;case on.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case on.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case on.DATA_LOSS:return ie.DATA_LOSS;default:return be(39323,{code:n})}}(it=on||(on={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k5=new vo([4294967295,4294967295],0);function qI(n){const e=JR().encode(n),t=new jC;return t.update(e),new Uint8Array(t.digest())}function jI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new vo([t,i],0),new vo([s,a],0)]}class F0{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new _d(`Invalid padding: ${t}`);if(i<0)throw new _d(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new _d(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new _d(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=vo.fromNumber(this.ge)}ye(e,t,i){let s=e.add(t.multiply(vo.fromNumber(i)));return s.compare(k5)===1&&(s=new vo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=qI(e),[i,s]=jI(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(i,s,a);if(!this.we(l))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new F0(a,s,t);return i.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const t=qI(e),[i,s]=jI(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(i,s,a);this.Se(l)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class _d extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e,t,i,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,Sh.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Ih(Pe.min(),s,new bt(Fe),oi(),ze())}}class Sh{constructor(e,t,i,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Sh(i,t,ze(),ze(),ze())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(e,t,i,s){this.be=e,this.removedTargetIds=t,this.key=i,this.De=s}}class QR{constructor(e,t){this.targetId=e,this.Ce=t}}class WR{constructor(e,t,i=jt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class BI{constructor(){this.ve=0,this.Fe=GI(),this.Me=jt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ze(),t=ze(),i=ze();return this.Fe.forEach(((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:be(38017,{changeType:a})}})),new Sh(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=GI()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ne(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class V5{constructor(e){this.Ge=e,this.ze=new Map,this.je=oi(),this.Je=mm(),this.He=mm(),this.Ye=new bt(Fe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:be(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,i=e.Ce.count,s=this.ot(t);if(s){const a=s.target;if(Qm(a))if(i===0){const l=new ve(a.path);this.et(t,l,Nt.newNoDocument(l,Pe.min()))}else Ne(i===1,20013,{expectedCount:i});else{const l=this._t(t);if(l!==i){const u=this.ut(e),h=u?this.ct(u,e,l):1;if(h!==0){this.it(t);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:a=0}=t;let l,u;try{l=gr(i).toUint8Array()}catch(h){if(h instanceof gR)return js("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new F0(l,s,a)}catch(h){return js(h instanceof _d?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let s=0;return i.forEach((a=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(u)||(this.et(t,a,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((a,l)=>{const u=this.ot(l);if(u){if(a.current&&Qm(u.target)){const h=new ve(u.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,Nt.newNoDocument(h,e))}a.Be&&(t.set(l,a.ke()),a.qe())}}));let i=ze();this.He.forEach(((a,l)=>{let u=!0;l.forEachWhile((h=>{const m=this.ot(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(i=i.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(e)));const s=new Ih(e,t,this.Ye,this.je,i);return this.je=oi(),this.Je=mm(),this.He=mm(),this.Ye=new bt(Fe),s}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new BI,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new gt(Fe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new gt(Fe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||he("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new BI),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function mm(){return new bt(ve.comparator)}function GI(){return new bt(ve.comparator)}const L5={asc:"ASCENDING",desc:"DESCENDING"},U5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},O5={and:"AND",or:"OR"};class F5{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function dv(n,e){return n.useProto3Json||vh(e)?e:{value:e}}function Nc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function XR(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function q5(n,e){return Nc(n,e.toTimestamp())}function Jt(n){return Ne(!!n,49232),Pe.fromTimestamp((function(t){const i=pr(t);return new dt(i.seconds,i.nanos)})(n))}function q0(n,e){return hv(n,e).canonicalString()}function hv(n,e){const t=(function(s){return new We(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function ZR(n){const e=We.fromString(n);return Ne(c1(e),10190,{key:e.toString()}),e}function th(n,e){return q0(n.databaseId,e.path)}function Os(n,e){const t=ZR(e);if(t.get(1)!==n.databaseId.projectId)throw new de(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new de(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ve(n1(t))}function e1(n,e){return q0(n.databaseId,e)}function t1(n){const e=ZR(n);return e.length===4?We.emptyPath():n1(e)}function fv(n){return new We(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function n1(n){return Ne(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function zI(n,e,t){return{name:th(n,e),fields:t.value.mapValue.fields}}function i1(n,e,t){const i=Os(n,e.name),s=Jt(e.updateTime),a=e.createTime?Jt(e.createTime):Pe.min(),l=new Cn({mapValue:{fields:e.fields}}),u=Nt.newFoundDocument(i,s,a,l);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function j5(n,e){return"found"in e?(function(i,s){Ne(!!s.found,43571),s.found.name,s.found.updateTime;const a=Os(i,s.found.name),l=Jt(s.found.updateTime),u=s.found.createTime?Jt(s.found.createTime):Pe.min(),h=new Cn({mapValue:{fields:s.found.fields}});return Nt.newFoundDocument(a,l,u,h)})(n,e):"missing"in e?(function(i,s){Ne(!!s.missing,3894),Ne(!!s.readTime,22933);const a=Os(i,s.missing),l=Jt(s.readTime);return Nt.newNoDocument(a,l)})(n,e):be(7234,{result:e})}function B5(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:be(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=(function(m,_){return m.useProto3Json?(Ne(_===void 0||typeof _=="string",58123),jt.fromBase64String(_||"")):(Ne(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),jt.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(m){const _=m.code===void 0?ie.UNKNOWN:YR(m.code);return new de(_,m.message||"")})(l);t=new WR(i,s,a,u||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=Os(n,i.document.name),a=Jt(i.document.updateTime),l=i.document.createTime?Jt(i.document.createTime):Pe.min(),u=new Cn({mapValue:{fields:i.document.fields}}),h=Nt.newFoundDocument(s,a,l,u),m=i.targetIds||[],_=i.removedTargetIds||[];t=new Pm(m,_,h.key,h)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=Os(n,i.document),a=i.readTime?Jt(i.readTime):Pe.min(),l=Nt.newNoDocument(s,a),u=i.removedTargetIds||[];t=new Pm([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=Os(n,i.document),a=i.removedTargetIds||[];t=new Pm([],a,s,null)}else{if(!("filter"in e))return be(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:a}=i,l=new M5(s,a),u=i.targetId;t=new QR(u,l)}}return t}function nh(n,e){let t;if(e instanceof zc)t={update:zI(n,e.key,e.value)};else if(e instanceof Hc)t={delete:th(n,e.key)};else if(e instanceof wr)t={update:zI(n,e.key,e.data),updateMask:Y5(e.fieldMask)};else{if(!(e instanceof V0))return be(16599,{Vt:e.type});t={verify:th(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(a,l){const u=l.transform;if(u instanceof Sc)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof ja)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Ba)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Ac)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw be(20930,{transform:l.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(s,a){return a.updateTime!==void 0?{updateTime:q5(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:be(27497)})(n,e.precondition)),t}function mv(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?Vt.updateTime(Jt(a.updateTime)):a.exists!==void 0?Vt.exists(a.exists):Vt.none()})(e.currentDocument):Vt.none(),i=e.updateTransforms?e.updateTransforms.map((s=>(function(l,u){let h=null;if("setToServerValue"in u)Ne(u.setToServerValue==="REQUEST_TIME",16630,{proto:u}),h=new Sc;else if("appendMissingElements"in u){const _=u.appendMissingElements.values||[];h=new ja(_)}else if("removeAllFromArray"in u){const _=u.removeAllFromArray.values||[];h=new Ba(_)}else"increment"in u?h=new Ac(l,u.increment):be(16584,{proto:u});const m=kt.fromServerFormat(u.fieldPath);return new bh(m,h)})(n,s))):[];if(e.update){e.update.name;const s=Os(n,e.update.name),a=new Cn({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(h){const m=h.fieldPaths||[];return new ri(m.map((_=>kt.fromServerFormat(_))))})(e.updateMask);return new wr(s,a,l,t,i)}return new zc(s,a,t,i)}if(e.delete){const s=Os(n,e.delete);return new Hc(s,t)}if(e.verify){const s=Os(n,e.verify);return new V0(s,t)}return be(1463,{proto:e})}function G5(n,e){return n&&n.length>0?(Ne(e!==void 0,14353),n.map((t=>(function(s,a){let l=s.updateTime?Jt(s.updateTime):Jt(a);return l.isEqual(Pe.min())&&(l=Jt(a)),new R5(l,s.transformResults||[])})(t,e)))):[]}function s1(n,e){return{documents:[e1(n,e.path)]}}function r1(n,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=e1(n,s);const a=(function(m){if(m.length!==0)return l1(pt.create(m,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(m){if(m.length!==0)return m.map((_=>(function(E){return{field:Zl(E.field),direction:H5(E.dir)}})(_)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const u=dv(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:s}}function o1(n){let e=t1(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){Ne(i===1,65062);const _=t.from[0];_.allDescendants?s=_.collectionId:e=e.child(_.collectionId)}let a=[];t.where&&(a=(function(T){const E=a1(T);return E instanceof pt&&P0(E)?E.getFilters():[E]})(t.where));let l=[];t.orderBy&&(l=(function(T){return T.map((E=>(function(k){return new eh(ec(k.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(E)))})(t.orderBy));let u=null;t.limit&&(u=(function(T){let E;return E=typeof T=="object"?T.value:T,vh(E)?null:E})(t.limit));let h=null;t.startAt&&(h=(function(T){const E=!!T.before,S=T.values||[];return new Co(S,E)})(t.startAt));let m=null;return t.endAt&&(m=(function(T){const E=!T.before,S=T.values||[];return new Co(S,E)})(t.endAt)),DR(e,s,l,a,u,"F",h,m)}function z5(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return be(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function a1(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ec(t.unaryFilter.field);return et.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=ec(t.unaryFilter.field);return et.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ec(t.unaryFilter.field);return et.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=ec(t.unaryFilter.field);return et.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return be(61313);default:return be(60726)}})(n):n.fieldFilter!==void 0?(function(t){return et.create(ec(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return be(58110);default:return be(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return pt.create(t.compositeFilter.filters.map((i=>a1(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return be(1026)}})(t.compositeFilter.op))})(n):be(30097,{filter:n})}function H5(n){return L5[n]}function $5(n){return U5[n]}function K5(n){return O5[n]}function Zl(n){return{fieldPath:n.canonicalString()}}function ec(n){return kt.fromServerFormat(n.fieldPath)}function l1(n){return n instanceof et?(function(t){if(t.op==="=="){if(NI(t.value))return{unaryFilter:{field:Zl(t.field),op:"IS_NAN"}};if(AI(t.value))return{unaryFilter:{field:Zl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(NI(t.value))return{unaryFilter:{field:Zl(t.field),op:"IS_NOT_NAN"}};if(AI(t.value))return{unaryFilter:{field:Zl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zl(t.field),op:$5(t.op),value:t.value}}})(n):n instanceof pt?(function(t){const i=t.getFilters().map((s=>l1(s)));return i.length===1?i[0]:{compositeFilter:{op:K5(t.op),filters:i}}})(n):be(54877,{filter:n})}function Y5(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function c1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e,t,i,s,a=Pe.min(),l=Pe.min(),u=jt.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new cr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new cr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e){this.yt=e}}function J5(n,e){let t;if(e.document)t=i1(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=ve.fromSegments(e.noDocument.path),s=za(e.noDocument.readTime);t=Nt.newNoDocument(i,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return be(56709);{const i=ve.fromSegments(e.unknownDocument.path),s=za(e.unknownDocument.version);t=Nt.newUnknownDocument(i,s)}}return e.readTime&&t.setReadTime((function(s){const a=new dt(s[0],s[1]);return Pe.fromTimestamp(a)})(e.readTime)),t}function HI(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Zm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(a,l){return{name:th(a,l.key),fields:l.data.value.mapValue.fields,updateTime:Nc(a,l.version.toTimestamp()),createTime:Nc(a,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Ga(e.version)};else{if(!e.isUnknownDocument())return be(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Ga(e.version)}}return i}function Zm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ga(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function za(n){const e=new dt(n.seconds,n.nanoseconds);return Pe.fromTimestamp(e)}function xa(n,e){const t=(e.baseMutations||[]).map((a=>mv(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const u=e.mutations[a+1];l.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const i=e.mutations.map((a=>mv(n.yt,a))),s=dt.fromMillis(e.localWriteTimeMs);return new L0(e.batchId,s,t,i)}function vd(n){const e=za(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?za(n.lastLimboFreeSnapshotVersion):Pe.min();let i;return i=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return Ne(l===1,1966,{count:l}),Kn(Gc(t1(a.documents[0])))})(n.query):(function(a){return Kn(o1(a))})(n.query),new cr(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,jt.fromBase64String(n.resumeToken))}function d1(n,e){const t=Ga(e.snapshotVersion),i=Ga(e.lastLimboFreeSnapshotVersion);let s;s=Qm(e.target)?s1(n.yt,e.target):r1(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:qa(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:s}}function j0(n){const e=o1({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Xm(e,e.limit,"L"):e}function R_(n,e){return new O0(e.largestBatchId,mv(n.yt,e.overlayMutation))}function $I(n,e){const t=e.path.lastSegment();return[n,Fn(e.path.popLast()),t]}function KI(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ga(i.readTime),documentKey:Fn(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{getBundleMetadata(e,t){return YI(e).get(t).next((i=>{if(i)return(function(a){return{id:a.bundleId,createTime:za(a.createTime),version:a.version}})(i)}))}saveBundleMetadata(e,t){return YI(e).put((function(s){return{bundleId:s.id,createTime:Ga(Jt(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return JI(e).get(t).next((i=>{if(i)return(function(a){return{name:a.name,query:j0(a.bundledQuery),readTime:za(a.readTime)}})(i)}))}saveNamedQuery(e,t){return JI(e).put((function(s){return{name:s.name,readTime:Ga(Jt(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function YI(n){return mn(n,Dp)}function JI(n){return mn(n,Mp)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new qp(e,i)}getOverlay(e,t){return ad(e).get($I(this.userId,t)).next((i=>i?R_(this.serializer,i):null))}getOverlays(e,t){const i=Ls();return Q.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&i.set(s,a)})))).next((()=>i))}saveOverlays(e,t,i){const s=[];return i.forEach(((a,l)=>{const u=new O0(t,l);s.push(this.St(e,u))})),Q.waitFor(s)}removeOverlaysForBatchId(e,t,i){const s=new Set;t.forEach((l=>s.add(Fn(l.getCollectionPath()))));const a=[];return s.forEach((l=>{const u=IDBKeyRange.bound([this.userId,l,i],[this.userId,l,i+1],!1,!0);a.push(ad(e).Z(nv,u))})),Q.waitFor(a)}getOverlaysForCollection(e,t,i){const s=Ls(),a=Fn(t),l=IDBKeyRange.bound([this.userId,a,i],[this.userId,a,Number.POSITIVE_INFINITY],!0);return ad(e).J(nv,l).next((u=>{for(const h of u){const m=R_(this.serializer,h);s.set(m.getKey(),m)}return s}))}getOverlaysForCollectionGroup(e,t,i,s){const a=Ls();let l;const u=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ad(e).ee({index:uR,range:u},((h,m,_)=>{const T=R_(this.serializer,m);a.size()<s||T.largestBatchId===l?(a.set(T.getKey(),T),l=T.largestBatchId):_.done()})).next((()=>a))}St(e,t){return ad(e).put((function(s,a,l){const[u,h,m]=$I(a,l.mutation.key);return{userId:a,collectionPath:h,documentId:m,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:nh(s.yt,l.mutation)}})(this.serializer,this.userId,t))}}function ad(n){return mn(n,kp)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{bt(e){return mn(e,A0)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t==null?void 0:t.value;return i?jt.fromUint8Array(i):jt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Dt(e.integerValue));else if("doubleValue"in e){const i=Dt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Kd(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=pr(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(gr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?ER(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Up(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):be(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const s of Object.keys(i))this.Ot(s,t),this.Ct(i[s],t)}kt(e,t){var l,u;const i=e.fields||{};this.Ft(t,53);const s=wc,a=((u=(l=i[s].arrayValue)==null?void 0:l.values)==null?void 0:u.length)||0;this.Ft(t,15),t.Mt(Dt(a)),this.Ot(s,t),this.Ct(i[s],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const s of i)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),ve.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Ea.Kt=new Ea;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kl=255;function X5(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function QI(n){const e=64-(function(i){let s=0;for(let a=0;a<8;++a){const l=X5(255&i[a]);if(s+=l,l!==8)break}return s})(n);return Math.ceil(e/8)}class Z5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const t=this.en(e),i=QI(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),i=QI(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(Kl),this.sn(255)}_n(){this.an(Kl),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let s=1;s<t.length;++s)t[s]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Kl?(this.sn(Kl),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Kl?(this.an(Kl),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const s=new Uint8Array(i);s.set(this.buffer),this.buffer=s}}class e6{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class t6{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class ld{constructor(){this.cn=new Z5,this.ln=new e6(this.cn),this.hn=new t6(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,t,i,s){this.Tn=e,this.In=t,this.En=i,this.dn=s}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new wa(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Dm(this.En),directionalValue:Dm(this.dn),orderedDocumentKey:Dm(t),documentKey:i.path.toArray()}}Vn(e,t,i){const s=this.Rn(e,t,i);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function ao(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=WI(n.En,e.En),t!==0?t:(t=WI(n.dn,e.dn),t!==0?t:ve.comparator(n.In,e.In)))}function WI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Dm(n){return AN()?(function(t){let i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(t[s]);return i})(n):n}function XI(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(n)}class ZI{constructor(e){this.mn=new gt(((t,i)=>kt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Ne(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Z_(e);if(t!==void 0&&!this.wn(t))return!1;const i=_a(e);let s=new Set,a=0,l=0;for(;a<i.length&&this.wn(i[a]);++a)s=s.add(i[a].fieldPath.canonicalString());if(a===i.length)return!0;if(this.mn.size>0){const u=this.mn.getIterator().getNext();if(!s.has(u.field.canonicalString())){const h=i[a];if(!this.Sn(u,h)||!this.bn(this.fn[l++],h))return!1}++a}for(;a<i.length;++a){const u=i[a];if(l>=this.fn.length||!this.bn(this.fn[l++],u))return!1}return!0}Dn(){if(this.pn)return null;let e=new gt(kt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new bm(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new bm(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new bm(i.field,i.dir==="asc"?0:1)));return new $m($m.UNKNOWN_ID,this.collectionId,t,$d.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(n){var t,i;if(Ne(n instanceof et||n instanceof pt,20012),n instanceof et){if(n instanceof PR){const s=((i=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:i.map((a=>et.create(n.field,"==",a))))||[];return pt.create(s,"or")}return n}const e=n.filters.map((s=>h1(s)));return pt.create(e,n.op)}function n6(n){if(n.getFilters().length===0)return[];const e=yv(h1(n));return Ne(f1(e),7391),pv(e)||gv(e)?[e]:e.getFilters()}function pv(n){return n instanceof et}function gv(n){return n instanceof pt&&P0(n)}function f1(n){return pv(n)||gv(n)||(function(t){if(t instanceof pt&&av(t)){for(const i of t.getFilters())if(!pv(i)&&!gv(i))return!1;return!0}return!1})(n)}function yv(n){if(Ne(n instanceof et||n instanceof pt,34018),n instanceof et)return n;if(n.filters.length===1)return yv(n.filters[0]);const e=n.filters.map((i=>yv(i)));let t=pt.create(e,n.op);return t=ep(t),f1(t)?t:(Ne(t instanceof pt,64498),Ne(Ic(t),40251),Ne(t.filters.length>1,57927),t.filters.reduce(((i,s)=>B0(i,s))))}function B0(n,e){let t;return Ne(n instanceof et||n instanceof pt,38388),Ne(e instanceof et||e instanceof pt,25473),t=n instanceof et?e instanceof et?(function(s,a){return pt.create([s,a],"and")})(n,e):eS(n,e):e instanceof et?eS(e,n):(function(s,a){if(Ne(s.filters.length>0&&a.filters.length>0,48005),Ic(s)&&Ic(a))return NR(s,a.getFilters());const l=av(s)?s:a,u=av(s)?a:s,h=l.filters.map((m=>B0(m,u)));return pt.create(h,"or")})(n,e),ep(t)}function eS(n,e){if(Ic(e))return NR(e,n.getFilters());{const t=e.filters.map((i=>B0(n,i)));return pt.create(t,"or")}}function ep(n){if(Ne(n instanceof et||n instanceof pt,11850),n instanceof et)return n;const e=n.getFilters();if(e.length===1)return ep(e[0]);if(SR(n))return n;const t=e.map((s=>ep(s))),i=[];return t.forEach((s=>{s instanceof et?i.push(s):s instanceof pt&&(s.op===n.op?i.push(...s.filters):i.push(s))})),i.length===1?i[0]:pt.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(){this.Cn=new G0}addToCollectionParentIndex(e,t){return this.Cn.add(t),Q.resolve()}getCollectionParents(e,t){return Q.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Q.resolve()}deleteFieldIndex(e,t){return Q.resolve()}deleteAllFieldIndexes(e){return Q.resolve()}createTargetIndexes(e,t){return Q.resolve()}getDocumentsMatchingTarget(e,t){return Q.resolve(null)}getIndexType(e,t){return Q.resolve(0)}getFieldIndexes(e,t){return Q.resolve([])}getNextCollectionGroupToUpdate(e){return Q.resolve(null)}getMinOffset(e,t){return Q.resolve(wi.min())}getMinOffsetFromCollectionGroup(e,t){return Q.resolve(wi.min())}updateCollectionGroup(e,t,i){return Q.resolve()}updateIndexEntries(e,t){return Q.resolve()}}class G0{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new gt(We.comparator),a=!s.has(i);return this.index[t]=s.add(i),a}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new gt(We.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS="IndexedDbIndexManager",pm=new Uint8Array(0);class s6{constructor(e,t){this.databaseId=t,this.vn=new G0,this.Fn=new Er((i=>qa(i)),((i,s)=>xh(i,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:i,parent:Fn(s)};return nS(e).put(a)}return Q.resolve()}getCollectionParents(e,t){const i=[],s=IDBKeyRange.bound([t,""],[JC(t),""],!1,!0);return nS(e).J(s).next((a=>{for(const l of a){if(l.collectionId!==t)break;i.push(Vs(l.parent))}return i}))}addFieldIndex(e,t){const i=cd(e),s=(function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map((h=>[h.fieldPath.canonicalString(),h.kind]))}})(t);delete s.indexId;const a=i.add(s);if(t.indexState){const l=Jl(e);return a.next((u=>{l.put(KI(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const i=cd(e),s=Jl(e),a=Yl(e);return i.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=cd(e),i=Yl(e),s=Jl(e);return t.Z().next((()=>i.Z())).next((()=>s.Z()))}createTargetIndexes(e,t){return Q.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((s=>{if(s===0||s===1){const a=new ZI(i).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const i=Yl(e);let s=!0;const a=new Map;return Q.forEach(this.Mn(t),(l=>this.xn(e,l).next((u=>{s&&(s=!!u),a.set(l,u)})))).next((()=>{if(s){let l=ze();const u=[];return Q.forEach(a,((h,m)=>{he(tS,`Using index ${(function($){return`id=${$.indexId}|cg=${$.collectionGroup}|f=${$.fields.map((U=>`${U.fieldPath}:${U.kind}`)).join(",")}`})(h)} to execute ${qa(t)}`);const _=(function($,U){const K=Z_(U);if(K===void 0)return null;for(const J of Wm($,K.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null})(m,h),T=(function($,U){const K=new Map;for(const J of _a(U))for(const R of Wm($,J.fieldPath))switch(R.op){case"==":case"in":K.set(J.fieldPath.canonicalString(),R.value);break;case"not-in":case"!=":return K.set(J.fieldPath.canonicalString(),R.value),Array.from(K.values())}return null})(m,h),E=(function($,U){const K=[];let J=!0;for(const R of _a(U)){const A=R.kind===0?MI($,R.fieldPath,$.startAt):kI($,R.fieldPath,$.startAt);K.push(A.value),J&&(J=A.inclusive)}return new Co(K,J)})(m,h),S=(function($,U){const K=[];let J=!0;for(const R of _a(U)){const A=R.kind===0?kI($,R.fieldPath,$.endAt):MI($,R.fieldPath,$.endAt);K.push(A.value),J&&(J=A.inclusive)}return new Co(K,J)})(m,h),k=this.On(h,m,E),V=this.On(h,m,S),O=this.Nn(h,m,T),j=this.Bn(h.indexId,_,k,E.inclusive,V,S.inclusive,O);return Q.forEach(j,(W=>i.Y(W,t.limit).next(($=>{$.forEach((U=>{const K=ve.fromSegments(U.documentKey);l.has(K)||(l=l.add(K),u.push(K))}))}))))})).next((()=>u))}return Q.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=n6(pt.create(e.filters,"and")).map((i=>cv(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,s,a,l,u){const h=(t!=null?t.length:1)*Math.max(i.length,a.length),m=h/(t!=null?t.length:1),_=[];for(let T=0;T<h;++T){const E=t?this.Ln(t[T/m]):pm,S=this.kn(e,E,i[T%m],s),k=this.qn(e,E,a[T%m],l),V=u.map((O=>this.kn(e,E,O,!0)));_.push(...this.createRange(S,k,V))}return _}kn(e,t,i,s){const a=new wa(e,ve.empty(),t,i);return s?a:a.An()}qn(e,t,i,s){const a=new wa(e,ve.empty(),t,i);return s?a.An():a}xn(e,t){const i=new ZI(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((a=>{let l=null;for(const u of a)i.yn(u)&&(!l||u.fields.length>l.fields.length)&&(l=u);return l}))}getIndexType(e,t){let i=2;const s=this.Mn(t);return Q.forEach(s,(a=>this.xn(e,a).next((l=>{l?i!==0&&l.fields.length<(function(h){let m=new gt(kt.comparator),_=!1;for(const T of h.filters)for(const E of T.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?_=!0:m=m.add(E.field));for(const T of h.orderBy)T.field.isKeyField()||(m=m.add(T.field));return m.size+(_?1:0)})(a)&&(i=1):i=0})))).next((()=>(function(l){return l.limit!==null})(t)&&s.length>1&&i===2?1:i))}Qn(e,t){const i=new ld;for(const s of _a(e)){const a=t.data.field(s.fieldPath);if(a==null)return null;const l=i.Pn(s.kind);Ea.Kt.Dt(a,l)}return i.un()}Ln(e){const t=new ld;return Ea.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new ld;return Ea.Kt.Dt(Fa(this.databaseId,t),i.Pn((function(a){const l=_a(a);return l.length===0?0:l[l.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let s=[];s.push(new ld);let a=0;for(const l of _a(e)){const u=i[a++];for(const h of s)if(this.Un(t,l.fieldPath)&&Zd(u))s=this.Kn(s,l,u);else{const m=h.Pn(l.kind);Ea.Kt.Dt(u,m)}}return this.Wn(s)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const s=[...e],a=[];for(const l of i.arrayValue.values||[])for(const u of s){const h=new ld;h.seed(u.un()),Ea.Kt.Dt(l,h.Pn(t.kind)),a.push(h)}return a}Un(e,t){return!!e.filters.find((i=>i instanceof et&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=cd(e),s=Jl(e);return(t?i.J(tv,IDBKeyRange.bound(t,t)):i.J()).next((a=>{const l=[];return Q.forEach(a,(u=>s.get([u.indexId,this.uid]).next((h=>{l.push((function(_,T){const E=T?new $d(T.sequenceNumber,new wi(za(T.readTime),new ve(Vs(T.documentKey)),T.largestBatchId)):$d.empty(),S=_.fields.map((([k,V])=>new bm(kt.fromServerFormat(k),V)));return new $m(_.indexId,_.collectionGroup,S,E)})(u,h))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,s)=>{const a=i.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:Fe(i.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const s=cd(e),a=Jl(e);return this.Gn(e).next((l=>s.J(tv,IDBKeyRange.bound(t,t)).next((u=>Q.forEach(u,(h=>a.put(KI(h.indexId,this.uid,l,i))))))))}updateIndexEntries(e,t){const i=new Map;return Q.forEach(t,((s,a)=>{const l=i.get(s.collectionGroup);return(l?Q.resolve(l):this.getFieldIndexes(e,s.collectionGroup)).next((u=>(i.set(s.collectionGroup,u),Q.forEach(u,(h=>this.zn(e,s,h).next((m=>{const _=this.jn(a,h);return m.isEqual(_)?Q.resolve():this.Jn(e,a,h,m,_)})))))))}))}Hn(e,t,i,s){return Yl(e).put(s.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,s){return Yl(e).delete(s.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const s=Yl(e);let a=new gt(ao);return s.ee({index:cR,range:IDBKeyRange.only([i.indexId,this.uid,Dm(this.$n(i,t))])},((l,u)=>{a=a.add(new wa(i.indexId,t,XI(u.arrayValue),XI(u.directionalValue)))})).next((()=>a))}jn(e,t){let i=new gt(ao);const s=this.Qn(t,e);if(s==null)return i;const a=Z_(t);if(a!=null){const l=e.data.field(a.fieldPath);if(Zd(l))for(const u of l.arrayValue.values||[])i=i.add(new wa(t.indexId,e.key,this.Ln(u),s))}else i=i.add(new wa(t.indexId,e.key,pm,s));return i}Jn(e,t,i,s,a){he(tS,"Updating index entries for document '%s'",t.key);const l=[];return(function(h,m,_,T,E){const S=h.getIterator(),k=m.getIterator();let V=$l(S),O=$l(k);for(;V||O;){let j=!1,W=!1;if(V&&O){const $=_(V,O);$<0?W=!0:$>0&&(j=!0)}else V!=null?W=!0:j=!0;j?(T(O),O=$l(k)):W?(E(V),V=$l(S)):(V=$l(S),O=$l(k))}})(s,a,ao,(u=>{l.push(this.Hn(e,t,i,u))}),(u=>{l.push(this.Yn(e,t,i,u))})),Q.waitFor(l)}Gn(e){let t=1;return Jl(e).ee({index:lR,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,s,a)=>{a.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((l,u)=>ao(l,u))).filter(((l,u,h)=>!u||ao(l,h[u-1])!==0));const s=[];s.push(e);for(const l of i){const u=ao(l,e),h=ao(l,t);if(u===0)s[0]=e.An();else if(u>0&&h<0)s.push(l),s.push(l.An());else if(h>0)break}s.push(t);const a=[];for(let l=0;l<s.length;l+=2){if(this.Zn(s[l],s[l+1]))return[];const u=s[l].Vn(this.uid,pm,ve.empty()),h=s[l+1].Vn(this.uid,pm,ve.empty());a.push(IDBKeyRange.bound(u,h))}return a}Zn(e,t){return ao(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(iS)}getMinOffset(e,t){return Q.mapArray(this.Mn(t),(i=>this.xn(e,i).next((s=>s||be(44426))))).next(iS)}}function nS(n){return mn(n,Qd)}function Yl(n){return mn(n,Pd)}function cd(n){return mn(n,S0)}function Jl(n){return mn(n,Rd)}function iS(n){Ne(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const s=n[i].indexState.offset;w0(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new wi(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sS={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},m1=41943040;class Vn{static withCacheSize(e){return new Vn(e,Vn.DEFAULT_COLLECTION_PERCENTILE,Vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p1(n,e,t){const i=n.store(ts),s=n.store(vc),a=[],l=IDBKeyRange.only(t.batchId);let u=0;const h=i.ee({range:l},((_,T,E)=>(u++,E.delete())));a.push(h.next((()=>{Ne(u===1,47070,{batchId:t.batchId})})));const m=[];for(const _ of t.mutations){const T=rR(e,_.key.path,t.batchId);a.push(s.delete(T)),m.push(_.key)}return Q.waitFor(a).next((()=>m))}function tp(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw be(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vn.DEFAULT_COLLECTION_PERCENTILE=10,Vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vn.DEFAULT=new Vn(m1,Vn.DEFAULT_COLLECTION_PERCENTILE,Vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vn.DISABLED=new Vn(-1,0,0);class jp{constructor(e,t,i,s){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=s,this.Xn={}}static wt(e,t,i,s){Ne(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new jp(a,t,i,s)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return lo(e).ee({index:Aa,range:i},((s,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,i,s){const a=tc(e),l=lo(e);return l.add({}).next((u=>{Ne(typeof u=="number",49019);const h=new L0(u,t,i,s),m=(function(S,k,V){const O=V.baseMutations.map((W=>nh(S.yt,W))),j=V.mutations.map((W=>nh(S.yt,W)));return{userId:k,batchId:V.batchId,localWriteTimeMs:V.localWriteTime.toMillis(),baseMutations:O,mutations:j}})(this.serializer,this.userId,h),_=[];let T=new gt(((E,S)=>Fe(E.canonicalString(),S.canonicalString())));for(const E of s){const S=rR(this.userId,E.key.path,u);T=T.add(E.key.path.popLast()),_.push(l.put(m)),_.push(a.put(S,OO))}return T.forEach((E=>{_.push(this.indexManager.addToCollectionParentIndex(e,E))})),e.addOnCommittedListener((()=>{this.Xn[u]=h.keys()})),Q.waitFor(_).next((()=>h))}))}lookupMutationBatch(e,t){return lo(e).get(t).next((i=>i?(Ne(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),xa(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Q.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const s=i.keys();return this.Xn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=IDBKeyRange.lowerBound([this.userId,i]);let a=null;return lo(e).ee({index:Aa,range:s},((l,u,h)=>{u.userId===this.userId&&(Ne(u.batchId>=i,47524,{tr:i}),a=xa(this.serializer,u)),h.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=To;return lo(e).ee({index:Aa,range:t,reverse:!0},((s,a,l)=>{i=a.batchId,l.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,To],[this.userId,Number.POSITIVE_INFINITY]);return lo(e).J(Aa,t).next((i=>i.map((s=>xa(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Im(this.userId,t.path),s=IDBKeyRange.lowerBound(i),a=[];return tc(e).ee({range:s},((l,u,h)=>{const[m,_,T]=l,E=Vs(_);if(m===this.userId&&t.path.isEqual(E))return lo(e).get(T).next((S=>{if(!S)throw be(61480,{nr:l,batchId:T});Ne(S.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:S.userId,batchId:T}),a.push(xa(this.serializer,S))}));h.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new gt(Fe);const s=[];return t.forEach((a=>{const l=Im(this.userId,a.path),u=IDBKeyRange.lowerBound(l),h=tc(e).ee({range:u},((m,_,T)=>{const[E,S,k]=m,V=Vs(S);E===this.userId&&a.path.isEqual(V)?i=i.add(k):T.done()}));s.push(h)})),Q.waitFor(s).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1,a=Im(this.userId,i),l=IDBKeyRange.lowerBound(a);let u=new gt(Fe);return tc(e).ee({range:l},((h,m,_)=>{const[T,E,S]=h,k=Vs(E);T===this.userId&&i.isPrefixOf(k)?k.length===s&&(u=u.add(S)):_.done()})).next((()=>this.rr(e,u)))}rr(e,t){const i=[],s=[];return t.forEach((a=>{s.push(lo(e).get(a).next((l=>{if(l===null)throw be(35274,{batchId:a});Ne(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),i.push(xa(this.serializer,l))})))})),Q.waitFor(s).next((()=>i))}removeMutationBatch(e,t){return p1(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Q.forEach(i,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Q.resolve();const i=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),s=[];return tc(e).ee({range:i},((a,l,u)=>{if(a[0]===this.userId){const h=Vs(a[1]);s.push(h)}else u.done()})).next((()=>{Ne(s.length===0,56720,{sr:s.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return g1(e,this.userId,t)}_r(e){return y1(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:To,lastStreamToken:""}))}}function g1(n,e,t){const i=Im(e,t.path),s=i[1],a=IDBKeyRange.lowerBound(i);let l=!1;return tc(n).ee({range:a,X:!0},((u,h,m)=>{const[_,T,E]=u;_===e&&T===s&&(l=!0),m.done()})).next((()=>l))}function lo(n){return mn(n,ts)}function tc(n){return mn(n,vc)}function y1(n){return mn(n,Yd)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ha(0)}static cr(){return new Ha(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Ha(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Pe.fromTimestamp(new dt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((s=>(s.highestListenSequenceNumber=t,i&&(s.lastRemoteSnapshotVersion=i.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.hr(e,s))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Ql(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Ne(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let s=0;const a=[];return Ql(e).ee(((l,u)=>{const h=vd(u);h.sequenceNumber<=t&&i.get(h.targetId)===null&&(s++,a.push(this.removeTargetData(e,h)))})).next((()=>Q.waitFor(a))).next((()=>s))}forEachTarget(e,t){return Ql(e).ee(((i,s)=>{const a=vd(s);t(a)}))}lr(e){return rS(e).get(Jm).next((t=>(Ne(t!==null,2888),t)))}hr(e,t){return rS(e).put(Jm,t)}Pr(e,t){return Ql(e).put(d1(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=qa(t),s=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let a=null;return Ql(e).ee({range:s,index:aR},((l,u,h)=>{const m=vd(u);xh(t,m.target)&&(a=m,h.done())})).next((()=>a))}addMatchingKeys(e,t,i){const s=[],a=ho(e);return t.forEach((l=>{const u=Fn(l.path);s.push(a.put({targetId:i,path:u})),s.push(this.referenceDelegate.addReference(e,i,l))})),Q.waitFor(s)}removeMatchingKeys(e,t,i){const s=ho(e);return Q.forEach(t,(a=>{const l=Fn(a.path);return Q.waitFor([s.delete([i,l]),this.referenceDelegate.removeReference(e,i,a)])}))}removeMatchingKeysForTargetId(e,t){const i=ho(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(s)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),s=ho(e);let a=ze();return s.ee({range:i,X:!0},((l,u,h)=>{const m=Vs(l[1]),_=new ve(m);a=a.add(_)})).next((()=>a))}containsKey(e,t){const i=Fn(t.path),s=IDBKeyRange.bound([i],[JC(i)],!1,!0);let a=0;return ho(e).ee({index:I0,X:!0,range:s},(([l,u],h,m)=>{l!==0&&(a++,m.done())})).next((()=>a>0))}At(e,t){return Ql(e).get(t).next((i=>i?vd(i):null))}}function Ql(n){return mn(n,Tc)}function rS(n){return mn(n,Ma)}function ho(n){return mn(n,xc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS="LruGarbageCollector",o6=1048576;function aS([n,e],[t,i]){const s=Fe(n,t);return s===0?Fe(e,i):s}class a6{constructor(e){this.Ir=e,this.buffer=new gt(aS),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();aS(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class _1{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){he(oS,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Lo(t)?he(oS,"Ignoring IndexedDB error during garbage collection: ",t):await Vo(t)}await this.Vr(3e5)}))}}class l6{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Q.resolve(si.ce);const i=new a6(t);return this.mr.forEachTarget(e,(s=>i.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>i.Ar(s))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(he("LruGarbageCollector","Garbage collection skipped; disabled"),Q.resolve(sS)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(he("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sS):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,s,a,l,u,h,m;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((T=>(T>this.params.maximumSequenceNumbersToCollect?(he("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),s=this.params.maximumSequenceNumbersToCollect):s=T,l=Date.now(),this.nthSequenceNumber(e,s)))).next((T=>(i=T,u=Date.now(),this.removeTargets(e,i,t)))).next((T=>(a=T,h=Date.now(),this.removeOrphanedDocuments(e,i)))).next((T=>(m=Date.now(),Wl()<=Qe.DEBUG&&he("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-_}ms
	Determined least recently used ${s} in `+(u-l)+`ms
	Removed ${a} targets in `+(h-u)+`ms
	Removed ${T} documents in `+(m-h)+`ms
Total Duration: ${m-_}ms`),Q.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:T}))))}}function v1(n,e){return new l6(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(e,t){this.db=e,this.garbageCollector=v1(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,s)=>t(s)))}addReference(e,t,i){return gm(e,i)}removeReference(e,t,i){return gm(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return gm(e,t)}br(e,t){return(function(s,a){let l=!1;return y1(s).te((u=>g1(s,u,a).next((h=>(h&&(l=!0),Q.resolve(!h)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.Sr(e,((l,u)=>{if(u<=t){const h=this.br(e,l).next((m=>{if(!m)return a++,i.getEntry(e,l).next((()=>(i.removeEntry(l,Pe.min()),ho(e).delete((function(T){return[0,Fn(T.path)]})(l)))))}));s.push(h)}})).next((()=>Q.waitFor(s))).next((()=>i.apply(e))).next((()=>a))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return gm(e,t)}Sr(e,t){const i=ho(e);let s,a=si.ce;return i.ee({index:I0},(([l,u],{path:h,sequenceNumber:m})=>{l===0?(a!==si.ce&&t(new ve(Vs(s)),a),a=m,s=h):a=si.ce})).next((()=>{a!==si.ce&&t(new ve(Vs(s)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function gm(n,e){return ho(n).put((function(i,s){return{targetId:0,path:Fn(i.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(){this.changes=new Er((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Nt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Q.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return ga(e).put(i)}removeEntry(e,t,i){return ga(e).delete((function(a,l){const u=a.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],Zm(l),u[u.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Nt.newInvalidDocument(t);return ga(e).ee({index:Sm,range:IDBKeyRange.only(ud(t))},((s,a)=>{i=this.Cr(t,a)})).next((()=>i))}vr(e,t){let i={size:0,document:Nt.newInvalidDocument(t)};return ga(e).ee({index:Sm,range:IDBKeyRange.only(ud(t))},((s,a)=>{i={document:this.Cr(t,a),size:tp(a)}})).next((()=>i))}getEntries(e,t){let i=oi();return this.Fr(e,t,((s,a)=>{const l=this.Cr(s,a);i=i.insert(s,l)})).next((()=>i))}Mr(e,t){let i=oi(),s=new bt(ve.comparator);return this.Fr(e,t,((a,l)=>{const u=this.Cr(a,l);i=i.insert(a,u),s=s.insert(a,tp(l))})).next((()=>({documents:i,Or:s})))}Fr(e,t,i){if(t.isEmpty())return Q.resolve();let s=new gt(uS);t.forEach((h=>s=s.add(h)));const a=IDBKeyRange.bound(ud(s.first()),ud(s.last())),l=s.getIterator();let u=l.getNext();return ga(e).ee({index:Sm,range:a},((h,m,_)=>{const T=ve.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;u&&uS(u,T)<0;)i(u,null),u=l.getNext();u&&u.isEqual(T)&&(i(u,m),u=l.hasNext()?l.getNext():null),u?_.j(ud(u)):_.done()})).next((()=>{for(;u;)i(u,null),u=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,i,s,a){const l=t.path,u=[l.popLast().toArray(),l.lastSegment(),Zm(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],h=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ga(e).J(IDBKeyRange.bound(u,h,!0)).next((m=>{a==null||a.incrementDocumentReadCount(m.length);let _=oi();for(const T of m){const E=this.Cr(ve.fromSegments(T.prefixPath.concat(T.collectionGroup,T.documentId)),T);E.isFoundDocument()&&(wh(t,E)||s.has(E.key))&&(_=_.insert(E.key,E))}return _}))}getAllFromCollectionGroup(e,t,i,s){let a=oi();const l=cS(t,i),u=cS(t,wi.max());return ga(e).ee({index:oR,range:IDBKeyRange.bound(l,u,!0)},((h,m,_)=>{const T=this.Cr(ve.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);a=a.insert(T.key,T),a.size===s&&_.done()})).next((()=>a))}newChangeBuffer(e){return new d6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return lS(e).get(ev).next((t=>(Ne(!!t,20021),t)))}Dr(e,t){return lS(e).put(ev,t)}Cr(e,t){if(t){const i=J5(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Pe.min())))return i}return Nt.newInvalidDocument(e)}}function x1(n){return new u6(n)}class d6 extends T1{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Er((i=>i.toString()),((i,s)=>i.isEqual(s)))}applyChanges(e){const t=[];let i=0,s=new gt(((a,l)=>Fe(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const u=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,u.readTime)),l.isValidDocument()){const h=HI(this.Nr.serializer,l);s=s.add(a.path.popLast());const m=tp(h);i+=m-u.size,t.push(this.Nr.addEntry(e,a,h))}else if(i-=u.size,this.trackRemovals){const h=HI(this.Nr.serializer,l.convertToNoDocument(Pe.min()));t.push(this.Nr.addEntry(e,a,h))}})),s.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,i)),Q.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:s})=>(s.forEach(((a,l)=>{this.Br.set(a,{size:l,readTime:i.get(a).readTime})})),i)))}}function lS(n){return mn(n,Jd)}function ga(n){return mn(n,Ym)}function ud(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function cS(n,e){const t=e.documentKey.path.toArray();return[n,Zm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function uS(n,e){const t=n.path.toArray(),i=e.path.toArray();let s=0;for(let a=0;a<t.length-2&&a<i.length-2;++a)if(s=Fe(t[a],i[a]),s)return s;return s=Fe(t.length,i.length),s||(s=Fe(t[t.length-2],i[i.length-2]),s||Fe(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(i=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(i!==null&&kd(i.mutation,s,ri.empty(),dt.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,ze()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=ze()){const s=Ls();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,i).next((a=>{let l=yd();return a.forEach(((u,h)=>{l=l.insert(u,h.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const i=Ls();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,ze())))}populateOverlays(e,t,i){const s=[];return i.forEach((a=>{t.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((l,u)=>{t.set(l,u)}))}))}computeViews(e,t,i,s){let a=oi();const l=Md(),u=(function(){return Md()})();return t.forEach(((h,m)=>{const _=i.get(m.key);s.has(m.key)&&(_===void 0||_.mutation instanceof wr)?a=a.insert(m.key,m):_!==void 0?(l.set(m.key,_.mutation.getFieldMask()),kd(_.mutation,m,_.mutation.getFieldMask(),dt.now())):l.set(m.key,ri.empty())})),this.recalculateAndSaveOverlays(e,a).next((h=>(h.forEach(((m,_)=>l.set(m,_))),t.forEach(((m,_)=>u.set(m,new h6(_,l.get(m)??null)))),u)))}recalculateAndSaveOverlays(e,t){const i=Md();let s=new bt(((l,u)=>l-u)),a=ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const u of l)u.keys().forEach((h=>{const m=t.get(h);if(m===null)return;let _=i.get(h)||ri.empty();_=u.applyToLocalView(m,_),i.set(h,_);const T=(s.get(u.batchId)||ze()).add(h);s=s.insert(u.batchId,T)}))})).next((()=>{const l=[],u=s.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),m=h.key,_=h.value,T=OR();_.forEach((E=>{if(!a.has(E)){const S=HR(t.get(E),i.get(E));S!==null&&T.set(E,S),a=a.add(E)}})),l.push(this.documentOverlayCache.saveOverlays(e,m,T))}return Q.waitFor(l)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,s){return(function(l){return ve.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):D0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next((a=>{const l=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-a.size):Q.resolve(Ls());let u=_c,h=a;return l.next((m=>Q.forEach(m,((_,T)=>(u<T.largestBatchId&&(u=T.largestBatchId),a.get(_)?Q.resolve():this.remoteDocumentCache.getEntry(e,_).next((E=>{h=h.insert(_,E)}))))).next((()=>this.populateOverlays(e,m,a))).next((()=>this.computeViews(e,h,m,ze()))).next((_=>({batchId:u,changes:UR(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ve(t)).next((i=>{let s=yd();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const a=t.collectionGroup;let l=yd();return this.indexManager.getCollectionParents(e,a).next((u=>Q.forEach(u,(h=>{const m=(function(T,E){return new xr(E,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)})(t,h.child(a));return this.getDocumentsMatchingCollectionQuery(e,m,i,s).next((_=>{_.forEach(((T,E)=>{l=l.insert(T,E)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,i,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,a,s)))).next((l=>{a.forEach(((h,m)=>{const _=m.getKey();l.get(_)===null&&(l=l.insert(_,Nt.newInvalidDocument(_)))}));let u=yd();return l.forEach(((h,m)=>{const _=a.get(h);_!==void 0&&kd(_.mutation,m,ri.empty(),dt.now()),wh(t,m)&&(u=u.insert(h,m))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Q.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Jt(s.createTime)}})(t)),Q.resolve()}getNamedQuery(e,t){return Q.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:j0(s.bundledQuery),readTime:Jt(s.readTime)}})(t)),Q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{constructor(){this.overlays=new bt(ve.comparator),this.qr=new Map}getOverlay(e,t){return Q.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ls();return Q.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&i.set(s,a)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((s,a)=>{this.St(e,t,a)})),Q.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.qr.get(i);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(i)),Q.resolve()}getOverlaysForCollection(e,t,i){const s=Ls(),a=t.length+1,l=new ve(t.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const h=u.getNext().value,m=h.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===a&&h.largestBatchId>i&&s.set(h.getKey(),h)}return Q.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let a=new bt(((m,_)=>m-_));const l=this.overlays.getIterator();for(;l.hasNext();){const m=l.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let _=a.get(m.largestBatchId);_===null&&(_=Ls(),a=a.insert(m.largestBatchId,_)),_.set(m.getKey(),m)}}const u=Ls(),h=a.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((m,_)=>u.set(m,_))),!(u.size()>=s)););return Q.resolve(u)}St(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const l=this.qr.get(s.largestBatchId).delete(i.key);this.qr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new O0(t,i));let a=this.qr.get(t);a===void 0&&(a=ze(),this.qr.set(t,a)),this.qr.set(t,a.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(){this.sessionToken=jt.EMPTY_BYTE_STRING}getSessionToken(e){return Q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(){this.Qr=new gt(_n.$r),this.Ur=new gt(_n.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new _n(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new _n(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new ve(new We([])),i=new _n(t,e),s=new _n(t,e+1),a=[];return this.Ur.forEachInRange([i,s],(l=>{this.Gr(l),a.push(l.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ve(new We([])),i=new _n(t,e),s=new _n(t,e+1);let a=ze();return this.Ur.forEachInRange([i,s],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new _n(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class _n{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ve.comparator(e.key,t.key)||Fe(e.Yr,t.Yr)}static Kr(e,t){return Fe(e.Yr,t.Yr)||ve.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new gt(_n.$r)}checkEmpty(e){return Q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new L0(a,t,i,s);this.mutationQueue.push(l);for(const u of s)this.Zr=this.Zr.add(new _n(u.key,a)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Q.resolve(l)}lookupMutationBatch(e,t){return Q.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.ei(i),a=s<0?0:s;return Q.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Q.resolve(this.mutationQueue.length===0?To:this.tr-1)}getAllMutationBatches(e){return Q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new _n(t,0),s=new _n(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([i,s],(l=>{const u=this.Xr(l.Yr);a.push(u)})),Q.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new gt(Fe);return t.forEach((s=>{const a=new _n(s,0),l=new _n(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],(u=>{i=i.add(u.Yr)}))})),Q.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let a=i;ve.isDocumentKey(a)||(a=a.child(""));const l=new _n(new ve(a),0);let u=new gt(Fe);return this.Zr.forEachWhile((h=>{const m=h.key.path;return!!i.isPrefixOf(m)&&(m.length===s&&(u=u.add(h.Yr)),!0)}),l),Q.resolve(this.ti(u))}ti(e){const t=[];return e.forEach((i=>{const s=this.Xr(i);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){Ne(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Q.forEach(t.mutations,(s=>{const a=new _n(s.key,t.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new _n(t,0),s=this.Zr.firstAfterOrEqual(i);return Q.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Q.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e){this.ri=e,this.docs=(function(){return new bt(ve.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),a=s?s.size:0,l=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Q.resolve(i?i.document.mutableCopy():Nt.newInvalidDocument(t))}getEntries(e,t){let i=oi();return t.forEach((s=>{const a=this.docs.get(s);i=i.insert(s,a?a.document.mutableCopy():Nt.newInvalidDocument(s))})),Q.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let a=oi();const l=t.path,u=new ve(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:m,value:{document:_}}=h.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||w0(eR(_),i)<=0||(s.has(_.key)||wh(t,_))&&(a=a.insert(_.key,_.mutableCopy()))}return Q.resolve(a)}getAllFromCollectionGroup(e,t,i,s){be(9500)}ii(e,t){return Q.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new _6(this)}getSize(e){return Q.resolve(this.size)}}class _6 extends T1{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(i)})),Q.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(e){this.persistence=e,this.si=new Er((t=>qa(t)),xh),this.lastRemoteSnapshotVersion=Pe.min(),this.highestTargetId=0,this.oi=0,this._i=new z0,this.targetCount=0,this.ai=Ha.ur()}forEachTarget(e,t){return this.si.forEach(((i,s)=>t(s))),Q.resolve()}getLastRemoteSnapshotVersion(e){return Q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Q.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ha(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Q.resolve()}updateTargetData(e,t){return this.Pr(t),Q.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Q.resolve()}removeTargets(e,t,i){let s=0;const a=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=t&&i.get(u.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(e,u.targetId)),s++)})),Q.waitFor(a).next((()=>s))}getTargetCount(e){return Q.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Q.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Q.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach((l=>{a.push(s.markPotentiallyOrphaned(e,l))})),Q.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Q.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Q.resolve(i)}containsKey(e,t){return Q.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(e,t){this.ui={},this.overlays={},this.ci=new si(0),this.li=!1,this.li=!0,this.hi=new p6,this.referenceDelegate=e(this),this.Pi=new v6(this),this.indexManager=new i6,this.remoteDocumentCache=(function(s){return new y6(s)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new u1(t),this.Ii=new f6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new m6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new g6(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){he("MemoryPersistence","Starting transaction:",e);const s=new T6(this.ci.next());return this.referenceDelegate.Ei(),i(s).next((a=>this.referenceDelegate.di(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ai(e,t){return Q.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class T6 extends nR{constructor(e){super(),this.currentSequenceNumber=e}}class Bp{constructor(e){this.persistence=e,this.Ri=new z0,this.Vi=null}static mi(e){return new Bp(e)}get fi(){if(this.Vi)return this.Vi;throw be(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Q.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Q.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Q.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((a=>this.fi.add(a.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Q.forEach(this.fi,(i=>{const s=ve.fromPath(i);return this.gi(e,s).next((a=>{a||t.removeEntry(s,Pe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Q.or([()=>Q.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class np{constructor(e,t){this.persistence=e,this.pi=new Er((i=>Fn(i.path)),((i,s)=>i.isEqual(s))),this.garbageCollector=v1(this,t)}static mi(e,t){return new np(e,t)}Ei(){}di(e){return Q.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return Q.forEach(this.pi,((i,s)=>this.br(e,i,s).next((a=>a?Q.resolve():t(s)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ii(e,(l=>this.br(e,l,t).next((u=>{u||(i++,a.removeEntry(l,Pe.min()))})))).next((()=>a.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Q.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),Q.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),Q.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Q.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Nm(e.data.value)),t}br(e,t,i){return Q.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return Q.resolve(s!==void 0&&s>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(e){this.serializer=e}k(e,t,i,s){const a=new Pp("createOrUpgrade",t);i<1&&s>=1&&((function(h){h.createObjectStore(Th)})(e),(function(h){h.createObjectStore(Yd,{keyPath:UO}),h.createObjectStore(ts,{keyPath:xI,autoIncrement:!0}).createIndex(Aa,EI,{unique:!0}),h.createObjectStore(vc)})(e),dS(e),(function(h){h.createObjectStore(va)})(e));let l=Q.resolve();return i<3&&s>=3&&(i!==0&&((function(h){h.deleteObjectStore(xc),h.deleteObjectStore(Tc),h.deleteObjectStore(Ma)})(e),dS(e)),l=l.next((()=>(function(h){const m=h.store(Ma),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Pe.min().toTimestamp(),targetCount:0};return m.put(Jm,_)})(a)))),i<4&&s>=4&&(i!==0&&(l=l.next((()=>(function(h,m){return m.store(ts).J().next((T=>{h.deleteObjectStore(ts),h.createObjectStore(ts,{keyPath:xI,autoIncrement:!0}).createIndex(Aa,EI,{unique:!0});const E=m.store(ts),S=T.map((k=>E.put(k)));return Q.waitFor(S)}))})(e,a)))),l=l.next((()=>{(function(h){h.createObjectStore(Ec,{keyPath:$O})})(e)}))),i<5&&s>=5&&(l=l.next((()=>this.yi(a)))),i<6&&s>=6&&(l=l.next((()=>((function(h){h.createObjectStore(Jd)})(e),this.wi(a))))),i<7&&s>=7&&(l=l.next((()=>this.Si(a)))),i<8&&s>=8&&(l=l.next((()=>this.bi(e,a)))),i<9&&s>=9&&(l=l.next((()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&s>=10&&(l=l.next((()=>this.Di(a)))),i<11&&s>=11&&(l=l.next((()=>{(function(h){h.createObjectStore(Dp,{keyPath:KO})})(e),(function(h){h.createObjectStore(Mp,{keyPath:YO})})(e)}))),i<12&&s>=12&&(l=l.next((()=>{(function(h){const m=h.createObjectStore(kp,{keyPath:t5});m.createIndex(nv,n5,{unique:!1}),m.createIndex(uR,i5,{unique:!1})})(e)}))),i<13&&s>=13&&(l=l.next((()=>(function(h){const m=h.createObjectStore(Ym,{keyPath:FO});m.createIndex(Sm,qO),m.createIndex(oR,jO)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(va)))),i<14&&s>=14&&(l=l.next((()=>this.Fi(e,a)))),i<15&&s>=15&&(l=l.next((()=>(function(h){h.createObjectStore(S0,{keyPath:JO,autoIncrement:!0}).createIndex(tv,QO,{unique:!1}),h.createObjectStore(Rd,{keyPath:WO}).createIndex(lR,XO,{unique:!1}),h.createObjectStore(Pd,{keyPath:ZO}).createIndex(cR,e5,{unique:!1})})(e)))),i<16&&s>=16&&(l=l.next((()=>{t.objectStore(Rd).clear()})).next((()=>{t.objectStore(Pd).clear()}))),i<17&&s>=17&&(l=l.next((()=>{(function(h){h.createObjectStore(A0,{keyPath:s5})})(e)}))),i<18&&s>=18&&AN()&&(l=l.next((()=>{t.objectStore(Rd).clear()})).next((()=>{t.objectStore(Pd).clear()}))),l}wi(e){let t=0;return e.store(va).ee(((i,s)=>{t+=tp(s)})).next((()=>{const i={byteSize:t};return e.store(Jd).put(ev,i)}))}yi(e){const t=e.store(Yd),i=e.store(ts);return t.J().next((s=>Q.forEach(s,(a=>{const l=IDBKeyRange.bound([a.userId,To],[a.userId,a.lastAcknowledgedBatchId]);return i.J(Aa,l).next((u=>Q.forEach(u,(h=>{Ne(h.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:h.batchId});const m=xa(this.serializer,h);return p1(e,a.userId,m).next((()=>{}))}))))}))))}Si(e){const t=e.store(xc),i=e.store(va);return e.store(Ma).get(Jm).next((s=>{const a=[];return i.ee(((l,u)=>{const h=new We(l),m=(function(T){return[0,Fn(T)]})(h);a.push(t.get(m).next((_=>_?Q.resolve():(T=>t.put({targetId:0,path:Fn(T),sequenceNumber:s.highestListenSequenceNumber}))(h))))})).next((()=>Q.waitFor(a)))}))}bi(e,t){e.createObjectStore(Qd,{keyPath:HO});const i=t.store(Qd),s=new G0,a=l=>{if(s.add(l)){const u=l.lastSegment(),h=l.popLast();return i.put({collectionId:u,parent:Fn(h)})}};return t.store(va).ee({X:!0},((l,u)=>{const h=new We(l);return a(h.popLast())})).next((()=>t.store(vc).ee({X:!0},(([l,u,h],m)=>{const _=Vs(u);return a(_.popLast())}))))}Di(e){const t=e.store(Tc);return t.ee(((i,s)=>{const a=vd(s),l=d1(this.serializer,a);return t.put(l)}))}Ci(e,t){const i=t.store(va),s=[];return i.ee(((a,l)=>{const u=t.store(Ym),h=(function(T){return T.document?new ve(We.fromString(T.document.name).popFirst(5)):T.noDocument?ve.fromSegments(T.noDocument.path):T.unknownDocument?ve.fromSegments(T.unknownDocument.path):be(36783)})(l).path.toArray(),m={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};s.push(u.put(m))})).next((()=>Q.waitFor(s)))}Fi(e,t){const i=t.store(ts),s=x1(this.serializer),a=new H0(Bp.mi,this.serializer.yt);return i.J().next((l=>{const u=new Map;return l.forEach((h=>{let m=u.get(h.userId)??ze();xa(this.serializer,h).keys().forEach((_=>m=m.add(_))),u.set(h.userId,m)})),Q.forEach(u,((h,m)=>{const _=new vn(m),T=qp.wt(this.serializer,_),E=a.getIndexManager(_),S=jp.wt(_,this.serializer,E,a.referenceDelegate);return new E1(s,S,T,E).recalculateAndSaveOverlaysForDocumentKeys(new iv(t,si.ce),h).next()}))}))}}function dS(n){n.createObjectStore(xc,{keyPath:GO}).createIndex(I0,zO,{unique:!0}),n.createObjectStore(Tc,{keyPath:"targetId"}).createIndex(aR,BO,{unique:!0}),n.createObjectStore(Ma)}const co="IndexedDbPersistence",P_=18e5,D_=5e3,M_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",w1="main";class $0{constructor(e,t,i,s,a,l,u,h,m,_,T=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=a,this.window=l,this.document=u,this.xi=m,this.Oi=_,this.Ni=T,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=E=>Promise.resolve(),!$0.v())throw new de(ie.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new c6(this,s),this.$i=t+w1,this.serializer=new u1(h),this.Ui=new Us(this.$i,this.Ni,new x6(this.serializer)),this.hi=new W5,this.Pi=new r6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=x1(this.serializer),this.Ii=new Q5,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,_===!1&&Yt(co,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new de(ie.FAILED_PRECONDITION,M_);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new si(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>ym(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Lo(e))return he(co,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return he(co,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return dd(e).get(Hl).next((t=>Q.resolve(this.es(t))))}ts(e){return ym(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,P_)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=mn(t,Ec);return i.J().next((s=>{const a=this.ss(s,P_),l=s.filter((u=>a.indexOf(u)===-1));return Q.forEach(l,(u=>i.delete(u.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Q.resolve(!0):dd(e).get(Hl).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,D_)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new de(ie.FAILED_PRECONDITION,M_);return!1}}return!(!this.networkEnabled||!this.inForeground)||ym(e).J().next((i=>this.ss(i,D_).find((s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,l=!this.inForeground&&s.inForeground,u=this.networkEnabled===s.networkEnabled;if(a||l&&u)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&he(co,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Th,Ec],(e=>{const t=new iv(e,si.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>ym(e).J().next((t=>this.ss(t,P_).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return jp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new s6(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return qp.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){he(co,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",a=(function(h){return h===18?a5:h===17?mR:h===16?o5:h===15?N0:h===14?fR:h===13?hR:h===12?r5:h===11?dR:void be(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,s,a,(u=>(l=new iv(u,this.ci?this.ci.next():si.ce),t==="readwrite-primary"?this.Hi(l).next((h=>!!h||this.Yi(l))).next((h=>{if(!h)throw Yt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new de(ie.FAILED_PRECONDITION,tR);return i(l)})).next((h=>this.Xi(l).next((()=>h)))):this.Is(l).next((()=>i(l)))))).then((u=>(l.raiseOnCommittedEvent(),u)))}Is(e){return dd(e).get(Hl).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,D_)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new de(ie.FAILED_PRECONDITION,M_)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return dd(e).put(Hl,t)}static v(){return Us.v()}Zi(e){const t=dd(e);return t.get(Hl).next((i=>this.es(i)?(he(co,"Releasing primary lease."),t.delete(Hl)):Q.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Yt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;SN()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const i=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return he(co,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Yt(co,"Failed to get zombied client id.",i),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Yt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function dd(n){return mn(n,Th)}function ym(n){return mn(n,Ec)}function K0(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=s}static As(e,t){let i=ze(),s=ze();for(const a of t.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new Y0(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return SN()?8:iR(Lt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,s){const a={result:null};return this.ys(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ws(e,t,s,i).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new E6;return this.Ss(e,t,l).next((u=>{if(a.result=u,this.Vs)return this.bs(e,t,l,u.size)}))})).next((()=>a.result))}bs(e,t,i,s){return i.documentReadCount<this.fs?(Wl()<=Qe.DEBUG&&he("QueryEngine","SDK will not create cache indexes for query:",Xl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Q.resolve()):(Wl()<=Qe.DEBUG&&he("QueryEngine","Query:",Xl(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.gs*s?(Wl()<=Qe.DEBUG&&he("QueryEngine","The SDK decides to create cache indexes for query:",Xl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Kn(t))):Q.resolve())}ys(e,t){if(VI(t))return Q.resolve(null);let i=Kn(t);return this.indexManager.getIndexType(e,i).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=Xm(t,null,"F"),i=Kn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((a=>{const l=ze(...a);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,i).next((h=>{const m=this.Ds(t,u);return this.Cs(t,m,l,h.readTime)?this.ys(e,Xm(t,null,"F")):this.vs(e,m,t,h)}))))})))))}ws(e,t,i,s){return VI(t)||s.isEqual(Pe.min())?Q.resolve(null):this.ps.getDocuments(e,i).next((a=>{const l=this.Ds(t,a);return this.Cs(t,l,i,s)?Q.resolve(null):(Wl()<=Qe.DEBUG&&he("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Xl(t)),this.vs(e,l,t,ZC(s,_c)).next((u=>u)))}))}Ds(e,t){let i=new gt(VR(e));return t.forEach(((s,a)=>{wh(e,a)&&(i=i.add(a))})),i}Cs(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(e,t,i){return Wl()<=Qe.DEBUG&&he("QueryEngine","Using full collection scan to execute query:",Xl(t)),this.ps.getDocumentsMatchingQuery(e,t,wi.min(),i)}vs(e,t,i,s){return this.ps.getDocumentsMatchingQuery(e,i,s).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0="LocalStore",w6=3e8;class b6{constructor(e,t,i,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new bt(Fe),this.xs=new Er((a=>qa(a)),xh),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new E1(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function I1(n,e,t,i){return new b6(n,e,t,i)}async function S1(n,e){const t=xe(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next((a=>(s=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((a=>{const l=[],u=[];let h=ze();for(const m of s){l.push(m.batchId);for(const _ of m.mutations)h=h.add(_.key)}for(const m of a){u.push(m.batchId);for(const _ of m.mutations)h=h.add(_.key)}return t.localDocuments.getDocuments(i,h).next((m=>({Ls:m,removedBatchIds:l,addedBatchIds:u})))}))}))}function I6(n,e){const t=xe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,h,m,_){const T=m.batch,E=T.keys();let S=Q.resolve();return E.forEach((k=>{S=S.next((()=>_.getEntry(h,k))).next((V=>{const O=m.docVersions.get(k);Ne(O!==null,48541),V.version.compareTo(O)<0&&(T.applyToRemoteDocument(V,m),V.isValidDocument()&&(V.setReadTime(m.commitVersion),_.addEntry(V)))}))})),S.next((()=>u.mutationQueue.removeMutationBatch(h,T)))})(t,i,e,a).next((()=>a.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(u){let h=ze();for(let m=0;m<u.mutationResults.length;++m)u.mutationResults[m].transformResults.length>0&&(h=h.add(u.batch.mutations[m].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(i,s)))}))}function A1(n){const e=xe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function S6(n,e){const t=xe(n),i=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const u=[];e.targetChanges.forEach(((_,T)=>{const E=s.get(T);if(!E)return;u.push(t.Pi.removeMatchingKeys(a,_.removedDocuments,T).next((()=>t.Pi.addMatchingKeys(a,_.addedDocuments,T))));let S=E.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(T)!==null?S=S.withResumeToken(jt.EMPTY_BYTE_STRING,Pe.min()).withLastLimboFreeSnapshotVersion(Pe.min()):_.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(_.resumeToken,i)),s=s.insert(T,S),(function(V,O,j){return V.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=w6?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0})(E,S,_)&&u.push(t.Pi.updateTargetData(a,S))}));let h=oi(),m=ze();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(a,_))})),u.push(N1(a,l,e.documentUpdates).next((_=>{h=_.ks,m=_.qs}))),!i.isEqual(Pe.min())){const _=t.Pi.getLastRemoteSnapshotVersion(a).next((T=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,i)));u.push(_)}return Q.waitFor(u).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,h,m))).next((()=>h))})).then((a=>(t.Ms=s,a)))}function N1(n,e,t){let i=ze(),s=ze();return t.forEach((a=>i=i.add(a))),e.getEntries(n,i).next((a=>{let l=oi();return t.forEach(((u,h)=>{const m=a.get(u);h.isFoundDocument()!==m.isFoundDocument()&&(s=s.add(u)),h.isNoDocument()&&h.version.isEqual(Pe.min())?(e.removeEntry(u,h.readTime),l=l.insert(u,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),l=l.insert(u,h)):he(J0,"Ignoring outdated watch update for ",u,". Current version:",m.version," Watch version:",h.version)})),{ks:l,qs:s}}))}function A6(n,e){const t=xe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=To),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Cc(n,e){const t=xe(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return t.Pi.getTargetData(i,e).next((a=>a?(s=a,Q.resolve(s)):t.Pi.allocateTargetId(i).next((l=>(s=new cr(e,l,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=t.Ms.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function Rc(n,e,t){const i=xe(n),s=i.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",a,(l=>i.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!Lo(l))throw l;he(J0,`Failed to update sequence numbers for target ${e}: ${l}`)}i.Ms=i.Ms.remove(e),i.xs.delete(s.target)}function ip(n,e,t){const i=xe(n);let s=Pe.min(),a=ze();return i.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,m,_){const T=xe(h),E=T.xs.get(_);return E!==void 0?Q.resolve(T.Ms.get(E)):T.Pi.getTargetData(m,_)})(i,l,Kn(e)).next((u=>{if(u)return s=u.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(l,u.targetId).next((h=>{a=h}))})).next((()=>i.Fs.getDocumentsMatchingQuery(l,e,t?s:Pe.min(),t?a:ze()))).next((u=>(P1(i,kR(e),u),{documents:u,Qs:a})))))}function C1(n,e){const t=xe(n),i=xe(t.Pi),s=t.Ms.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(a=>i.At(a,e).next((l=>l?l.target:null))))}function R1(n,e){const t=xe(n),i=t.Os.get(e)||Pe.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.Ns.getAllFromCollectionGroup(s,e,ZC(i,_c),Number.MAX_SAFE_INTEGER))).then((s=>(P1(t,e,s),s)))}function P1(n,e,t){let i=n.Os.get(e)||Pe.min();t.forEach(((s,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)})),n.Os.set(e,i)}async function N6(n,e,t,i){const s=xe(n);let a=ze(),l=oi();for(const m of t){const _=e.$s(m.metadata.name);m.document&&(a=a.add(_));const T=e.Us(m);T.setReadTime(e.Ks(m.metadata.readTime)),l=l.insert(_,T)}const u=s.Ns.newChangeBuffer({trackRemovals:!0}),h=await Cc(s,(function(_){return Kn(Gc(We.fromString(`__bundle__/docs/${_}`)))})(i));return s.persistence.runTransaction("Apply bundle documents","readwrite",(m=>N1(m,u,l).next((_=>(u.apply(m),_))).next((_=>s.Pi.removeMatchingKeysForTargetId(m,h.targetId).next((()=>s.Pi.addMatchingKeys(m,a,h.targetId))).next((()=>s.localDocuments.getLocalViewOfDocuments(m,_.ks,_.qs))).next((()=>_.ks))))))}async function C6(n,e,t=ze()){const i=await Cc(n,Kn(j0(e.bundledQuery))),s=xe(n);return s.persistence.runTransaction("Save named query","readwrite",(a=>{const l=Jt(e.readTime);if(i.snapshotVersion.compareTo(l)>=0)return s.Ii.saveNamedQuery(a,e);const u=i.withResumeToken(jt.EMPTY_BYTE_STRING,l);return s.Ms=s.Ms.insert(u.targetId,u),s.Pi.updateTargetData(a,u).next((()=>s.Pi.removeMatchingKeysForTargetId(a,i.targetId))).next((()=>s.Pi.addMatchingKeys(a,t,i.targetId))).next((()=>s.Ii.saveNamedQuery(a,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="firestore_clients";function hS(n,e){return`${D1}_${n}_${e}`}const M1="firestore_mutations";function fS(n,e,t){let i=`${M1}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const k1="firestore_targets";function k_(n,e){return`${k1}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs="SharedClientState";class sp{constructor(e,t,i,s){this.user=e,this.batchId=t,this.state=i,this.error=s}static Ws(e,t,i){const s=JSON.parse(i);let a,l=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return l&&s.error&&(l=typeof s.error.message=="string"&&typeof s.error.code=="string",l&&(a=new de(s.error.code,s.error.message))),l?new sp(e,t,s.state,a):(Yt(Cs,`Failed to parse mutation state for ID '${t}': ${i}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Vd{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Ws(e,t){const i=JSON.parse(t);let s,a=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new de(i.error.code,i.error.message))),a?new Vd(e,i.state,s):(Yt(Cs,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class rp{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const i=JSON.parse(t);let s=typeof i=="object"&&i.activeTargetIds instanceof Array,a=M0();for(let l=0;s&&l<i.activeTargetIds.length;++l)s=sR(i.activeTargetIds[l]),a=a.add(i.activeTargetIds[l]);return s?new rp(e,a):(Yt(Cs,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Q0{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Q0(t.clientId,t.onlineState):(Yt(Cs,`Failed to parse online state: ${e}`),null)}}class _v{constructor(){this.activeTargetIds=M0()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class V_{constructor(e,t,i,s,a){this.window=e,this.Mi=t,this.persistenceKey=i,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new bt(Fe),this.started=!1,this.Xs=[];const l=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.eo=hS(this.persistenceKey,this.Js),this.no=(function(h){return`firestore_sequence_number_${h}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new _v),this.ro=new RegExp(`^${D1}_${l}_([^_]*)$`),this.io=new RegExp(`^${M1}_${l}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${k1}_${l}_(\\d+)$`),this.oo=(function(h){return`firestore_online_state_${h}`})(this.persistenceKey),this._o=(function(h){return`firestore_bundle_loaded_v2_${h}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const i of e){if(i===this.Js)continue;const s=this.getItem(hS(this.persistenceKey,i));if(s){const a=rp.Ws(i,s);a&&(this.Zs=this.Zs.insert(a.clientId,a))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const i=this.uo(t);i&&this.co(i)}for(const i of this.Xs)this.Ys(i);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((i,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,i){this.ho(e,t,i),this.Po(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(k_(this.persistenceKey,e));if(s){const a=Vd.Ws(e,s);a&&(i=a.state)}}return t&&this.To.zs(e),this.ao(),i}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(k_(this.persistenceKey,e))}updateQueryState(e,t,i){this.Io(e,t,i)}handleUserChange(e,t,i){t.forEach((s=>{this.Po(s)})),this.currentUser=e,i.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return he(Cs,"READ",e,t),t}setItem(e,t){he(Cs,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){he(Cs,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(he(Cs,"EVENT",t.key,t.newValue),t.key===this.eo)return void Yt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const i=this.Ro(t.key);return this.Vo(i,null)}{const i=this.mo(t.key,t.newValue);if(i)return this.Vo(i.clientId,i)}}else if(this.io.test(t.key)){if(t.newValue!==null){const i=this.fo(t.key,t.newValue);if(i)return this.po(i)}}else if(this.so.test(t.key)){if(t.newValue!==null){const i=this.yo(t.key,t.newValue);if(i)return this.wo(i)}}else if(t.key===this.oo){if(t.newValue!==null){const i=this.uo(t.newValue);if(i)return this.co(i)}}else if(t.key===this.no){const i=(function(a){let l=si.ce;if(a!=null)try{const u=JSON.parse(a);Ne(typeof u=="number",30636,{So:a}),l=u}catch(u){Yt(Cs,"Failed to read sequence number from WebStorage",u)}return l})(t.newValue);i!==si.ce&&this.sequenceNumberHandler(i)}else if(t.key===this._o){const i=this.bo(t.newValue);await Promise.all(i.map((s=>this.syncEngine.Do(s))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,i){const s=new sp(this.currentUser,e,t,i),a=fS(this.persistenceKey,this.currentUser,e);this.setItem(a,s.Gs())}Po(e){const t=fS(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,i){const s=k_(this.persistenceKey,e),a=new Vd(e,t,i);this.setItem(s,a.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const i=this.Ro(e);return rp.Ws(i,t)}fo(e,t){const i=this.io.exec(e),s=Number(i[1]),a=i[2]!==void 0?i[2]:null;return sp.Ws(new vn(a),s,t)}yo(e,t){const i=this.so.exec(e),s=Number(i[1]);return Vd.Ws(s,t)}uo(e){return Q0.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);he(Cs,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const i=t?this.Zs.insert(e,t):this.Zs.remove(e),s=this.lo(this.Zs),a=this.lo(i),l=[],u=[];return a.forEach((h=>{s.has(h)||l.push(h)})),s.forEach((h=>{a.has(h)||u.push(h)})),this.syncEngine.Fo(l,u).then((()=>{this.Zs=i}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=M0();return e.forEach(((i,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class V1{constructor(){this.Mo=new _v,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new _v,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS="ConnectivityMonitor";class pS{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){he(mS,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){he(mS,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _m=null;function vv(){return _m===null?_m=(function(){return 268435456+Math.round(2147483648*Math.random())})():_m++,"0x"+_m.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_="RestConnection",P6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class D6{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${s}`,this.Wo=this.databaseId.database===sv?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Go(e,t,i,s,a){const l=vv(),u=this.zo(e,t.toUriEncodedString());he(L_,`Sending RPC '${e}' ${l}:`,u,i);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,s,a);const{host:m}=new URL(u),_=Uc(m);return this.Jo(e,u,h,i,_).then((T=>(he(L_,`Received RPC '${e}' ${l}: `,T),T)),(T=>{throw js(L_,`RPC '${e}' ${l} failed with error: `,T,"url: ",u,"request:",i),T}))}Ho(e,t,i,s,a,l){return this.Go(e,t,i,s,a)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Bc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,a)=>e[a]=s)),i&&i.headers.forEach(((s,a)=>e[a]=s))}zo(e,t){const i=P6[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn="WebChannelConnection";class k6 extends D6{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,s,a){const l=vv();return new Promise(((u,h)=>{const m=new BC;m.setWithCredentials(!0),m.listenOnce(GC.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case wm.NO_ERROR:const T=m.getResponseJson();he(kn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(T)),u(T);break;case wm.TIMEOUT:he(kn,`RPC '${e}' ${l} timed out`),h(new de(ie.DEADLINE_EXCEEDED,"Request time out"));break;case wm.HTTP_ERROR:const E=m.getStatus();if(he(kn,`RPC '${e}' ${l} failed with status:`,E,"response text:",m.getResponseText()),E>0){let S=m.getResponseJson();Array.isArray(S)&&(S=S[0]);const k=S==null?void 0:S.error;if(k&&k.status&&k.message){const V=(function(j){const W=j.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(W)>=0?W:ie.UNKNOWN})(k.status);h(new de(V,k.message))}else h(new de(ie.UNKNOWN,"Server responded with status "+m.getStatus()))}else h(new de(ie.UNAVAILABLE,"Connection failed."));break;default:be(9055,{l_:e,streamId:l,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{he(kn,`RPC '${e}' ${l} completed.`)}}));const _=JSON.stringify(s);he(kn,`RPC '${e}' ${l} sending request:`,s),m.send(t,"POST",_,i,15)}))}T_(e,t,i){const s=vv(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=$C(),u=HC(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,t,i),h.encodeInitMessageHeaders=!0;const _=a.join("");he(kn,`Creating RPC '${e}' stream ${s}: ${_}`,h);const T=l.createWebChannel(_,h);this.I_(T);let E=!1,S=!1;const k=new M6({Yo:O=>{S?he(kn,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(E||(he(kn,`Opening RPC '${e}' stream ${s} transport.`),T.open(),E=!0),he(kn,`RPC '${e}' stream ${s} sending:`,O),T.send(O))},Zo:()=>T.close()}),V=(O,j,W)=>{O.listen(j,($=>{try{W($)}catch(U){setTimeout((()=>{throw U}),0)}}))};return V(T,gd.EventType.OPEN,(()=>{S||(he(kn,`RPC '${e}' stream ${s} transport opened.`),k.o_())})),V(T,gd.EventType.CLOSE,(()=>{S||(S=!0,he(kn,`RPC '${e}' stream ${s} transport closed`),k.a_(),this.E_(T))})),V(T,gd.EventType.ERROR,(O=>{S||(S=!0,js(kn,`RPC '${e}' stream ${s} transport errored. Name:`,O.name,"Message:",O.message),k.a_(new de(ie.UNAVAILABLE,"The operation could not be completed")))})),V(T,gd.EventType.MESSAGE,(O=>{var j;if(!S){const W=O.data[0];Ne(!!W,16349);const $=W,U=($==null?void 0:$.error)||((j=$[0])==null?void 0:j.error);if(U){he(kn,`RPC '${e}' stream ${s} received error:`,U);const K=U.status;let J=(function(C){const M=on[C];if(M!==void 0)return YR(M)})(K),R=U.message;J===void 0&&(J=ie.INTERNAL,R="Unknown error status: "+K+" with message "+U.message),S=!0,k.a_(new de(J,R)),T.close()}else he(kn,`RPC '${e}' stream ${s} received:`,W),k.u_(W)}})),V(u,zC.STAT_EVENT,(O=>{O.stat===W_.PROXY?he(kn,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===W_.NOPROXY&&he(kn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{k.__()}),0),k}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L1(){return typeof window<"u"?window:null}function Mm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ah(n){return new F5(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(e,t,i=1e3,s=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=s,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-i);s>0&&he("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gS="PersistentStream";class U1{constructor(e,t,i,s,a,l,u,h){this.Mi=e,this.S_=i,this.b_=s,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new W0(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(Yt(t.toString()),Yt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.D_===t&&this.G_(i,s)}),(i=>{e((()=>{const s=new de(ie.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(s)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{i((()=>this.z_(s)))})),this.stream.onMessage((s=>{i((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return he(gS,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(he(gS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class V6 extends U1{constructor(e,t,i,s,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=B5(this.serializer,e),i=(function(a){if(!("targetChange"in a))return Pe.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Pe.min():l.readTime?Jt(l.readTime):Pe.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=fv(this.serializer),t.addTarget=(function(a,l){let u;const h=l.target;if(u=Qm(h)?{documents:s1(a,h)}:{query:r1(a,h).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=XR(a,l.resumeToken);const m=dv(a,l.expectedCount);m!==null&&(u.expectedCount=m)}else if(l.snapshotVersion.compareTo(Pe.min())>0){u.readTime=Nc(a,l.snapshotVersion.toTimestamp());const m=dv(a,l.expectedCount);m!==null&&(u.expectedCount=m)}return u})(this.serializer,e);const i=z5(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=fv(this.serializer),t.removeTarget=e,this.q_(t)}}class L6 extends U1{constructor(e,t,i,s,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=G5(e.writeResults,e.commitTime),i=Jt(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=fv(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>nh(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U6{}class O6 extends U6{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new de(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Go(e,hv(t,i),s,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new de(ie.UNKNOWN,a.toString())}))}Ho(e,t,i,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,hv(t,i),s,l,u,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new de(ie.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class F6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Yt(t),this.aa=!1):he("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a="RemoteStore";class q6{constructor(e,t,i,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((l=>{i.enqueueAndForget((async()=>{Oo(this)&&(he($a,"Restarting streams for network reachability change."),await(async function(h){const m=xe(h);m.Ea.add(4),await $c(m),m.Ra.set("Unknown"),m.Ea.delete(4),await Nh(m)})(this))}))})),this.Ra=new F6(i,s)}}async function Nh(n){if(Oo(n))for(const e of n.da)await e(!0)}async function $c(n){for(const e of n.da)await e(!1)}function Gp(n,e){const t=xe(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),eT(t)?Z0(t):Yc(t).O_()&&X0(t,e))}function Pc(n,e){const t=xe(n),i=Yc(t);t.Ia.delete(e),i.O_()&&O1(t,e),t.Ia.size===0&&(i.O_()?i.L_():Oo(t)&&t.Ra.set("Unknown"))}function X0(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Pe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Yc(n).Y_(e)}function O1(n,e){n.Va.Ue(e),Yc(n).Z_(e)}function Z0(n){n.Va=new V5({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Yc(n).start(),n.Ra.ua()}function eT(n){return Oo(n)&&!Yc(n).x_()&&n.Ia.size>0}function Oo(n){return xe(n).Ea.size===0}function F1(n){n.Va=void 0}async function j6(n){n.Ra.set("Online")}async function B6(n){n.Ia.forEach(((e,t)=>{X0(n,e)}))}async function G6(n,e){F1(n),eT(n)?(n.Ra.ha(e),Z0(n)):n.Ra.set("Unknown")}async function z6(n,e,t){if(n.Ra.set("Online"),e instanceof WR&&e.state===2&&e.cause)try{await(async function(s,a){const l=a.cause;for(const u of a.targetIds)s.Ia.has(u)&&(await s.remoteSyncer.rejectListen(u,l),s.Ia.delete(u),s.Va.removeTarget(u))})(n,e)}catch(i){he($a,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await op(n,i)}else if(e instanceof Pm?n.Va.Ze(e):e instanceof QR?n.Va.st(e):n.Va.tt(e),!t.isEqual(Pe.min()))try{const i=await A1(n.localStore);t.compareTo(i)>=0&&await(function(a,l){const u=a.Va.Tt(l);return u.targetChanges.forEach(((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const _=a.Ia.get(m);_&&a.Ia.set(m,_.withResumeToken(h.resumeToken,l))}})),u.targetMismatches.forEach(((h,m)=>{const _=a.Ia.get(h);if(!_)return;a.Ia.set(h,_.withResumeToken(jt.EMPTY_BYTE_STRING,_.snapshotVersion)),O1(a,h);const T=new cr(_.target,h,m,_.sequenceNumber);X0(a,T)})),a.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(i){he($a,"Failed to raise snapshot:",i),await op(n,i)}}async function op(n,e,t){if(!Lo(e))throw e;n.Ea.add(1),await $c(n),n.Ra.set("Offline"),t||(t=()=>A1(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{he($a,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Nh(n)}))}function q1(n,e){return e().catch((t=>op(n,t,e)))}async function Kc(n){const e=xe(n),t=Ro(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:To;for(;H6(e);)try{const s=await A6(e.localStore,i);if(s===null){e.Ta.length===0&&t.L_();break}i=s.batchId,$6(e,s)}catch(s){await op(e,s)}j1(e)&&B1(e)}function H6(n){return Oo(n)&&n.Ta.length<10}function $6(n,e){n.Ta.push(e);const t=Ro(n);t.O_()&&t.X_&&t.ea(e.mutations)}function j1(n){return Oo(n)&&!Ro(n).x_()&&n.Ta.length>0}function B1(n){Ro(n).start()}async function K6(n){Ro(n).ra()}async function Y6(n){const e=Ro(n);for(const t of n.Ta)e.ea(t.mutations)}async function J6(n,e,t){const i=n.Ta.shift(),s=U0.from(i,e,t);await q1(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Kc(n)}async function Q6(n,e){e&&Ro(n).X_&&await(async function(i,s){if((function(l){return KR(l)&&l!==ie.ABORTED})(s.code)){const a=i.Ta.shift();Ro(i).B_(),await q1(i,(()=>i.remoteSyncer.rejectFailedWrite(a.batchId,s))),await Kc(i)}})(n,e),j1(n)&&B1(n)}async function yS(n,e){const t=xe(n);t.asyncQueue.verifyOperationInProgress(),he($a,"RemoteStore received new credentials");const i=Oo(t);t.Ea.add(3),await $c(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Nh(t)}async function Tv(n,e){const t=xe(n);e?(t.Ea.delete(2),await Nh(t)):e||(t.Ea.add(2),await $c(t),t.Ra.set("Unknown"))}function Yc(n){return n.ma||(n.ma=(function(t,i,s){const a=xe(t);return a.sa(),new V6(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:j6.bind(null,n),t_:B6.bind(null,n),r_:G6.bind(null,n),H_:z6.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),eT(n)?Z0(n):n.Ra.set("Unknown")):(await n.ma.stop(),F1(n))}))),n.ma}function Ro(n){return n.fa||(n.fa=(function(t,i,s){const a=xe(t);return a.sa(),new L6(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:K6.bind(null,n),r_:Q6.bind(null,n),ta:Y6.bind(null,n),na:J6.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Kc(n)):(await n.fa.stop(),n.Ta.length>0&&(he($a,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e,t,i,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=a,this.deferred=new Pn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,a){const l=Date.now()+i,u=new tT(e,t,l,s,a);return u.start(i),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new de(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Jc(n,e){if(Yt("AsyncQueue",`${e}: ${n}`),Lo(n))return new de(ie.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{static emptySet(e){return new cc(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ve.comparator(t.key,i.key):(t,i)=>ve.comparator(t.key,i.key),this.keyedMap=yd(),this.sortedSet=new bt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof cc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=i.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new cc;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(){this.ga=new bt(ve.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):be(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Dc{constructor(e,t,i,s,a,l,u,h,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,s,a){const l=[];return t.forEach((u=>{l.push({type:0,doc:u})})),new Dc(e,t,cc.emptySet(t),l,i,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Eh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W6{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class X6{constructor(){this.queries=vS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const s=xe(t),a=s.queries;s.queries=vS(),a.forEach(((l,u)=>{for(const h of u.Sa)h.onError(i)}))})(this,new de(ie.ABORTED,"Firestore shutting down"))}}function vS(){return new Er((n=>MR(n)),Eh)}async function nT(n,e){const t=xe(n);let i=3;const s=e.query;let a=t.queries.get(s);a?!a.ba()&&e.Da()&&(i=2):(a=new W6,i=e.Da()?0:1);try{switch(i){case 0:a.wa=await t.onListen(s,!0);break;case 1:a.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(l){const u=Jc(l,`Initialization of query '${Xl(e.query)}' failed`);return void e.onError(u)}t.queries.set(s,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&sT(t)}async function iT(n,e){const t=xe(n),i=e.query;let s=3;const a=t.queries.get(i);if(a){const l=a.Sa.indexOf(e);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?s=e.Da()?0:1:!a.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function Z6(n,e){const t=xe(n);let i=!1;for(const s of e){const a=s.query,l=t.queries.get(a);if(l){for(const u of l.Sa)u.Fa(s)&&(i=!0);l.wa=s}}i&&sT(t)}function eF(n,e,t){const i=xe(n),s=i.queries.get(e);if(s)for(const a of s.Sa)a.onError(t);i.queries.delete(e)}function sT(n){n.Ca.forEach((e=>{e.next()}))}var xv,TS;(TS=xv||(xv={})).Ma="default",TS.Cache="cache";class rT{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new Dc(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Dc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==xv.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e){this.serializer=e}$s(e){return Os(this.serializer,e)}Us(e){return e.metadata.exists?i1(this.serializer,e.document,!1):Nt.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Jt(e)}}class nF{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=G1(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const i=We.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,i=new xS(this.serializer);for(const s of e)if(s.metadata.queries){const a=i.$s(s.metadata.name);for(const l of s.metadata.queries){const u=(t.get(l)||ze()).add(a);t.set(l,u)}}return t}async ja(e){const t=await N6(e,new xS(this.serializer),this.Wa,this.Ua.id),i=this.za(this.documents);for(const s of this.Ka)await C6(e,s,i.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function G1(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e){this.key=e}}class H1{constructor(e){this.key=e}}class $1{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ze(),this.mutatedKeys=ze(),this.eu=VR(e),this.tu=new cc(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new _S,s=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=s,u=!1;const h=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,m=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((_,T)=>{const E=s.get(_),S=wh(this.query,T)?T:null,k=!!E&&this.mutatedKeys.has(E.key),V=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let O=!1;E&&S?E.data.isEqual(S.data)?k!==V&&(i.track({type:3,doc:S}),O=!0):this.su(E,S)||(i.track({type:2,doc:S}),O=!0,(h&&this.eu(S,h)>0||m&&this.eu(S,m)<0)&&(u=!0)):!E&&S?(i.track({type:0,doc:S}),O=!0):E&&!S&&(i.track({type:1,doc:E}),O=!0,(h||m)&&(u=!0)),O&&(S?(l=l.add(S),a=V?a.add(_):a.delete(_)):(l=l.delete(_),a=a.delete(_)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const _=this.query.limitType==="F"?l.last():l.first();l=l.delete(_.key),a=a.delete(_.key),i.track({type:1,doc:_})}return{tu:l,iu:i,Cs:u,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((_,T)=>(function(S,k){const V=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return be(20277,{Rt:O})}};return V(S)-V(k)})(_.type,T.type)||this.eu(_.doc,T.doc))),this.ou(i),s=s??!1;const u=t&&!s?this._u():[],h=this.Xa.size===0&&this.current&&!s?1:0,m=h!==this.Za;return this.Za=h,l.length!==0||m?{snapshot:new Dc(this.query,e.tu,a,l,e.mutatedKeys,h===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new _S,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ze(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new H1(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new z1(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=ze();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Dc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Fo="SyncEngine";class iF{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class sF{constructor(e){this.key=e,this.hu=!1}}class rF{constructor(e,t,i,s,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Er((u=>MR(u)),Eh),this.Iu=new Map,this.Eu=new Set,this.du=new bt(ve.comparator),this.Au=new Map,this.Ru=new z0,this.Vu={},this.mu=new Map,this.fu=Ha.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function oF(n,e,t=!0){const i=zp(n);let s;const a=i.Tu.get(e);return a?(i.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await K1(i,e,t,!0),s}async function aF(n,e){const t=zp(n);await K1(t,e,!0,!1)}async function K1(n,e,t,i){const s=await Cc(n.localStore,Kn(e)),a=s.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let u;return i&&(u=await oT(n,e,a,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&Gp(n.remoteStore,s),u}async function oT(n,e,t,i,s){n.pu=(T,E,S)=>(async function(V,O,j,W){let $=O.view.ru(j);$.Cs&&($=await ip(V.localStore,O.query,!1).then((({documents:R})=>O.view.ru(R,$))));const U=W&&W.targetChanges.get(O.targetId),K=W&&W.targetMismatches.get(O.targetId)!=null,J=O.view.applyChanges($,V.isPrimaryClient,U,K);return Ev(V,O.targetId,J.au),J.snapshot})(n,T,E,S);const a=await ip(n.localStore,e,!0),l=new $1(e,a.Qs),u=l.ru(a.documents),h=Sh.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),m=l.applyChanges(u,n.isPrimaryClient,h);Ev(n,t,m.au);const _=new iF(e,t,l);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function lF(n,e,t){const i=xe(n),s=i.Tu.get(e),a=i.Iu.get(s.targetId);if(a.length>1)return i.Iu.set(s.targetId,a.filter((l=>!Eh(l,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await Rc(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),t&&Pc(i.remoteStore,s.targetId),Mc(i,s.targetId)})).catch(Vo)):(Mc(i,s.targetId),await Rc(i.localStore,s.targetId,!0))}async function cF(n,e){const t=xe(n),i=t.Tu.get(e),s=t.Iu.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Pc(t.remoteStore,i.targetId))}async function uF(n,e,t){const i=uT(n);try{const s=await(function(l,u){const h=xe(l),m=dt.now(),_=u.reduce(((S,k)=>S.add(k.key)),ze());let T,E;return h.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let k=oi(),V=ze();return h.Ns.getEntries(S,_).next((O=>{k=O,k.forEach(((j,W)=>{W.isValidDocument()||(V=V.add(j))}))})).next((()=>h.localDocuments.getOverlayedDocuments(S,k))).next((O=>{T=O;const j=[];for(const W of u){const $=D5(W,T.get(W.key).overlayedDocument);$!=null&&j.push(new wr(W.key,$,bR($.value.mapValue),Vt.exists(!0)))}return h.mutationQueue.addMutationBatch(S,m,j,u)})).next((O=>{E=O;const j=O.applyToLocalDocumentSet(T,V);return h.documentOverlayCache.saveOverlays(S,O.batchId,j)}))})).then((()=>({batchId:E.batchId,changes:UR(T)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),(function(l,u,h){let m=l.Vu[l.currentUser.toKey()];m||(m=new bt(Fe)),m=m.insert(u,h),l.Vu[l.currentUser.toKey()]=m})(i,s.batchId,t),await br(i,s.changes),await Kc(i.remoteStore)}catch(s){const a=Jc(s,"Failed to persist write");t.reject(a)}}async function Y1(n,e){const t=xe(n);try{const i=await S6(t.localStore,e);e.targetChanges.forEach(((s,a)=>{const l=t.Au.get(a);l&&(Ne(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.hu=!0:s.modifiedDocuments.size>0?Ne(l.hu,14607):s.removedDocuments.size>0&&(Ne(l.hu,42227),l.hu=!1))})),await br(t,i,e)}catch(i){await Vo(i)}}function ES(n,e,t){const i=xe(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.Tu.forEach(((a,l)=>{const u=l.view.va(e);u.snapshot&&s.push(u.snapshot)})),(function(l,u){const h=xe(l);h.onlineState=u;let m=!1;h.queries.forEach(((_,T)=>{for(const E of T.Sa)E.va(u)&&(m=!0)})),m&&sT(h)})(i.eventManager,e),s.length&&i.Pu.H_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function dF(n,e,t){const i=xe(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Au.get(e),a=s&&s.key;if(a){let l=new bt(ve.comparator);l=l.insert(a,Nt.newNoDocument(a,Pe.min()));const u=ze().add(a),h=new Ih(Pe.min(),new Map,new bt(Fe),l,u);await Y1(i,h),i.du=i.du.remove(a),i.Au.delete(e),cT(i)}else await Rc(i.localStore,e,!1).then((()=>Mc(i,e,t))).catch(Vo)}async function hF(n,e){const t=xe(n),i=e.batch.batchId;try{const s=await I6(t.localStore,e);lT(t,i,null),aT(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await br(t,s)}catch(s){await Vo(s)}}async function fF(n,e,t){const i=xe(n);try{const s=await(function(l,u){const h=xe(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let _;return h.mutationQueue.lookupMutationBatch(m,u).next((T=>(Ne(T!==null,37113),_=T.keys(),h.mutationQueue.removeMutationBatch(m,T)))).next((()=>h.mutationQueue.performConsistencyCheck(m))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(m,_,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,_))).next((()=>h.localDocuments.getDocuments(m,_)))}))})(i.localStore,e);lT(i,e,t),aT(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await br(i,s)}catch(s){await Vo(s)}}async function mF(n,e){const t=xe(n);Oo(t.remoteStore)||he(Fo,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=await(function(l){const u=xe(l);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(h=>u.mutationQueue.getHighestUnacknowledgedBatchId(h)))})(t.localStore);if(i===To)return void e.resolve();const s=t.mu.get(i)||[];s.push(e),t.mu.set(i,s)}catch(i){const s=Jc(i,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function aT(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function lT(n,e,t){const i=xe(n);let s=i.Vu[i.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),i.Vu[i.currentUser.toKey()]=s}}function Mc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||J1(n,i)}))}function J1(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Pc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),cT(n))}function Ev(n,e,t){for(const i of t)i instanceof z1?(n.Ru.addReference(i.key,e),pF(n,i)):i instanceof H1?(he(Fo,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||J1(n,i.key)):be(19791,{wu:i})}function pF(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(he(Fo,"New document in limbo: "+t),n.Eu.add(i),cT(n))}function cT(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ve(We.fromString(e)),i=n.fu.next();n.Au.set(i,new sF(t)),n.du=n.du.insert(t,i),Gp(n.remoteStore,new cr(Kn(Gc(t.path)),i,"TargetPurposeLimboResolution",si.ce))}}async function br(n,e,t){const i=xe(n),s=[],a=[],l=[];i.Tu.isEmpty()||(i.Tu.forEach(((u,h)=>{l.push(i.pu(h,e,t).then((m=>{var _;if((m||t)&&i.isPrimaryClient){const T=m?!m.fromCache:(_=t==null?void 0:t.targetChanges.get(h.targetId))==null?void 0:_.current;i.sharedClientState.updateQueryState(h.targetId,T?"current":"not-current")}if(m){s.push(m);const T=Y0.As(h.targetId,m);a.push(T)}})))})),await Promise.all(l),i.Pu.H_(s),await(async function(h,m){const _=xe(h);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(T=>Q.forEach(m,(E=>Q.forEach(E.Es,(S=>_.persistence.referenceDelegate.addReference(T,E.targetId,S))).next((()=>Q.forEach(E.ds,(S=>_.persistence.referenceDelegate.removeReference(T,E.targetId,S)))))))))}catch(T){if(!Lo(T))throw T;he(J0,"Failed to update sequence numbers: "+T)}for(const T of m){const E=T.targetId;if(!T.fromCache){const S=_.Ms.get(E),k=S.snapshotVersion,V=S.withLastLimboFreeSnapshotVersion(k);_.Ms=_.Ms.insert(E,V)}}})(i.localStore,a))}async function gF(n,e){const t=xe(n);if(!t.currentUser.isEqual(e)){he(Fo,"User change. New user:",e.toKey());const i=await S1(t.localStore,e);t.currentUser=e,(function(a,l){a.mu.forEach((u=>{u.forEach((h=>{h.reject(new de(ie.CANCELLED,l))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await br(t,i.Ls)}}function yF(n,e){const t=xe(n),i=t.Au.get(e);if(i&&i.hu)return ze().add(i.key);{let s=ze();const a=t.Iu.get(e);if(!a)return s;for(const l of a){const u=t.Tu.get(l);s=s.unionWith(u.view.nu)}return s}}async function _F(n,e){const t=xe(n),i=await ip(t.localStore,e.query,!0),s=e.view.cu(i);return t.isPrimaryClient&&Ev(t,e.targetId,s.au),s}async function vF(n,e){const t=xe(n);return R1(t.localStore,e).then((i=>br(t,i)))}async function TF(n,e,t,i){const s=xe(n),a=await(function(u,h){const m=xe(u),_=xe(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",(T=>_.er(T,h).next((E=>E?m.localDocuments.getDocuments(T,E):Q.resolve(null)))))})(s.localStore,e);a!==null?(t==="pending"?await Kc(s.remoteStore):t==="acknowledged"||t==="rejected"?(lT(s,e,i||null),aT(s,e),(function(u,h){xe(xe(u).mutationQueue).ir(h)})(s.localStore,e)):be(6720,"Unknown batchState",{Su:t}),await br(s,a)):he(Fo,"Cannot apply mutation batch with id: "+e)}async function xF(n,e){const t=xe(n);if(zp(t),uT(t),e===!0&&t.gu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),s=await wS(t,i.toArray());t.gu=!0,await Tv(t.remoteStore,!0);for(const a of s)Gp(t.remoteStore,a)}else if(e===!1&&t.gu!==!1){const i=[];let s=Promise.resolve();t.Iu.forEach(((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?i.push(l):s=s.then((()=>(Mc(t,l),Rc(t.localStore,l,!0)))),Pc(t.remoteStore,l)})),await s,await wS(t,i),(function(l){const u=xe(l);u.Au.forEach(((h,m)=>{Pc(u.remoteStore,m)})),u.Ru.Jr(),u.Au=new Map,u.du=new bt(ve.comparator)})(t),t.gu=!1,await Tv(t.remoteStore,!1)}}async function wS(n,e,t){const i=xe(n),s=[],a=[];for(const l of e){let u;const h=i.Iu.get(l);if(h&&h.length!==0){u=await Cc(i.localStore,Kn(h[0]));for(const m of h){const _=i.Tu.get(m),T=await _F(i,_);T.snapshot&&a.push(T.snapshot)}}else{const m=await C1(i.localStore,l);u=await Cc(i.localStore,m),await oT(i,Q1(m),l,!1,u.resumeToken)}s.push(u)}return i.Pu.H_(a),s}function Q1(n){return DR(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function EF(n){return(function(t){return xe(xe(t).persistence).Ts()})(xe(n).localStore)}async function wF(n,e,t,i){const s=xe(n);if(s.gu)return void he(Fo,"Ignoring unexpected query state notification.");const a=s.Iu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=await R1(s.localStore,kR(a[0])),u=Ih.createSynthesizedRemoteEventForCurrentChange(e,t==="current",jt.EMPTY_BYTE_STRING);await br(s,l,u);break}case"rejected":await Rc(s.localStore,e,!0),Mc(s,e,i);break;default:be(64155,t)}}async function bF(n,e,t){const i=zp(n);if(i.gu){for(const s of e){if(i.Iu.has(s)&&i.sharedClientState.isActiveQueryTarget(s)){he(Fo,"Adding an already active target "+s);continue}const a=await C1(i.localStore,s),l=await Cc(i.localStore,a);await oT(i,Q1(a),l.targetId,!1,l.resumeToken),Gp(i.remoteStore,l)}for(const s of t)i.Iu.has(s)&&await Rc(i.localStore,s,!1).then((()=>{Pc(i.remoteStore,s),Mc(i,s)})).catch(Vo)}}function zp(n){const e=xe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Y1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dF.bind(null,e),e.Pu.H_=Z6.bind(null,e.eventManager),e.Pu.yu=eF.bind(null,e.eventManager),e}function uT(n){const e=xe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fF.bind(null,e),e}function IF(n,e,t){const i=xe(n);(async function(a,l,u){try{const h=await l.getMetadata();if(await(function(S,k){const V=xe(S),O=Jt(k.createTime);return V.persistence.runTransaction("hasNewerBundle","readonly",(j=>V.Ii.getBundleMetadata(j,k.id))).then((j=>!!j&&j.createTime.compareTo(O)>=0))})(a.localStore,h))return await l.close(),u._completeWith((function(S){return{taskState:"Success",documentsLoaded:S.totalDocuments,bytesLoaded:S.totalBytes,totalDocuments:S.totalDocuments,totalBytes:S.totalBytes}})(h)),Promise.resolve(new Set);u._updateProgress(G1(h));const m=new nF(h,l.serializer);let _=await l.bu();for(;_;){const E=await m.Ga(_);E&&u._updateProgress(E),_=await l.bu()}const T=await m.ja(a.localStore);return await br(a,T.Ha,void 0),await(function(S,k){const V=xe(S);return V.persistence.runTransaction("Save bundle","readwrite",(O=>V.Ii.saveBundleMetadata(O,k)))})(a.localStore,h),u._completeWith(T.progress),Promise.resolve(T.Ja)}catch(h){return js(Fo,`Loading bundle failed with ${h}`),u._failWith(h),Promise.resolve(new Set)}})(i,e,t).then((s=>{i.sharedClientState.notifyBundleLoaded(s)}))}class ih{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ah(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return I1(this.persistence,new b1,e.initialUser,this.serializer)}Cu(e){return new H0(Bp.mi,this.serializer)}Du(e){return new V1}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ih.provider={build:()=>new ih};class SF extends ih{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ne(this.persistence.referenceDelegate instanceof np,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new _1(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Vn.withCacheSize(this.cacheSizeBytes):Vn.DEFAULT;return new H0((i=>np.mi(i,t)),this.serializer)}}class W1 extends ih{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await uT(this.xu.syncEngine),await Kc(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return I1(this.persistence,new b1,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new _1(i,e.asyncQueue,t)}Mu(e,t){const i=new VO(t,this.persistence);return new kO(e.asyncQueue,i)}Cu(e){const t=K0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Vn.withCacheSize(this.cacheSizeBytes):Vn.DEFAULT;return new $0(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,L1(),Mm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new V1}}class AF extends W1{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof V_&&(this.sharedClientState.syncEngine={Co:TF.bind(null,t),vo:wF.bind(null,t),Fo:bF.bind(null,t),Ts:EF.bind(null,t),Do:vF.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async i=>{await xF(this.xu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Du(e){const t=L1();if(!V_.v(t))throw new de(ie.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=K0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new V_(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class sh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>ES(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=gF.bind(null,this.syncEngine),await Tv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new X6})()}createDatastore(e){const t=Ah(e.databaseInfo.databaseId),i=(function(a){return new k6(a)})(e.databaseInfo);return(function(a,l,u,h){return new O6(a,l,u,h)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,s,a,l,u){return new q6(i,s,a,l,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>ES(this.syncEngine,t,0)),(function(){return pS.v()?new pS:new R6})())}createSyncEngine(e,t){return(function(s,a,l,u,h,m,_){const T=new rF(s,a,l,u,h,m);return _&&(T.gu=!0),T})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const a=xe(s);he($a,"RemoteStore shutting down."),a.Ea.add(5),await $c(a),a.Aa.shutdown(),a.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}sh.provider={build:()=>new sh};function bS(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Yt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Pn,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((i=>{i&&i.$a()?this.metadata.resolve(i.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i==null?void 0:i.Qa)}`))}),(i=>this.metadata.reject(i)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),i=Number(t);isNaN(i)&&this.Qu(`length string (${t}) is not valid number`);const s=await this.$u(i);return new tF(JSON.parse(s),e.length+i)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new de(ie.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(s,a){const l=xe(s),u={documents:a.map((T=>th(l.serializer,T)))},h=await l.Ho("BatchGetDocuments",l.serializer.databaseId,We.emptyPath(),u,a.length),m=new Map;h.forEach((T=>{const E=j5(l.serializer,T);m.set(E.key.toString(),E)}));const _=[];return a.forEach((T=>{const E=m.get(T.toString());Ne(!!E,55234,{key:T}),_.push(E)})),_})(this.datastore,e);return t.forEach((i=>this.recordVersion(i))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new Hc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,i)=>{const s=ve.fromPath(i);this.mutations.push(new V0(s,this.precondition(s)))})),await(async function(i,s){const a=xe(i),l={writes:s.map((u=>nh(a.serializer,u)))};await a.Go("Commit",a.serializer.databaseId,We.emptyPath(),l)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw be(50498,{Gu:e.constructor.name});t=Pe.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new de(ie.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Pe.min())?Vt.exists(!1):Vt.updateTime(t):Vt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Pe.min()))throw new de(ie.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Vt.updateTime(t)}return Vt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(e,t,i,s,a){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=s,this.deferred=a,this.zu=i.maxAttempts,this.M_=new W0(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new CF(this.datastore),t=this.Hu(e);t&&t.then((i=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(i)})).catch((s=>{this.Yu(s)}))))})).catch((i=>{this.Yu(i)}))}))}Hu(e){try{const t=this.updateFunction(e);return!vh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!KR(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po="FirestoreClient";class PF{constructor(e,t,i,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=vn.UNAUTHENTICATED,this.clientId=x0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(i,(async l=>{he(Po,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(i,(l=>(he(Po,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Pn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Jc(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function U_(n,e){n.asyncQueue.verifyOperationInProgress(),he(Po,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await S1(e.localStore,s),i=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function IS(n,e){n.asyncQueue.verifyOperationInProgress();const t=await dT(n);he(Po,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>yS(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>yS(e.remoteStore,s))),n._onlineComponents=e}async function dT(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){he(Po,"Using user provided OfflineComponentProvider");try{await U_(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===ie.FAILED_PRECONDITION||s.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;js("Error using user provided cache. Falling back to memory cache: "+t),await U_(n,new ih)}}else he(Po,"Using default OfflineComponentProvider"),await U_(n,new SF(void 0));return n._offlineComponents}async function $p(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(he(Po,"Using user provided OnlineComponentProvider"),await IS(n,n._uninitializedComponentsProvider._online)):(he(Po,"Using default OnlineComponentProvider"),await IS(n,new sh))),n._onlineComponents}function X1(n){return dT(n).then((e=>e.persistence))}function hT(n){return dT(n).then((e=>e.localStore))}function Z1(n){return $p(n).then((e=>e.remoteStore))}function fT(n){return $p(n).then((e=>e.syncEngine))}function DF(n){return $p(n).then((e=>e.datastore))}async function kc(n){const e=await $p(n),t=e.eventManager;return t.onListen=oF.bind(null,e.syncEngine),t.onUnlisten=lF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=aF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=cF.bind(null,e.syncEngine),t}function MF(n){return n.asyncQueue.enqueue((async()=>{const e=await X1(n),t=await Z1(n);return e.setNetworkEnabled(!0),(function(s){const a=xe(s);return a.Ea.delete(0),Nh(a)})(t)}))}function kF(n){return n.asyncQueue.enqueue((async()=>{const e=await X1(n),t=await Z1(n);return e.setNetworkEnabled(!1),(async function(s){const a=xe(s);a.Ea.add(0),await $c(a),a.Ra.set("Offline")})(t)}))}function VF(n,e){const t=new Pn;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,a,l){try{const u=await(function(m,_){const T=xe(m);return T.persistence.runTransaction("read document","readonly",(E=>T.localDocuments.getDocument(E,_)))})(s,a);u.isFoundDocument()?l.resolve(u):u.isNoDocument()?l.resolve(null):l.reject(new de(ie.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const h=Jc(u,`Failed to get document '${a} from cache`);l.reject(h)}})(await hT(n),e,t))),t.promise}function eP(n,e,t={}){const i=new Pn;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,u,h,m){const _=new Hp({next:E=>{_.Nu(),l.enqueueAndForget((()=>iT(a,T)));const S=E.docs.has(u);!S&&E.fromCache?m.reject(new de(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&E.fromCache&&h&&h.source==="server"?m.reject(new de(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(E)},error:E=>m.reject(E)}),T=new rT(Gc(u.path),_,{includeMetadataChanges:!0,qa:!0});return nT(a,T)})(await kc(n),n.asyncQueue,e,t,i))),i.promise}function LF(n,e){const t=new Pn;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,a,l){try{const u=await ip(s,a,!0),h=new $1(a,u.Qs),m=h.ru(u.documents),_=h.applyChanges(m,!1);l.resolve(_.snapshot)}catch(u){const h=Jc(u,`Failed to execute query '${a} against cache`);l.reject(h)}})(await hT(n),e,t))),t.promise}function tP(n,e,t={}){const i=new Pn;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,u,h,m){const _=new Hp({next:E=>{_.Nu(),l.enqueueAndForget((()=>iT(a,T))),E.fromCache&&h.source==="server"?m.reject(new de(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(E)},error:E=>m.reject(E)}),T=new rT(u,_,{includeMetadataChanges:!0,qa:!0});return nT(a,T)})(await kc(n),n.asyncQueue,e,t,i))),i.promise}function UF(n,e){const t=new Hp(e);return n.asyncQueue.enqueueAndForget((async()=>(function(s,a){xe(s).Ca.add(a),a.next()})(await kc(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(s,a){xe(s).Ca.delete(a)})(await kc(n),t)))}}function OF(n,e,t,i){const s=(function(l,u){let h;return h=typeof l=="string"?JR().encode(l):l,(function(_,T){return new NF(_,T)})((function(_,T){if(_ instanceof Uint8Array)return bS(_,T);if(_ instanceof ArrayBuffer)return bS(new Uint8Array(_),T);if(_ instanceof ReadableStream)return _.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(h),u)})(t,Ah(e));n.asyncQueue.enqueueAndForget((async()=>{IF(await fT(n),s,i)}))}function FF(n,e){return n.asyncQueue.enqueue((async()=>(function(i,s){const a=xe(i);return a.persistence.runTransaction("Get named query","readonly",(l=>a.Ii.getNamedQuery(l,s)))})(await hT(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SS=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP="firestore.googleapis.com",AS=!0;class NS{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new de(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=iP,this.ssl=AS}else this.host=e.host,this.ssl=e.ssl??AS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=m1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<o6)throw new de(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}QC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nP(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new de(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new de(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new de(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ch{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new NS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new de(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new de(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new NS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new EO;switch(i.type){case"firstParty":return new SO(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new de(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=SS.get(t);i&&(he("ComponentProvider","Removing Datastore"),SS.delete(t),i.terminate())})(this),Promise.resolve()}}function qF(n,e,t,i={}){var m;n=at(n,Ch);const s=Uc(e),a=n._getSettings(),l={...a,emulatorOptions:n._getEmulatorOptions()},u=`${e}:${t}`;s&&(EN(`https://${u}`),wN("Firestore",!0)),a.host!==iP&&a.host!==u&&js("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...a,host:u,ssl:s,emulatorOptions:i};if(!Eo(h,l)&&(n._setSettings(h),i.mockUserToken)){let _,T;if(typeof i.mockUserToken=="string")_=i.mockUserToken,T=vn.MOCK_USER;else{_=U2(i.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const E=i.mockUserToken.sub||i.mockUserToken.user_id;if(!E)throw new de(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");T=new vn(E)}n._authCredentials=new wO(new YC(_,T))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jn=class sP{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new sP(this.firestore,e,this._query)}},wt=class Td{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Td(this.firestore,e,this._key)}toJSON(){return{type:Td._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(_h(t,Td._jsonSchema))return new Td(e,i||null,new ve(We.fromString(t.referencePath)))}};wt._jsonSchemaVersion="firestore/documentReference/1.0",wt._jsonSchema={type:ln("string",wt._jsonSchemaVersion),referencePath:ln("string")};let xo=class rP extends Jn{constructor(e,t,i){super(e,t,Gc(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wt(this.firestore,null,new ve(e))}withConverter(e){return new rP(this.firestore,e,this._path)}};function oP(n,e,...t){if(n=De(n),E0("collection","path",e),n instanceof Ch){const i=We.fromString(e,...t);return gI(i),new xo(n,null,i)}{if(!(n instanceof wt||n instanceof xo))throw new de(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(We.fromString(e,...t));return gI(i),new xo(n.firestore,null,i)}}function jF(n,e){if(n=at(n,Ch),E0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new de(ie.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Jn(n,null,(function(i){return new xr(We.emptyPath(),i)})(e))}function ap(n,e,...t){if(n=De(n),arguments.length===1&&(e=x0.newId()),E0("doc","path",e),n instanceof Ch){const i=We.fromString(e,...t);return pI(i),new wt(n,null,new ve(i))}{if(!(n instanceof wt||n instanceof xo))throw new de(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(We.fromString(e,...t));return pI(i),new wt(n.firestore,n instanceof xo?n.converter:null,new ve(i))}}function aP(n,e){return n=De(n),e=De(e),(n instanceof wt||n instanceof xo)&&(e instanceof wt||e instanceof xo)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function lP(n,e){return n=De(n),e=De(e),n instanceof Jn&&e instanceof Jn&&n.firestore===e.firestore&&Eh(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CS="AsyncQueue";class RS{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new W0(this,"async_queue_retry"),this._c=()=>{const i=Mm();i&&he(CS,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Mm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Mm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Pn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Lo(e))throw e;he(CS,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Yt("INTERNAL UNHANDLED ERROR: ",PS(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=tT.createAndSchedule(this,e,t,i,(a=>this.hc(a)));return this.tc.push(s),s}uc(){this.nc&&be(47125,{Pc:PS(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function PS(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const s=t;for(const a of i)if(a in s&&typeof s[a]=="function")return!0;return!1})(n,["next","error","complete"])}class BF{constructor(){this._progressObserver={},this._taskCompletionResolver=new Pn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF=-1;let Qt=class extends Ch{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new RS,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new RS(e),this._firestoreClient=void 0,await e}}};function qn(n){if(n._terminated)throw new de(ie.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||cP(n),n._firestoreClient}function cP(n){var i,s,a;const e=n._freezeSettings(),t=(function(u,h,m,_){return new u5(u,h,m,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,nP(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((a=e.localCache)!=null&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new PF(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(u){const h=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(h),_online:h}})(n._componentsProvider))}function zF(n,e){js("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return uP(n,sh.provider,{build:i=>new W1(i,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function HF(n){js("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();uP(n,sh.provider,{build:t=>new AF(t,e.cacheSizeBytes)})}function uP(n,e,t){if((n=at(n,Qt))._firestoreClient||n._terminated)throw new de(ie.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new de(ie.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},cP(n)}function $F(n){if(n._initialized&&!n._terminated)throw new de(ie.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Pn;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(i){if(!Us.v())return Promise.resolve();const s=i+w1;await Us.delete(s)})(K0(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function KF(n){return(function(t){const i=new Pn;return t.asyncQueue.enqueueAndForget((async()=>mF(await fT(t),i))),i.promise})(qn(n=at(n,Qt)))}function YF(n){return MF(qn(n=at(n,Qt)))}function JF(n){return kF(qn(n=at(n,Qt)))}function QF(n,e){const t=qn(n=at(n,Qt)),i=new BF;return OF(t,n._databaseId,e,i),i}function WF(n,e){return FF(qn(n=at(n,Qt)),e).then((t=>t?new Jn(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Un(jt.fromBase64String(e))}catch(t){throw new de(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Un(jt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Un._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(_h(e,Un._jsonSchema))return Un.fromBase64String(e.bytes)}}Un._jsonSchemaVersion="firestore/bytes/1.0",Un._jsonSchema={type:ln("string",Un._jsonSchemaVersion),bytes:ln("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Do=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new de(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xa=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new de(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new de(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Fe(this._lat,e._lat)||Fe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:is._jsonSchemaVersion}}static fromJSON(e){if(_h(e,is._jsonSchema))return new is(e.latitude,e.longitude)}}is._jsonSchemaVersion="firestore/geoPoint/1.0",is._jsonSchema={type:ln("string",is._jsonSchemaVersion),latitude:ln("number"),longitude:ln("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,s){if(i.length!==s.length)return!1;for(let a=0;a<i.length;++a)if(i[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Fs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(_h(e,Fs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Fs(e.vectorValues);throw new de(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fs._jsonSchemaVersion="firestore/vectorValue/1.0",Fs._jsonSchema={type:ln("string",Fs._jsonSchemaVersion),vectorValues:ln("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XF=/^__.*__$/;class ZF{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new wr(e,this.data,this.fieldMask,t,this.fieldTransforms):new zc(e,this.data,t,this.fieldTransforms)}}class dP{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new wr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function hP(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw be(40011,{Ac:n})}}class Kp{constructor(e,t,i,s,a,l){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Kp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return lp(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(hP(this.Ac)&&XF.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class e3{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Ah(e)}Cc(e,t,i,s=!1){return new Kp({Ac:e,methodName:t,Dc:i,path:kt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Za(n){const e=n._freezeSettings(),t=Ah(n._databaseId);return new e3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Yp(n,e,t,i,s,a={}){const l=n.Cc(a.merge||a.mergeFields?2:0,e,t,s);TT("Data must be an object, but it was:",l,i);const u=pP(i,l);let h,m;if(a.merge)h=new ri(l.fieldMask),m=l.fieldTransforms;else if(a.mergeFields){const _=[];for(const T of a.mergeFields){const E=bv(e,T,t);if(!l.contains(E))throw new de(ie.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);yP(_,E)||_.push(E)}h=new ri(_),m=l.fieldTransforms.filter((T=>h.covers(T.field)))}else h=null,m=l.fieldTransforms;return new ZF(new Cn(u),h,m)}class Rh extends Xa{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rh}}function fP(n,e,t){return new Kp({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class mT extends Xa{_toFieldTransform(e){return new bh(e.path,new Sc)}isEqual(e){return e instanceof mT}}class pT extends Xa{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=fP(this,e,!0),i=this.vc.map((a=>el(a,t))),s=new ja(i);return new bh(e.path,s)}isEqual(e){return e instanceof pT&&Eo(this.vc,e.vc)}}class gT extends Xa{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=fP(this,e,!0),i=this.vc.map((a=>el(a,t))),s=new Ba(i);return new bh(e.path,s)}isEqual(e){return e instanceof gT&&Eo(this.vc,e.vc)}}class yT extends Xa{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Ac(e.serializer,qR(e.serializer,this.Fc));return new bh(e.path,t)}isEqual(e){return e instanceof yT&&this.Fc===e.Fc}}function _T(n,e,t,i){const s=n.Cc(1,e,t);TT("Data must be an object, but it was:",s,i);const a=[],l=Cn.empty();Uo(i,((h,m)=>{const _=xT(e,h,t);m=De(m);const T=s.yc(_);if(m instanceof Rh)a.push(_);else{const E=el(m,T);E!=null&&(a.push(_),l.set(_,E))}}));const u=new ri(a);return new dP(l,u,s.fieldTransforms)}function vT(n,e,t,i,s,a){const l=n.Cc(1,e,t),u=[bv(e,i,t)],h=[s];if(a.length%2!=0)throw new de(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<a.length;E+=2)u.push(bv(e,a[E])),h.push(a[E+1]);const m=[],_=Cn.empty();for(let E=u.length-1;E>=0;--E)if(!yP(m,u[E])){const S=u[E];let k=h[E];k=De(k);const V=l.yc(S);if(k instanceof Rh)m.push(S);else{const O=el(k,V);O!=null&&(m.push(S),_.set(S,O))}}const T=new ri(m);return new dP(_,T,l.fieldTransforms)}function mP(n,e,t,i=!1){return el(t,n.Cc(i?4:3,e))}function el(n,e){if(gP(n=De(n)))return TT("Unsupported field value:",e,n),pP(n,e);if(n instanceof Xa)return(function(i,s){if(!hP(s.Ac))throw s.Sc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${i._methodName}() is not currently supported inside arrays`);const a=i._toFieldTransform(s);a&&s.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,s){const a=[];let l=0;for(const u of i){let h=el(u,s.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),a.push(h),l++}return{arrayValue:{values:a}}})(n,e)}return(function(i,s){if((i=De(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return qR(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const a=dt.fromDate(i);return{timestampValue:Nc(s.serializer,a)}}if(i instanceof dt){const a=new dt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Nc(s.serializer,a)}}if(i instanceof is)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Un)return{bytesValue:XR(s.serializer,i._byteString)};if(i instanceof wt){const a=s.databaseId,l=i.firestore._databaseId;if(!l.isEqual(a))throw s.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:q0(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof Fs)return(function(l,u){return{mapValue:{fields:{[C0]:{stringValue:R0},[wc]:{arrayValue:{values:l.toArray().map((m=>{if(typeof m!="number")throw u.Sc("VectorValues must only contain numeric values.");return k0(u.serializer,m)}))}}}}}})(i,s);throw s.Sc(`Unsupported field value: ${Rp(i)}`)})(n,e)}function pP(n,e){const t={};return pR(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Uo(n,((i,s)=>{const a=el(s,e.mc(i));a!=null&&(t[i]=a)})),{mapValue:{fields:t}}}function gP(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof dt||n instanceof is||n instanceof Un||n instanceof wt||n instanceof Xa||n instanceof Fs)}function TT(n,e,t){if(!gP(t)||!WC(t)){const i=Rp(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function bv(n,e,t){if((e=De(e))instanceof Do)return e._internalPath;if(typeof e=="string")return xT(n,e);throw lp("Field path arguments must be of type string or ",n,!1,void 0,t)}const t3=new RegExp("[~\\*/\\[\\]]");function xT(n,e,t){if(e.search(t3)>=0)throw lp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Do(...e.split("."))._internalPath}catch{throw lp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function lp(n,e,t,i,s){const a=i&&!i.isEmpty(),l=s!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(a||l)&&(h+=" (found",a&&(h+=` in field ${i}`),l&&(h+=` in document ${s}`),h+=")"),new de(ie.INVALID_ARGUMENT,u+n+h)}function yP(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,t,i,s,a){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new wt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new n3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Jp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class n3 extends rh{data(){return super.data()}}function Jp(n,e){return typeof e=="string"?xT(n,e):e instanceof Do?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _P(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new de(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ET{}class Ph extends ET{}function uo(n,e,...t){let i=[];e instanceof ET&&i.push(e),i=i.concat(t),(function(a){const l=a.filter((h=>h instanceof wT)).length,u=a.filter((h=>h instanceof Qp)).length;if(l>1||l>0&&u>0)throw new de(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const s of i)n=s._apply(n);return n}class Qp extends Ph{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Qp(e,t,i)}_apply(e){const t=this._parse(e);return TP(e._query,t),new Jn(e.firestore,e.converter,uv(e._query,t))}_parse(e){const t=Za(e.firestore);return(function(a,l,u,h,m,_,T){let E;if(m.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new de(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){MS(T,_);const k=[];for(const V of T)k.push(DS(h,a,V));E={arrayValue:{values:k}}}else E=DS(h,a,T)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||MS(T,_),E=mP(u,l,T,_==="in"||_==="not-in");return et.create(m,_,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function i3(n,e,t){const i=e,s=Jp("where",n);return Qp._create(s,i,t)}class wT extends ET{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new wT(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:pt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,a){let l=s;const u=a.getFlattenedFilters();for(const h of u)TP(l,h),l=uv(l,h)})(e._query,t),new Jn(e.firestore,e.converter,uv(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class bT extends Ph{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new bT(e,t)}_apply(e){const t=(function(s,a,l){if(s.startAt!==null)throw new de(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new de(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new eh(a,l)})(e._query,this._field,this._direction);return new Jn(e.firestore,e.converter,(function(s,a){const l=s.explicitOrderBy.concat([a]);return new xr(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function s3(n,e="asc"){const t=e,i=Jp("orderBy",n);return bT._create(i,t)}class Wp extends Ph{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new Wp(e,t,i)}_apply(e){return new Jn(e.firestore,e.converter,Xm(e._query,this._limit,this._limitType))}}function r3(n){return XC("limit",n),Wp._create("limit",n,"F")}function o3(n){return XC("limitToLast",n),Wp._create("limitToLast",n,"L")}class Xp extends Ph{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new Xp(e,t,i)}_apply(e){const t=vP(e,this.type,this._docOrFields,this._inclusive);return new Jn(e.firestore,e.converter,(function(s,a){return new xr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,a,s.endAt)})(e._query,t))}}function a3(...n){return Xp._create("startAt",n,!0)}function l3(...n){return Xp._create("startAfter",n,!1)}class Zp extends Ph{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new Zp(e,t,i)}_apply(e){const t=vP(e,this.type,this._docOrFields,this._inclusive);return new Jn(e.firestore,e.converter,(function(s,a){return new xr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,a)})(e._query,t))}}function c3(...n){return Zp._create("endBefore",n,!1)}function u3(...n){return Zp._create("endAt",n,!0)}function vP(n,e,t,i){if(t[0]=De(t[0]),t[0]instanceof rh)return(function(a,l,u,h,m){if(!h)throw new de(ie.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const _=[];for(const T of lc(a))if(T.field.isKeyField())_.push(Fa(l,h.key));else{const E=h.data.field(T.field);if(Vp(E))throw new de(ie.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+T.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(E===null){const S=T.field.canonicalString();throw new de(ie.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${S}' (used as the orderBy) does not exist.`)}_.push(E)}return new Co(_,m)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{const s=Za(n.firestore);return(function(l,u,h,m,_,T){const E=l.explicitOrderBy;if(_.length>E.length)throw new de(ie.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const S=[];for(let k=0;k<_.length;k++){const V=_[k];if(E[k].field.isKeyField()){if(typeof V!="string")throw new de(ie.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof V}`);if(!D0(l)&&V.indexOf("/")!==-1)throw new de(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${V}' contains a slash.`);const O=l.path.child(We.fromString(V));if(!ve.isDocumentKey(O))throw new de(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${O}' is not because it contains an odd number of segments.`);const j=new ve(O);S.push(Fa(u,j))}else{const O=mP(h,m,V);S.push(O)}}return new Co(S,T)})(n._query,n.firestore._databaseId,s,e,t,i)}}function DS(n,e,t){if(typeof(t=De(t))=="string"){if(t==="")throw new de(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!D0(e)&&t.indexOf("/")!==-1)throw new de(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(We.fromString(t));if(!ve.isDocumentKey(i))throw new de(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Fa(n,new ve(i))}if(t instanceof wt)return Fa(n,t._key);throw new de(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Rp(t)}.`)}function MS(n,e){if(!Array.isArray(n)||n.length===0)throw new de(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function TP(n,e){const t=(function(s,a){for(const l of s)for(const u of l.getFlattenedFilters())if(a.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new de(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new de(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class IT{convertValue(e,t="none"){switch(Ao(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw be(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Uo(e,((s,a)=>{i[s]=this.convertValue(a,t)})),i}convertVectorValue(e){var i,s,a;const t=(a=(s=(i=e.fields)==null?void 0:i[wc].arrayValue)==null?void 0:s.values)==null?void 0:a.map((l=>Dt(l.doubleValue)));return new Fs(t)}convertGeoPoint(e){return new is(Dt(e.latitude),Dt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Lp(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Wd(e));default:return null}}convertTimestamp(e){const t=pr(e);return new dt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=We.fromString(e);Ne(c1(i),9688,{name:e});const s=new So(i.get(1),i.get(3)),a=new ve(i.popFirst(5));return s.isEqual(t)||Yt(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class d3 extends IT{constructor(e){super(),this.firestore=e}convertBytes(e){return new Un(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new wt(this.firestore,null,t)}}class Na{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Oi=class xP extends rh{constructor(e,t,i,s,a,l){super(e,t,i,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ld(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Jp("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new de(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=xP._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Oi._jsonSchemaVersion="firestore/documentSnapshot/1.0",Oi._jsonSchema={type:ln("string",Oi._jsonSchemaVersion),bundleSource:ln("string","DocumentSnapshot"),bundleName:ln("string"),bundle:ln("string")};let Ld=class extends Oi{data(e={}){return super.data(e)}},ss=class EP{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Na(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Ld(this._firestore,this._userDataWriter,i.key,i,new Na(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new de(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((u=>{const h=new Ld(s._firestore,s._userDataWriter,u.doc.key,u.doc,new Na(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((u=>a||u.type!==3)).map((u=>{const h=new Ld(s._firestore,s._userDataWriter,u.doc.key,u.doc,new Na(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);let m=-1,_=-1;return u.type!==0&&(m=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),_=l.indexOf(u.doc.key)),{type:h3(u.type),doc:h,oldIndex:m,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new de(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=EP._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=x0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),i.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function h3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return be(61501,{type:n})}}function wP(n,e){return n instanceof Oi&&e instanceof Oi?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof ss&&e instanceof ss&&n._firestore===e._firestore&&lP(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f3(n){n=at(n,wt);const e=at(n.firestore,Qt);return eP(qn(e),n._key).then((t=>ST(e,n,t)))}ss._jsonSchemaVersion="firestore/querySnapshot/1.0",ss._jsonSchema={type:ln("string",ss._jsonSchemaVersion),bundleSource:ln("string","QuerySnapshot"),bundleName:ln("string"),bundle:ln("string")};class tl extends IT{constructor(e){super(),this.firestore=e}convertBytes(e){return new Un(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new wt(this.firestore,null,t)}}function m3(n){n=at(n,wt);const e=at(n.firestore,Qt),t=qn(e),i=new tl(e);return VF(t,n._key).then((s=>new Oi(e,i,n._key,s,new Na(s!==null&&s.hasLocalMutations,!0),n.converter)))}function p3(n){n=at(n,wt);const e=at(n.firestore,Qt);return eP(qn(e),n._key,{source:"server"}).then((t=>ST(e,n,t)))}function g3(n){n=at(n,Jn);const e=at(n.firestore,Qt),t=qn(e),i=new tl(e);return _P(n._query),tP(t,n._query).then((s=>new ss(e,i,n,s)))}function y3(n){n=at(n,Jn);const e=at(n.firestore,Qt),t=qn(e),i=new tl(e);return LF(t,n._query).then((s=>new ss(e,i,n,s)))}function _3(n){n=at(n,Jn);const e=at(n.firestore,Qt),t=qn(e),i=new tl(e);return tP(t,n._query,{source:"server"}).then((s=>new ss(e,i,n,s)))}function kS(n,e,t){n=at(n,wt);const i=at(n.firestore,Qt),s=eg(n.converter,e,t);return Dh(i,[Yp(Za(i),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Vt.none())])}function VS(n,e,t,...i){n=at(n,wt);const s=at(n.firestore,Qt),a=Za(s);let l;return l=typeof(e=De(e))=="string"||e instanceof Do?vT(a,"updateDoc",n._key,e,t,i):_T(a,"updateDoc",n._key,e),Dh(s,[l.toMutation(n._key,Vt.exists(!0))])}function v3(n){return Dh(at(n.firestore,Qt),[new Hc(n._key,Vt.none())])}function T3(n,e){const t=at(n.firestore,Qt),i=ap(n),s=eg(n.converter,e);return Dh(t,[Yp(Za(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,Vt.exists(!1))]).then((()=>i))}function bP(n,...e){var h,m,_;n=De(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||wv(e[i])||(t=e[i++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(wv(e[i])){const T=e[i];e[i]=(h=T.next)==null?void 0:h.bind(T),e[i+1]=(m=T.error)==null?void 0:m.bind(T),e[i+2]=(_=T.complete)==null?void 0:_.bind(T)}let a,l,u;if(n instanceof wt)l=at(n.firestore,Qt),u=Gc(n._key.path),a={next:T=>{e[i]&&e[i](ST(l,n,T))},error:e[i+1],complete:e[i+2]};else{const T=at(n,Jn);l=at(T.firestore,Qt),u=T._query;const E=new tl(l);a={next:S=>{e[i]&&e[i](new ss(l,E,T,S))},error:e[i+1],complete:e[i+2]},_P(n._query)}return(function(E,S,k,V){const O=new Hp(V),j=new rT(S,O,k);return E.asyncQueue.enqueueAndForget((async()=>nT(await kc(E),j))),()=>{O.Nu(),E.asyncQueue.enqueueAndForget((async()=>iT(await kc(E),j)))}})(qn(l),u,s,a)}function x3(n,e){return UF(qn(n=at(n,Qt)),wv(e)?e:{next:e})}function Dh(n,e){return(function(i,s){const a=new Pn;return i.asyncQueue.enqueueAndForget((async()=>uF(await fT(i),s,a))),a.promise})(qn(n),e)}function ST(n,e,t){const i=t.docs.get(e._key),s=new tl(n);return new Oi(n,s,e._key,i,new Na(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let w3=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Za(e)}set(e,t,i){this._verifyNotCommitted();const s=po(e,this._firestore),a=eg(s.converter,t,i),l=Yp(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,i);return this._mutations.push(l.toMutation(s._key,Vt.none())),this}update(e,t,i,...s){this._verifyNotCommitted();const a=po(e,this._firestore);let l;return l=typeof(t=De(t))=="string"||t instanceof Do?vT(this._dataReader,"WriteBatch.update",a._key,t,i,s):_T(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,Vt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=po(e,this._firestore);return this._mutations=this._mutations.concat(new Hc(t._key,Vt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new de(ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function po(n,e){if((n=De(n)).firestore!==e)throw new de(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Za(e)}get(e){const t=po(e,this._firestore),i=new d3(this._firestore);return this._transaction.lookup([t._key]).then((s=>{if(!s||s.length!==1)return be(24041);const a=s[0];if(a.isFoundDocument())return new rh(this._firestore,i,a.key,a,t.converter);if(a.isNoDocument())return new rh(this._firestore,i,t._key,null,t.converter);throw be(18433,{doc:a})}))}set(e,t,i){const s=po(e,this._firestore),a=eg(s.converter,t,i),l=Yp(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(e,t,i,...s){const a=po(e,this._firestore);let l;return l=typeof(t=De(t))=="string"||t instanceof Do?vT(this._dataReader,"Transaction.update",a._key,t,i,s):_T(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=po(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let I3=class extends b3{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=po(e,this._firestore),i=new tl(this._firestore);return super.get(e).then((s=>new Oi(this._firestore,i,t._key,s._document,new Na(!1,!1),t.converter)))}};function S3(n,e,t){n=at(n,Qt);const i={...E3,...t};return(function(a){if(a.maxAttempts<1)throw new de(ie.INVALID_ARGUMENT,"Max attempts must be at least 1")})(i),(function(a,l,u){const h=new Pn;return a.asyncQueue.enqueueAndForget((async()=>{const m=await DF(a);new RF(a.asyncQueue,m,u,l,h).ju()})),h.promise})(qn(n),(s=>e(new I3(n,s))),i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A3(){return new Rh("deleteField")}function N3(){return new mT("serverTimestamp")}function C3(...n){return new pT("arrayUnion",n)}function R3(...n){return new gT("arrayRemove",n)}function P3(n){return new yT("increment",n)}(function(e,t=!0){(function(s){Bc=s})(Mo),qi(new Yn("firestore",((i,{instanceIdentifier:s,options:a})=>{const l=i.getProvider("app").getImmediate(),u=new Qt(new bO(i.getProvider("auth-internal")),new AO(l,i.getProvider("app-check-internal")),(function(m,_){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new de(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new So(m.options.projectId,_)})(l,s),l);return a={useFetchStreams:t,...a},u._setSettings(a),u}),"PUBLIC").setMultipleInstances(!0)),$n(dI,hI,e),$n(dI,hI,"esm2020")})();const D3="@firebase/firestore-compat",M3="0.4.2";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AT(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new de("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(){if(typeof Uint8Array>"u")throw new de("unimplemented","Uint8Arrays are not available in this environment.")}function US(){if(!l5())throw new de("unimplemented","Blobs are unavailable in Firestore in this environment.")}let IP=class Iv{constructor(e){this._delegate=e}static fromBase64String(e){return US(),new Iv(Un.fromBase64String(e))}static fromUint8Array(e){return LS(),new Iv(Un.fromUint8Array(e))}toBase64(){return US(),this._delegate.toBase64()}toUint8Array(){return LS(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sv(n){return k3(n,["next","error","complete"])}function k3(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{enableIndexedDbPersistence(e,t){return zF(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return HF(e._delegate)}clearIndexedDbPersistence(e){return $F(e._delegate)}}class SP{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof So||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&js("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,i={}){qF(this._delegate,e,t,i)}enableNetwork(){return YF(this._delegate)}disableNetwork(){return JF(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,QC("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return KF(this._delegate)}onSnapshotsInSync(e){return x3(this._delegate,e)}get app(){if(!this._appCompat)throw new de("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Vc(this,oP(this._delegate,e))}catch(t){throw Hn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ui(this,ap(this._delegate,e))}catch(t){throw Hn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new zn(this,jF(this._delegate,e))}catch(t){throw Hn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return S3(this._delegate,t=>e(new AP(this,t)))}batch(){return qn(this._delegate),new NP(new w3(this._delegate,e=>Dh(this._delegate,e)))}loadBundle(e){return QF(this._delegate,e)}namedQuery(e){return WF(this._delegate,e).then(t=>t?new zn(this,t):null)}}class tg extends IT{constructor(e){super(),this.firestore=e}convertBytes(e){return new IP(new Un(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Ui.forKey(t,this.firestore,null)}}function L3(n){TO(n)}class AP{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new tg(e)}get(e){const t=Ca(e);return this._delegate.get(t).then(i=>new oh(this._firestore,new Oi(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const s=Ca(e);return i?(AT("Transaction.set",i),this._delegate.set(s,t,i)):this._delegate.set(s,t),this}update(e,t,i,...s){const a=Ca(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,i,...s),this}delete(e){const t=Ca(e);return this._delegate.delete(t),this}}class NP{constructor(e){this._delegate=e}set(e,t,i){const s=Ca(e);return i?(AT("WriteBatch.set",i),this._delegate.set(s,t,i)):this._delegate.set(s,t),this}update(e,t,i,...s){const a=Ca(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,i,...s),this}delete(e){const t=Ca(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Ka{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new Ld(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ah(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=Ka.INSTANCES;let s=i.get(e);s||(s=new WeakMap,i.set(e,s));let a=s.get(t);return a||(a=new Ka(e,new tg(e),t),s.set(t,a)),a}}Ka.INSTANCES=new WeakMap;class Ui{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new tg(e)}static forPath(e,t,i){if(e.length%2!==0)throw new de("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Ui(t,new wt(t._delegate,i,new ve(e)))}static forKey(e,t,i){return new Ui(t,new wt(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new Vc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Vc(this.firestore,oP(this._delegate,e))}catch(t){throw Hn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=De(e),e instanceof wt?aP(this._delegate,e):!1}set(e,t){t=AT("DocumentReference.set",t);try{return t?kS(this._delegate,e,t):kS(this._delegate,e)}catch(i){throw Hn(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return arguments.length===1?VS(this._delegate,e):VS(this._delegate,e,t,...i)}catch(s){throw Hn(s,"updateDoc()","DocumentReference.update()")}}delete(){return v3(this._delegate)}onSnapshot(...e){const t=CP(e),i=RP(e,s=>new oh(this.firestore,new Oi(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return bP(this._delegate,t,i)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=m3(this._delegate):(e==null?void 0:e.source)==="server"?t=p3(this._delegate):t=f3(this._delegate),t.then(i=>new oh(this.firestore,new Oi(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new Ui(this.firestore,e?this._delegate.withConverter(Ka.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Hn(n,e,t){return n.message=n.message.replace(e,t),n}function CP(n){for(const e of n)if(typeof e=="object"&&!Sv(e))return e;return{}}function RP(n,e){var i,s;let t;return Sv(n[0])?t=n[0]:Sv(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:a=>{t.next&&t.next(e(a))},error:(i=t.error)==null?void 0:i.bind(t),complete:(s=t.complete)==null?void 0:s.bind(t)}}class oh{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ui(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return wP(this._delegate,e._delegate)}}class ah extends oh{data(e){const t=this._delegate.data(e);return this._delegate._converter||xO(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class zn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new tg(e)}where(e,t,i){try{return new zn(this.firestore,uo(this._delegate,i3(e,t,i)))}catch(s){throw Hn(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new zn(this.firestore,uo(this._delegate,s3(e,t)))}catch(i){throw Hn(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new zn(this.firestore,uo(this._delegate,r3(e)))}catch(t){throw Hn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new zn(this.firestore,uo(this._delegate,o3(e)))}catch(t){throw Hn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new zn(this.firestore,uo(this._delegate,a3(...e)))}catch(t){throw Hn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new zn(this.firestore,uo(this._delegate,l3(...e)))}catch(t){throw Hn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new zn(this.firestore,uo(this._delegate,c3(...e)))}catch(t){throw Hn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new zn(this.firestore,uo(this._delegate,u3(...e)))}catch(t){throw Hn(t,"endAt()","Query.endAt()")}}isEqual(e){return lP(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=y3(this._delegate):(e==null?void 0:e.source)==="server"?t=_3(this._delegate):t=g3(this._delegate),t.then(i=>new Av(this.firestore,new ss(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=CP(e),i=RP(e,s=>new Av(this.firestore,new ss(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return bP(this._delegate,t,i)}withConverter(e){return new zn(this.firestore,e?this._delegate.withConverter(Ka.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class U3{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new ah(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Av{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new zn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ah(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new U3(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new ah(this._firestore,i))})}isEqual(e){return wP(this._delegate,e._delegate)}}class Vc extends zn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Ui(this.firestore,e):null}doc(e){try{return e===void 0?new Ui(this.firestore,ap(this._delegate)):new Ui(this.firestore,ap(this._delegate,e))}catch(t){throw Hn(t,"doc()","CollectionReference.doc()")}}add(e){return T3(this._delegate,e).then(t=>new Ui(this.firestore,t))}isEqual(e){return aP(this._delegate,e._delegate)}withConverter(e){return new Vc(this.firestore,e?this._delegate.withConverter(Ka.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ca(n){return at(n,wt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(...e){this._delegate=new Do(...e)}static documentId(){return new NT(kt.keyField().canonicalString())}isEqual(e){return e=De(e),e instanceof Do?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{static serverTimestamp(){const e=N3();return e._methodName="FieldValue.serverTimestamp",new ba(e)}static delete(){const e=A3();return e._methodName="FieldValue.delete",new ba(e)}static arrayUnion(...e){const t=C3(...e);return t._methodName="FieldValue.arrayUnion",new ba(t)}static arrayRemove(...e){const t=R3(...e);return t._methodName="FieldValue.arrayRemove",new ba(t)}static increment(e){const t=P3(e);return t._methodName="FieldValue.increment",new ba(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3={Firestore:SP,GeoPoint:is,Timestamp:dt,Blob:IP,Transaction:AP,WriteBatch:NP,DocumentReference:Ui,DocumentSnapshot:oh,Query:zn,QueryDocumentSnapshot:ah,QuerySnapshot:Av,CollectionReference:Vc,FieldPath:NT,FieldValue:ba,setLogLevel:L3,CACHE_SIZE_UNLIMITED:GF};function F3(n,e){n.INTERNAL.registerComponent(new Yn("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(i,s)},"PUBLIC").setServiceProps({...O3}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q3(n){F3(n,(e,t)=>new SP(e,t,new V3)),n.registerVersion(D3,M3)}q3(ke);const PP="@firebase/installations",CT="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP=1e4,MP=`w:${CT}`,kP="FIS_v2",j3="https://firebaseinstallations.googleapis.com/v1",B3=3600*1e3,G3="installations",z3="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H3={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ya=new _r(G3,z3,H3);function VP(n){return n instanceof Rn&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LP({projectId:n}){return`${j3}/projects/${n}/installations`}function UP(n){return{token:n.token,requestStatus:2,expiresIn:K3(n.expiresIn),creationTime:Date.now()}}async function OP(n,e){const i=(await e.json()).error;return Ya.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function FP({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function $3(n,{refreshToken:e}){const t=FP(n);return t.append("Authorization",Y3(e)),t}async function qP(n){const e=await n();return e.status>=500&&e.status<600?n():e}function K3(n){return Number(n.replace("s","000"))}function Y3(n){return`${kP} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J3({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=LP(n),s=FP(n),a=e.getImmediate({optional:!0});if(a){const m=await a.getHeartbeatsHeader();m&&s.append("x-firebase-client",m)}const l={fid:t,authVersion:kP,appId:n.appId,sdkVersion:MP},u={method:"POST",headers:s,body:JSON.stringify(l)},h=await qP(()=>fetch(i,u));if(h.ok){const m=await h.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:UP(m.authToken)}}else throw await OP("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jP(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q3(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W3=/^[cdef][\w-]{21}$/,Nv="";function X3(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=Z3(n);return W3.test(t)?t:Nv}catch{return Nv}}function Z3(n){return Q3(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ng(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BP=new Map;function GP(n,e){const t=ng(n);zP(t,e),eq(t,e)}function zP(n,e){const t=BP.get(n);if(t)for(const i of t)i(e)}function eq(n,e){const t=tq();t&&t.postMessage({key:n,fid:e}),nq()}let Ra=null;function tq(){return!Ra&&"BroadcastChannel"in self&&(Ra=new BroadcastChannel("[Firebase] FID Change"),Ra.onmessage=n=>{zP(n.data.key,n.data.fid)}),Ra}function nq(){BP.size===0&&Ra&&(Ra.close(),Ra=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iq="firebase-installations-database",sq=1,Ja="firebase-installations-store";let O_=null;function RT(){return O_||(O_=kN(iq,sq,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Ja)}}})),O_}async function cp(n,e){const t=ng(n),s=(await RT()).transaction(Ja,"readwrite"),a=s.objectStore(Ja),l=await a.get(t);return await a.put(e,t),await s.done,(!l||l.fid!==e.fid)&&GP(n,e.fid),e}async function HP(n){const e=ng(n),i=(await RT()).transaction(Ja,"readwrite");await i.objectStore(Ja).delete(e),await i.done}async function ig(n,e){const t=ng(n),s=(await RT()).transaction(Ja,"readwrite"),a=s.objectStore(Ja),l=await a.get(t),u=e(l);return u===void 0?await a.delete(t):await a.put(u,t),await s.done,u&&(!l||l.fid!==u.fid)&&GP(n,u.fid),u}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PT(n){let e;const t=await ig(n.appConfig,i=>{const s=rq(i),a=oq(n,s);return e=a.registrationPromise,a.installationEntry});return t.fid===Nv?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function rq(n){const e=n||{fid:X3(),registrationStatus:0};return $P(e)}function oq(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Ya.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=aq(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:lq(n)}:{installationEntry:e}}async function aq(n,e){try{const t=await J3(n,e);return cp(n.appConfig,t)}catch(t){throw VP(t)&&t.customData.serverCode===409?await HP(n.appConfig):await cp(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function lq(n){let e=await OS(n.appConfig);for(;e.registrationStatus===1;)await jP(100),e=await OS(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await PT(n);return i||t}return e}function OS(n){return ig(n,e=>{if(!e)throw Ya.create("installation-not-found");return $P(e)})}function $P(n){return cq(n)?{fid:n.fid,registrationStatus:0}:n}function cq(n){return n.registrationStatus===1&&n.registrationTime+DP<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uq({appConfig:n,heartbeatServiceProvider:e},t){const i=dq(n,t),s=$3(n,t),a=e.getImmediate({optional:!0});if(a){const m=await a.getHeartbeatsHeader();m&&s.append("x-firebase-client",m)}const l={installation:{sdkVersion:MP,appId:n.appId}},u={method:"POST",headers:s,body:JSON.stringify(l)},h=await qP(()=>fetch(i,u));if(h.ok){const m=await h.json();return UP(m)}else throw await OP("Generate Auth Token",h)}function dq(n,{fid:e}){return`${LP(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DT(n,e=!1){let t;const i=await ig(n.appConfig,a=>{if(!KP(a))throw Ya.create("not-registered");const l=a.authToken;if(!e&&mq(l))return a;if(l.requestStatus===1)return t=hq(n,e),a;{if(!navigator.onLine)throw Ya.create("app-offline");const u=gq(a);return t=fq(n,u),u}});return t?await t:i.authToken}async function hq(n,e){let t=await FS(n.appConfig);for(;t.authToken.requestStatus===1;)await jP(100),t=await FS(n.appConfig);const i=t.authToken;return i.requestStatus===0?DT(n,e):i}function FS(n){return ig(n,e=>{if(!KP(e))throw Ya.create("not-registered");const t=e.authToken;return yq(t)?{...e,authToken:{requestStatus:0}}:e})}async function fq(n,e){try{const t=await uq(n,e),i={...e,authToken:t};return await cp(n.appConfig,i),t}catch(t){if(VP(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await HP(n.appConfig);else{const i={...e,authToken:{requestStatus:0}};await cp(n.appConfig,i)}throw t}}function KP(n){return n!==void 0&&n.registrationStatus===2}function mq(n){return n.requestStatus===2&&!pq(n)}function pq(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+B3}function gq(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function yq(n){return n.requestStatus===1&&n.requestTime+DP<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _q(n){const e=n,{installationEntry:t,registrationPromise:i}=await PT(e);return i?i.catch(console.error):DT(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vq(n,e=!1){const t=n;return await Tq(t),(await DT(t,e)).token}async function Tq(n){const{registrationPromise:e}=await PT(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xq(n){if(!n||!n.options)throw F_("App Configuration");if(!n.name)throw F_("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw F_(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function F_(n){return Ya.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YP="installations",Eq="installations-internal",wq=n=>{const e=n.getProvider("app").getImmediate(),t=xq(e),i=_p(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},bq=n=>{const e=n.getProvider("app").getImmediate(),t=_p(e,YP).getImmediate();return{getId:()=>_q(t),getToken:s=>vq(t,s)}};function Iq(){qi(new Yn(YP,wq,"PUBLIC")),qi(new Yn(Eq,bq,"PRIVATE"))}Iq();$n(PP,CT);$n(PP,CT,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qS="analytics",Sq="firebase_id",Aq="origin",Nq=60*1e3,Cq="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",MT="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xn=new uh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rq={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},xi=new _r("analytics","Analytics",Rq);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pq(n){if(!n.startsWith(MT)){const e=xi.create("invalid-gtag-resource",{gtagURL:n});return xn.warn(e.message),""}return n}function JP(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function Dq(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function Mq(n,e){const t=Dq("firebase-js-sdk-policy",{createScriptURL:Pq}),i=document.createElement("script"),s=`${MT}?l=${n}&id=${e}`;i.src=t?t==null?void 0:t.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}function kq(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function Vq(n,e,t,i,s,a){const l=i[s];try{if(l)await e[l];else{const h=(await JP(t)).find(m=>m.measurementId===s);h&&await e[h.appId]}}catch(u){xn.error(u)}n("config",s,a)}async function Lq(n,e,t,i,s){try{let a=[];if(s&&s.send_to){let l=s.send_to;Array.isArray(l)||(l=[l]);const u=await JP(t);for(const h of l){const m=u.find(T=>T.measurementId===h),_=m&&e[m.appId];if(_)a.push(_);else{a=[];break}}}a.length===0&&(a=Object.values(e)),await Promise.all(a),n("event",i,s||{})}catch(a){xn.error(a)}}function Uq(n,e,t,i){async function s(a,...l){try{if(a==="event"){const[u,h]=l;await Lq(n,e,t,u,h)}else if(a==="config"){const[u,h]=l;await Vq(n,e,t,i,u,h)}else if(a==="consent"){const[u,h]=l;n("consent",u,h)}else if(a==="get"){const[u,h,m]=l;n("get",u,h,m)}else if(a==="set"){const[u]=l;n("set",u)}else n(a,...l)}catch(u){xn.error(u)}}return s}function Oq(n,e,t,i,s){let a=function(...l){window[i].push(arguments)};return window[s]&&typeof window[s]=="function"&&(a=window[s]),window[s]=Uq(a,n,e,t),{gtagCore:a,wrappedGtag:window[s]}}function Fq(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(MT)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qq=30,jq=1e3;class Bq{constructor(e={},t=jq){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const QP=new Bq;function Gq(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function zq(n){var l;const{appId:e,apiKey:t}=n,i={method:"GET",headers:Gq(t)},s=Cq.replace("{app-id}",e),a=await fetch(s,i);if(a.status!==200&&a.status!==304){let u="";try{const h=await a.json();(l=h.error)!=null&&l.message&&(u=h.error.message)}catch{}throw xi.create("config-fetch-failed",{httpStatus:a.status,responseMessage:u})}return a.json()}async function Hq(n,e=QP,t){const{appId:i,apiKey:s,measurementId:a}=n.options;if(!i)throw xi.create("no-app-id");if(!s){if(a)return{measurementId:a,appId:i};throw xi.create("no-api-key")}const l=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new Yq;return setTimeout(async()=>{u.abort()},Nq),WP({appId:i,apiKey:s,measurementId:a},l,u,e)}async function WP(n,{throttleEndTimeMillis:e,backoffCount:t},i,s=QP){var u;const{appId:a,measurementId:l}=n;try{await $q(i,e)}catch(h){if(l)return xn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:a,measurementId:l};throw h}try{const h=await zq(n);return s.deleteThrottleMetadata(a),h}catch(h){const m=h;if(!Kq(m)){if(s.deleteThrottleMetadata(a),l)return xn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${m==null?void 0:m.message}]`),{appId:a,measurementId:l};throw h}const _=Number((u=m==null?void 0:m.customData)==null?void 0:u.httpStatus)===503?Db(t,s.intervalMillis,qq):Db(t,s.intervalMillis),T={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return s.setThrottleMetadata(a,T),xn.debug(`Calling attemptFetch again in ${_} millis`),WP(n,T,i,s)}}function $q(n,e){return new Promise((t,i)=>{const s=Math.max(e-Date.now(),0),a=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(a),i(xi.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Kq(n){if(!(n instanceof Rn)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class Yq{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Jq(n,e,t,i,s){if(s&&s.global){n("event",t,i);return}else{const a=await e,l={...i,send_to:a};n("event",t,l)}}async function Qq(n,e,t,i){if(i&&i.global)return n("set",{screen_name:t}),Promise.resolve();{const s=await e;n("config",s,{update:!0,screen_name:t})}}async function Wq(n,e,t,i){if(i&&i.global)return n("set",{user_id:t}),Promise.resolve();{const s=await e;n("config",s,{update:!0,user_id:t})}}async function Xq(n,e,t,i){if(i&&i.global){const s={};for(const a of Object.keys(t))s[`user_properties.${a}`]=t[a];return n("set",s),Promise.resolve()}else{const s=await e;n("config",s,{update:!0,user_properties:t})}}async function Zq(n,e){const t=await n;window[`ga-disable-${t}`]=!e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ej(){if(Va())try{await Yv()}catch(n){return xn.warn(xi.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return xn.warn(xi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function tj(n,e,t,i,s,a,l){const u=Hq(n);u.then(E=>{t[E.measurementId]=E.appId,n.options.measurementId&&E.measurementId!==n.options.measurementId&&xn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${E.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(E=>xn.error(E)),e.push(u);const h=ej().then(E=>{if(E)return i.getId()}),[m,_]=await Promise.all([u,h]);Fq(a)||Mq(a,m.measurementId),s("js",new Date);const T=(l==null?void 0:l.config)??{};return T[Aq]="firebase",T.update=!0,_!=null&&(T[Sq]=_),s("config",m.measurementId,T),m.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nj=class{constructor(e){this.app=e}_delete(){return delete hr[this.app.options.appId],Promise.resolve()}},hr={},jS=[];const BS={};let km="dataLayer",XP="gtag",GS,Mh,Cv=!1;function ij(n){if(Cv)throw xi.create("already-initialized");n.dataLayerName&&(km=n.dataLayerName),n.gtagName&&(XP=n.gtagName)}function sj(){const n=[];if(yp()&&n.push("This is a browser extension environment."),NN()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,s)=>`(${s+1}) ${i}`).join(" "),t=xi.create("invalid-analytics-context",{errorInfo:e});xn.warn(t.message)}}function rj(n,e,t){sj();const i=n.options.appId;if(!i)throw xi.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)xn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw xi.create("no-api-key");if(hr[i]!=null)throw xi.create("already-exists",{id:i});if(!Cv){kq(km);const{wrappedGtag:a,gtagCore:l}=Oq(hr,jS,BS,km,XP);Mh=a,GS=l,Cv=!0}return hr[i]=tj(n,jS,BS,e,GS,km,t),new nj(n)}async function oj(){if(yp()||!NN()||!Va())return!1;try{return await Yv()}catch{return!1}}function aj(n,e,t){n=De(n),Qq(Mh,hr[n.app.options.appId],e,t).catch(i=>xn.error(i))}function lj(n,e,t){n=De(n),Wq(Mh,hr[n.app.options.appId],e,t).catch(i=>xn.error(i))}function ZP(n,e,t){n=De(n),Xq(Mh,hr[n.app.options.appId],e,t).catch(i=>xn.error(i))}function cj(n,e){n=De(n),Zq(hr[n.app.options.appId],e).catch(t=>xn.error(t))}function eD(n,e,t,i){n=De(n),Jq(Mh,hr[n.app.options.appId],e,t,i).catch(s=>xn.error(s))}const zS="@firebase/analytics",HS="0.10.19";function uj(){qi(new Yn(qS,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return rj(i,s,t)},"PUBLIC")),qi(new Yn("analytics-internal",n,"PRIVATE")),$n(zS,HS),$n(zS,HS,"esm2020");function n(e){try{const t=e.getProvider(qS).getImmediate();return{logEvent:(i,s,a)=>eD(t,i,s,a),setUserProperties:(i,s)=>ZP(t,i,s)}}catch(t){throw xi.create("interop-component-reg-failed",{reason:t})}}}uj();const dj="@firebase/analytics-compat",hj="0.2.25";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e,t){this.app=e,this._delegate=t}logEvent(e,t,i){eD(this._delegate,e,t,i)}setCurrentScreen(e,t){aj(this._delegate,e,t)}setUserId(e,t){lj(this._delegate,e,t)}setUserProperties(e,t){ZP(this._delegate,e,t)}setAnalyticsCollectionEnabled(e){cj(this._delegate,e)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rv;(function(n){n.ADD_SHIPPING_INFO="add_shipping_info",n.ADD_PAYMENT_INFO="add_payment_info",n.ADD_TO_CART="add_to_cart",n.ADD_TO_WISHLIST="add_to_wishlist",n.BEGIN_CHECKOUT="begin_checkout",n.CHECKOUT_PROGRESS="checkout_progress",n.EXCEPTION="exception",n.GENERATE_LEAD="generate_lead",n.LOGIN="login",n.PAGE_VIEW="page_view",n.PURCHASE="purchase",n.REFUND="refund",n.REMOVE_FROM_CART="remove_from_cart",n.SCREEN_VIEW="screen_view",n.SEARCH="search",n.SELECT_CONTENT="select_content",n.SELECT_ITEM="select_item",n.SELECT_PROMOTION="select_promotion",n.SET_CHECKOUT_OPTION="set_checkout_option",n.SHARE="share",n.SIGN_UP="sign_up",n.TIMING_COMPLETE="timing_complete",n.VIEW_CART="view_cart",n.VIEW_ITEM="view_item",n.VIEW_ITEM_LIST="view_item_list",n.VIEW_PROMOTION="view_promotion",n.VIEW_SEARCH_RESULTS="view_search_results"})(Rv||(Rv={}));/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fj=n=>{const e=n.getProvider("app-compat").getImmediate(),t=n.getProvider("analytics").getImmediate();return new tD(e,t)};function mj(){const n={Analytics:tD,settings:ij,isSupported:oj,EventName:Rv};ke.INTERNAL.registerComponent(new Yn("analytics-compat",fj,"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}mj();ke.registerVersion(dj,hj);const pj={apiKey:"AIzaSyCxUiyusobT7AHBnBp81ui0b6jptWXZZ2U",authDomain:"st22-f2f0e.firebaseapp.com",projectId:"st22-f2f0e",storageBucket:"st22-f2f0e.firebasestorage.app",messagingSenderId:"859513780268",appId:"1:859513780268:web:b73d97b63d72710435b989",measurementId:"G-GG0MH3BS9D"};ke.apps.length||ke.initializeApp(pj);ke.app();if(typeof window<"u")try{ke.analytics()}catch{console.warn("Firebase Analytics not supported in this environment")}const Te=ke.firestore(),Et=ke.auth();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let gj,yj;function _j(){return{geminiUrl:gj,vertexUrl:yj}}function vj(n,e,t,i){var s,a;if(!(n!=null&&n.baseUrl)){const l=_j();return e?(s=l.vertexUrl)!==null&&s!==void 0?s:t:(a=l.geminiUrl)!==null&&a!==void 0?a:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ir{}function Ee(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const a=e[s];return a!=null?String(a):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function g(n,e,t){for(let a=0;a<e.length-1;a++){const l=e[a];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in n))if(Array.isArray(t))n[u]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(n[u])){const h=n[u];if(Array.isArray(t))for(let m=0;m<h.length;m++){const _=h[m];g(_,e.slice(a+1),t[m])}else for(const m of h)g(m,e.slice(a+1),t)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in n||(n[u]=[{}]);const h=n[u];g(h[0],e.slice(a+1),t);return}(!n[l]||typeof n[l]!="object")&&(n[l]={}),n=n[l]}const i=e[e.length-1],s=n[i];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function p(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const s=e[i];if(s.endsWith("[]")){const a=s.slice(0,-2);if(a in n){const l=n[a];return Array.isArray(l)?l.map(u=>p(u,e.slice(i+1),t)):t}else return t}else n=n[s]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function Tj(n,e){for(const[t,i]of Object.entries(e)){const s=t.split("."),a=i.split("."),l=new Set;let u=-1;for(let h=0;h<s.length;h++)if(s[h]==="*"){u=h;break}if(u!==-1&&a.length>u)for(let h=u;h<a.length;h++){const m=a[h];m!=="*"&&!m.endsWith("[]")&&!m.endsWith("[0]")&&l.add(m)}Pv(n,s,a,0,l)}}function Pv(n,e,t,i,s){if(i>=e.length||typeof n!="object"||n===null)return;const a=e[i];if(a.endsWith("[]")){const l=a.slice(0,-2),u=n;if(l in u&&Array.isArray(u[l]))for(const h of u[l])Pv(h,e,t,i+1,s)}else if(a==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const l=n,u=Object.keys(l).filter(m=>!m.startsWith("_")&&!s.has(m)),h={};for(const m of u)h[m]=l[m];for(const[m,_]of Object.entries(h)){const T=[];for(const E of t.slice(i))E==="*"?T.push(m):T.push(E);g(l,T,_)}for(const m of u)delete l[m]}}else{const l=n;a in l&&Pv(l[a],e,t,i+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kT(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xj(n){const e={},t=p(n,["operationName"]);t!=null&&g(e,["operationName"],t);const i=p(n,["resourceName"]);return i!=null&&g(e,["_url","resourceName"],i),e}function Ej(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const s=p(n,["done"]);s!=null&&g(e,["done"],s);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response","generateVideoResponse"]);return l!=null&&g(e,["response"],bj(l)),e}function wj(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const s=p(n,["done"]);s!=null&&g(e,["done"],s);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response"]);return l!=null&&g(e,["response"],Ij(l)),e}function bj(n){const e={},t=p(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>Sj(l))),g(e,["generatedVideos"],a)}const i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);const s=p(n,["raiMediaFilteredReasons"]);return s!=null&&g(e,["raiMediaFilteredReasons"],s),e}function Ij(n){const e={},t=p(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>Aj(l))),g(e,["generatedVideos"],a)}const i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);const s=p(n,["raiMediaFilteredReasons"]);return s!=null&&g(e,["raiMediaFilteredReasons"],s),e}function Sj(n){const e={},t=p(n,["video"]);return t!=null&&g(e,["video"],Mj(t)),e}function Aj(n){const e={},t=p(n,["_self"]);return t!=null&&g(e,["video"],kj(t)),e}function Nj(n){const e={},t=p(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function Cj(n){const e={},t=p(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function Rj(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const s=p(n,["done"]);s!=null&&g(e,["done"],s);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response"]);return l!=null&&g(e,["response"],Pj(l)),e}function Pj(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["parent"]);i!=null&&g(e,["parent"],i);const s=p(n,["documentName"]);return s!=null&&g(e,["documentName"],s),e}function nD(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const s=p(n,["done"]);s!=null&&g(e,["done"],s);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response"]);return l!=null&&g(e,["response"],Dj(l)),e}function Dj(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["parent"]);i!=null&&g(e,["parent"],i);const s=p(n,["documentName"]);return s!=null&&g(e,["documentName"],s),e}function Mj(n){const e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);const i=p(n,["encodedVideo"]);i!=null&&g(e,["videoBytes"],kT(i));const s=p(n,["encoding"]);return s!=null&&g(e,["mimeType"],s),e}function kj(n){const e={},t=p(n,["gcsUri"]);t!=null&&g(e,["uri"],t);const i=p(n,["bytesBase64Encoded"]);i!=null&&g(e,["videoBytes"],kT(i));const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $S;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})($S||($S={}));var KS;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(KS||(KS={}));var YS;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(YS||(YS={}));var go;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(go||(go={}));var JS;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(JS||(JS={}));var QS;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(QS||(QS={}));var WS;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(WS||(WS={}));var XS;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(XS||(XS={}));var ZS;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(ZS||(ZS={}));var eA;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(eA||(eA={}));var tA;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(tA||(tA={}));var nA;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(nA||(nA={}));var iA;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(iA||(iA={}));var sA;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(sA||(sA={}));var rA;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(rA||(rA={}));var oA;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(oA||(oA={}));var aA;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(aA||(aA={}));var lA;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(lA||(lA={}));var cA;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(cA||(cA={}));var up;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(up||(up={}));var uA;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(uA||(uA={}));var dA;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(dA||(dA={}));var hA;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(hA||(hA={}));var Dv;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Dv||(Dv={}));var fA;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(fA||(fA={}));var mA;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(mA||(mA={}));var pA;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(pA||(pA={}));var gA;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(gA||(gA={}));var yA;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(yA||(yA={}));var _A;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(_A||(_A={}));var vA;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(vA||(vA={}));var TA;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(TA||(TA={}));var xA;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(xA||(xA={}));var EA;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(EA||(EA={}));var wA;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(wA||(wA={}));var bA;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(bA||(bA={}));var IA;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(IA||(IA={}));var SA;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(SA||(SA={}));var AA;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(AA||(AA={}));var NA;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(NA||(NA={}));var CA;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(CA||(CA={}));var RA;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(RA||(RA={}));var PA;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(PA||(PA={}));var DA;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(DA||(DA={}));var MA;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(MA||(MA={}));var kA;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(kA||(kA={}));var VA;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(VA||(VA={}));var LA;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(LA||(LA={}));var UA;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(UA||(UA={}));var OA;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(OA||(OA={}));var FA;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(FA||(FA={}));var qA;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(qA||(qA={}));var jA;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(jA||(jA={}));var BA;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(BA||(BA={}));var ic;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(ic||(ic={}));class Mv{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class hd{get text(){var e,t,i,s,a,l,u,h;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",_=!1;const T=[];for(const E of(h=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&h!==void 0?h:[]){for(const[S,k]of Object.entries(E))S!=="text"&&S!=="thought"&&S!=="thoughtSignature"&&(k!==null||k!==void 0)&&T.push(S);if(typeof E.text=="string"){if(typeof E.thought=="boolean"&&E.thought)continue;_=!0,m+=E.text}}return T.length>0&&console.warn(`there are non-text parts ${T} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),_?m:void 0}get data(){var e,t,i,s,a,l,u,h;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="";const _=[];for(const T of(h=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&h!==void 0?h:[]){for(const[E,S]of Object.entries(T))E!=="inlineData"&&(S!==null||S!==void 0)&&_.push(E);T.inlineData&&typeof T.inlineData.data=="string"&&(m+=atob(T.inlineData.data))}return _.length>0&&console.warn(`there are non-data parts ${_} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var e,t,i,s,a,l,u,h;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const m=(h=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||h===void 0?void 0:h.filter(_=>_.functionCall).map(_=>_.functionCall).filter(_=>_!==void 0);if((m==null?void 0:m.length)!==0)return m}get executableCode(){var e,t,i,s,a,l,u,h,m;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const _=(h=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||h===void 0?void 0:h.filter(T=>T.executableCode).map(T=>T.executableCode).filter(T=>T!==void 0);if((_==null?void 0:_.length)!==0)return(m=_==null?void 0:_[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var e,t,i,s,a,l,u,h,m;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const _=(h=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||h===void 0?void 0:h.filter(T=>T.codeExecutionResult).map(T=>T.codeExecutionResult).filter(T=>T!==void 0);if((_==null?void 0:_.length)!==0)return(m=_==null?void 0:_[0])===null||m===void 0?void 0:m.output}}class GA{}class zA{}class Vj{}class Lj{}class Uj{}class Oj{}class HA{}class $A{}class KA{}class Fj{}class dp{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new dp;let s;const a=e;return t?s=wj(a):s=Ej(a),Object.assign(i,s),i}}class YA{}class JA{}class QA{}class WA{}class qj{}class jj{}class Bj{}class VT{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new VT,a=Rj(e);return Object.assign(i,a),i}}class Gj{}class zj{}class Hj{}class XA{}class $j{get text(){var e,t,i;let s="",a=!1;const l=[];for(const u of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[h,m]of Object.entries(u))h!=="text"&&h!=="thought"&&m!==null&&l.push(h);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;a=!0,s+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?s:void 0}get data(){var e,t,i;let s="";const a=[];for(const l of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[u,h]of Object.entries(l))u!=="inlineData"&&h!==null&&a.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(s+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class Kj{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class LT{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new LT,a=nD(e);return Object.assign(i,a),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function iD(n,e){const t=lt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function sD(n){return Array.isArray(n)?n.map(e=>hp(e)):[hp(n)]}function hp(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function rD(n){const e=hp(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function oD(n){const e=hp(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function ZA(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function aD(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>ZA(e)):[ZA(n)]}function kv(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function eN(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function tN(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function On(n){if(n==null)throw new Error("ContentUnion is required");return kv(n)?n:{role:"user",parts:aD(n)}}function UT(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=On(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=On(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>On(t)):[On(e)]}function Fi(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(eN(n)||tN(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[On(n)]}const e=[],t=[],i=kv(n[0]);for(const s of n){const a=kv(s);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(s);else{if(eN(s)||tN(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return i||e.push({role:"user",parts:aD(t)}),e}function Yj(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(go).includes(t[0].toUpperCase())?t[0].toUpperCase():go.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(go).includes(i.toUpperCase())?i.toUpperCase():go.TYPE_UNSPECIFIED})}}function uc(n){const e={},t=["items"],i=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&Yj(n.type,e);for(const[l,u]of Object.entries(n))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(go).includes(u.toUpperCase())?u.toUpperCase():go.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=uc(u);else if(i.includes(l)){const h=[];for(const m of u){if(m.type=="null"){e.nullable=!0;continue}h.push(uc(m))}e[l]=h}else if(s.includes(l)){const h={};for(const[m,_]of Object.entries(u))h[m]=uc(_);e[l]=h}else{if(l==="additionalProperties")continue;e[l]=u}return e}function OT(n){return uc(n)}function FT(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function qT(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Qc(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=uc(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=uc(e.response));return n}function Wc(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function Jj(n,e,t,i=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Sr(n,e){if(typeof e!="string")throw new Error("name must be a string");return Jj(n,e,"cachedContents")}function lD(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function qo(n){return kT(n)}function Qj(n){return n!=null&&typeof n=="object"&&"name"in n}function Wj(n){return n!=null&&typeof n=="object"&&"video"in n}function Xj(n){return n!=null&&typeof n=="object"&&"uri"in n}function cD(n){var e;let t;if(Qj(n)&&(t=n.name),!(Xj(n)&&(t=n.uri,t===void 0))&&!(Wj(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function uD(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function dD(n){for(const e of["models","tunedModels","publisherModels"])if(Zj(n,e))return n[e];return[]}function Zj(n,e){return n!==null&&typeof n=="object"&&e in n}function eB(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function tB(n,e={}){const t=[],i=new Set;for(const s of n){const a=s.name;if(i.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);i.add(a);const l=eB(s,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function hD(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(s>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function nB(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function fD(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return n;let a=!1;for(const l of s){if(typeof l!="object"||l===null)continue;const h=l.response;if(typeof h!="object"||h===null)continue;if(h.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Xc(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function mD(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iB(n){const e={},t=p(n,["responsesFile"]);t!=null&&g(e,["fileName"],t);const i=p(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>UB(l))),g(e,["inlinedResponses"],a)}const s=p(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["inlinedEmbedContentResponses"],a)}return e}function sB(n){const e={},t=p(n,["predictionsFormat"]);t!=null&&g(e,["format"],t);const i=p(n,["gcsDestination","outputUriPrefix"]);i!=null&&g(e,["gcsUri"],i);const s=p(n,["bigqueryDestination","outputUri"]);return s!=null&&g(e,["bigqueryUri"],s),e}function rB(n){const e={},t=p(n,["format"]);t!=null&&g(e,["predictionsFormat"],t);const i=p(n,["gcsUri"]);i!=null&&g(e,["gcsDestination","outputUriPrefix"],i);const s=p(n,["bigqueryUri"]);if(s!=null&&g(e,["bigqueryDestination","outputUri"],s),p(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(p(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Vm(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata","displayName"]);i!=null&&g(e,["displayName"],i);const s=p(n,["metadata","state"]);s!=null&&g(e,["state"],mD(s));const a=p(n,["metadata","createTime"]);a!=null&&g(e,["createTime"],a);const l=p(n,["metadata","endTime"]);l!=null&&g(e,["endTime"],l);const u=p(n,["metadata","updateTime"]);u!=null&&g(e,["updateTime"],u);const h=p(n,["metadata","model"]);h!=null&&g(e,["model"],h);const m=p(n,["metadata","output"]);return m!=null&&g(e,["dest"],iB(fD(m))),e}function Vv(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["displayName"]);i!=null&&g(e,["displayName"],i);const s=p(n,["state"]);s!=null&&g(e,["state"],mD(s));const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["createTime"]);l!=null&&g(e,["createTime"],l);const u=p(n,["startTime"]);u!=null&&g(e,["startTime"],u);const h=p(n,["endTime"]);h!=null&&g(e,["endTime"],h);const m=p(n,["updateTime"]);m!=null&&g(e,["updateTime"],m);const _=p(n,["model"]);_!=null&&g(e,["model"],_);const T=p(n,["inputConfig"]);T!=null&&g(e,["src"],oB(T));const E=p(n,["outputConfig"]);E!=null&&g(e,["dest"],sB(fD(E)));const S=p(n,["completionStats"]);return S!=null&&g(e,["completionStats"],S),e}function oB(n){const e={},t=p(n,["instancesFormat"]);t!=null&&g(e,["format"],t);const i=p(n,["gcsSource","uris"]);i!=null&&g(e,["gcsUri"],i);const s=p(n,["bigquerySource","inputUri"]);return s!=null&&g(e,["bigqueryUri"],s),e}function aB(n,e){const t={};if(p(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=p(e,["fileName"]);i!=null&&g(t,["fileName"],i);const s=p(e,["inlinedRequests"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>LB(n,l))),g(t,["requests","requests"],a)}return t}function lB(n){const e={},t=p(n,["format"]);t!=null&&g(e,["instancesFormat"],t);const i=p(n,["gcsUri"]);i!=null&&g(e,["gcsSource","uris"],i);const s=p(n,["bigqueryUri"]);if(s!=null&&g(e,["bigquerySource","inputUri"],s),p(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function cB(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function uB(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Xc(n,i)),t}function dB(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Xc(n,i)),t}function hB(n){const e={},t=p(n,["content"]);t!=null&&g(e,["content"],t);const i=p(n,["citationMetadata"]);i!=null&&g(e,["citationMetadata"],fB(i));const s=p(n,["tokenCount"]);s!=null&&g(e,["tokenCount"],s);const a=p(n,["finishReason"]);a!=null&&g(e,["finishReason"],a);const l=p(n,["avgLogprobs"]);l!=null&&g(e,["avgLogprobs"],l);const u=p(n,["groundingMetadata"]);u!=null&&g(e,["groundingMetadata"],u);const h=p(n,["index"]);h!=null&&g(e,["index"],h);const m=p(n,["logprobsResult"]);m!=null&&g(e,["logprobsResult"],m);const _=p(n,["safetyRatings"]);if(_!=null){let E=_;Array.isArray(E)&&(E=E.map(S=>S)),g(e,["safetyRatings"],E)}const T=p(n,["urlContextMetadata"]);return T!=null&&g(e,["urlContextMetadata"],T),e}function fB(n){const e={},t=p(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),g(e,["citations"],i)}return e}function pD(n){const e={},t=p(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>zB(a))),g(e,["parts"],s)}const i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function mB(n,e){const t={},i=p(n,["displayName"]);if(e!==void 0&&i!=null&&g(e,["batch","displayName"],i),p(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function pB(n,e){const t={},i=p(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);const s=p(n,["dest"]);return e!==void 0&&s!=null&&g(e,["outputConfig"],rB(nB(s))),t}function nN(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["src"]);s!=null&&g(t,["batch","inputConfig"],aB(n,hD(n,s)));const a=p(e,["config"]);return a!=null&&mB(a,t),t}function gB(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["model"],lt(n,i));const s=p(e,["src"]);s!=null&&g(t,["inputConfig"],lB(hD(n,s)));const a=p(e,["config"]);return a!=null&&pB(a,t),t}function yB(n,e){const t={},i=p(n,["displayName"]);return e!==void 0&&i!=null&&g(e,["batch","displayName"],i),t}function _B(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["src"]);s!=null&&g(t,["batch","inputConfig"],IB(n,s));const a=p(e,["config"]);return a!=null&&yB(a,t),t}function vB(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Xc(n,i)),t}function TB(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Xc(n,i)),t}function xB(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["name"]);i!=null&&g(e,["name"],i);const s=p(n,["done"]);s!=null&&g(e,["done"],s);const a=p(n,["error"]);return a!=null&&g(e,["error"],a),e}function EB(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["name"]);i!=null&&g(e,["name"],i);const s=p(n,["done"]);s!=null&&g(e,["done"],s);const a=p(n,["error"]);return a!=null&&g(e,["error"],a),e}function wB(n,e){const t={},i=p(e,["contents"]);if(i!=null){let a=UT(n,i);Array.isArray(a)&&(a=a.map(l=>l)),g(t,["requests[]","request","content"],a)}const s=p(e,["config"]);return s!=null&&(g(t,["_self"],bB(s,t)),Tj(t,{"requests[].*":"requests[].request.*"})),t}function bB(n,e){const t={},i=p(n,["taskType"]);e!==void 0&&i!=null&&g(e,["requests[]","taskType"],i);const s=p(n,["title"]);e!==void 0&&s!=null&&g(e,["requests[]","title"],s);const a=p(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&g(e,["requests[]","outputDimensionality"],a),p(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function IB(n,e){const t={},i=p(e,["fileName"]);i!=null&&g(t,["file_name"],i);const s=p(e,["inlinedRequests"]);return s!=null&&g(t,["requests"],wB(n,s)),t}function SB(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function AB(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const i=p(n,["args"]);i!=null&&g(e,["args"],i);const s=p(n,["name"]);if(s!=null&&g(e,["name"],s),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function NB(n){const e={},t=p(n,["mode"]);t!=null&&g(e,["mode"],t);const i=p(n,["allowedFunctionNames"]);if(i!=null&&g(e,["allowedFunctionNames"],i),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function CB(n,e,t){const i={},s=p(e,["systemInstruction"]);t!==void 0&&s!=null&&g(t,["systemInstruction"],pD(On(s)));const a=p(e,["temperature"]);a!=null&&g(i,["temperature"],a);const l=p(e,["topP"]);l!=null&&g(i,["topP"],l);const u=p(e,["topK"]);u!=null&&g(i,["topK"],u);const h=p(e,["candidateCount"]);h!=null&&g(i,["candidateCount"],h);const m=p(e,["maxOutputTokens"]);m!=null&&g(i,["maxOutputTokens"],m);const _=p(e,["stopSequences"]);_!=null&&g(i,["stopSequences"],_);const T=p(e,["responseLogprobs"]);T!=null&&g(i,["responseLogprobs"],T);const E=p(e,["logprobs"]);E!=null&&g(i,["logprobs"],E);const S=p(e,["presencePenalty"]);S!=null&&g(i,["presencePenalty"],S);const k=p(e,["frequencyPenalty"]);k!=null&&g(i,["frequencyPenalty"],k);const V=p(e,["seed"]);V!=null&&g(i,["seed"],V);const O=p(e,["responseMimeType"]);O!=null&&g(i,["responseMimeType"],O);const j=p(e,["responseSchema"]);j!=null&&g(i,["responseSchema"],OT(j));const W=p(e,["responseJsonSchema"]);if(W!=null&&g(i,["responseJsonSchema"],W),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const $=p(e,["safetySettings"]);if(t!==void 0&&$!=null){let D=$;Array.isArray(D)&&(D=D.map(ye=>HB(ye))),g(t,["safetySettings"],D)}const U=p(e,["tools"]);if(t!==void 0&&U!=null){let D=Wc(U);Array.isArray(D)&&(D=D.map(ye=>KB(Qc(ye)))),g(t,["tools"],D)}const K=p(e,["toolConfig"]);if(t!==void 0&&K!=null&&g(t,["toolConfig"],$B(K)),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=p(e,["cachedContent"]);t!==void 0&&J!=null&&g(t,["cachedContent"],Sr(n,J));const R=p(e,["responseModalities"]);R!=null&&g(i,["responseModalities"],R);const A=p(e,["mediaResolution"]);A!=null&&g(i,["mediaResolution"],A);const C=p(e,["speechConfig"]);if(C!=null&&g(i,["speechConfig"],FT(C)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const M=p(e,["thinkingConfig"]);M!=null&&g(i,["thinkingConfig"],M);const L=p(e,["imageConfig"]);L!=null&&g(i,["imageConfig"],VB(L));const F=p(e,["enableEnhancedCivicAnswers"]);return F!=null&&g(i,["enableEnhancedCivicAnswers"],F),i}function RB(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["candidates"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(m=>hB(m))),g(e,["candidates"],h)}const s=p(n,["modelVersion"]);s!=null&&g(e,["modelVersion"],s);const a=p(n,["promptFeedback"]);a!=null&&g(e,["promptFeedback"],a);const l=p(n,["responseId"]);l!=null&&g(e,["responseId"],l);const u=p(n,["usageMetadata"]);return u!=null&&g(e,["usageMetadata"],u),e}function PB(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Xc(n,i)),t}function DB(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Xc(n,i)),t}function MB(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function kB(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function VB(n){const e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);const i=p(n,["imageSize"]);if(i!=null&&g(e,["imageSize"],i),p(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function LB(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["request","model"],lt(n,i));const s=p(e,["contents"]);if(s!=null){let u=Fi(s);Array.isArray(u)&&(u=u.map(h=>pD(h))),g(t,["request","contents"],u)}const a=p(e,["metadata"]);a!=null&&g(t,["metadata"],a);const l=p(e,["config"]);return l!=null&&g(t,["request","generationConfig"],CB(n,l,p(t,["request"],{}))),t}function UB(n){const e={},t=p(n,["response"]);t!=null&&g(e,["response"],RB(t));const i=p(n,["error"]);return i!=null&&g(e,["error"],i),e}function OB(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const s=p(n,["pageToken"]);if(e!==void 0&&s!=null&&g(e,["_query","pageToken"],s),p(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function FB(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const s=p(n,["pageToken"]);e!==void 0&&s!=null&&g(e,["_query","pageToken"],s);const a=p(n,["filter"]);return e!==void 0&&a!=null&&g(e,["_query","filter"],a),t}function qB(n){const e={},t=p(n,["config"]);return t!=null&&OB(t,e),e}function jB(n){const e={},t=p(n,["config"]);return t!=null&&FB(t,e),e}function BB(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const s=p(n,["operations"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>Vm(l))),g(e,["batchJobs"],a)}return e}function GB(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const s=p(n,["batchPredictionJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>Vv(l))),g(e,["batchJobs"],a)}return e}function zB(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const s=p(n,["executableCode"]);s!=null&&g(e,["executableCode"],s);const a=p(n,["fileData"]);a!=null&&g(e,["fileData"],SB(a));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],AB(l));const u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);const h=p(n,["inlineData"]);h!=null&&g(e,["inlineData"],cB(h));const m=p(n,["text"]);m!=null&&g(e,["text"],m);const _=p(n,["thought"]);_!=null&&g(e,["thought"],_);const T=p(n,["thoughtSignature"]);T!=null&&g(e,["thoughtSignature"],T);const E=p(n,["videoMetadata"]);return E!=null&&g(e,["videoMetadata"],E),e}function HB(n){const e={},t=p(n,["category"]);if(t!=null&&g(e,["category"],t),p(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=p(n,["threshold"]);return i!=null&&g(e,["threshold"],i),e}function $B(n){const e={},t=p(n,["functionCallingConfig"]);t!=null&&g(e,["functionCallingConfig"],NB(t));const i=p(n,["retrievalConfig"]);return i!=null&&g(e,["retrievalConfig"],i),e}function KB(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(T=>T)),g(e,["functionDeclarations"],_)}if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=p(n,["googleSearchRetrieval"]);i!=null&&g(e,["googleSearchRetrieval"],i);const s=p(n,["computerUse"]);s!=null&&g(e,["computerUse"],s);const a=p(n,["fileSearch"]);a!=null&&g(e,["fileSearch"],a);const l=p(n,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],MB(u));const h=p(n,["googleSearch"]);h!=null&&g(e,["googleSearch"],kB(h));const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var yr;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(yr||(yr={}));class nl{constructor(e,t,i,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,s)}init(e,t,i){var s,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!i||Object.keys(i).length===0?l={config:{}}:typeof i=="object"?l=Object.assign({},i):l=i,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(s=l.config)===null||s===void 0?void 0:s.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YB extends Ir{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new nl(yr.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=nN(this.apiClient,e),i=t._url,s=Ee("{model}:batchGenerateContent",i),u=t.batch.inputConfig.requests,h=u.requests,m=[];for(const _ of h){const T=Object.assign({},_);if(T.systemInstruction){const E=T.systemInstruction;delete T.systemInstruction;const S=T.request;S.systemInstruction=E,T.request=S}m.push(T)}return u.requests=m,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},s=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${s}`),i.dest===void 0){const a=this.getGcsUri(e),l=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?i.dest=`${a.slice(0,-6)}/dest`:i.dest=`${a}_dest_${s}`;else if(l)i.dest=`${l}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=gB(this.apiClient,e);return u=Ee("batchPredictionJobs",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>Vv(_))}else{const m=nN(this.apiClient,e);return u=Ee("{model}:batchGenerateContent",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Vm(_))}}async createEmbeddingsInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=_B(this.apiClient,e);return a=Ee("{model}:asyncBatchEmbedContent",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>Vm(h))}}async get(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=DB(this.apiClient,e);return u=Ee("batchPredictionJobs/{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>Vv(_))}else{const m=PB(this.apiClient,e);return u=Ee("batches/{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Vm(_))}}async cancel(e){var t,i,s,a;let l="",u={};if(this.apiClient.isVertexAI()){const h=dB(this.apiClient,e);l=Ee("batchPredictionJobs/{name}:cancel",h._url),u=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const h=uB(this.apiClient,e);l=Ee("batches/{name}:cancel",h._url),u=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=jB(e);return u=Ee("batchPredictionJobs",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=GB(_),E=new XA;return Object.assign(E,T),E})}else{const m=qB(e);return u=Ee("batches",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=BB(_),E=new XA;return Object.assign(E,T),E})}}async delete(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=TB(this.apiClient,e);return u=Ee("batchPredictionJobs/{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>EB(_))}else{const m=vB(this.apiClient,e);return u=Ee("batches/{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>xB(_))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JB(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function iN(n){const e={},t=p(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>_G(a))),g(e,["parts"],s)}const i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function QB(n,e){const t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const s=p(n,["expireTime"]);e!==void 0&&s!=null&&g(e,["expireTime"],s);const a=p(n,["displayName"]);e!==void 0&&a!=null&&g(e,["displayName"],a);const l=p(n,["contents"]);if(e!==void 0&&l!=null){let _=Fi(l);Array.isArray(_)&&(_=_.map(T=>iN(T))),g(e,["contents"],_)}const u=p(n,["systemInstruction"]);e!==void 0&&u!=null&&g(e,["systemInstruction"],iN(On(u)));const h=p(n,["tools"]);if(e!==void 0&&h!=null){let _=h;Array.isArray(_)&&(_=_.map(T=>TG(T))),g(e,["tools"],_)}const m=p(n,["toolConfig"]);if(e!==void 0&&m!=null&&g(e,["toolConfig"],vG(m)),p(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function WB(n,e){const t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const s=p(n,["expireTime"]);e!==void 0&&s!=null&&g(e,["expireTime"],s);const a=p(n,["displayName"]);e!==void 0&&a!=null&&g(e,["displayName"],a);const l=p(n,["contents"]);if(e!==void 0&&l!=null){let T=Fi(l);Array.isArray(T)&&(T=T.map(E=>E)),g(e,["contents"],T)}const u=p(n,["systemInstruction"]);e!==void 0&&u!=null&&g(e,["systemInstruction"],On(u));const h=p(n,["tools"]);if(e!==void 0&&h!=null){let T=h;Array.isArray(T)&&(T=T.map(E=>xG(E))),g(e,["tools"],T)}const m=p(n,["toolConfig"]);e!==void 0&&m!=null&&g(e,["toolConfig"],m);const _=p(n,["kmsKeyName"]);return e!==void 0&&_!=null&&g(e,["encryption_spec","kmsKeyName"],_),t}function XB(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["model"],iD(n,i));const s=p(e,["config"]);return s!=null&&QB(s,t),t}function ZB(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["model"],iD(n,i));const s=p(e,["config"]);return s!=null&&WB(s,t),t}function eG(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Sr(n,i)),t}function tG(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Sr(n,i)),t}function nG(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function iG(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function sG(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function rG(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const i=p(n,["args"]);i!=null&&g(e,["args"],i);const s=p(n,["name"]);if(s!=null&&g(e,["name"],s),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function oG(n){const e={},t=p(n,["mode"]);t!=null&&g(e,["mode"],t);const i=p(n,["allowedFunctionNames"]);if(i!=null&&g(e,["allowedFunctionNames"],i),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function aG(n){const e={};if(p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=p(n,["description"]);t!=null&&g(e,["description"],t);const i=p(n,["name"]);i!=null&&g(e,["name"],i);const s=p(n,["parameters"]);s!=null&&g(e,["parameters"],s);const a=p(n,["parametersJsonSchema"]);a!=null&&g(e,["parametersJsonSchema"],a);const l=p(n,["response"]);l!=null&&g(e,["response"],l);const u=p(n,["responseJsonSchema"]);return u!=null&&g(e,["responseJsonSchema"],u),e}function lG(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Sr(n,i)),t}function cG(n,e){const t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Sr(n,i)),t}function uG(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function dG(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function hG(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const s=p(n,["pageToken"]);return e!==void 0&&s!=null&&g(e,["_query","pageToken"],s),t}function fG(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const s=p(n,["pageToken"]);return e!==void 0&&s!=null&&g(e,["_query","pageToken"],s),t}function mG(n){const e={},t=p(n,["config"]);return t!=null&&hG(t,e),e}function pG(n){const e={},t=p(n,["config"]);return t!=null&&fG(t,e),e}function gG(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const s=p(n,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["cachedContents"],a)}return e}function yG(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const s=p(n,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["cachedContents"],a)}return e}function _G(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const s=p(n,["executableCode"]);s!=null&&g(e,["executableCode"],s);const a=p(n,["fileData"]);a!=null&&g(e,["fileData"],sG(a));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],rG(l));const u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);const h=p(n,["inlineData"]);h!=null&&g(e,["inlineData"],JB(h));const m=p(n,["text"]);m!=null&&g(e,["text"],m);const _=p(n,["thought"]);_!=null&&g(e,["thought"],_);const T=p(n,["thoughtSignature"]);T!=null&&g(e,["thoughtSignature"],T);const E=p(n,["videoMetadata"]);return E!=null&&g(e,["videoMetadata"],E),e}function vG(n){const e={},t=p(n,["functionCallingConfig"]);t!=null&&g(e,["functionCallingConfig"],oG(t));const i=p(n,["retrievalConfig"]);return i!=null&&g(e,["retrievalConfig"],i),e}function TG(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(T=>T)),g(e,["functionDeclarations"],_)}if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=p(n,["googleSearchRetrieval"]);i!=null&&g(e,["googleSearchRetrieval"],i);const s=p(n,["computerUse"]);s!=null&&g(e,["computerUse"],s);const a=p(n,["fileSearch"]);a!=null&&g(e,["fileSearch"],a);const l=p(n,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],uG(u));const h=p(n,["googleSearch"]);h!=null&&g(e,["googleSearch"],dG(h));const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function xG(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(E=>aG(E))),g(e,["functionDeclarations"],T)}const i=p(n,["retrieval"]);i!=null&&g(e,["retrieval"],i);const s=p(n,["googleSearchRetrieval"]);s!=null&&g(e,["googleSearchRetrieval"],s);const a=p(n,["computerUse"]);if(a!=null&&g(e,["computerUse"],a),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=p(n,["codeExecution"]);l!=null&&g(e,["codeExecution"],l);const u=p(n,["enterpriseWebSearch"]);u!=null&&g(e,["enterpriseWebSearch"],u);const h=p(n,["googleMaps"]);h!=null&&g(e,["googleMaps"],h);const m=p(n,["googleSearch"]);m!=null&&g(e,["googleSearch"],m);const _=p(n,["urlContext"]);return _!=null&&g(e,["urlContext"],_),e}function EG(n,e){const t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const s=p(n,["expireTime"]);return e!==void 0&&s!=null&&g(e,["expireTime"],s),t}function wG(n,e){const t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const s=p(n,["expireTime"]);return e!==void 0&&s!=null&&g(e,["expireTime"],s),t}function bG(n,e){const t={},i=p(e,["name"]);i!=null&&g(t,["_url","name"],Sr(n,i));const s=p(e,["config"]);return s!=null&&EG(s,t),t}function IG(n,e){const t={},i=p(e,["name"]);i!=null&&g(t,["_url","name"],Sr(n,i));const s=p(e,["config"]);return s!=null&&wG(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SG extends Ir{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new nl(yr.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=ZB(this.apiClient,e);return u=Ee("cachedContents",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const m=XB(this.apiClient,e);return u=Ee("cachedContents",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async get(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=cG(this.apiClient,e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const m=lG(this.apiClient,e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async delete(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=tG(this.apiClient,e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=iG(_),E=new QA;return Object.assign(E,T),E})}else{const m=eG(this.apiClient,e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=nG(_),E=new QA;return Object.assign(E,T),E})}}async update(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=IG(this.apiClient,e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const m=bG(this.apiClient,e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async listInternal(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=pG(e);return u=Ee("cachedContents",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=yG(_),E=new WA;return Object.assign(E,T),E})}else{const m=mG(e);return u=Ee("cachedContents",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=gG(_),E=new WA;return Object.assign(E,T),E})}}}function sN(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function At(n){return this instanceof At?(this.v=n,this):new At(n)}function dc(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),s[Symbol.asyncIterator]=function(){return this},s;function l(S){return function(k){return Promise.resolve(k).then(S,T)}}function u(S,k){i[S]&&(s[S]=function(V){return new Promise(function(O,j){a.push([S,V,O,j])>1||h(S,V)})},k&&(s[S]=k(s[S])))}function h(S,k){try{m(i[S](k))}catch(V){E(a[0][3],V)}}function m(S){S.value instanceof At?Promise.resolve(S.value.v).then(_,T):E(a[0][2],S)}function _(S){h("next",S)}function T(S){h("throw",S)}function E(S,k){S(k),a.shift(),a.length&&h(a[0][0],a[0][1])}}function Ud(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof sN=="function"?sN(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=n[a]&&function(l){return new Promise(function(u,h){l=n[a](l),s(u,h,l.done,l.value)})}}function s(a,l,u,h){Promise.resolve(h).then(function(m){a({value:m,done:u})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AG(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:gD(t)}function gD(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function NG(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function rN(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const s=[];let a=!0;for(;i<t&&n[i].role==="model";)s.push(n[i]),a&&!gD(n[i])&&(a=!1),i++;a?e.push(...s):e.pop()}return e}class CG{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new RG(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class RG{constructor(e,t,i,s={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=s,this.history=a,this.sendPromise=Promise.resolve(),NG(a)}async sendMessage(e){var t;await this.sendPromise;const i=On(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,l,u;const h=await s,m=(l=(a=h.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,_=h.automaticFunctionCallingHistory,T=this.getHistory(!0).length;let E=[];_!=null&&(E=(u=_.slice(T))!==null&&u!==void 0?u:[]);const S=m?[m]:[];this.recordHistory(i,S,E)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const i=On(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const a=await s;return this.processStreamResponse(a,i)}getHistory(e=!1){const t=e?rN(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return dc(this,arguments,function*(){var s,a,l,u,h,m;const _=[];try{for(var T=!0,E=Ud(e),S;S=yield At(E.next()),s=S.done,!s;T=!0){u=S.value,T=!1;const k=u;if(AG(k)){const V=(m=(h=k.candidates)===null||h===void 0?void 0:h[0])===null||m===void 0?void 0:m.content;V!==void 0&&_.push(V)}yield yield At(k)}}catch(k){a={error:k}}finally{try{!T&&!s&&(l=E.return)&&(yield At(l.call(E)))}finally{if(a)throw a.error}}this.recordHistory(t,_)})}recordHistory(e,t,i){let s=[];t.length>0&&t.every(a=>a.role!==void 0)?s=t:s.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...rN(i)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sg extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,sg.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PG(n){const e={},t=p(n,["file"]);return t!=null&&g(e,["file"],t),e}function DG(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function MG(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","file"],cD(t)),e}function kG(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function VG(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","file"],cD(t)),e}function LG(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const s=p(n,["pageToken"]);return e!==void 0&&s!=null&&g(e,["_query","pageToken"],s),t}function UG(n){const e={},t=p(n,["config"]);return t!=null&&LG(t,e),e}function OG(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const s=p(n,["files"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FG extends Ir{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new nl(yr.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=UG(e);return a=Ee("files",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{const m=OG(h),_=new Gj;return Object.assign(_,m),_})}}async createInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=PG(e);return a=Ee("upload/v1beta/files",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const m=DG(h),_=new zj;return Object.assign(_,m),_})}}async get(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=VG(e);return a=Ee("files/{file}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=MG(e);return a=Ee("files/{file}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{const m=kG(h),_=new Hj;return Object.assign(_,m),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lm(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function qG(n){const e={},t=p(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>n9(a))),g(e,["parts"],s)}const i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function jG(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function BG(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const i=p(n,["args"]);i!=null&&g(e,["args"],i);const s=p(n,["name"]);if(s!=null&&g(e,["name"],s),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function GG(n){const e={};if(p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=p(n,["description"]);t!=null&&g(e,["description"],t);const i=p(n,["name"]);i!=null&&g(e,["name"],i);const s=p(n,["parameters"]);s!=null&&g(e,["parameters"],s);const a=p(n,["parametersJsonSchema"]);a!=null&&g(e,["parametersJsonSchema"],a);const l=p(n,["response"]);l!=null&&g(e,["response"],l);const u=p(n,["responseJsonSchema"]);return u!=null&&g(e,["responseJsonSchema"],u),e}function zG(n){const e={},t=p(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);const i=p(n,["responseJsonSchema"]);i!=null&&g(e,["responseJsonSchema"],i);const s=p(n,["audioTimestamp"]);s!=null&&g(e,["audioTimestamp"],s);const a=p(n,["candidateCount"]);a!=null&&g(e,["candidateCount"],a);const l=p(n,["enableAffectiveDialog"]);l!=null&&g(e,["enableAffectiveDialog"],l);const u=p(n,["frequencyPenalty"]);u!=null&&g(e,["frequencyPenalty"],u);const h=p(n,["logprobs"]);h!=null&&g(e,["logprobs"],h);const m=p(n,["maxOutputTokens"]);m!=null&&g(e,["maxOutputTokens"],m);const _=p(n,["mediaResolution"]);_!=null&&g(e,["mediaResolution"],_);const T=p(n,["presencePenalty"]);T!=null&&g(e,["presencePenalty"],T);const E=p(n,["responseLogprobs"]);E!=null&&g(e,["responseLogprobs"],E);const S=p(n,["responseMimeType"]);S!=null&&g(e,["responseMimeType"],S);const k=p(n,["responseModalities"]);k!=null&&g(e,["responseModalities"],k);const V=p(n,["responseSchema"]);V!=null&&g(e,["responseSchema"],V);const O=p(n,["routingConfig"]);O!=null&&g(e,["routingConfig"],O);const j=p(n,["seed"]);j!=null&&g(e,["seed"],j);const W=p(n,["speechConfig"]);W!=null&&g(e,["speechConfig"],yD(W));const $=p(n,["stopSequences"]);$!=null&&g(e,["stopSequences"],$);const U=p(n,["temperature"]);U!=null&&g(e,["temperature"],U);const K=p(n,["thinkingConfig"]);K!=null&&g(e,["thinkingConfig"],K);const J=p(n,["topK"]);J!=null&&g(e,["topK"],J);const R=p(n,["topP"]);if(R!=null&&g(e,["topP"],R),p(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function HG(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function $G(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function KG(n,e){const t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],i);const s=p(n,["responseModalities"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig","responseModalities"],s);const a=p(n,["temperature"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","temperature"],a);const l=p(n,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);const h=p(n,["maxOutputTokens"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","maxOutputTokens"],h);const m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);const _=p(n,["seed"]);e!==void 0&&_!=null&&g(e,["setup","generationConfig","seed"],_);const T=p(n,["speechConfig"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","speechConfig"],qT(T));const E=p(n,["thinkingConfig"]);e!==void 0&&E!=null&&g(e,["setup","generationConfig","thinkingConfig"],E);const S=p(n,["enableAffectiveDialog"]);e!==void 0&&S!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],S);const k=p(n,["systemInstruction"]);e!==void 0&&k!=null&&g(e,["setup","systemInstruction"],qG(On(k)));const V=p(n,["tools"]);if(e!==void 0&&V!=null){let J=Wc(V);Array.isArray(J)&&(J=J.map(R=>s9(Qc(R)))),g(e,["setup","tools"],J)}const O=p(n,["sessionResumption"]);e!==void 0&&O!=null&&g(e,["setup","sessionResumption"],i9(O));const j=p(n,["inputAudioTranscription"]);e!==void 0&&j!=null&&g(e,["setup","inputAudioTranscription"],j);const W=p(n,["outputAudioTranscription"]);e!==void 0&&W!=null&&g(e,["setup","outputAudioTranscription"],W);const $=p(n,["realtimeInputConfig"]);e!==void 0&&$!=null&&g(e,["setup","realtimeInputConfig"],$);const U=p(n,["contextWindowCompression"]);e!==void 0&&U!=null&&g(e,["setup","contextWindowCompression"],U);const K=p(n,["proactivity"]);return e!==void 0&&K!=null&&g(e,["setup","proactivity"],K),t}function YG(n,e){const t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],zG(i));const s=p(n,["responseModalities"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig","responseModalities"],s);const a=p(n,["temperature"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","temperature"],a);const l=p(n,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);const h=p(n,["maxOutputTokens"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","maxOutputTokens"],h);const m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);const _=p(n,["seed"]);e!==void 0&&_!=null&&g(e,["setup","generationConfig","seed"],_);const T=p(n,["speechConfig"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","speechConfig"],yD(qT(T)));const E=p(n,["thinkingConfig"]);e!==void 0&&E!=null&&g(e,["setup","generationConfig","thinkingConfig"],E);const S=p(n,["enableAffectiveDialog"]);e!==void 0&&S!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],S);const k=p(n,["systemInstruction"]);e!==void 0&&k!=null&&g(e,["setup","systemInstruction"],On(k));const V=p(n,["tools"]);if(e!==void 0&&V!=null){let J=Wc(V);Array.isArray(J)&&(J=J.map(R=>r9(Qc(R)))),g(e,["setup","tools"],J)}const O=p(n,["sessionResumption"]);e!==void 0&&O!=null&&g(e,["setup","sessionResumption"],O);const j=p(n,["inputAudioTranscription"]);e!==void 0&&j!=null&&g(e,["setup","inputAudioTranscription"],j);const W=p(n,["outputAudioTranscription"]);e!==void 0&&W!=null&&g(e,["setup","outputAudioTranscription"],W);const $=p(n,["realtimeInputConfig"]);e!==void 0&&$!=null&&g(e,["setup","realtimeInputConfig"],$);const U=p(n,["contextWindowCompression"]);e!==void 0&&U!=null&&g(e,["setup","contextWindowCompression"],U);const K=p(n,["proactivity"]);return e!==void 0&&K!=null&&g(e,["setup","proactivity"],K),t}function JG(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],lt(n,i));const s=p(e,["config"]);return s!=null&&g(t,["config"],KG(s,t)),t}function QG(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],lt(n,i));const s=p(e,["config"]);return s!=null&&g(t,["config"],YG(s,t)),t}function WG(n){const e={},t=p(n,["musicGenerationConfig"]);return t!=null&&g(e,["musicGenerationConfig"],t),e}function XG(n){const e={},t=p(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),g(e,["weightedPrompts"],i)}return e}function ZG(n){const e={},t=p(n,["media"]);if(t!=null){let m=sD(t);Array.isArray(m)&&(m=m.map(_=>Lm(_))),g(e,["mediaChunks"],m)}const i=p(n,["audio"]);i!=null&&g(e,["audio"],Lm(oD(i)));const s=p(n,["audioStreamEnd"]);s!=null&&g(e,["audioStreamEnd"],s);const a=p(n,["video"]);a!=null&&g(e,["video"],Lm(rD(a)));const l=p(n,["text"]);l!=null&&g(e,["text"],l);const u=p(n,["activityStart"]);u!=null&&g(e,["activityStart"],u);const h=p(n,["activityEnd"]);return h!=null&&g(e,["activityEnd"],h),e}function e9(n){const e={},t=p(n,["media"]);if(t!=null){let m=sD(t);Array.isArray(m)&&(m=m.map(_=>_)),g(e,["mediaChunks"],m)}const i=p(n,["audio"]);i!=null&&g(e,["audio"],oD(i));const s=p(n,["audioStreamEnd"]);s!=null&&g(e,["audioStreamEnd"],s);const a=p(n,["video"]);a!=null&&g(e,["video"],rD(a));const l=p(n,["text"]);l!=null&&g(e,["text"],l);const u=p(n,["activityStart"]);u!=null&&g(e,["activityStart"],u);const h=p(n,["activityEnd"]);return h!=null&&g(e,["activityEnd"],h),e}function t9(n){const e={},t=p(n,["setupComplete"]);t!=null&&g(e,["setupComplete"],t);const i=p(n,["serverContent"]);i!=null&&g(e,["serverContent"],i);const s=p(n,["toolCall"]);s!=null&&g(e,["toolCall"],s);const a=p(n,["toolCallCancellation"]);a!=null&&g(e,["toolCallCancellation"],a);const l=p(n,["usageMetadata"]);l!=null&&g(e,["usageMetadata"],o9(l));const u=p(n,["goAway"]);u!=null&&g(e,["goAway"],u);const h=p(n,["sessionResumptionUpdate"]);return h!=null&&g(e,["sessionResumptionUpdate"],h),e}function n9(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const s=p(n,["executableCode"]);s!=null&&g(e,["executableCode"],s);const a=p(n,["fileData"]);a!=null&&g(e,["fileData"],jG(a));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],BG(l));const u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);const h=p(n,["inlineData"]);h!=null&&g(e,["inlineData"],Lm(h));const m=p(n,["text"]);m!=null&&g(e,["text"],m);const _=p(n,["thought"]);_!=null&&g(e,["thought"],_);const T=p(n,["thoughtSignature"]);T!=null&&g(e,["thoughtSignature"],T);const E=p(n,["videoMetadata"]);return E!=null&&g(e,["videoMetadata"],E),e}function i9(n){const e={},t=p(n,["handle"]);if(t!=null&&g(e,["handle"],t),p(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function yD(n){const e={},t=p(n,["voiceConfig"]);t!=null&&g(e,["voiceConfig"],t);const i=p(n,["languageCode"]);if(i!=null&&g(e,["languageCode"],i),p(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function s9(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(T=>T)),g(e,["functionDeclarations"],_)}if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=p(n,["googleSearchRetrieval"]);i!=null&&g(e,["googleSearchRetrieval"],i);const s=p(n,["computerUse"]);s!=null&&g(e,["computerUse"],s);const a=p(n,["fileSearch"]);a!=null&&g(e,["fileSearch"],a);const l=p(n,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],HG(u));const h=p(n,["googleSearch"]);h!=null&&g(e,["googleSearch"],$G(h));const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function r9(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(E=>GG(E))),g(e,["functionDeclarations"],T)}const i=p(n,["retrieval"]);i!=null&&g(e,["retrieval"],i);const s=p(n,["googleSearchRetrieval"]);s!=null&&g(e,["googleSearchRetrieval"],s);const a=p(n,["computerUse"]);if(a!=null&&g(e,["computerUse"],a),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=p(n,["codeExecution"]);l!=null&&g(e,["codeExecution"],l);const u=p(n,["enterpriseWebSearch"]);u!=null&&g(e,["enterpriseWebSearch"],u);const h=p(n,["googleMaps"]);h!=null&&g(e,["googleMaps"],h);const m=p(n,["googleSearch"]);m!=null&&g(e,["googleSearch"],m);const _=p(n,["urlContext"]);return _!=null&&g(e,["urlContext"],_),e}function o9(n){const e={},t=p(n,["promptTokenCount"]);t!=null&&g(e,["promptTokenCount"],t);const i=p(n,["cachedContentTokenCount"]);i!=null&&g(e,["cachedContentTokenCount"],i);const s=p(n,["candidatesTokenCount"]);s!=null&&g(e,["responseTokenCount"],s);const a=p(n,["toolUsePromptTokenCount"]);a!=null&&g(e,["toolUsePromptTokenCount"],a);const l=p(n,["thoughtsTokenCount"]);l!=null&&g(e,["thoughtsTokenCount"],l);const u=p(n,["totalTokenCount"]);u!=null&&g(e,["totalTokenCount"],u);const h=p(n,["promptTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(k=>k)),g(e,["promptTokensDetails"],S)}const m=p(n,["cacheTokensDetails"]);if(m!=null){let S=m;Array.isArray(S)&&(S=S.map(k=>k)),g(e,["cacheTokensDetails"],S)}const _=p(n,["candidatesTokensDetails"]);if(_!=null){let S=_;Array.isArray(S)&&(S=S.map(k=>k)),g(e,["responseTokensDetails"],S)}const T=p(n,["toolUsePromptTokensDetails"]);if(T!=null){let S=T;Array.isArray(S)&&(S=S.map(k=>k)),g(e,["toolUsePromptTokensDetails"],S)}const E=p(n,["trafficType"]);return E!=null&&g(e,["trafficType"],E),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function a9(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function l9(n){const e={},t=p(n,["content"]);t!=null&&g(e,["content"],t);const i=p(n,["citationMetadata"]);i!=null&&g(e,["citationMetadata"],c9(i));const s=p(n,["tokenCount"]);s!=null&&g(e,["tokenCount"],s);const a=p(n,["finishReason"]);a!=null&&g(e,["finishReason"],a);const l=p(n,["avgLogprobs"]);l!=null&&g(e,["avgLogprobs"],l);const u=p(n,["groundingMetadata"]);u!=null&&g(e,["groundingMetadata"],u);const h=p(n,["index"]);h!=null&&g(e,["index"],h);const m=p(n,["logprobsResult"]);m!=null&&g(e,["logprobsResult"],m);const _=p(n,["safetyRatings"]);if(_!=null){let E=_;Array.isArray(E)&&(E=E.map(S=>S)),g(e,["safetyRatings"],E)}const T=p(n,["urlContextMetadata"]);return T!=null&&g(e,["urlContextMetadata"],T),e}function c9(n){const e={},t=p(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),g(e,["citations"],i)}return e}function u9(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["contents"]);if(s!=null){let a=Fi(s);Array.isArray(a)&&(a=a.map(l=>l)),g(t,["contents"],a)}return t}function d9(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["tokensInfo"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),g(e,["tokensInfo"],s)}return e}function h9(n){const e={},t=p(n,["values"]);t!=null&&g(e,["values"],t);const i=p(n,["statistics"]);return i!=null&&g(e,["statistics"],f9(i)),e}function f9(n){const e={},t=p(n,["truncated"]);t!=null&&g(e,["truncated"],t);const i=p(n,["token_count"]);return i!=null&&g(e,["tokenCount"],i),e}function rg(n){const e={},t=p(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>Ez(a))),g(e,["parts"],s)}const i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function m9(n){const e={},t=p(n,["controlType"]);t!=null&&g(e,["controlType"],t);const i=p(n,["enableControlImageComputation"]);return i!=null&&g(e,["computeControl"],i),e}function p9(n){const e={};if(p(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(p(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(p(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function g9(n,e){const t={},i=p(n,["systemInstruction"]);e!==void 0&&i!=null&&g(e,["systemInstruction"],On(i));const s=p(n,["tools"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>ED(u))),g(e,["tools"],l)}const a=p(n,["generationConfig"]);return e!==void 0&&a!=null&&g(e,["generationConfig"],az(a)),t}function y9(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["contents"]);if(s!=null){let l=Fi(s);Array.isArray(l)&&(l=l.map(u=>rg(u))),g(t,["contents"],l)}const a=p(e,["config"]);return a!=null&&p9(a),t}function _9(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["contents"]);if(s!=null){let l=Fi(s);Array.isArray(l)&&(l=l.map(u=>u)),g(t,["contents"],l)}const a=p(e,["config"]);return a!=null&&g9(a,t),t}function v9(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["totalTokens"]);i!=null&&g(e,["totalTokens"],i);const s=p(n,["cachedContentTokenCount"]);return s!=null&&g(e,["cachedContentTokenCount"],s),e}function T9(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["totalTokens"]);return i!=null&&g(e,["totalTokens"],i),e}function x9(n,e){const t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],lt(n,i)),t}function E9(n,e){const t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],lt(n,i)),t}function w9(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function b9(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function I9(n,e){const t={},i=p(n,["outputGcsUri"]);e!==void 0&&i!=null&&g(e,["parameters","storageUri"],i);const s=p(n,["negativePrompt"]);e!==void 0&&s!=null&&g(e,["parameters","negativePrompt"],s);const a=p(n,["numberOfImages"]);e!==void 0&&a!=null&&g(e,["parameters","sampleCount"],a);const l=p(n,["aspectRatio"]);e!==void 0&&l!=null&&g(e,["parameters","aspectRatio"],l);const u=p(n,["guidanceScale"]);e!==void 0&&u!=null&&g(e,["parameters","guidanceScale"],u);const h=p(n,["seed"]);e!==void 0&&h!=null&&g(e,["parameters","seed"],h);const m=p(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&g(e,["parameters","safetySetting"],m);const _=p(n,["personGeneration"]);e!==void 0&&_!=null&&g(e,["parameters","personGeneration"],_);const T=p(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&g(e,["parameters","includeSafetyAttributes"],T);const E=p(n,["includeRaiReason"]);e!==void 0&&E!=null&&g(e,["parameters","includeRaiReason"],E);const S=p(n,["language"]);e!==void 0&&S!=null&&g(e,["parameters","language"],S);const k=p(n,["outputMimeType"]);e!==void 0&&k!=null&&g(e,["parameters","outputOptions","mimeType"],k);const V=p(n,["outputCompressionQuality"]);e!==void 0&&V!=null&&g(e,["parameters","outputOptions","compressionQuality"],V);const O=p(n,["addWatermark"]);e!==void 0&&O!=null&&g(e,["parameters","addWatermark"],O);const j=p(n,["labels"]);e!==void 0&&j!=null&&g(e,["labels"],j);const W=p(n,["editMode"]);e!==void 0&&W!=null&&g(e,["parameters","editMode"],W);const $=p(n,["baseSteps"]);return e!==void 0&&$!=null&&g(e,["parameters","editConfig","baseSteps"],$),t}function S9(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["prompt"]);s!=null&&g(t,["instances[0]","prompt"],s);const a=p(e,["referenceImages"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(h=>Nz(h))),g(t,["instances[0]","referenceImages"],u)}const l=p(e,["config"]);return l!=null&&I9(l,t),t}function A9(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>og(a))),g(e,["generatedImages"],s)}return e}function N9(n,e){const t={},i=p(n,["taskType"]);e!==void 0&&i!=null&&g(e,["requests[]","taskType"],i);const s=p(n,["title"]);e!==void 0&&s!=null&&g(e,["requests[]","title"],s);const a=p(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&g(e,["requests[]","outputDimensionality"],a),p(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function C9(n,e){const t={},i=p(n,["taskType"]);e!==void 0&&i!=null&&g(e,["instances[]","task_type"],i);const s=p(n,["title"]);e!==void 0&&s!=null&&g(e,["instances[]","title"],s);const a=p(n,["outputDimensionality"]);e!==void 0&&a!=null&&g(e,["parameters","outputDimensionality"],a);const l=p(n,["mimeType"]);e!==void 0&&l!=null&&g(e,["instances[]","mimeType"],l);const u=p(n,["autoTruncate"]);return e!==void 0&&u!=null&&g(e,["parameters","autoTruncate"],u),t}function R9(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["contents"]);if(s!=null){let u=UT(n,s);Array.isArray(u)&&(u=u.map(h=>h)),g(t,["requests[]","content"],u)}const a=p(e,["config"]);a!=null&&N9(a,t);const l=p(e,["model"]);return l!==void 0&&g(t,["requests[]","model"],lt(n,l)),t}function P9(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["contents"]);if(s!=null){let l=UT(n,s);Array.isArray(l)&&(l=l.map(u=>u)),g(t,["instances[]","content"],l)}const a=p(e,["config"]);return a!=null&&C9(a,t),t}function D9(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["embeddings"],a)}const s=p(n,["metadata"]);return s!=null&&g(e,["metadata"],s),e}function M9(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["predictions[]","embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>h9(l))),g(e,["embeddings"],a)}const s=p(n,["metadata"]);return s!=null&&g(e,["metadata"],s),e}function k9(n){const e={},t=p(n,["endpoint"]);t!=null&&g(e,["name"],t);const i=p(n,["deployedModelId"]);return i!=null&&g(e,["deployedModelId"],i),e}function V9(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function L9(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const i=p(n,["args"]);i!=null&&g(e,["args"],i);const s=p(n,["name"]);if(s!=null&&g(e,["name"],s),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function U9(n){const e={},t=p(n,["mode"]);t!=null&&g(e,["mode"],t);const i=p(n,["allowedFunctionNames"]);if(i!=null&&g(e,["allowedFunctionNames"],i),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function O9(n){const e={};if(p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=p(n,["description"]);t!=null&&g(e,["description"],t);const i=p(n,["name"]);i!=null&&g(e,["name"],i);const s=p(n,["parameters"]);s!=null&&g(e,["parameters"],s);const a=p(n,["parametersJsonSchema"]);a!=null&&g(e,["parametersJsonSchema"],a);const l=p(n,["response"]);l!=null&&g(e,["response"],l);const u=p(n,["responseJsonSchema"]);return u!=null&&g(e,["responseJsonSchema"],u),e}function F9(n,e,t){const i={},s=p(e,["systemInstruction"]);t!==void 0&&s!=null&&g(t,["systemInstruction"],rg(On(s)));const a=p(e,["temperature"]);a!=null&&g(i,["temperature"],a);const l=p(e,["topP"]);l!=null&&g(i,["topP"],l);const u=p(e,["topK"]);u!=null&&g(i,["topK"],u);const h=p(e,["candidateCount"]);h!=null&&g(i,["candidateCount"],h);const m=p(e,["maxOutputTokens"]);m!=null&&g(i,["maxOutputTokens"],m);const _=p(e,["stopSequences"]);_!=null&&g(i,["stopSequences"],_);const T=p(e,["responseLogprobs"]);T!=null&&g(i,["responseLogprobs"],T);const E=p(e,["logprobs"]);E!=null&&g(i,["logprobs"],E);const S=p(e,["presencePenalty"]);S!=null&&g(i,["presencePenalty"],S);const k=p(e,["frequencyPenalty"]);k!=null&&g(i,["frequencyPenalty"],k);const V=p(e,["seed"]);V!=null&&g(i,["seed"],V);const O=p(e,["responseMimeType"]);O!=null&&g(i,["responseMimeType"],O);const j=p(e,["responseSchema"]);j!=null&&g(i,["responseSchema"],OT(j));const W=p(e,["responseJsonSchema"]);if(W!=null&&g(i,["responseJsonSchema"],W),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const $=p(e,["safetySettings"]);if(t!==void 0&&$!=null){let D=$;Array.isArray(D)&&(D=D.map(ye=>Cz(ye))),g(t,["safetySettings"],D)}const U=p(e,["tools"]);if(t!==void 0&&U!=null){let D=Wc(U);Array.isArray(D)&&(D=D.map(ye=>Lz(Qc(ye)))),g(t,["tools"],D)}const K=p(e,["toolConfig"]);if(t!==void 0&&K!=null&&g(t,["toolConfig"],Vz(K)),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=p(e,["cachedContent"]);t!==void 0&&J!=null&&g(t,["cachedContent"],Sr(n,J));const R=p(e,["responseModalities"]);R!=null&&g(i,["responseModalities"],R);const A=p(e,["mediaResolution"]);A!=null&&g(i,["mediaResolution"],A);const C=p(e,["speechConfig"]);if(C!=null&&g(i,["speechConfig"],FT(C)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const M=p(e,["thinkingConfig"]);M!=null&&g(i,["thinkingConfig"],M);const L=p(e,["imageConfig"]);L!=null&&g(i,["imageConfig"],hz(L));const F=p(e,["enableEnhancedCivicAnswers"]);return F!=null&&g(i,["enableEnhancedCivicAnswers"],F),i}function q9(n,e,t){const i={},s=p(e,["systemInstruction"]);t!==void 0&&s!=null&&g(t,["systemInstruction"],On(s));const a=p(e,["temperature"]);a!=null&&g(i,["temperature"],a);const l=p(e,["topP"]);l!=null&&g(i,["topP"],l);const u=p(e,["topK"]);u!=null&&g(i,["topK"],u);const h=p(e,["candidateCount"]);h!=null&&g(i,["candidateCount"],h);const m=p(e,["maxOutputTokens"]);m!=null&&g(i,["maxOutputTokens"],m);const _=p(e,["stopSequences"]);_!=null&&g(i,["stopSequences"],_);const T=p(e,["responseLogprobs"]);T!=null&&g(i,["responseLogprobs"],T);const E=p(e,["logprobs"]);E!=null&&g(i,["logprobs"],E);const S=p(e,["presencePenalty"]);S!=null&&g(i,["presencePenalty"],S);const k=p(e,["frequencyPenalty"]);k!=null&&g(i,["frequencyPenalty"],k);const V=p(e,["seed"]);V!=null&&g(i,["seed"],V);const O=p(e,["responseMimeType"]);O!=null&&g(i,["responseMimeType"],O);const j=p(e,["responseSchema"]);j!=null&&g(i,["responseSchema"],OT(j));const W=p(e,["responseJsonSchema"]);W!=null&&g(i,["responseJsonSchema"],W);const $=p(e,["routingConfig"]);$!=null&&g(i,["routingConfig"],$);const U=p(e,["modelSelectionConfig"]);U!=null&&g(i,["modelConfig"],U);const K=p(e,["safetySettings"]);if(t!==void 0&&K!=null){let X=K;Array.isArray(X)&&(X=X.map(fe=>fe)),g(t,["safetySettings"],X)}const J=p(e,["tools"]);if(t!==void 0&&J!=null){let X=Wc(J);Array.isArray(X)&&(X=X.map(fe=>ED(Qc(fe)))),g(t,["tools"],X)}const R=p(e,["toolConfig"]);t!==void 0&&R!=null&&g(t,["toolConfig"],R);const A=p(e,["labels"]);t!==void 0&&A!=null&&g(t,["labels"],A);const C=p(e,["cachedContent"]);t!==void 0&&C!=null&&g(t,["cachedContent"],Sr(n,C));const M=p(e,["responseModalities"]);M!=null&&g(i,["responseModalities"],M);const L=p(e,["mediaResolution"]);L!=null&&g(i,["mediaResolution"],L);const F=p(e,["speechConfig"]);F!=null&&g(i,["speechConfig"],xD(FT(F)));const D=p(e,["audioTimestamp"]);D!=null&&g(i,["audioTimestamp"],D);const ye=p(e,["thinkingConfig"]);ye!=null&&g(i,["thinkingConfig"],ye);const Oe=p(e,["imageConfig"]);if(Oe!=null&&g(i,["imageConfig"],fz(Oe)),p(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return i}function oN(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["contents"]);if(s!=null){let l=Fi(s);Array.isArray(l)&&(l=l.map(u=>rg(u))),g(t,["contents"],l)}const a=p(e,["config"]);return a!=null&&g(t,["generationConfig"],F9(n,a,t)),t}function aN(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["contents"]);if(s!=null){let l=Fi(s);Array.isArray(l)&&(l=l.map(u=>u)),g(t,["contents"],l)}const a=p(e,["config"]);return a!=null&&g(t,["generationConfig"],q9(n,a,t)),t}function lN(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["candidates"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(m=>l9(m))),g(e,["candidates"],h)}const s=p(n,["modelVersion"]);s!=null&&g(e,["modelVersion"],s);const a=p(n,["promptFeedback"]);a!=null&&g(e,["promptFeedback"],a);const l=p(n,["responseId"]);l!=null&&g(e,["responseId"],l);const u=p(n,["usageMetadata"]);return u!=null&&g(e,["usageMetadata"],u),e}function cN(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(_=>_)),g(e,["candidates"],m)}const s=p(n,["createTime"]);s!=null&&g(e,["createTime"],s);const a=p(n,["modelVersion"]);a!=null&&g(e,["modelVersion"],a);const l=p(n,["promptFeedback"]);l!=null&&g(e,["promptFeedback"],l);const u=p(n,["responseId"]);u!=null&&g(e,["responseId"],u);const h=p(n,["usageMetadata"]);return h!=null&&g(e,["usageMetadata"],h),e}function j9(n,e){const t={};if(p(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=p(n,["numberOfImages"]);e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i);const s=p(n,["aspectRatio"]);e!==void 0&&s!=null&&g(e,["parameters","aspectRatio"],s);const a=p(n,["guidanceScale"]);if(e!==void 0&&a!=null&&g(e,["parameters","guidanceScale"],a),p(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=p(n,["safetyFilterLevel"]);e!==void 0&&l!=null&&g(e,["parameters","safetySetting"],l);const u=p(n,["personGeneration"]);e!==void 0&&u!=null&&g(e,["parameters","personGeneration"],u);const h=p(n,["includeSafetyAttributes"]);e!==void 0&&h!=null&&g(e,["parameters","includeSafetyAttributes"],h);const m=p(n,["includeRaiReason"]);e!==void 0&&m!=null&&g(e,["parameters","includeRaiReason"],m);const _=p(n,["language"]);e!==void 0&&_!=null&&g(e,["parameters","language"],_);const T=p(n,["outputMimeType"]);e!==void 0&&T!=null&&g(e,["parameters","outputOptions","mimeType"],T);const E=p(n,["outputCompressionQuality"]);if(e!==void 0&&E!=null&&g(e,["parameters","outputOptions","compressionQuality"],E),p(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(p(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const S=p(n,["imageSize"]);if(e!==void 0&&S!=null&&g(e,["parameters","sampleImageSize"],S),p(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function B9(n,e){const t={},i=p(n,["outputGcsUri"]);e!==void 0&&i!=null&&g(e,["parameters","storageUri"],i);const s=p(n,["negativePrompt"]);e!==void 0&&s!=null&&g(e,["parameters","negativePrompt"],s);const a=p(n,["numberOfImages"]);e!==void 0&&a!=null&&g(e,["parameters","sampleCount"],a);const l=p(n,["aspectRatio"]);e!==void 0&&l!=null&&g(e,["parameters","aspectRatio"],l);const u=p(n,["guidanceScale"]);e!==void 0&&u!=null&&g(e,["parameters","guidanceScale"],u);const h=p(n,["seed"]);e!==void 0&&h!=null&&g(e,["parameters","seed"],h);const m=p(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&g(e,["parameters","safetySetting"],m);const _=p(n,["personGeneration"]);e!==void 0&&_!=null&&g(e,["parameters","personGeneration"],_);const T=p(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&g(e,["parameters","includeSafetyAttributes"],T);const E=p(n,["includeRaiReason"]);e!==void 0&&E!=null&&g(e,["parameters","includeRaiReason"],E);const S=p(n,["language"]);e!==void 0&&S!=null&&g(e,["parameters","language"],S);const k=p(n,["outputMimeType"]);e!==void 0&&k!=null&&g(e,["parameters","outputOptions","mimeType"],k);const V=p(n,["outputCompressionQuality"]);e!==void 0&&V!=null&&g(e,["parameters","outputOptions","compressionQuality"],V);const O=p(n,["addWatermark"]);e!==void 0&&O!=null&&g(e,["parameters","addWatermark"],O);const j=p(n,["labels"]);e!==void 0&&j!=null&&g(e,["labels"],j);const W=p(n,["imageSize"]);e!==void 0&&W!=null&&g(e,["parameters","sampleImageSize"],W);const $=p(n,["enhancePrompt"]);return e!==void 0&&$!=null&&g(e,["parameters","enhancePrompt"],$),t}function G9(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["prompt"]);s!=null&&g(t,["instances[0]","prompt"],s);const a=p(e,["config"]);return a!=null&&j9(a,t),t}function z9(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["prompt"]);s!=null&&g(t,["instances[0]","prompt"],s);const a=p(e,["config"]);return a!=null&&B9(a,t),t}function H9(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>iz(l))),g(e,["generatedImages"],a)}const s=p(n,["positivePromptSafetyAttributes"]);return s!=null&&g(e,["positivePromptSafetyAttributes"],vD(s)),e}function $9(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>og(l))),g(e,["generatedImages"],a)}const s=p(n,["positivePromptSafetyAttributes"]);return s!=null&&g(e,["positivePromptSafetyAttributes"],TD(s)),e}function K9(n,e){const t={},i=p(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i),p(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=p(n,["durationSeconds"]);if(e!==void 0&&s!=null&&g(e,["parameters","durationSeconds"],s),p(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=p(n,["aspectRatio"]);e!==void 0&&a!=null&&g(e,["parameters","aspectRatio"],a);const l=p(n,["resolution"]);e!==void 0&&l!=null&&g(e,["parameters","resolution"],l);const u=p(n,["personGeneration"]);if(e!==void 0&&u!=null&&g(e,["parameters","personGeneration"],u),p(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=p(n,["negativePrompt"]);e!==void 0&&h!=null&&g(e,["parameters","negativePrompt"],h);const m=p(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&g(e,["parameters","enhancePrompt"],m),p(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const _=p(n,["lastFrame"]);e!==void 0&&_!=null&&g(e,["instances[0]","lastFrame"],ag(_));const T=p(n,["referenceImages"]);if(e!==void 0&&T!=null){let E=T;Array.isArray(E)&&(E=E.map(S=>Jz(S))),g(e,["instances[0]","referenceImages"],E)}if(p(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(p(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function Y9(n,e){const t={},i=p(n,["numberOfVideos"]);e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i);const s=p(n,["outputGcsUri"]);e!==void 0&&s!=null&&g(e,["parameters","storageUri"],s);const a=p(n,["fps"]);e!==void 0&&a!=null&&g(e,["parameters","fps"],a);const l=p(n,["durationSeconds"]);e!==void 0&&l!=null&&g(e,["parameters","durationSeconds"],l);const u=p(n,["seed"]);e!==void 0&&u!=null&&g(e,["parameters","seed"],u);const h=p(n,["aspectRatio"]);e!==void 0&&h!=null&&g(e,["parameters","aspectRatio"],h);const m=p(n,["resolution"]);e!==void 0&&m!=null&&g(e,["parameters","resolution"],m);const _=p(n,["personGeneration"]);e!==void 0&&_!=null&&g(e,["parameters","personGeneration"],_);const T=p(n,["pubsubTopic"]);e!==void 0&&T!=null&&g(e,["parameters","pubsubTopic"],T);const E=p(n,["negativePrompt"]);e!==void 0&&E!=null&&g(e,["parameters","negativePrompt"],E);const S=p(n,["enhancePrompt"]);e!==void 0&&S!=null&&g(e,["parameters","enhancePrompt"],S);const k=p(n,["generateAudio"]);e!==void 0&&k!=null&&g(e,["parameters","generateAudio"],k);const V=p(n,["lastFrame"]);e!==void 0&&V!=null&&g(e,["instances[0]","lastFrame"],os(V));const O=p(n,["referenceImages"]);if(e!==void 0&&O!=null){let $=O;Array.isArray($)&&($=$.map(U=>Qz(U))),g(e,["instances[0]","referenceImages"],$)}const j=p(n,["mask"]);e!==void 0&&j!=null&&g(e,["instances[0]","mask"],Yz(j));const W=p(n,["compressionQuality"]);return e!==void 0&&W!=null&&g(e,["parameters","compressionQuality"],W),t}function J9(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const s=p(n,["done"]);s!=null&&g(e,["done"],s);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response","generateVideoResponse"]);return l!=null&&g(e,["response"],Z9(l)),e}function Q9(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const s=p(n,["done"]);s!=null&&g(e,["done"],s);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response"]);return l!=null&&g(e,["response"],ez(l)),e}function W9(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["prompt"]);s!=null&&g(t,["instances[0]","prompt"],s);const a=p(e,["image"]);a!=null&&g(t,["instances[0]","image"],ag(a));const l=p(e,["video"]);l!=null&&g(t,["instances[0]","video"],wD(l));const u=p(e,["source"]);u!=null&&tz(u,t);const h=p(e,["config"]);return h!=null&&K9(h,t),t}function X9(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["prompt"]);s!=null&&g(t,["instances[0]","prompt"],s);const a=p(e,["image"]);a!=null&&g(t,["instances[0]","image"],os(a));const l=p(e,["video"]);l!=null&&g(t,["instances[0]","video"],bD(l));const u=p(e,["source"]);u!=null&&nz(u,t);const h=p(e,["config"]);return h!=null&&Y9(h,t),t}function Z9(n){const e={},t=p(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>rz(l))),g(e,["generatedVideos"],a)}const i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);const s=p(n,["raiMediaFilteredReasons"]);return s!=null&&g(e,["raiMediaFilteredReasons"],s),e}function ez(n){const e={},t=p(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>oz(l))),g(e,["generatedVideos"],a)}const i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);const s=p(n,["raiMediaFilteredReasons"]);return s!=null&&g(e,["raiMediaFilteredReasons"],s),e}function tz(n,e){const t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);const s=p(n,["image"]);e!==void 0&&s!=null&&g(e,["instances[0]","image"],ag(s));const a=p(n,["video"]);return e!==void 0&&a!=null&&g(e,["instances[0]","video"],wD(a)),t}function nz(n,e){const t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);const s=p(n,["image"]);e!==void 0&&s!=null&&g(e,["instances[0]","image"],os(s));const a=p(n,["video"]);return e!==void 0&&a!=null&&g(e,["instances[0]","video"],bD(a)),t}function iz(n){const e={},t=p(n,["_self"]);t!=null&&g(e,["image"],mz(t));const i=p(n,["raiFilteredReason"]);i!=null&&g(e,["raiFilteredReason"],i);const s=p(n,["_self"]);return s!=null&&g(e,["safetyAttributes"],vD(s)),e}function og(n){const e={},t=p(n,["_self"]);t!=null&&g(e,["image"],_D(t));const i=p(n,["raiFilteredReason"]);i!=null&&g(e,["raiFilteredReason"],i);const s=p(n,["_self"]);s!=null&&g(e,["safetyAttributes"],TD(s));const a=p(n,["prompt"]);return a!=null&&g(e,["enhancedPrompt"],a),e}function sz(n){const e={},t=p(n,["_self"]);t!=null&&g(e,["mask"],_D(t));const i=p(n,["labels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),g(e,["labels"],s)}return e}function rz(n){const e={},t=p(n,["video"]);return t!=null&&g(e,["video"],$z(t)),e}function oz(n){const e={},t=p(n,["_self"]);return t!=null&&g(e,["video"],Kz(t)),e}function az(n){const e={},t=p(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);const i=p(n,["responseJsonSchema"]);i!=null&&g(e,["responseJsonSchema"],i);const s=p(n,["audioTimestamp"]);s!=null&&g(e,["audioTimestamp"],s);const a=p(n,["candidateCount"]);a!=null&&g(e,["candidateCount"],a);const l=p(n,["enableAffectiveDialog"]);l!=null&&g(e,["enableAffectiveDialog"],l);const u=p(n,["frequencyPenalty"]);u!=null&&g(e,["frequencyPenalty"],u);const h=p(n,["logprobs"]);h!=null&&g(e,["logprobs"],h);const m=p(n,["maxOutputTokens"]);m!=null&&g(e,["maxOutputTokens"],m);const _=p(n,["mediaResolution"]);_!=null&&g(e,["mediaResolution"],_);const T=p(n,["presencePenalty"]);T!=null&&g(e,["presencePenalty"],T);const E=p(n,["responseLogprobs"]);E!=null&&g(e,["responseLogprobs"],E);const S=p(n,["responseMimeType"]);S!=null&&g(e,["responseMimeType"],S);const k=p(n,["responseModalities"]);k!=null&&g(e,["responseModalities"],k);const V=p(n,["responseSchema"]);V!=null&&g(e,["responseSchema"],V);const O=p(n,["routingConfig"]);O!=null&&g(e,["routingConfig"],O);const j=p(n,["seed"]);j!=null&&g(e,["seed"],j);const W=p(n,["speechConfig"]);W!=null&&g(e,["speechConfig"],xD(W));const $=p(n,["stopSequences"]);$!=null&&g(e,["stopSequences"],$);const U=p(n,["temperature"]);U!=null&&g(e,["temperature"],U);const K=p(n,["thinkingConfig"]);K!=null&&g(e,["thinkingConfig"],K);const J=p(n,["topK"]);J!=null&&g(e,["topK"],J);const R=p(n,["topP"]);if(R!=null&&g(e,["topP"],R),p(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function lz(n,e){const t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],lt(n,i)),t}function cz(n,e){const t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],lt(n,i)),t}function uz(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function dz(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function hz(n){const e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);const i=p(n,["imageSize"]);if(i!=null&&g(e,["imageSize"],i),p(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function fz(n){const e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);const i=p(n,["imageSize"]);i!=null&&g(e,["imageSize"],i);const s=p(n,["outputMimeType"]);s!=null&&g(e,["imageOutputOptions","mimeType"],s);const a=p(n,["outputCompressionQuality"]);return a!=null&&g(e,["imageOutputOptions","compressionQuality"],a),e}function mz(n){const e={},t=p(n,["bytesBase64Encoded"]);t!=null&&g(e,["imageBytes"],qo(t));const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function _D(n){const e={},t=p(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);const i=p(n,["bytesBase64Encoded"]);i!=null&&g(e,["imageBytes"],qo(i));const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function ag(n){const e={};if(p(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=p(n,["imageBytes"]);t!=null&&g(e,["bytesBase64Encoded"],qo(t));const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function os(n){const e={},t=p(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);const i=p(n,["imageBytes"]);i!=null&&g(e,["bytesBase64Encoded"],qo(i));const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function pz(n,e,t){const i={},s=p(e,["pageSize"]);t!==void 0&&s!=null&&g(t,["_query","pageSize"],s);const a=p(e,["pageToken"]);t!==void 0&&a!=null&&g(t,["_query","pageToken"],a);const l=p(e,["filter"]);t!==void 0&&l!=null&&g(t,["_query","filter"],l);const u=p(e,["queryBase"]);return t!==void 0&&u!=null&&g(t,["_url","models_url"],uD(n,u)),i}function gz(n,e,t){const i={},s=p(e,["pageSize"]);t!==void 0&&s!=null&&g(t,["_query","pageSize"],s);const a=p(e,["pageToken"]);t!==void 0&&a!=null&&g(t,["_query","pageToken"],a);const l=p(e,["filter"]);t!==void 0&&l!=null&&g(t,["_query","filter"],l);const u=p(e,["queryBase"]);return t!==void 0&&u!=null&&g(t,["_url","models_url"],uD(n,u)),i}function yz(n,e){const t={},i=p(e,["config"]);return i!=null&&pz(n,i,t),t}function _z(n,e){const t={},i=p(e,["config"]);return i!=null&&gz(n,i,t),t}function vz(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const s=p(n,["_self"]);if(s!=null){let a=dD(s);Array.isArray(a)&&(a=a.map(l=>Lv(l))),g(e,["models"],a)}return e}function Tz(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const s=p(n,["_self"]);if(s!=null){let a=dD(s);Array.isArray(a)&&(a=a.map(l=>Uv(l))),g(e,["models"],a)}return e}function xz(n){const e={},t=p(n,["maskMode"]);t!=null&&g(e,["maskMode"],t);const i=p(n,["segmentationClasses"]);i!=null&&g(e,["maskClasses"],i);const s=p(n,["maskDilation"]);return s!=null&&g(e,["dilation"],s),e}function Lv(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["displayName"]);i!=null&&g(e,["displayName"],i);const s=p(n,["description"]);s!=null&&g(e,["description"],s);const a=p(n,["version"]);a!=null&&g(e,["version"],a);const l=p(n,["_self"]);l!=null&&g(e,["tunedModelInfo"],Uz(l));const u=p(n,["inputTokenLimit"]);u!=null&&g(e,["inputTokenLimit"],u);const h=p(n,["outputTokenLimit"]);h!=null&&g(e,["outputTokenLimit"],h);const m=p(n,["supportedGenerationMethods"]);m!=null&&g(e,["supportedActions"],m);const _=p(n,["temperature"]);_!=null&&g(e,["temperature"],_);const T=p(n,["maxTemperature"]);T!=null&&g(e,["maxTemperature"],T);const E=p(n,["topP"]);E!=null&&g(e,["topP"],E);const S=p(n,["topK"]);S!=null&&g(e,["topK"],S);const k=p(n,["thinking"]);return k!=null&&g(e,["thinking"],k),e}function Uv(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["displayName"]);i!=null&&g(e,["displayName"],i);const s=p(n,["description"]);s!=null&&g(e,["description"],s);const a=p(n,["versionId"]);a!=null&&g(e,["version"],a);const l=p(n,["deployedModels"]);if(l!=null){let T=l;Array.isArray(T)&&(T=T.map(E=>k9(E))),g(e,["endpoints"],T)}const u=p(n,["labels"]);u!=null&&g(e,["labels"],u);const h=p(n,["_self"]);h!=null&&g(e,["tunedModelInfo"],Oz(h));const m=p(n,["defaultCheckpointId"]);m!=null&&g(e,["defaultCheckpointId"],m);const _=p(n,["checkpoints"]);if(_!=null){let T=_;Array.isArray(T)&&(T=T.map(E=>E)),g(e,["checkpoints"],T)}return e}function Ez(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const s=p(n,["executableCode"]);s!=null&&g(e,["executableCode"],s);const a=p(n,["fileData"]);a!=null&&g(e,["fileData"],V9(a));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],L9(l));const u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);const h=p(n,["inlineData"]);h!=null&&g(e,["inlineData"],a9(h));const m=p(n,["text"]);m!=null&&g(e,["text"],m);const _=p(n,["thought"]);_!=null&&g(e,["thought"],_);const T=p(n,["thoughtSignature"]);T!=null&&g(e,["thoughtSignature"],T);const E=p(n,["videoMetadata"]);return E!=null&&g(e,["videoMetadata"],E),e}function wz(n){const e={},t=p(n,["productImage"]);return t!=null&&g(e,["image"],os(t)),e}function bz(n,e){const t={},i=p(n,["numberOfImages"]);e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i);const s=p(n,["baseSteps"]);e!==void 0&&s!=null&&g(e,["parameters","baseSteps"],s);const a=p(n,["outputGcsUri"]);e!==void 0&&a!=null&&g(e,["parameters","storageUri"],a);const l=p(n,["seed"]);e!==void 0&&l!=null&&g(e,["parameters","seed"],l);const u=p(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&g(e,["parameters","safetySetting"],u);const h=p(n,["personGeneration"]);e!==void 0&&h!=null&&g(e,["parameters","personGeneration"],h);const m=p(n,["addWatermark"]);e!==void 0&&m!=null&&g(e,["parameters","addWatermark"],m);const _=p(n,["outputMimeType"]);e!==void 0&&_!=null&&g(e,["parameters","outputOptions","mimeType"],_);const T=p(n,["outputCompressionQuality"]);e!==void 0&&T!=null&&g(e,["parameters","outputOptions","compressionQuality"],T);const E=p(n,["enhancePrompt"]);e!==void 0&&E!=null&&g(e,["parameters","enhancePrompt"],E);const S=p(n,["labels"]);return e!==void 0&&S!=null&&g(e,["labels"],S),t}function Iz(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["source"]);s!=null&&Az(s,t);const a=p(e,["config"]);return a!=null&&bz(a,t),t}function Sz(n){const e={},t=p(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>og(s))),g(e,["generatedImages"],i)}return e}function Az(n,e){const t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);const s=p(n,["personImage"]);e!==void 0&&s!=null&&g(e,["instances[0]","personImage","image"],os(s));const a=p(n,["productImages"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>wz(u))),g(e,["instances[0]","productImages"],l)}return t}function Nz(n){const e={},t=p(n,["referenceImage"]);t!=null&&g(e,["referenceImage"],os(t));const i=p(n,["referenceId"]);i!=null&&g(e,["referenceId"],i);const s=p(n,["referenceType"]);s!=null&&g(e,["referenceType"],s);const a=p(n,["maskImageConfig"]);a!=null&&g(e,["maskImageConfig"],xz(a));const l=p(n,["controlImageConfig"]);l!=null&&g(e,["controlImageConfig"],m9(l));const u=p(n,["styleImageConfig"]);u!=null&&g(e,["styleImageConfig"],u);const h=p(n,["subjectImageConfig"]);return h!=null&&g(e,["subjectImageConfig"],h),e}function vD(n){const e={},t=p(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);const i=p(n,["safetyAttributes","scores"]);i!=null&&g(e,["scores"],i);const s=p(n,["contentType"]);return s!=null&&g(e,["contentType"],s),e}function TD(n){const e={},t=p(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);const i=p(n,["safetyAttributes","scores"]);i!=null&&g(e,["scores"],i);const s=p(n,["contentType"]);return s!=null&&g(e,["contentType"],s),e}function Cz(n){const e={},t=p(n,["category"]);if(t!=null&&g(e,["category"],t),p(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=p(n,["threshold"]);return i!=null&&g(e,["threshold"],i),e}function Rz(n){const e={},t=p(n,["image"]);return t!=null&&g(e,["image"],os(t)),e}function Pz(n,e){const t={},i=p(n,["mode"]);e!==void 0&&i!=null&&g(e,["parameters","mode"],i);const s=p(n,["maxPredictions"]);e!==void 0&&s!=null&&g(e,["parameters","maxPredictions"],s);const a=p(n,["confidenceThreshold"]);e!==void 0&&a!=null&&g(e,["parameters","confidenceThreshold"],a);const l=p(n,["maskDilation"]);e!==void 0&&l!=null&&g(e,["parameters","maskDilation"],l);const u=p(n,["binaryColorThreshold"]);e!==void 0&&u!=null&&g(e,["parameters","binaryColorThreshold"],u);const h=p(n,["labels"]);return e!==void 0&&h!=null&&g(e,["labels"],h),t}function Dz(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["source"]);s!=null&&kz(s,t);const a=p(e,["config"]);return a!=null&&Pz(a,t),t}function Mz(n){const e={},t=p(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>sz(s))),g(e,["generatedMasks"],i)}return e}function kz(n,e){const t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);const s=p(n,["image"]);e!==void 0&&s!=null&&g(e,["instances[0]","image"],os(s));const a=p(n,["scribbleImage"]);return e!==void 0&&a!=null&&g(e,["instances[0]","scribble"],Rz(a)),t}function xD(n){const e={},t=p(n,["voiceConfig"]);t!=null&&g(e,["voiceConfig"],t);const i=p(n,["languageCode"]);if(i!=null&&g(e,["languageCode"],i),p(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function Vz(n){const e={},t=p(n,["functionCallingConfig"]);t!=null&&g(e,["functionCallingConfig"],U9(t));const i=p(n,["retrievalConfig"]);return i!=null&&g(e,["retrievalConfig"],i),e}function Lz(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(T=>T)),g(e,["functionDeclarations"],_)}if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=p(n,["googleSearchRetrieval"]);i!=null&&g(e,["googleSearchRetrieval"],i);const s=p(n,["computerUse"]);s!=null&&g(e,["computerUse"],s);const a=p(n,["fileSearch"]);a!=null&&g(e,["fileSearch"],a);const l=p(n,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],uz(u));const h=p(n,["googleSearch"]);h!=null&&g(e,["googleSearch"],dz(h));const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function ED(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(E=>O9(E))),g(e,["functionDeclarations"],T)}const i=p(n,["retrieval"]);i!=null&&g(e,["retrieval"],i);const s=p(n,["googleSearchRetrieval"]);s!=null&&g(e,["googleSearchRetrieval"],s);const a=p(n,["computerUse"]);if(a!=null&&g(e,["computerUse"],a),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=p(n,["codeExecution"]);l!=null&&g(e,["codeExecution"],l);const u=p(n,["enterpriseWebSearch"]);u!=null&&g(e,["enterpriseWebSearch"],u);const h=p(n,["googleMaps"]);h!=null&&g(e,["googleMaps"],h);const m=p(n,["googleSearch"]);m!=null&&g(e,["googleSearch"],m);const _=p(n,["urlContext"]);return _!=null&&g(e,["urlContext"],_),e}function Uz(n){const e={},t=p(n,["baseModel"]);t!=null&&g(e,["baseModel"],t);const i=p(n,["createTime"]);i!=null&&g(e,["createTime"],i);const s=p(n,["updateTime"]);return s!=null&&g(e,["updateTime"],s),e}function Oz(n){const e={},t=p(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&g(e,["baseModel"],t);const i=p(n,["createTime"]);i!=null&&g(e,["createTime"],i);const s=p(n,["updateTime"]);return s!=null&&g(e,["updateTime"],s),e}function Fz(n,e){const t={},i=p(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);const s=p(n,["description"]);e!==void 0&&s!=null&&g(e,["description"],s);const a=p(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&g(e,["defaultCheckpointId"],a),t}function qz(n,e){const t={},i=p(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);const s=p(n,["description"]);e!==void 0&&s!=null&&g(e,["description"],s);const a=p(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&g(e,["defaultCheckpointId"],a),t}function jz(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","name"],lt(n,i));const s=p(e,["config"]);return s!=null&&Fz(s,t),t}function Bz(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["config"]);return s!=null&&qz(s,t),t}function Gz(n,e){const t={},i=p(n,["outputGcsUri"]);e!==void 0&&i!=null&&g(e,["parameters","storageUri"],i);const s=p(n,["safetyFilterLevel"]);e!==void 0&&s!=null&&g(e,["parameters","safetySetting"],s);const a=p(n,["personGeneration"]);e!==void 0&&a!=null&&g(e,["parameters","personGeneration"],a);const l=p(n,["includeRaiReason"]);e!==void 0&&l!=null&&g(e,["parameters","includeRaiReason"],l);const u=p(n,["outputMimeType"]);e!==void 0&&u!=null&&g(e,["parameters","outputOptions","mimeType"],u);const h=p(n,["outputCompressionQuality"]);e!==void 0&&h!=null&&g(e,["parameters","outputOptions","compressionQuality"],h);const m=p(n,["enhanceInputImage"]);e!==void 0&&m!=null&&g(e,["parameters","upscaleConfig","enhanceInputImage"],m);const _=p(n,["imagePreservationFactor"]);e!==void 0&&_!=null&&g(e,["parameters","upscaleConfig","imagePreservationFactor"],_);const T=p(n,["labels"]);e!==void 0&&T!=null&&g(e,["labels"],T);const E=p(n,["numberOfImages"]);e!==void 0&&E!=null&&g(e,["parameters","sampleCount"],E);const S=p(n,["mode"]);return e!==void 0&&S!=null&&g(e,["parameters","mode"],S),t}function zz(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],lt(n,i));const s=p(e,["image"]);s!=null&&g(t,["instances[0]","image"],os(s));const a=p(e,["upscaleFactor"]);a!=null&&g(t,["parameters","upscaleConfig","upscaleFactor"],a);const l=p(e,["config"]);return l!=null&&Gz(l,t),t}function Hz(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>og(a))),g(e,["generatedImages"],s)}return e}function $z(n){const e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);const i=p(n,["encodedVideo"]);i!=null&&g(e,["videoBytes"],qo(i));const s=p(n,["encoding"]);return s!=null&&g(e,["mimeType"],s),e}function Kz(n){const e={},t=p(n,["gcsUri"]);t!=null&&g(e,["uri"],t);const i=p(n,["bytesBase64Encoded"]);i!=null&&g(e,["videoBytes"],qo(i));const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function Yz(n){const e={},t=p(n,["image"]);t!=null&&g(e,["_self"],os(t));const i=p(n,["maskMode"]);return i!=null&&g(e,["maskMode"],i),e}function Jz(n){const e={},t=p(n,["image"]);t!=null&&g(e,["image"],ag(t));const i=p(n,["referenceType"]);return i!=null&&g(e,["referenceType"],i),e}function Qz(n){const e={},t=p(n,["image"]);t!=null&&g(e,["image"],os(t));const i=p(n,["referenceType"]);return i!=null&&g(e,["referenceType"],i),e}function wD(n){const e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);const i=p(n,["videoBytes"]);i!=null&&g(e,["encodedVideo"],qo(i));const s=p(n,["mimeType"]);return s!=null&&g(e,["encoding"],s),e}function bD(n){const e={},t=p(n,["uri"]);t!=null&&g(e,["gcsUri"],t);const i=p(n,["videoBytes"]);i!=null&&g(e,["bytesBase64Encoded"],qo(i));const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wz(n,e){const t={},i=p(n,["displayName"]);return e!==void 0&&i!=null&&g(e,["displayName"],i),t}function Xz(n){const e={},t=p(n,["config"]);return t!=null&&Wz(t,e),e}function Zz(n,e){const t={},i=p(n,["force"]);return e!==void 0&&i!=null&&g(e,["_query","force"],i),t}function e8(n){const e={},t=p(n,["name"]);t!=null&&g(e,["_url","name"],t);const i=p(n,["config"]);return i!=null&&Zz(i,e),e}function t8(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function n8(n,e){const t={},i=p(n,["customMetadata"]);if(e!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["customMetadata"],a)}const s=p(n,["chunkingConfig"]);return e!==void 0&&s!=null&&g(e,["chunkingConfig"],s),t}function i8(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);const s=p(n,["done"]);s!=null&&g(e,["done"],s);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response"]);return l!=null&&g(e,["response"],r8(l)),e}function s8(n){const e={},t=p(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);const i=p(n,["fileName"]);i!=null&&g(e,["fileName"],i);const s=p(n,["config"]);return s!=null&&n8(s,e),e}function r8(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["parent"]);i!=null&&g(e,["parent"],i);const s=p(n,["documentName"]);return s!=null&&g(e,["documentName"],s),e}function o8(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const s=p(n,["pageToken"]);return e!==void 0&&s!=null&&g(e,["_query","pageToken"],s),t}function a8(n){const e={},t=p(n,["config"]);return t!=null&&o8(t,e),e}function l8(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const s=p(n,["fileSearchStores"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["fileSearchStores"],a)}return e}function ID(n,e){const t={},i=p(n,["mimeType"]);e!==void 0&&i!=null&&g(e,["mimeType"],i);const s=p(n,["displayName"]);e!==void 0&&s!=null&&g(e,["displayName"],s);const a=p(n,["customMetadata"]);if(e!==void 0&&a!=null){let u=a;Array.isArray(u)&&(u=u.map(h=>h)),g(e,["customMetadata"],u)}const l=p(n,["chunkingConfig"]);return e!==void 0&&l!=null&&g(e,["chunkingConfig"],l),t}function c8(n){const e={},t=p(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);const i=p(n,["config"]);return i!=null&&ID(i,e),e}function u8(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const d8="Content-Type",h8="X-Server-Timeout",f8="User-Agent",Ov="x-goog-api-client",m8="1.32.0",p8=`google-genai-sdk/${m8}`,g8="v1beta1",y8="v1beta";class _8{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:g8,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:y8,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const s=[this.getRequestUrlInternal(t)];return i&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[l,u]of Object.entries(e.queryParams))s.searchParams.append(l,String(u));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,s.toString(),e.abortSignal),this.unaryApiCall(s,a,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[s,a]of Object.entries(t))typeof a=="object"?i[s]=Object.assign(Object.assign({},i[s]),a):a!==void 0&&(i[s]=a);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,s.toString(),e.abortSignal),this.streamApiCall(s,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,s){if(t&&t.timeout||s){const a=new AbortController,l=a.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const u=setTimeout(()=>a.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}s&&s.addEventListener("abort",()=>{a.abort()}),e.signal=l}return t&&t.extraBody!==null&&v8(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await uN(s),new Mv(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await uN(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return dc(this,arguments,function*(){var i;const s=(i=e==null?void 0:e.body)===null||i===void 0?void 0:i.getReader(),a=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let l="";const u="data:",h=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:m,value:_}=yield At(s.read());if(m){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const T=a.decode(_,{stream:!0});try{const k=JSON.parse(T);if("error"in k){const V=JSON.parse(JSON.stringify(k.error)),O=V.status,j=V.code,W=`got status: ${O}. ${JSON.stringify(k)}`;if(j>=400&&j<600)throw new sg({message:W,status:j})}}catch(k){if(k.name==="ApiError")throw k}l+=T;let E=-1,S=0;for(;;){E=-1,S=0;for(const O of h){const j=l.indexOf(O);j!==-1&&(E===-1||j<E)&&(E=j,S=O.length)}if(E===-1)break;const k=l.substring(0,E);l=l.substring(E+S);const V=k.trim();if(V.startsWith(u)){const O=V.substring(u.length).trim();try{const j=new Response(O,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield At(new Mv(j))}catch(j){throw new Error(`exception parsing stream chunk ${O}. ${j}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=p8+" "+this.clientOptions.userAgentExtra;return e[f8]=t,e[Ov]=t,e[d8]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[s,a]of Object.entries(e.headers))i.append(s,a);e.timeout&&e.timeout>0&&i.append(h8,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const a=this.clientOptions.uploader,l=await a.stat(e);s.sizeBytes=String(l.size);const u=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=u;const h={file:s},m=this.getFileName(e),_=Ee("upload/v1beta/files",h._url),T=await this.fetchUploadUrl(_,s.sizeBytes,s.mimeType,m,h,t==null?void 0:t.httpOptions);return a.upload(e,T,this)}async uploadFileToFileSearchStore(e,t,i){var s;const a=this.clientOptions.uploader,l=await a.stat(t),u=String(l.size),h=(s=i==null?void 0:i.mimeType)!==null&&s!==void 0?s:l.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const m=`upload/v1beta/${e}:uploadToFileSearchStore`,_=this.getFileName(t),T={};i!=null&&ID(i,T);const E=await this.fetchUploadUrl(m,u,h,_,T,i==null?void 0:i.httpOptions);return a.uploadToFileSearchStore(t,E,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,s,a,l){var u;let h={};l?h=l:h={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},s?{"X-Goog-Upload-File-Name":s}:{})};const m=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:h});if(!m||!(m!=null&&m.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const _=(u=m==null?void 0:m.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(_===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return _}}async function uN(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const s=JSON.stringify(i);throw t>=400&&t<600?new sg({message:s,status:t}):new Error(s)}}function v8(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const a=JSON.parse(n.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(a,l){const u=Object.assign({},a);for(const h in l)if(Object.prototype.hasOwnProperty.call(l,h)){const m=l[h],_=u[h];m&&typeof m=="object"&&!Array.isArray(m)&&_&&typeof _=="object"&&!Array.isArray(_)?u[h]=i(_,m):(_&&m&&typeof _!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${h}". Original type: ${typeof _}, New type: ${typeof m}. Overwriting.`),u[h]=m)}return u}const s=i(t,e);n.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const T8="mcp_used/unknown";let x8=!1;function SD(n){for(const e of n)if(E8(e)||typeof e=="object"&&"inputSchema"in e)return!0;return x8}function AD(n){var e;const t=(e=n[Ov])!==null&&e!==void 0?e:"";n[Ov]=(t+` ${T8}`).trimStart()}function E8(n){return n!==null&&typeof n=="object"&&n instanceof jT}function w8(n){return dc(this,arguments,function*(t,i=100){let s,a=0;for(;a<i;){const l=yield At(t.listTools({cursor:s}));for(const u of l.tools)yield yield At(u),a++;if(!l.nextCursor)break;s=l.nextCursor}})}class jT{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new jT(e,t)}async initialize(){var e,t,i,s;if(this.mcpTools.length>0)return;const a={},l=[];for(const _ of this.mcpClients)try{for(var u=!0,h=(t=void 0,Ud(w8(_))),m;m=await h.next(),e=m.done,!e;u=!0){s=m.value,u=!1;const T=s;l.push(T);const E=T.name;if(a[E])throw new Error(`Duplicate function name ${E} found in MCP tools. Please ensure function names are unique.`);a[E]=_}}catch(T){t={error:T}}finally{try{!u&&!e&&(i=h.return)&&await i.call(h)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),tB(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[i.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const l=await s.callTool({name:i.name,arguments:i.args},void 0,a);t.push({functionResponse:{name:i.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function b8(n,e,t){const i=new Kj;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(i,s),e(i)}class I8{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=N8(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),h=`${s}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${u}`;let m=()=>{};const _=new Promise($=>{m=$}),T=e.callbacks,E=function(){m({})},S=this.apiClient,k={onopen:E,onmessage:$=>{b8(S,T.onmessage,$)},onerror:(t=T==null?void 0:T.onerror)!==null&&t!==void 0?t:function($){},onclose:(i=T==null?void 0:T.onclose)!==null&&i!==void 0?i:function($){}},V=this.webSocketFactory.create(h,A8(l),k);V.connect(),await _;const W={setup:{model:lt(this.apiClient,e.model)}};return V.send(JSON.stringify(W)),new S8(V,this.apiClient)}}class S8{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=XG(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=WG(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(ic.PLAY)}pause(){this.sendPlaybackControl(ic.PAUSE)}stop(){this.sendPlaybackControl(ic.STOP)}resetContext(){this.sendPlaybackControl(ic.RESET_CONTEXT)}close(){this.conn.close()}}function A8(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function N8(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const C8="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function R8(n,e,t){const i=new $j;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const a=JSON.parse(s);if(n.isVertexAI()){const l=t9(a);Object.assign(i,l)}else Object.assign(i,a);e(i)}class P8{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new I8(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,s,a,l,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion();let _;const T=this.apiClient.getHeaders();e.config&&e.config.tools&&SD(e.config.tools)&&AD(T);const E=V8(T);if(this.apiClient.isVertexAI())_=`${h}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(E,_);else{const C=this.apiClient.getApiKey();let M="BidiGenerateContent",L="key";C!=null&&C.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),m!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),M="BidiGenerateContentConstrained",L="access_token"),_=`${h}/ws/google.ai.generativelanguage.${m}.GenerativeService.${M}?${L}=${C}`}let S=()=>{};const k=new Promise(C=>{S=C}),V=e.callbacks,O=function(){var C;(C=V==null?void 0:V.onopen)===null||C===void 0||C.call(V),S({})},j=this.apiClient,W={onopen:O,onmessage:C=>{R8(j,V.onmessage,C)},onerror:(t=V==null?void 0:V.onerror)!==null&&t!==void 0?t:function(C){},onclose:(i=V==null?void 0:V.onclose)!==null&&i!==void 0?i:function(C){}},$=this.webSocketFactory.create(_,k8(E),W);$.connect(),await k;let U=lt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&U.startsWith("publishers/")){const C=this.apiClient.getProject(),M=this.apiClient.getLocation();U=`projects/${C}/locations/${M}/`+U}let K={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[up.AUDIO]}:e.config.responseModalities=[up.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const J=(u=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],R=[];for(const C of J)if(this.isCallableTool(C)){const M=C;R.push(await M.tool())}else R.push(C);R.length>0&&(e.config.tools=R);const A={model:U,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?K=QG(this.apiClient,A):K=JG(this.apiClient,A),delete K.config,$.send(JSON.stringify(K)),new M8($,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const D8={turnComplete:!0};class M8{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Fi(t.turns),e.isVertexAI()||(i=i.map(s=>rg(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const a of i){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(C8)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},D8),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:e9(e)}:t={realtimeInput:ZG(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function k8(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function V8(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dN=10;function hN(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const l of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(hc(l)){s=!0;break}if(!s)return!0;const a=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function hc(n){return"callTool"in n&&typeof n.callTool=="function"}function L8(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>hc(s)))!==null&&i!==void 0?i:!1}function fN(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,s)=>{if(hc(i))return;const a=i;a.functionDeclarations&&a.functionDeclarations.length>0&&t.push(s)}),t}function mN(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class U8 extends Ir{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,s,a,l,u;const h=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!L8(t)||hN(t.config))return await this.generateContentInternal(h);const m=fN(t);if(m.length>0){const V=m.map(O=>`tools[${O}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${V}.`)}let _,T;const E=Fi(h.contents),S=(a=(s=(i=h.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&a!==void 0?a:dN;let k=0;for(;k<S&&(_=await this.generateContentInternal(h),!(!_.functionCalls||_.functionCalls.length===0));){const V=_.candidates[0].content,O=[];for(const j of(u=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(hc(j)){const $=await j.callTool(_.functionCalls);O.push(...$)}k++,T={role:"user",parts:O},h.contents=Fi(h.contents),h.contents.push(V),h.contents.push(T),mN(h.config)&&(E.push(V),E.push(T))}return mN(h.config)&&(_.automaticFunctionCallingHistory=E),_},this.generateContentStream=async t=>{var i,s,a,l,u;if(this.maybeMoveToResponseJsonSchem(t),hN(t.config)){const T=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(T)}const h=fN(t);if(h.length>0){const T=h.map(E=>`tools[${E}]`).join(", ");throw new Error(`Incompatible tools found at ${T}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const m=(a=(s=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,_=(u=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(m&&!_)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var s;let a;const l=[];if(i!=null&&i.generatedImages)for(const h of i.generatedImages)h&&(h!=null&&h.safetyAttributes)&&((s=h==null?void 0:h.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?a=h==null?void 0:h.safetyAttributes:l.push(h);let u;return a?u={generatedImages:l,positivePromptSafetyAttributes:a,sdkHttpResponse:i.sdkHttpResponse}:u={generatedImages:l,sdkHttpResponse:i.sdkHttpResponse},u}),this.list=async t=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new nl(yr.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var i,s,a,l,u,h;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(a=t.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.uri&&(!((h=(u=t.source)===null||u===void 0?void 0:u.video)===null||h===void 0)&&h.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,s;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const l=await Promise.all(a.map(async h=>hc(h)?await h.tool():h)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(u.config.tools=l,e.config&&e.config.tools&&SD(e.config.tools)){const h=(s=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&s!==void 0?s:{};let m=Object.assign({},h);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),AD(m),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:m})}return u}async initAfcToolsMap(e){var t,i,s;const a=new Map;for(const l of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(hc(l)){const u=l,h=await u.tool();for(const m of(s=h.functionDeclarations)!==null&&s!==void 0?s:[]){if(!m.name)throw new Error("Function declaration name is required.");if(a.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);a.set(m.name,u)}}return a}async processAfcStream(e){var t,i,s;const a=(s=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:dN;let l=!1,u=0;const h=await this.initAfcToolsMap(e);return(function(m,_,T){return dc(this,arguments,function*(){for(var E,S,k,V,O,j;u<a;){l&&(u++,l=!1);const K=yield At(m.processParamsMaybeAddMcpUsage(T)),J=yield At(m.generateContentStreamInternal(K)),R=[],A=[];try{for(var W=!0,$=(S=void 0,Ud(J)),U;U=yield At($.next()),E=U.done,!E;W=!0){V=U.value,W=!1;const C=V;if(yield yield At(C),C.candidates&&(!((O=C.candidates[0])===null||O===void 0)&&O.content)){A.push(C.candidates[0].content);for(const M of(j=C.candidates[0].content.parts)!==null&&j!==void 0?j:[])if(u<a&&M.functionCall){if(!M.functionCall.name)throw new Error("Function call name was not returned by the model.");if(_.has(M.functionCall.name)){const L=yield At(_.get(M.functionCall.name).callTool([M.functionCall]));R.push(...L)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${_.keys()}, mising tool: ${M.functionCall.name}`)}}}}catch(C){S={error:C}}finally{try{!W&&!E&&(k=$.return)&&(yield At(k.call($)))}finally{if(S)throw S.error}}if(R.length>0){l=!0;const C=new hd;C.candidates=[{content:{role:"user",parts:R}}],yield yield At(C);const M=[];M.push(...A),M.push({role:"user",parts:R});const L=Fi(T.contents).concat(M);T.contents=L}else break}})})(this,h,e)}async generateContentInternal(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=aN(this.apiClient,e);return u=Ee("{model}:generateContent",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=cN(_),E=new hd;return Object.assign(E,T),E})}else{const m=oN(this.apiClient,e);return u=Ee("{model}:generateContent",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=lN(_),E=new hd;return Object.assign(E,T),E})}}async generateContentStreamInternal(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=aN(this.apiClient,e);return u=Ee("{model}:streamGenerateContent?alt=sse",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.requestStream({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(T){return dc(this,arguments,function*(){var E,S,k,V;try{for(var O=!0,j=Ud(T),W;W=yield At(j.next()),E=W.done,!E;O=!0){V=W.value,O=!1;const $=V,U=cN(yield At($.json()));U.sdkHttpResponse={headers:$.headers};const K=new hd;Object.assign(K,U),yield yield At(K)}}catch($){S={error:$}}finally{try{!O&&!E&&(k=j.return)&&(yield At(k.call(j)))}finally{if(S)throw S.error}}})})}else{const m=oN(this.apiClient,e);return u=Ee("{model}:streamGenerateContent?alt=sse",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.requestStream({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(T){return dc(this,arguments,function*(){var E,S,k,V;try{for(var O=!0,j=Ud(T),W;W=yield At(j.next()),E=W.done,!E;O=!0){V=W.value,O=!1;const $=V,U=lN(yield At($.json()));U.sdkHttpResponse={headers:$.headers};const K=new hd;Object.assign(K,U),yield yield At(K)}}catch($){S={error:$}}finally{try{!O&&!E&&(k=j.return)&&(yield At(k.call(j)))}finally{if(S)throw S.error}}})})}}async embedContent(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=P9(this.apiClient,e);return u=Ee("{model}:predict",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=M9(_),E=new GA;return Object.assign(E,T),E})}else{const m=R9(this.apiClient,e);return u=Ee("{model}:batchEmbedContents",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=D9(_),E=new GA;return Object.assign(E,T),E})}}async generateImagesInternal(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=z9(this.apiClient,e);return u=Ee("{model}:predict",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=$9(_),E=new zA;return Object.assign(E,T),E})}else{const m=G9(this.apiClient,e);return u=Ee("{model}:predict",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=H9(_),E=new zA;return Object.assign(E,T),E})}}async editImageInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=S9(this.apiClient,e);return a=Ee("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{const m=A9(h),_=new Vj;return Object.assign(_,m),_})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=zz(this.apiClient,e);return a=Ee("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{const m=Hz(h),_=new Lj;return Object.assign(_,m),_})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=Iz(this.apiClient,e);return a=Ee("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const m=Sz(h),_=new Uj;return Object.assign(_,m),_})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=Dz(this.apiClient,e);return a=Ee("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const m=Mz(h),_=new Oj;return Object.assign(_,m),_})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=cz(this.apiClient,e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>Uv(_))}else{const m=lz(this.apiClient,e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Lv(_))}}async listInternal(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=_z(this.apiClient,e);return u=Ee("{models_url}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=Tz(_),E=new HA;return Object.assign(E,T),E})}else{const m=yz(this.apiClient,e);return u=Ee("{models_url}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=vz(_),E=new HA;return Object.assign(E,T),E})}}async update(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=Bz(this.apiClient,e);return u=Ee("{model}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>Uv(_))}else{const m=jz(this.apiClient,e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Lv(_))}}async delete(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=E9(this.apiClient,e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=b9(_),E=new $A;return Object.assign(E,T),E})}else{const m=x9(this.apiClient,e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=w9(_),E=new $A;return Object.assign(E,T),E})}}async countTokens(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=_9(this.apiClient,e);return u=Ee("{model}:countTokens",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=T9(_),E=new KA;return Object.assign(E,T),E})}else{const m=y9(this.apiClient,e);return u=Ee("{model}:countTokens",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=v9(_),E=new KA;return Object.assign(E,T),E})}}async computeTokens(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=u9(this.apiClient,e);return a=Ee("{model}:computeTokens",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{const m=d9(h),_=new Fj;return Object.assign(_,m),_})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=X9(this.apiClient,e);return u=Ee("{model}:predictLongRunning",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>{const T=Q9(_),E=new dp;return Object.assign(E,T),E})}else{const m=W9(this.apiClient,e);return u=Ee("{model}:predictLongRunning",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>{const T=J9(_),E=new dp;return Object.assign(E,T),E})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class O8 extends Ir{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=Cj(e);return u=Ee("{operationName}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l}else{const m=Nj(e);return u=Ee("{operationName}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l}}async fetchPredictVideosOperationInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=xj(e);return a=Ee("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function F8(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function q8(n){const e={},t=p(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>J8(a))),g(e,["parts"],s)}const i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function j8(n,e,t){const i={},s=p(e,["expireTime"]);t!==void 0&&s!=null&&g(t,["expireTime"],s);const a=p(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&g(t,["newSessionExpireTime"],a);const l=p(e,["uses"]);t!==void 0&&l!=null&&g(t,["uses"],l);const u=p(e,["liveConnectConstraints"]);t!==void 0&&u!=null&&g(t,["bidiGenerateContentSetup"],Y8(n,u));const h=p(e,["lockAdditionalFields"]);return t!==void 0&&h!=null&&g(t,["fieldMask"],h),i}function B8(n,e){const t={},i=p(e,["config"]);return i!=null&&g(t,["config"],j8(n,i,t)),t}function G8(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function z8(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const i=p(n,["args"]);i!=null&&g(e,["args"],i);const s=p(n,["name"]);if(s!=null&&g(e,["name"],s),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function H8(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function $8(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function K8(n,e){const t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],i);const s=p(n,["responseModalities"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig","responseModalities"],s);const a=p(n,["temperature"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","temperature"],a);const l=p(n,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);const h=p(n,["maxOutputTokens"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","maxOutputTokens"],h);const m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);const _=p(n,["seed"]);e!==void 0&&_!=null&&g(e,["setup","generationConfig","seed"],_);const T=p(n,["speechConfig"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","speechConfig"],qT(T));const E=p(n,["thinkingConfig"]);e!==void 0&&E!=null&&g(e,["setup","generationConfig","thinkingConfig"],E);const S=p(n,["enableAffectiveDialog"]);e!==void 0&&S!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],S);const k=p(n,["systemInstruction"]);e!==void 0&&k!=null&&g(e,["setup","systemInstruction"],q8(On(k)));const V=p(n,["tools"]);if(e!==void 0&&V!=null){let J=Wc(V);Array.isArray(J)&&(J=J.map(R=>W8(Qc(R)))),g(e,["setup","tools"],J)}const O=p(n,["sessionResumption"]);e!==void 0&&O!=null&&g(e,["setup","sessionResumption"],Q8(O));const j=p(n,["inputAudioTranscription"]);e!==void 0&&j!=null&&g(e,["setup","inputAudioTranscription"],j);const W=p(n,["outputAudioTranscription"]);e!==void 0&&W!=null&&g(e,["setup","outputAudioTranscription"],W);const $=p(n,["realtimeInputConfig"]);e!==void 0&&$!=null&&g(e,["setup","realtimeInputConfig"],$);const U=p(n,["contextWindowCompression"]);e!==void 0&&U!=null&&g(e,["setup","contextWindowCompression"],U);const K=p(n,["proactivity"]);return e!==void 0&&K!=null&&g(e,["setup","proactivity"],K),t}function Y8(n,e){const t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],lt(n,i));const s=p(e,["config"]);return s!=null&&g(t,["config"],K8(s,t)),t}function J8(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const s=p(n,["executableCode"]);s!=null&&g(e,["executableCode"],s);const a=p(n,["fileData"]);a!=null&&g(e,["fileData"],G8(a));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],z8(l));const u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);const h=p(n,["inlineData"]);h!=null&&g(e,["inlineData"],F8(h));const m=p(n,["text"]);m!=null&&g(e,["text"],m);const _=p(n,["thought"]);_!=null&&g(e,["thought"],_);const T=p(n,["thoughtSignature"]);T!=null&&g(e,["thoughtSignature"],T);const E=p(n,["videoMetadata"]);return E!=null&&g(e,["videoMetadata"],E),e}function Q8(n){const e={},t=p(n,["handle"]);if(t!=null&&g(e,["handle"],t),p(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function W8(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(T=>T)),g(e,["functionDeclarations"],_)}if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=p(n,["googleSearchRetrieval"]);i!=null&&g(e,["googleSearchRetrieval"],i);const s=p(n,["computerUse"]);s!=null&&g(e,["computerUse"],s);const a=p(n,["fileSearch"]);a!=null&&g(e,["fileSearch"],a);const l=p(n,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],H8(u));const h=p(n,["googleSearch"]);h!=null&&g(e,["googleSearch"],$8(h));const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function X8(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const s=Object.keys(i).map(a=>`${t}.${a}`);e.push(...s)}else e.push(t)}return e.join(",")}function Z8(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const a=i.setup;typeof a=="object"&&a!==null?(n.bidiGenerateContentSetup=a,t=a):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const s=n.fieldMask;if(t){const a=X8(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?n.fieldMask=a:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];s.length>0&&(u=s.map(m=>l.includes(m)?`generationConfig.${m}`:m));const h=[];a&&h.push(a),u.length>0&&h.push(...u),h.length>0?n.fieldMask=h.join(","):delete n.fieldMask}else delete n.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?n.fieldMask=s.join(","):delete n.fieldMask;return n}class eH extends Ir{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=B8(this.apiClient,e);a=Ee("auth_tokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query;const h=Z8(u,e.config);return s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),s.then(m=>m)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tH(n,e){const t={},i=p(n,["force"]);return e!==void 0&&i!=null&&g(e,["_query","force"],i),t}function nH(n){const e={},t=p(n,["name"]);t!=null&&g(e,["_url","name"],t);const i=p(n,["config"]);return i!=null&&tH(i,e),e}function iH(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function sH(n,e){const t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const s=p(n,["pageToken"]);return e!==void 0&&s!=null&&g(e,["_query","pageToken"],s),t}function rH(n){const e={},t=p(n,["parent"]);t!=null&&g(e,["_url","parent"],t);const i=p(n,["config"]);return i!=null&&sH(i,e),e}function oH(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const s=p(n,["documents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aH extends Ir{constructor(e){super(),this.apiClient=e,this.list=async t=>new nl(yr.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=iH(e);return a=Ee("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,i;let s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=nH(e);s=Ee("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=rH(e);return a=Ee("{parent}/documents",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const m=oH(h),_=new qj;return Object.assign(_,m),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lH extends Ir{constructor(e,t=new aH(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new nl(yr.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Xz(e);return a=Ee("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async get(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=t8(e);return a=Ee("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,i;let s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=e8(e);s=Ee("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=a8(e);return a=Ee("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const m=l8(h),_=new jj;return Object.assign(_,m),_})}}async uploadToFileSearchStoreInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=c8(e);return a=Ee("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const m=u8(h),_=new Bj;return Object.assign(_,m),_})}}async importFile(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=s8(e);return a=Ee("{file_search_store_name}:importFile",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const m=i8(h),_=new VT;return Object.assign(_,m),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cH(n,e){const t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function uH(n,e){const t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function dH(n,e){const t={},i=p(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function hH(n,e){const t={},i=p(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function fH(n,e,t){const i={};if(p(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=p(n,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&g(e,["displayName"],s),p(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=p(n,["epochCount"]);e!==void 0&&a!=null&&g(e,["tuningTask","hyperparameters","epochCount"],a);const l=p(n,["learningRateMultiplier"]);if(l!=null&&g(i,["tuningTask","hyperparameters","learningRateMultiplier"],l),p(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(p(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(p(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=p(n,["batchSize"]);e!==void 0&&u!=null&&g(e,["tuningTask","hyperparameters","batchSize"],u);const h=p(n,["learningRate"]);if(e!==void 0&&h!=null&&g(e,["tuningTask","hyperparameters","learningRate"],h),p(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(p(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function mH(n,e,t){const i={};let s=p(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const S=p(n,["validationDataset"]);e!==void 0&&S!=null&&g(e,["supervisedTuningSpec"],pN(S))}else if(s==="PREFERENCE_TUNING"){const S=p(n,["validationDataset"]);e!==void 0&&S!=null&&g(e,["preferenceOptimizationSpec"],pN(S))}const a=p(n,["tunedModelDisplayName"]);e!==void 0&&a!=null&&g(e,["tunedModelDisplayName"],a);const l=p(n,["description"]);e!==void 0&&l!=null&&g(e,["description"],l);let u=p(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const S=p(n,["epochCount"]);e!==void 0&&S!=null&&g(e,["supervisedTuningSpec","hyperParameters","epochCount"],S)}else if(u==="PREFERENCE_TUNING"){const S=p(n,["epochCount"]);e!==void 0&&S!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],S)}let h=p(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const S=p(n,["learningRateMultiplier"]);e!==void 0&&S!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],S)}else if(h==="PREFERENCE_TUNING"){const S=p(n,["learningRateMultiplier"]);e!==void 0&&S!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],S)}let m=p(t,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const S=p(n,["exportLastCheckpointOnly"]);e!==void 0&&S!=null&&g(e,["supervisedTuningSpec","exportLastCheckpointOnly"],S)}else if(m==="PREFERENCE_TUNING"){const S=p(n,["exportLastCheckpointOnly"]);e!==void 0&&S!=null&&g(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],S)}let _=p(t,["config","method"]);if(_===void 0&&(_="SUPERVISED_FINE_TUNING"),_==="SUPERVISED_FINE_TUNING"){const S=p(n,["adapterSize"]);e!==void 0&&S!=null&&g(e,["supervisedTuningSpec","hyperParameters","adapterSize"],S)}else if(_==="PREFERENCE_TUNING"){const S=p(n,["adapterSize"]);e!==void 0&&S!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],S)}if(p(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(p(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const T=p(n,["labels"]);e!==void 0&&T!=null&&g(e,["labels"],T);const E=p(n,["beta"]);return e!==void 0&&E!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","beta"],E),i}function pH(n,e){const t={},i=p(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);const s=p(n,["preTunedModel"]);s!=null&&g(t,["preTunedModel"],s);const a=p(n,["trainingDataset"]);a!=null&&SH(a);const l=p(n,["config"]);return l!=null&&fH(l,t),t}function gH(n,e){const t={},i=p(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);const s=p(n,["preTunedModel"]);s!=null&&g(t,["preTunedModel"],s);const a=p(n,["trainingDataset"]);a!=null&&AH(a,t,e);const l=p(n,["config"]);return l!=null&&mH(l,t,e),t}function yH(n,e){const t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function _H(n,e){const t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function vH(n,e,t){const i={},s=p(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const a=p(n,["pageToken"]);e!==void 0&&a!=null&&g(e,["_query","pageToken"],a);const l=p(n,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),i}function TH(n,e,t){const i={},s=p(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const a=p(n,["pageToken"]);e!==void 0&&a!=null&&g(e,["_query","pageToken"],a);const l=p(n,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),i}function xH(n,e){const t={},i=p(n,["config"]);return i!=null&&vH(i,t),t}function EH(n,e){const t={},i=p(n,["config"]);return i!=null&&TH(i,t),t}function wH(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const s=p(n,["nextPageToken"]);s!=null&&g(t,["nextPageToken"],s);const a=p(n,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>ND(u))),g(t,["tuningJobs"],l)}return t}function bH(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const s=p(n,["nextPageToken"]);s!=null&&g(t,["nextPageToken"],s);const a=p(n,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>Fv(u))),g(t,["tuningJobs"],l)}return t}function IH(n,e){const t={},i=p(n,["name"]);i!=null&&g(t,["model"],i);const s=p(n,["name"]);return s!=null&&g(t,["endpoint"],s),t}function SH(n,e){const t={};if(p(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=p(n,["examples"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),g(t,["examples","examples"],s)}return t}function AH(n,e,t){const i={};let s=p(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=p(n,["gcsUri"]);e!==void 0&&l!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=p(n,["gcsUri"]);e!==void 0&&l!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let a=p(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=p(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=p(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(p(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function ND(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const s=p(n,["name"]);s!=null&&g(t,["name"],s);const a=p(n,["state"]);a!=null&&g(t,["state"],lD(a));const l=p(n,["createTime"]);l!=null&&g(t,["createTime"],l);const u=p(n,["tuningTask","startTime"]);u!=null&&g(t,["startTime"],u);const h=p(n,["tuningTask","completeTime"]);h!=null&&g(t,["endTime"],h);const m=p(n,["updateTime"]);m!=null&&g(t,["updateTime"],m);const _=p(n,["description"]);_!=null&&g(t,["description"],_);const T=p(n,["baseModel"]);T!=null&&g(t,["baseModel"],T);const E=p(n,["_self"]);return E!=null&&g(t,["tunedModel"],IH(E)),t}function Fv(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const s=p(n,["name"]);s!=null&&g(t,["name"],s);const a=p(n,["state"]);a!=null&&g(t,["state"],lD(a));const l=p(n,["createTime"]);l!=null&&g(t,["createTime"],l);const u=p(n,["startTime"]);u!=null&&g(t,["startTime"],u);const h=p(n,["endTime"]);h!=null&&g(t,["endTime"],h);const m=p(n,["updateTime"]);m!=null&&g(t,["updateTime"],m);const _=p(n,["error"]);_!=null&&g(t,["error"],_);const T=p(n,["description"]);T!=null&&g(t,["description"],T);const E=p(n,["baseModel"]);E!=null&&g(t,["baseModel"],E);const S=p(n,["tunedModel"]);S!=null&&g(t,["tunedModel"],S);const k=p(n,["preTunedModel"]);k!=null&&g(t,["preTunedModel"],k);const V=p(n,["supervisedTuningSpec"]);V!=null&&g(t,["supervisedTuningSpec"],V);const O=p(n,["preferenceOptimizationSpec"]);O!=null&&g(t,["preferenceOptimizationSpec"],O);const j=p(n,["tuningDataStats"]);j!=null&&g(t,["tuningDataStats"],j);const W=p(n,["encryptionSpec"]);W!=null&&g(t,["encryptionSpec"],W);const $=p(n,["partnerModelTuningSpec"]);$!=null&&g(t,["partnerModelTuningSpec"],$);const U=p(n,["customBaseModel"]);U!=null&&g(t,["customBaseModel"],U);const K=p(n,["experiment"]);K!=null&&g(t,["experiment"],K);const J=p(n,["labels"]);J!=null&&g(t,["labels"],J);const R=p(n,["outputUri"]);R!=null&&g(t,["outputUri"],R);const A=p(n,["pipelineJob"]);A!=null&&g(t,["pipelineJob"],A);const C=p(n,["serviceAccount"]);C!=null&&g(t,["serviceAccount"],C);const M=p(n,["tunedModelDisplayName"]);M!=null&&g(t,["tunedModelDisplayName"],M);const L=p(n,["veoTuningSpec"]);return L!=null&&g(t,["veoTuningSpec"],L),t}function NH(n,e){const t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const s=p(n,["name"]);s!=null&&g(t,["name"],s);const a=p(n,["metadata"]);a!=null&&g(t,["metadata"],a);const l=p(n,["done"]);l!=null&&g(t,["done"],l);const u=p(n,["error"]);return u!=null&&g(t,["error"],u),t}function pN(n,e){const t={},i=p(n,["gcsUri"]);i!=null&&g(t,["validationDatasetUri"],i);const s=p(n,["vertexDatasetResource"]);return s!=null&&g(t,["validationDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CH extends Ir{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new nl(yr.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},t),{preTunedModel:s});return a.baseModel=void 0,await this.tuneInternal(a)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),a=await this.tuneMldevInternal(s);let l="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?l=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(l=a.name.split("/operations/")[0]),{name:l,state:Dv.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=_H(e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>Fv(_))}else{const m=yH(e);return u=Ee("{name}",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>ND(_))}}async listInternal(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=EH(e);return u=Ee("tuningJobs",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=bH(_),E=new YA;return Object.assign(E,T),E})}else{const m=xH(e);return u=Ee("tunedModels",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=wH(_),E=new YA;return Object.assign(E,T),E})}}async cancel(e){var t,i,s,a;let l,u="",h={};if(this.apiClient.isVertexAI()){const m=uH(e);return u=Ee("{name}:cancel",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=hH(_),E=new JA;return Object.assign(E,T),E})}else{const m=cH(e);return u=Ee("{name}:cancel",m._url),h=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=dH(_),E=new JA;return Object.assign(E,T),E})}}async tuneInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=gH(e,e);return a=Ee("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>Fv(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=pH(e);return a=Ee("tunedModels",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>NH(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RH{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const PH=1024*1024*8,DH=3,MH=1e3,kH=2,fp="x-goog-upload-status";async function VH(n,e,t){var i;const s=await CD(n,e,t),a=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[fp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function LH(n,e,t){var i;const s=await CD(n,e,t),a=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[fp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=nD(a),u=new LT;return Object.assign(u,l),u}async function CD(n,e,t){var i,s;let a=0,l=0,u=new Mv(new Response),h="upload";for(a=n.size;l<a;){const m=Math.min(PH,a-l),_=n.slice(l,l+m);l+m>=a&&(h+=", finalize");let T=0,E=MH;for(;T<DH&&(u=await t.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(l),"Content-Length":String(m)}}}),!(!((i=u==null?void 0:u.headers)===null||i===void 0)&&i[fp]));)T++,await OH(E),E=E*kH;if(l+=m,((s=u==null?void 0:u.headers)===null||s===void 0?void 0:s[fp])!=="active")break;if(a<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function UH(n){return{size:n.size,type:n.type}}function OH(n){return new Promise(e=>setTimeout(e,n))}class FH{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await VH(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await LH(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await UH(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qH{create(e,t,i){return new jH(e,t,i)}}class jH{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gN="x-goog-api-key";class BH{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(gN)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(gN,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GH="gl-node/";class zH{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=vj(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new BH(this.apiKey);this.apiClient=new _8({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:GH+"web",uploader:new FH,downloader:new RH}),this.models=new U8(this.apiClient),this.live=new P8(this.apiClient,s,new qH),this.batches=new YB(this.apiClient),this.chats=new CG(this.models,this.apiClient),this.caches=new SG(this.apiClient),this.files=new FG(this.apiClient),this.operations=new O8(this.apiClient),this.authTokens=new eH(this.apiClient),this.tunings=new CH(this.apiClient),this.fileSearchStores=new lH(this.apiClient)}}/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HH=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$H=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),yN=n=>{const e=$H(n);return e.charAt(0).toUpperCase()+e.slice(1)},RD=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),KH=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var YH={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JH=oe.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:s="",children:a,iconNode:l,...u},h)=>oe.createElement("svg",{ref:h,...YH,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:RD("lucide",s),...!a&&!KH(u)&&{"aria-hidden":"true"},...u},[...l.map(([m,_])=>oe.createElement(m,_)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=(n,e)=>{const t=oe.forwardRef(({className:i,...s},a)=>oe.createElement(JH,{ref:a,iconNode:e,className:RD(`lucide-${HH(yN(n))}`,`lucide-${n}`,i),...s}));return t.displayName=yN(n),t};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QH=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],PD=Ue("activity",QH);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WH=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],XH=Ue("arrow-right",WH);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZH=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],lg=Ue("bell",ZH);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e7=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],t7=Ue("calendar-clock",e7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n7=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],i7=Ue("calendar",n7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s7=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],r7=Ue("chart-column",s7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o7=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],BT=Ue("check",o7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a7=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],l7=Ue("chevron-down",a7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],GT=Ue("circle-alert",c7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ei=Ue("circle-check",u7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],lh=Ue("circle-x",d7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h7=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],f7=Ue("clipboard-list",h7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m7=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],DD=Ue("clock",m7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p7=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],g7=Ue("credit-card",p7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y7=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Lc=Ue("dollar-sign",y7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _7=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],v7=Ue("eye",_7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]],zT=Ue("file-chart-column-increasing",T7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],HT=Ue("file-check",x7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],MD=Ue("file-spreadsheet",E7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],$T=Ue("file-text",w7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b7=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],KT=Ue("flask-conical",b7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],S7=Ue("globe",I7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],YT=Ue("info",A7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N7=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],cg=Ue("layout-dashboard",N7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C7=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],R7=Ue("list",C7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P7=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Qa=Ue("loader-circle",P7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D7=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],M7=Ue("log-out",D7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k7=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],V7=Ue("map-pin",k7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L7=[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]],JT=Ue("microscope",L7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U7=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],ur=Ue("package",U7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O7=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],kD=Ue("phone",O7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F7=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ka=Ue("plus",F7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q7=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],kh=Ue("printer",q7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j7=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],B7=Ue("qr-code",j7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G7=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Od=Ue("search",G7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z7=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_N=Ue("settings",z7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H7=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],QT=Ue("shield",H7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $7=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],K7=Ue("sparkles",$7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y7=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],WT=Ue("syringe",Y7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J7=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ug=Ue("trash-2",J7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q7=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],W7=Ue("trending-up",Q7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X7=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],dg=Ue("triangle-alert",X7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z7=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],Fd=Ue("truck",Z7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e$=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],hg=Ue("user-plus",e$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t$=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],n$=Ue("user",t$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i$=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ch=Ue("users",i$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s$=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],r$=Ue("wallet",s$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o$=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Zc=Ue("x",o$),a$=({toasts:n,onClose:e})=>f.jsx("div",{className:"fixed top-4 right-4 z-[9999] space-y-2",children:n.map(t=>{const i={success:f.jsx(Ei,{className:"w-5 h-5"}),error:f.jsx(lh,{className:"w-5 h-5"}),warning:f.jsx(dg,{className:"w-5 h-5"}),info:f.jsx(YT,{className:"w-5 h-5"})},s={success:"bg-green-50 border-green-200 text-green-800",error:"bg-red-50 border-red-200 text-red-800",warning:"bg-amber-50 border-amber-200 text-amber-800",info:"bg-blue-50 border-blue-200 text-blue-800"};return f.jsxs("div",{className:`${s[t.type]} border rounded-lg shadow-lg p-4 min-w-[300px] max-w-md animate-in slide-in-from-right-5 flex items-start gap-3`,children:[i[t.type],f.jsx("p",{className:"flex-1 text-sm font-medium",children:t.message}),f.jsx("button",{onClick:()=>e(t.id),className:"hover:opacity-70",children:f.jsx(Zc,{className:"w-4 h-4"})})]},t.id)})}),l$=({isOpen:n,type:e,title:t,message:i,onClose:s})=>{if(!n)return null;const l={success:{icon:Ei,color:"text-green-600",bg:"bg-green-50",border:"border-green-200"},error:{icon:lh,color:"text-red-600",bg:"bg-red-50",border:"border-red-200"},warning:{icon:dg,color:"text-amber-600",bg:"bg-amber-50",border:"border-amber-200"},info:{icon:YT,color:"text-blue-600",bg:"bg-blue-50",border:"border-blue-200"}}[e],u=l.icon;return f.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9998] flex items-center justify-center p-4 animate-in fade-in",onClick:s,children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full animate-in zoom-in-95",onClick:h=>h.stopPropagation(),children:[f.jsxs("div",{className:`${l.bg} ${l.border} border-b p-4 rounded-t-xl flex items-center gap-3`,children:[f.jsx(u,{className:`w-6 h-6 ${l.color}`}),f.jsx("h3",{className:"font-bold text-lg text-slate-800",children:t||e.charAt(0).toUpperCase()+e.slice(1)})]}),f.jsx("div",{className:"p-6",children:f.jsx("p",{className:"text-slate-700 leading-relaxed",children:i})}),f.jsx("div",{className:"p-4 bg-slate-50 rounded-b-xl flex justify-end",children:f.jsx("button",{onClick:s,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 transition-colors",children:"OK"})})]})})},c$=({isOpen:n,title:e,message:t,confirmText:i="Confirm",cancelText:s="Cancel",type:a="primary",onConfirm:l,onCancel:u})=>{if(!n)return null;const h={danger:"bg-red-600 hover:bg-red-700",primary:"bg-indigo-600 hover:bg-indigo-700",warning:"bg-amber-600 hover:bg-amber-700"};return f.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9998] flex items-center justify-center p-4 animate-in fade-in",onClick:u,children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full animate-in zoom-in-95",onClick:m=>m.stopPropagation(),children:[f.jsxs("div",{className:"p-6",children:[e&&f.jsx("h3",{className:"font-bold text-xl text-slate-800 mb-4",children:e}),f.jsx("p",{className:"text-slate-700 leading-relaxed",children:t})]}),f.jsxs("div",{className:"p-4 bg-slate-50 rounded-b-xl flex justify-end gap-3",children:[f.jsx("button",{onClick:u,className:"px-6 py-2 text-slate-600 hover:bg-slate-200 rounded-lg font-bold transition-colors",children:s}),f.jsx("button",{onClick:l,className:`px-6 py-2 ${h[a]} text-white rounded-lg font-bold transition-colors`,children:i})]})]})})},u$=({isOpen:n,title:e,message:t,defaultValue:i="",placeholder:s,onConfirm:a,onCancel:l})=>{const[u,h]=oe.useState(i);if(oe.useEffect(()=>{n&&h(i)},[n,i]),!n)return null;const m=()=>{u.trim()&&(a(u),h(""))};return f.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9998] flex items-center justify-center p-4 animate-in fade-in",onClick:l,children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full animate-in zoom-in-95",onClick:_=>_.stopPropagation(),children:[f.jsxs("div",{className:"p-6",children:[e&&f.jsx("h3",{className:"font-bold text-xl text-slate-800 mb-4",children:e}),f.jsx("p",{className:"text-slate-700 leading-relaxed mb-4",children:t}),f.jsx("input",{type:"text",value:u,onChange:_=>h(_.target.value),onKeyDown:_=>_.key==="Enter"&&m(),placeholder:s,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none",autoFocus:!0})]}),f.jsxs("div",{className:"p-4 bg-slate-50 rounded-b-xl flex justify-end gap-3",children:[f.jsx("button",{onClick:l,className:"px-6 py-2 text-slate-600 hover:bg-slate-200 rounded-lg font-bold transition-colors",children:"Cancel"}),f.jsx("button",{onClick:m,disabled:!u.trim(),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"OK"})]})]})})},qv={admin:["dashboard","admin_users","admin_tests","finance","admin_reports","inventory","admin_logs","admin_settings","reception","collection","lab_tech","lab_path"],receptionist:["dashboard","patients","reception"],phlebotomist:["dashboard","patients","collection"],technician:["dashboard","lab_tech"],pathologist:["dashboard","lab_path","patients","admin_reports"],accountant:["dashboard","finance"],inventory_manager:["dashboard","inventory","admin_reports"]},d$=["Test Reagent","Consumable","Equipment","Packaging","PPE","General","Machinery","Electric","Stationary","Furniture","Other"],h$=n=>n==="admin"||n==="inventory_manager",mp=[{id:"admin",label:"System Administrator",icon:QT},{id:"receptionist",label:"Receptionist",icon:ch},{id:"phlebotomist",label:"Sample Collection",icon:WT},{id:"technician",label:"Lab Technologist",icon:JT},{id:"pathologist",label:"Pathologist",icon:HT},{id:"accountant",label:"Finance Manager",icon:Lc},{id:"inventory_manager",label:"Inventory Manager",icon:ur},{id:"doctor",label:"Referring Doctor",icon:hg,disabled:!0,disabledReason:"Portal coming soon"}],f$=[{id:1,text:"System maintenance scheduled for Sunday 2 AM - 4 AM.",type:"warning"},{id:2,text:"New 'Liver Function Panel' added to test catalog.",type:"info"},{id:3,text:"COVID-19 RT-PCR reports now available in 6 hours.",type:"success"}],pp=n=>{if(!n)return 0;const e=new Date(n),t=Date.now()-e.getTime(),i=new Date(t);return Math.abs(i.getUTCFullYear()-1970)},Ln=n=>{if(!n)return"";try{return(n.toDate?n.toDate():n instanceof Date?n:new Date(n)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return""}},m$=n=>{if(!n)return"";try{return(n.toDate?n.toDate():n instanceof Date?n:new Date(n)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return""}},Ia=async(n,e,t,i)=>{try{await Te.collection("audit_logs").add({action:n,module:e,details:t,userId:i.uid||"unknown",userName:i.email||i.username||"System",timestamp:ke.firestore.Timestamp.now()})}catch(s){console.error("Audit log failed",s)}},p$=(n,e)=>{const t=new Date,i=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getFullYear()).slice(-2),l=n?n.slice(-4).toUpperCase():"XXXX";return`${i}${s}${a}-${l}-${e+1}`},xd=(n,e)=>{if(!n.length)return;const t=Object.keys(n[0]),i=[t.join(","),...n.map(l=>t.map(u=>JSON.stringify(l[u],(h,m)=>m===null?"":m)).join(","))].join(`
`),s=new Blob([i],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(s),a.download=e,a.click()},g$=({data:n,color:e="bg-indigo-500"})=>{const t=Math.max(...n.map(s=>s.value))||1,i=160;return f.jsx("div",{className:"flex items-end gap-3 w-full",style:{height:`${i}px`},children:n.map((s,a)=>{const l=Math.max(s.value/t*i,4);return f.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2 group relative",children:[f.jsx("div",{className:"relative w-full flex justify-center items-end flex-1",style:{minHeight:`${i}px`},children:f.jsx("div",{style:{height:`${l}px`},className:`w-full max-w-[50px] ${e} opacity-80 group-hover:opacity-100 transition-all rounded-t relative`,children:f.jsxs("div",{className:"absolute bottom-full mb-2 left-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 bg-slate-800 text-white text-[10px] px-2 py-1 rounded pointer-events-none whitespace-nowrap z-10 transition-opacity",children:["$",s.value.toLocaleString()]})})}),f.jsxs("div",{className:"text-center",children:[f.jsx("span",{className:"text-[10px] text-slate-400 block",children:s.label}),f.jsxs("span",{className:"text-xs font-bold text-slate-700 block mt-0.5",children:["$",(s.value/1e3).toFixed(1),"k"]})]})]},a)})})},y$=({data:n})=>{const e=n.reduce((i,s)=>i+s.value,0)||1;let t=0;return f.jsxs("div",{className:"relative w-32 h-32 mx-auto",children:[f.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full rotate-[-90deg]",children:[n.map((i,s)=>{const a=i.value/e*360,l=50+40*Math.cos(Math.PI*t/180),u=50+40*Math.sin(Math.PI*t/180),h=50+40*Math.cos(Math.PI*(t+a)/180),m=50+40*Math.sin(Math.PI*(t+a)/180),_=a>180?1:0,T=`M 50 50 L ${l} ${u} A 40 40 0 ${_} 1 ${h} ${m} Z`;return t+=a,f.jsx("path",{d:T,fill:i.color,className:"hover:opacity-80 transition-opacity",title:`${i.label}: ${i.value}`},s)}),f.jsx("circle",{cx:"50",cy:"50",r:"25",fill:"white"})]}),f.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:f.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:"Total"})})]})},VD=({isOpen:n,onClose:e,userId:t,userName:i,userRole:s})=>{const{showAlert:a,showConfirm:l,showToast:u}=fg(),[h,m]=oe.useState("new"),[_,T]=oe.useState([]),[E,S]=oe.useState([]),[k,V]=oe.useState(""),[O,j]=oe.useState(1),[W,$]=oe.useState(""),[U,K]=oe.useState(!1);oe.useEffect(()=>{if(!n)return;const A=Te.collection("inventory_items").where("status","!=","out_of_stock").orderBy("name").onSnapshot(M=>T(M.docs.map(L=>({id:L.id,...L.data()})))),C=Te.collection("inventory_requests").where("requesterId","==",t).orderBy("createdAt","desc").limit(20).onSnapshot(M=>S(M.docs.map(L=>({id:L.id,...L.data()}))));return()=>{A(),C()}},[n,t]);const J=async()=>{if(!k||O<=0||!W){a("warning","Please fill all required fields.","Incomplete Form");return}const A=_.find(C=>C.id===k);if(A){K(!0);try{await Te.collection("inventory_requests").add({requesterId:t,requesterName:i,requesterRole:s,itemId:A.id,itemName:A.name,quantity:O,purpose:W,status:"pending",createdAt:ke.firestore.Timestamp.now()}),u("success","Request submitted successfully!"),m("history"),V(""),j(1),$("")}catch(C){console.error(C),a("error","Failed to submit request. Please try again.")}finally{K(!1)}}},R=async A=>{if(!await l(`Confirm receipt of ${A.releasedQuantity} x ${A.itemName}? This will deduct items from stock.`,{title:"Confirm Receipt",confirmText:"Confirm Receipt",type:"primary"}))return;const M=Te.batch(),L=Te.collection("inventory_requests").doc(A.id);M.update(L,{status:"completed",completedAt:ke.firestore.Timestamp.now()});const ye=((await Te.collection("inventory_items").doc(A.itemId).get()).data().purchasePrice||0)*(A.releasedQuantity||0),Oe=Te.collection("inventory_items").doc(A.itemId);M.update(Oe,{quantity:ke.firestore.FieldValue.increment(-(A.releasedQuantity||0))});const X=Te.collection("inventory_transactions").doc();M.set(X,{itemId:A.itemId,itemName:A.itemName,type:"issue",quantity:-(A.releasedQuantity||0),cost:ye,performedBy:t,reason:`Staff Request: ${A.purpose}`,timestamp:ke.firestore.Timestamp.now()});try{await M.commit(),u("success","Receipt confirmed & stock deducted")}catch(fe){console.error(fe),a("error","Failed to confirm receipt. Please try again.")}};return n?f.jsx("div",{className:"fixed inset-0 bg-black/70 z-[100] flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl h-[80vh] flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"p-4 border-b bg-slate-50 flex justify-between items-center",children:[f.jsxs("h3",{className:"font-bold text-lg text-slate-800 flex items-center gap-2",children:[f.jsx(Fd,{className:"w-5 h-5 text-indigo-600"})," Request Inventory"]}),f.jsx("button",{onClick:e,children:f.jsx(Zc,{className:"w-5 h-5 text-slate-500 hover:text-red-500"})})]}),f.jsxs("div",{className:"flex border-b border-slate-200",children:[f.jsx("button",{onClick:()=>m("new"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${h==="new"?"border-indigo-600 text-indigo-600 bg-indigo-50/50":"border-transparent text-slate-500 hover:bg-slate-50"}`,children:"New Request"}),f.jsxs("button",{onClick:()=>m("history"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${h==="history"?"border-indigo-600 text-indigo-600 bg-indigo-50/50":"border-transparent text-slate-500 hover:bg-slate-50"}`,children:["My Requests ",E.filter(A=>A.status==="released").length>0&&f.jsx("span",{className:"ml-1 bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded-full",children:E.filter(A=>A.status==="released").length})]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50/50",children:[h==="new"&&f.jsxs("div",{className:"space-y-4 max-w-lg mx-auto bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Select Item"}),f.jsxs("select",{className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",value:k,onChange:A=>V(A.target.value),children:[f.jsx("option",{value:"",children:"-- Choose Item --"}),_.map(A=>f.jsxs("option",{value:A.id,children:[A.name," (",A.quantity," ",A.unit," avail)"]},A.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Quantity Needed"}),f.jsx("input",{type:"number",min:"1",className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",value:O,onChange:A=>j(parseInt(A.target.value))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Purpose / Reason"}),f.jsx("textarea",{className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500 h-24 resize-none",placeholder:"e.g. Restocking Phlebotomy Room 2",value:W,onChange:A=>$(A.target.value)})]}),f.jsxs("button",{onClick:J,disabled:U,className:"w-full bg-indigo-600 text-white py-3 rounded-lg font-bold shadow-md hover:bg-indigo-700 disabled:opacity-50 flex justify-center items-center gap-2",children:[U?f.jsx(Qa,{className:"w-5 h-5 animate-spin"}):f.jsx(Ei,{className:"w-5 h-5"})," Submit Request"]})]}),h==="history"&&f.jsxs("div",{className:"space-y-3",children:[E.map(A=>f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200 shadow-sm flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("h4",{className:"font-bold text-slate-800",children:A.itemName}),f.jsxs("span",{className:"text-sm font-medium bg-slate-100 px-2 py-0.5 rounded",children:["x",A.quantity]})]}),f.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Requested: ",Ln(A.createdAt),"  Reason: ",A.purpose]}),A.status==="released"&&f.jsxs("div",{className:"mt-2 bg-green-50 p-2 rounded border border-green-100 text-xs",children:[f.jsx("p",{className:"font-bold text-green-800",children:"Ready for Pickup!"}),f.jsxs("p",{className:"text-green-700",children:["Manager released ",A.releasedQuantity," items."]})]}),A.status==="rejected"&&f.jsxs("div",{className:"mt-2 bg-red-50 p-2 rounded border border-red-100 text-xs",children:[f.jsx("p",{className:"font-bold text-red-800",children:"Request Rejected"}),f.jsxs("p",{className:"text-red-700",children:["Reason: ",A.rejectionReason||"No reason provided"]}),A.rejectedAt&&f.jsxs("p",{className:"text-red-600 mt-1",children:["Rejected on: ",Ln(A.rejectedAt)]})]})]}),f.jsxs("div",{className:"shrink-0 flex items-center gap-3",children:[f.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase ${A.status==="pending"?"bg-blue-100 text-blue-700":A.status==="released"?"bg-amber-100 text-amber-700 animate-pulse":A.status==="completed"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:A.status==="released"?"Ready to Pick":A.status}),A.status==="released"&&f.jsxs("button",{onClick:()=>R(A),className:"bg-green-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold shadow hover:bg-green-700 flex items-center gap-1",children:[f.jsx(BT,{className:"w-3 h-3"})," Confirm Received"]})]})]},A.id)),E.length===0&&f.jsx("p",{className:"text-center text-slate-400 py-8 italic",children:"No request history."})]})]})]})}):null},_$=({data:n,onClose:e})=>{oe.useEffect(()=>{const i=setTimeout(()=>{window.print()},800);return()=>clearTimeout(i)},[]);const t=()=>{window.print()};return f.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4 print:p-0 print:bg-white print:fixed print:inset-0 print:z-[9999]",children:[f.jsx("style",{children:"@media print { body > *:not(.print-modal-root) { display: none !important; } .print-modal-root { display: flex !important; width: 100% !important; height: 100% !important; } }"}),f.jsxs("div",{className:"print-modal-root bg-white w-full max-w-2xl rounded-xl shadow-2xl overflow-hidden print:shadow-none print:w-full print:max-w-none print:rounded-none print:h-full print:absolute print:top-0 print:left-0",children:[f.jsxs("div",{className:"bg-slate-800 text-white p-4 flex justify-between items-center print:hidden",children:[f.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[f.jsx(kh,{className:"w-5 h-5"})," Print Preview"]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:t,className:"bg-indigo-500 hover:bg-indigo-600 px-4 py-2 rounded-lg font-bold text-sm shadow-sm transition-all",children:"Print Now"}),f.jsx("button",{onClick:e,className:"bg-slate-700 hover:bg-slate-600 px-4 py-2 rounded-lg font-bold text-sm shadow-sm transition-all",children:"Close"})]})]}),f.jsxs("div",{className:"p-10 print:p-8 text-slate-900 font-serif h-full flex flex-col overflow-y-auto",children:[f.jsxs("div",{className:"border-b-2 border-slate-800 pb-6 mb-6 flex justify-between items-start",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"LabPro Diagnostics"}),f.jsxs("p",{className:"text-sm text-slate-600 mt-2 leading-relaxed",children:["123 Medical Plaza, Suite 400",f.jsx("br",{}),"New York, NY 10001",f.jsx("br",{}),"Phone: +1 (555) 123-4567"]})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("h2",{className:"text-xl font-bold uppercase tracking-widest text-slate-400",children:"Invoice"}),f.jsxs("p",{className:"font-mono font-bold text-xl mt-1 text-slate-900",children:["#",n.invoiceId.slice(0,8).toUpperCase()]}),f.jsx("p",{className:"text-sm text-slate-500 mt-1",children:n.date})]})]}),f.jsxs("div",{className:"flex justify-between mb-8 bg-slate-50 p-5 rounded-lg border border-slate-100 print:bg-transparent print:p-0 print:border-0",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Patient Details"}),f.jsx("p",{className:"font-bold text-lg text-slate-800",children:n.patientName}),f.jsxs("p",{className:"text-sm text-slate-700",children:[n.age," / ",n.gender]}),f.jsx("p",{className:"text-sm text-slate-700",children:n.patientPhone})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Referred By"}),f.jsx("p",{className:"font-bold text-slate-800",children:n.doctor}),f.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mt-4 mb-1",children:"Payment Mode"}),f.jsx("p",{className:"uppercase font-bold text-slate-800",children:n.paymentMethod})]})]}),f.jsx("div",{className:"flex-1",children:f.jsxs("table",{className:"w-full text-left mb-8",children:[f.jsx("thead",{className:"border-b-2 border-slate-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"py-2 text-sm font-bold uppercase text-slate-500",children:"Test Description"}),f.jsx("th",{className:"py-2 text-right text-sm font-bold uppercase text-slate-500",children:"Amount"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-100",children:n.items.map((i,s)=>f.jsxs("tr",{children:[f.jsxs("td",{className:"py-3",children:[f.jsx("p",{className:"font-bold text-slate-800",children:i.name}),f.jsx("p",{className:"text-xs text-slate-500",children:i.code})]}),f.jsxs("td",{className:"py-3 text-right font-mono font-medium text-slate-700",children:["$",i.price.toFixed(2)]})]},s))})]})}),f.jsx("div",{className:"flex justify-end border-t border-slate-200 pt-6",children:f.jsxs("div",{className:"w-56 space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-slate-500 font-medium",children:"Subtotal:"}),f.jsxs("span",{className:"font-mono font-bold text-slate-700",children:["$",n.subtotal.toFixed(2)]})]}),n.discount>0&&f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-slate-500 font-medium",children:"Discount:"}),f.jsxs("span",{className:"font-mono font-bold text-red-500",children:["-$",n.discount.toFixed(2)]})]}),f.jsxs("div",{className:"flex justify-between text-xl font-bold border-t border-slate-800 pt-3 mt-2 text-slate-900",children:[f.jsx("span",{children:"Total:"}),f.jsxs("span",{children:["$",n.total.toFixed(2)]})]}),f.jsxs("div",{className:"flex justify-between text-sm mt-4 pt-4 border-t border-slate-200",children:[f.jsx("span",{className:"text-slate-500 font-medium",children:"Amount Paid:"}),f.jsxs("span",{className:"font-mono font-bold text-slate-700",children:["$",n.paid.toFixed(2)]})]}),n.due>0&&f.jsxs("div",{className:"flex justify-between text-sm text-red-600 bg-red-50 p-2 rounded mt-2 print:bg-transparent print:p-0 print:text-red-600",children:[f.jsx("span",{className:"font-bold",children:"Balance Due:"}),f.jsxs("span",{className:"font-mono font-bold",children:["$",n.due.toFixed(2)]})]})]})}),f.jsxs("div",{className:"mt-12 pt-8 border-t border-slate-200 text-center text-xs text-slate-400",children:[f.jsx("p",{children:"Thank you for choosing LabPro Diagnostics."}),f.jsx("p",{children:"This is a computer generated invoice and does not require a signature."}),f.jsx("p",{className:"mt-2 font-mono",children:n.invoiceId})]})]})]})]})},LD=({data:n,onClose:e})=>(oe.useEffect(()=>{const t=setTimeout(()=>window.print(),800);return()=>clearTimeout(t)},[]),f.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4 print:p-0 print:bg-white print:fixed print:inset-0 print:z-[9999]",children:[f.jsx("style",{children:"@media print { body > *:not(.print-report-root) { display: none !important; } .print-report-root { display: flex !important; width: 100% !important; height: 100% !important; position: absolute; top: 0; left: 0; } @page { margin: 0; size: A4; } }"}),f.jsxs("div",{className:"print-report-root bg-white w-full max-w-3xl rounded-xl shadow-2xl overflow-hidden flex flex-col h-[90vh] print:h-full print:rounded-none print:shadow-none",children:[f.jsxs("div",{className:"bg-slate-800 text-white p-4 flex justify-between items-center print:hidden shrink-0",children:[f.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[f.jsx($T,{className:"w-5 h-5"})," Report Preview"]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>window.print(),className:"bg-indigo-500 hover:bg-indigo-600 px-4 py-2 rounded-lg font-bold text-sm",children:"Print"}),f.jsx("button",{onClick:e,className:"bg-slate-700 hover:bg-slate-600 px-4 py-2 rounded-lg font-bold text-sm",children:"Close"})]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-10 print:p-8 font-serif bg-white text-slate-900",children:[f.jsxs("div",{className:"border-b-2 border-slate-900 pb-6 mb-8 flex justify-between items-end",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold tracking-tight text-slate-900",children:"LabPro Diagnostics"}),f.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"123 Medical Plaza, New York, NY 10001"}),f.jsx("p",{className:"text-sm text-slate-600",children:"ISO 15189 Certified Laboratory"})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("h2",{className:"text-xl font-bold uppercase tracking-widest text-slate-400",children:"Lab Report"}),f.jsx("p",{className:"font-mono font-bold text-lg mt-1",children:n.sampleLabelId||n.id.slice(0,8).toUpperCase()}),f.jsx("p",{className:"text-sm text-slate-500",children:Ln(n.reportedAt||new Date)})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-8 mb-8 bg-slate-50 p-6 rounded-lg border border-slate-100 print:bg-transparent print:p-0 print:border-0",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Patient Name"}),f.jsx("p",{className:"font-bold text-lg",children:n.patientName})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Age / Gender"}),f.jsxs("p",{className:"font-bold text-lg",children:[n.patientAge||"--"," Yrs / ",n.patientGender||"--"]})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Referred By"}),f.jsx("p",{className:"font-bold text-lg",children:"Dr. Smith (General)"})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Sample Type"}),f.jsx("p",{className:"font-bold text-lg",children:n.sampleType})]})]}),f.jsx("div",{className:"mb-6 text-center",children:f.jsx("h2",{className:"text-xl font-bold underline decoration-2 underline-offset-4 text-slate-900",children:n.testName})}),f.jsxs("table",{className:"w-full text-left mb-8",children:[f.jsx("thead",{className:"border-b-2 border-slate-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"py-2 font-bold uppercase text-xs text-slate-500 w-1/2",children:"Investigation"}),f.jsx("th",{className:"py-2 font-bold uppercase text-xs text-slate-500 w-1/4",children:"Result"}),f.jsx("th",{className:"py-2 font-bold uppercase text-xs text-slate-500 w-1/4 text-right",children:"Reference Range"})]})}),f.jsxs("tbody",{className:"divide-y divide-slate-100",children:[n.results&&Object.entries(n.results).map(([t,i])=>f.jsxs("tr",{children:[f.jsx("td",{className:"py-3 font-medium text-slate-800",children:t}),f.jsx("td",{className:"py-3 font-bold text-slate-900",children:i}),f.jsx("td",{className:"py-3 text-right text-slate-500 text-sm",children:"--"})]},t)),(!n.results||Object.keys(n.results).length===0)&&f.jsx("tr",{children:f.jsx("td",{colSpan:3,className:"py-4 text-center text-slate-400 italic",children:"No quantitative results recorded."})})]})]}),(n.conclusion||n.pathologistRemarks)&&f.jsxs("div",{className:"mb-12 border rounded-lg p-4 bg-slate-50 print:bg-transparent print:border-slate-300",children:[n.conclusion&&f.jsxs("div",{className:"mb-4",children:[f.jsx("h4",{className:"font-bold text-sm uppercase text-slate-700 mb-1",children:"Pathologist's Conclusion"}),f.jsx("p",{className:"text-slate-900 text-sm leading-relaxed",children:n.conclusion})]}),n.pathologistRemarks&&f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-sm uppercase text-slate-700 mb-1",children:"Remarks"}),f.jsx("p",{className:"text-slate-900 text-sm leading-relaxed",children:n.pathologistRemarks})]})]}),f.jsx("div",{className:"mt-auto pt-6 flex justify-end",children:f.jsxs("div",{className:"text-center w-48",children:[f.jsx("div",{className:"h-16 mb-2 border-b border-slate-900/20",children:f.jsx("div",{className:"h-full flex items-end justify-center pb-2 font-cursive text-2xl text-slate-600",children:"Dr. A. Pathologist"})}),f.jsx("p",{className:"font-bold text-sm text-slate-900",children:n.verifiedBy||"Dr. Alice Pathologist"}),f.jsx("p",{className:"text-xs text-slate-500",children:"MD, Pathology (Reg: 12345)"})]})}),f.jsx("div",{className:"mt-8 pt-4 border-t border-slate-200 text-center text-[10px] text-slate-400",children:f.jsx("p",{children:"End of Report. Electronically generated by LabPro System."})})]})]})]})),v$=({onLoginSuccess:n})=>{const[e,t]=oe.useState(""),[i,s]=oe.useState(""),[a,l]=oe.useState(!1),[u,h]=oe.useState(""),[m,_]=oe.useState("receptionist");oe.useEffect(()=>{Et.setPersistence(ke.auth.Auth.Persistence.LOCAL).catch(console.error)},[]);const T=async E=>{if(E.preventDefault(),!e||!i){h("Please enter username and password.");return}l(!0),h("");try{const S=await Te.collection("users").where("username","==",e).where("password","==",i).where("status","==","active").limit(1).get();if(!S.empty){const k=S.docs[0].data();if(k.role!==m&&k.role!=="admin"){h(`Credentials valid, but this user is a ${k.role}, not a ${m}.`),l(!1);return}try{await Et.signInAnonymously()}catch(V){console.warn("Anonymous auth failed:",V)}n(k.role,{uid:S.docs[0].id,email:k.username,...k}),await Ia("LOGIN","Auth",`User logged in as ${k.role}`,{uid:S.docs[0].id,username:k.username});return}if(e==="admin"&&i==="admin")if((await Te.collection("users").where("role","==","admin").limit(1).get()).empty){try{await Et.signInAnonymously()}catch(V){console.warn("Anonymous auth failed:",V)}n("admin",{uid:"sys-admin",email:"System Admin",username:"admin"});return}else{h("Default admin access disabled. Use your assigned credentials.");return}h("Invalid credentials.")}catch(S){console.error(S),h("Login failed. Please try again.")}finally{l(!1)}};return f.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col font-sans",children:[f.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b border-slate-200",children:f.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white shadow-md",children:f.jsx(KT,{className:"w-5 h-5"})}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-xl font-bold text-slate-800 leading-none",children:"LabPro"}),f.jsx("p",{className:"text-[10px] text-slate-500 font-bold tracking-wider",children:"DIAGNOSTICS"})]})]}),f.jsxs("div",{className:"flex items-center gap-4 text-xs font-medium text-slate-600",children:[f.jsxs("div",{className:"hidden sm:flex items-center gap-1 cursor-pointer hover:text-indigo-600",children:[f.jsx(S7,{className:"w-4 h-4"}),f.jsx("span",{children:"English"})]}),f.jsxs("div",{className:"flex items-center gap-1 cursor-pointer hover:text-indigo-600",children:[f.jsx(YT,{className:"w-4 h-4"}),f.jsx("span",{children:"Help"})]})]})]})}),f.jsxs("main",{className:"flex-1 flex flex-col md:flex-row max-w-7xl mx-auto w-full",children:[f.jsxs("div",{className:"hidden md:flex flex-col justify-center p-12 lg:p-20 w-full md:w-1/2 bg-slate-50",children:[f.jsxs("h2",{className:"text-4xl lg:text-5xl font-extrabold text-slate-900 mb-6 leading-tight",children:["Precision ",f.jsx("br",{}),f.jsx("span",{className:"text-indigo-600",children:"Diagnostics"})," ",f.jsx("br",{}),"Made Simple."]}),f.jsx("p",{className:"text-lg text-slate-600 mb-8 max-w-md leading-relaxed",children:"Access your workspace securely. Manage patients, samples, and reports with LabPro's integrated platform."}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-3 text-slate-700",children:[f.jsx(Ei,{className:"w-5 h-5 text-green-500"}),f.jsx("span",{children:"ISO 15189 Certified Laboratory"})]}),f.jsxs("div",{className:"flex items-center gap-3 text-slate-700",children:[f.jsx(Ei,{className:"w-5 h-5 text-green-500"}),f.jsx("span",{children:"24/7 Processing Capabilities"})]}),f.jsxs("div",{className:"flex items-center gap-3 text-slate-700",children:[f.jsx(Ei,{className:"w-5 h-5 text-green-500"}),f.jsx("span",{children:"Secure Cloud Data Storage"})]})]})]}),f.jsx("div",{className:"flex-1 flex flex-col justify-center p-4 sm:p-12 w-full md:w-1/2 bg-white md:shadow-[-20px_0_40px_-10px_rgba(0,0,0,0.05)] z-10",children:f.jsx("div",{className:"max-w-md mx-auto w-full",children:f.jsxs("div",{className:"bg-white rounded-2xl md:p-2 w-full",children:[f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-1",children:"Login to Lab System"}),f.jsx("p",{className:"text-sm text-slate-400",children:"Select role and enter credentials"})]}),f.jsxs("form",{onSubmit:T,className:"space-y-5",autoComplete:"on",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Select Role"}),f.jsxs("div",{className:"relative",children:[f.jsx("select",{value:m,onChange:E=>_(E.target.value),className:"w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none appearance-none font-bold text-slate-700",name:"role",children:mp.filter(E=>!E.disabled).map(E=>f.jsx("option",{value:E.id,children:E.label},E.id))}),f.jsx(l7,{className:"absolute right-4 top-4 text-slate-400 w-4 h-4 pointer-events-none"})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-1.5",children:[f.jsx("label",{className:"block text-sm font-medium text-slate-600",children:"Username"}),f.jsx("input",{type:"text",value:e,onChange:E=>t(E.target.value),className:"w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all",placeholder:"Enter username",autoFocus:!0,name:"username",autoComplete:"username"})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx("div",{className:"flex justify-between",children:f.jsx("label",{className:"block text-sm font-medium text-slate-600",children:"Password"})}),f.jsx("input",{type:"password",value:i,onChange:E=>s(E.target.value),className:"w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all",placeholder:"",name:"password",autoComplete:"current-password"})]})]}),u&&f.jsxs("div",{className:"bg-red-50 border border-red-100 text-red-600 p-3 rounded-xl text-sm flex items-start gap-2 animate-in fade-in slide-in-from-top-2",children:[f.jsx(GT,{className:"w-4 h-4 mt-0.5 shrink-0"}),f.jsx("span",{className:"leading-snug",children:u})]}),f.jsx("button",{type:"submit",disabled:a||!e||!i,className:"w-full bg-indigo-600 text-white py-3.5 rounded-xl font-bold hover:bg-indigo-700 transition-all disabled:opacity-50 disabled:scale-[0.99] shadow-lg shadow-indigo-100 flex justify-center items-center gap-2",children:a?f.jsx(Qa,{className:"w-5 h-5 animate-spin"}):"Secure Login"})]}),f.jsxs("div",{className:"mt-10 border-t border-slate-100 pt-6",children:[f.jsxs("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3 flex items-center gap-2",children:[f.jsx(lg,{className:"w-3 h-3"})," System Notices"]}),f.jsx("div",{className:"space-y-3",children:f$.map(E=>f.jsxs("div",{className:"flex gap-3 text-sm",children:[f.jsx("span",{className:`w-1.5 h-1.5 rounded-full mt-1.5 shrink-0 ${E.type==="warning"?"bg-amber-500":E.type==="success"?"bg-green-500":"bg-blue-500"}`}),f.jsx("p",{className:"text-slate-600 leading-snug",children:E.text})]},E.id))})]})]})})})]}),f.jsx("footer",{className:"bg-slate-900 text-slate-300 py-6",children:f.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 md:grid-cols-3 gap-6 text-sm",children:[f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("h5",{className:"text-white font-bold mb-1",children:"Visit Us"}),f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx(V7,{className:"w-4 h-4 mt-0.5 text-indigo-400"}),f.jsxs("span",{children:["123 Medical Plaza, Suite 400",f.jsx("br",{}),"New York, NY 10001"]})]})]}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("h5",{className:"text-white font-bold mb-1",children:"Working Hours"}),f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx(DD,{className:"w-4 h-4 mt-0.5 text-indigo-400"}),f.jsxs("span",{children:["Mon - Fri: 7:00 AM - 9:00 PM",f.jsx("br",{}),f.jsx("span",{className:"text-amber-500 font-medium",children:"Emergency: 24/7"})]})]})]}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("h5",{className:"text-white font-bold mb-1",children:"Contact"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(kD,{className:"w-4 h-4 text-indigo-400"}),f.jsx("span",{children:"+1 (555) 123-4567"})]})]})]})})]})},T$=({expenses:n})=>{const[e,t]=oe.useState("due"),[i,s]=oe.useState(!1),[a,l]=oe.useState({category:"General",isRecurring:!1,status:"pending"}),[u,h]=oe.useState("month"),m=async()=>{var E;if(!(!a.title||!a.amount||!a.dueDate))try{await Te.collection("expenses").add({...a,date:ke.firestore.Timestamp.now(),createdBy:((E=Et.currentUser)==null?void 0:E.email)||"admin"}),await Ia("ADD_EXPENSE","Finance",`Added expense: ${a.title} ($${a.amount})`,Et.currentUser),s(!1),l({category:"General",isRecurring:!1,status:"pending"})}catch(S){console.error(S)}},_=async E=>{var S;try{await Te.collection("expenses").doc(E.id).update({status:"paid",paidAt:ke.firestore.Timestamp.now(),paidBy:((S=Et.currentUser)==null?void 0:S.email)||"admin"})}catch(k){console.error(k)}},T=oe.useMemo(()=>{if(e==="due")return n.filter(S=>S.status!=="paid");const E=new Date;return n.filter(S=>{if(S.status!=="paid")return!1;const k=S.paidAt?S.paidAt.toDate?S.paidAt.toDate():new Date(S.paidAt):new Date(S.date);return u==="day"?k.toDateString()===E.toDateString():u==="week"?k>new Date(E.setDate(E.getDate()-7)):u==="month"?k.getMonth()===E.getMonth()&&k.getFullYear()===E.getFullYear():u==="year"?k.getFullYear()===E.getFullYear():!0})},[n,e,u]);return f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Expense Management"}),f.jsxs("div",{className:"flex gap-2 mt-2",children:[f.jsx("button",{onClick:()=>t("due"),className:`px-3 py-1 text-sm rounded-full font-bold ${e==="due"?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-500"}`,children:"Due Expenses"}),f.jsx("button",{onClick:()=>t("paid"),className:`px-3 py-1 text-sm rounded-full font-bold ${e==="paid"?"bg-green-100 text-green-700":"bg-slate-100 text-slate-500"}`,children:"Paid History"})]})]}),f.jsxs("div",{className:"flex gap-2",children:[e==="paid"&&f.jsxs(f.Fragment,{children:[f.jsxs("select",{value:u,onChange:E=>h(E.target.value),className:"p-2 border rounded text-sm font-bold bg-white",children:[f.jsx("option",{value:"day",children:"Today"}),f.jsx("option",{value:"week",children:"This Week"}),f.jsx("option",{value:"month",children:"This Month"}),f.jsx("option",{value:"year",children:"This Year"})]}),f.jsx("button",{onClick:()=>xd(T,"paid_expenses.csv"),className:"bg-slate-200 p-2 rounded hover:bg-slate-300",title:"Export Excel",children:f.jsx(MD,{className:"w-5 h-5"})}),f.jsx("button",{onClick:()=>window.print(),className:"bg-slate-200 p-2 rounded hover:bg-slate-300",title:"Print",children:f.jsx(kh,{className:"w-5 h-5"})})]}),f.jsxs("button",{onClick:()=>s(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2",children:[f.jsx(ka,{className:"w-4 h-4"})," Add Expense"]})]})]}),i&&f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 mb-6 animate-in slide-in-from-top-4",children:[f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[f.jsx("input",{className:"p-2 border rounded",placeholder:"Title / Description",value:a.title||"",onChange:E=>l({...a,title:E.target.value})}),f.jsx("input",{className:"p-2 border rounded",type:"number",placeholder:"Amount",value:a.amount||"",onChange:E=>l({...a,amount:parseFloat(E.target.value)})}),f.jsxs("select",{className:"p-2 border rounded",value:a.category,onChange:E=>l({...a,category:E.target.value}),children:[f.jsx("option",{children:"General"}),f.jsx("option",{children:"Rent"}),f.jsx("option",{children:"Utilities"}),f.jsx("option",{children:"Salaries"}),f.jsx("option",{children:"Inventory"}),f.jsx("option",{children:"Maintenance"})]}),f.jsx("input",{className:"p-2 border rounded",type:"date",placeholder:"Due Date",value:a.dueDate||"",onChange:E=>l({...a,dueDate:E.target.value})})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("input",{className:"p-2 border rounded w-64",placeholder:"Vendor (Optional)",value:a.vendor||"",onChange:E=>l({...a,vendor:E.target.value})}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 text-slate-500",children:"Cancel"}),f.jsx("button",{onClick:m,className:"bg-green-600 text-white px-4 py-2 rounded font-bold",children:"Save Record"})]})]})]}),f.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm flex-1 overflow-hidden flex flex-col",children:f.jsx("div",{className:"overflow-y-auto",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:e==="due"?"Due Date":"Paid Date"}),f.jsx("th",{className:"p-4",children:"Description"}),f.jsx("th",{className:"p-4",children:"Category"}),f.jsx("th",{className:"p-4",children:"Vendor"}),f.jsx("th",{className:"p-4 text-right",children:"Amount"}),e==="due"&&f.jsx("th",{className:"p-4 text-center",children:"Action"})]})}),f.jsxs("tbody",{className:"divide-y divide-slate-100",children:[T.map(E=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 text-slate-500 text-xs font-mono",children:e==="due"?E.dueDate:Ln(E.paidAt)}),f.jsx("td",{className:"p-4 font-bold text-slate-700",children:E.title}),f.jsx("td",{className:"p-4",children:f.jsx("span",{className:"bg-slate-100 px-2 py-1 rounded text-xs",children:E.category})}),f.jsx("td",{className:"p-4 text-slate-500",children:E.vendor||"-"}),f.jsxs("td",{className:"p-4 text-right font-bold text-slate-800",children:["$",E.amount.toFixed(2)]}),e==="due"&&f.jsx("td",{className:"p-4 text-center",children:f.jsx("button",{onClick:()=>_(E),className:"bg-green-500 text-white px-3 py-1 rounded text-xs font-bold shadow hover:bg-green-600 transition-colors",children:"Mark Paid"})})]},E.id)),T.length===0&&f.jsx("tr",{children:f.jsx("td",{colSpan:6,className:"p-8 text-center text-slate-400",children:"No expenses found."})})]})]})})})]})},x$=({doctors:n,orders:e})=>{const{showAlert:t,showConfirm:i,showToast:s}=fg(),[a,l]=oe.useState(!1),[u,h]=oe.useState({status:"active",commissionRate:0}),m=async()=>{if(u.name)try{await Te.collection("doctors").add(u),l(!1),h({status:"active",commissionRate:0})}catch(T){console.error(T)}},_=async T=>{var E;try{console.log("Attempting to pay commission for:",T.name);const S=e.filter(W=>W.doctorId===T.id&&!W.commissionPaid);if(console.log("Unpaid orders count:",S.length),S.length===0){t("info","No unpaid orders found for this doctor in the current view.","No Pending Commissions");return}const k=S.reduce((W,$)=>W+($.doctorCommission||0),0);if(!await i(`Mark $${k.toFixed(2)} as paid to Dr. ${T.name}? This will create a specific expense record.`,{title:"Confirm Commission Payment",confirmText:"Mark Paid",type:"primary"}))return;const O=Te.batch(),j=Te.collection("expenses").doc();O.set(j,{title:`Commission - ${T.name}`,category:"Commission",amount:k,status:"paid",date:ke.firestore.Timestamp.now(),paidAt:ke.firestore.Timestamp.now(),paidBy:((E=Et.currentUser)==null?void 0:E.email)||"admin",createdBy:"system"}),S.forEach(W=>{const $=Te.collection("orders").doc(W.id);O.update($,{commissionPaid:!0})}),await O.commit(),s("success",`Commission of $${k.toFixed(2)} paid & expense logged`)}catch(S){console.error("Payment failed",S),t("error","Failed to pay commission: "+(S instanceof Error?S.message:String(S)),"Payment Failed")}};return f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Doctor Referral Program"}),f.jsxs("button",{onClick:()=>l(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2",children:[f.jsx(hg,{className:"w-4 h-4"})," Add Doctor"]})]}),a&&f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 mb-6",children:[f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[f.jsx("input",{className:"p-2 border rounded",placeholder:"Doctor Name",value:u.name||"",onChange:T=>h({...u,name:T.target.value})}),f.jsx("input",{className:"p-2 border rounded",placeholder:"Clinic / Hospital",value:u.clinic||"",onChange:T=>h({...u,clinic:T.target.value})}),f.jsx("input",{className:"p-2 border rounded",placeholder:"Phone",value:u.phone||"",onChange:T=>h({...u,phone:T.target.value})}),f.jsx("input",{className:"p-2 border rounded",type:"number",placeholder:"Commission %",value:u.commissionRate||"",onChange:T=>h({...u,commissionRate:parseFloat(T.target.value)})})]}),f.jsxs("div",{className:"flex justify-end gap-2",children:[f.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 text-slate-500",children:"Cancel"}),f.jsx("button",{onClick:m,className:"bg-green-600 text-white px-4 py-2 rounded font-bold",children:"Save Doctor"})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full min-h-0",children:[f.jsx("div",{className:"lg:col-span-2 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden flex flex-col",children:f.jsx("div",{className:"overflow-y-auto",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Doctor"}),f.jsx("th",{className:"p-4",children:"Clinic"}),f.jsx("th",{className:"p-4",children:"Comm. Rate"}),f.jsx("th",{className:"p-4 text-right",children:"Revenue Generated"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-100",children:n.map(T=>{const E=e.filter(S=>S.doctorId===T.id).reduce((S,k)=>S+k.totalAmount,0);return f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 font-bold text-slate-800",children:T.name}),f.jsx("td",{className:"p-4 text-slate-500",children:T.clinic}),f.jsxs("td",{className:"p-4 font-mono text-indigo-600 font-bold",children:[T.commissionRate,"%"]}),f.jsxs("td",{className:"p-4 text-right font-bold text-green-600",children:["$",E.toLocaleString()]})]},T.id)})})]})})}),f.jsxs("div",{className:"bg-indigo-50 p-6 rounded-xl border border-indigo-100 overflow-y-auto",children:[f.jsx("h4",{className:"font-bold text-indigo-900 mb-4",children:"Outstanding Commission Liabilities"}),f.jsxs("div",{className:"space-y-4",children:[n.map(T=>{const E=e.filter(S=>S.doctorId===T.id&&!S.commissionPaid).reduce((S,k)=>S+(k.doctorCommission||0),0);return E<=0?null:f.jsxs("div",{className:"bg-white p-3 rounded border border-indigo-100 flex justify-between items-center shadow-sm",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-bold text-slate-700 text-sm",children:T.name}),f.jsx("p",{className:"text-xs text-slate-400",children:T.clinic})]}),f.jsxs("div",{className:"text-right",children:[f.jsxs("p",{className:"font-bold text-indigo-600",children:["$",E.toFixed(2)]}),f.jsx("button",{onClick:()=>_(T),className:"text-[10px] bg-green-100 text-green-700 font-bold px-2 py-1 rounded hover:bg-green-200 mt-1 transition-colors",children:"Mark Paid"})]})]},T.id)}),n.every(T=>e.filter(E=>E.doctorId===T.id&&!E.commissionPaid).reduce((E,S)=>E+(S.doctorCommission||0),0)<=0)&&f.jsx("p",{className:"text-center text-indigo-400 text-sm py-4",children:"No pending commissions."})]})]})]})]})},UD=()=>{const{showToast:n}=fg(),[e,t]=oe.useState("dashboard"),[i,s]=oe.useState([]),[a,l]=oe.useState([]),[u,h]=oe.useState([]),[m,_]=oe.useState(0),[T,E]=oe.useState([]),[S,k]=oe.useState("month");oe.useEffect(()=>{const U=Te.collection("orders").orderBy("createdAt","desc").limit(200).onSnapshot(C=>s(C.docs.map(M=>({id:M.id,...M.data()})))),K=Te.collection("expenses").orderBy("date","desc").limit(200).onSnapshot(C=>l(C.docs.map(M=>({id:M.id,...M.data()})))),J=Te.collection("doctors").onSnapshot(C=>h(C.docs.map(M=>({id:M.id,...M.data()})))),R=Te.collection("inventory_items").onSnapshot(C=>{const M=C.docs.reduce((L,F)=>{const D=F.data();return L+D.quantity*(D.purchasePrice||0)},0);_(M)}),A=Te.collection("inventory_transactions").orderBy("timestamp","desc").limit(100).onSnapshot(C=>E(C.docs.map(M=>({id:M.id,...M.data()}))));return()=>{U(),K(),J(),R(),A()}},[]);const V=U=>{const K=U.toDate?U.toDate():new Date(U),J=new Date;return S==="today"?K.toDateString()===J.toDateString():S==="week"?K>new Date(J.setDate(J.getDate()-7)):S==="month"?K.getMonth()===J.getMonth()&&K.getFullYear()===J.getFullYear():S==="year"?K.getFullYear()===J.getFullYear():!0},O=oe.useMemo(()=>i.filter(U=>V(U.createdAt)),[i,S]),j=oe.useMemo(()=>a.filter(U=>U.status==="paid"&&V(U.paidAt)),[a,S]),W=oe.useMemo(()=>T.filter(U=>(U.type==="issue"||U.type==="deduction")&&V(U.timestamp)),[T,S]),$=oe.useMemo(()=>{const U=O.reduce((C,M)=>C+M.totalAmount,0),K=j.reduce((C,M)=>C+M.amount,0),J=W.reduce((C,M)=>C+(M.cost||0),0),R=i.filter(C=>!C.commissionPaid).reduce((C,M)=>C+(M.doctorCommission||0),0),A=U-K-J;return{revenue:U,paidExpenses:K,invUsageCost:J,pendingCommissions:R,profit:A}},[O,j,W,i]);return f.jsxs("div",{className:"h-full flex flex-col bg-slate-50",children:[f.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-3 flex justify-between items-center shrink-0",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[f.jsx(Lc,{className:"w-6 h-6 text-indigo-600"})," Financial Dashboard"]})}),f.jsx("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[{id:"dashboard",label:"Overview",icon:cg},{id:"sales",label:"Sales",icon:$T},{id:"expenses",label:"Expenses",icon:r$},{id:"doctors",label:"Referrals",icon:hg},{id:"inventory",label:"Inventory Finance",icon:ur}].map(U=>f.jsxs("button",{onClick:()=>t(U.id),className:`px-3 py-1.5 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${e===U.id?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-800"}`,children:[f.jsx(U.icon,{className:"w-4 h-4"})," ",f.jsx("span",{className:"hidden sm:inline",children:U.label})]},U.id))})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[f.jsx("div",{className:"flex justify-end mb-6",children:f.jsxs("select",{value:S,onChange:U=>k(U.target.value),className:"p-2 border rounded-lg text-sm bg-white font-bold text-slate-700",children:[f.jsx("option",{value:"today",children:"Today"}),f.jsx("option",{value:"week",children:"This Week"}),f.jsx("option",{value:"month",children:"This Month"}),f.jsx("option",{value:"year",children:"This Year"})]})}),e==="dashboard"&&f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Total Revenue"}),f.jsxs("p",{className:"text-3xl font-bold text-slate-800 mt-2",children:["$",$.revenue.toLocaleString()]}),f.jsxs("p",{className:"text-xs text-green-600 mt-1 font-bold flex items-center gap-1",children:[f.jsx(W7,{className:"w-3 h-3"})," Income"]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Paid Expenses"}),f.jsxs("p",{className:"text-3xl font-bold text-slate-800 mt-2",children:["$",$.paidExpenses.toLocaleString()]}),f.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Operational & Paid Comms"})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Inventory Usage Cost"}),f.jsxs("p",{className:"text-3xl font-bold text-slate-800 mt-2",children:["$",$.invUsageCost.toLocaleString()]}),f.jsx("p",{className:"text-xs text-amber-600 mt-1 font-bold",children:"Cost of Goods Sold"})]}),f.jsxs("div",{className:`p-6 rounded-xl border shadow-lg text-white ${$.profit>=0?"bg-indigo-600 border-indigo-700 shadow-indigo-200":"bg-red-600 border-red-700 shadow-red-200"}`,children:[f.jsx("p",{className:"text-white/80 text-xs font-bold uppercase",children:"Net Profit"}),f.jsxs("p",{className:"text-3xl font-bold mt-2",children:["$",$.profit.toLocaleString()]}),f.jsx("p",{className:"text-xs text-white/70 mt-1 opacity-80",children:"Rev - (Exp + Inv. Usage)"})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Financial Overview"}),[$.revenue,$.paidExpenses,$.invUsageCost].some(U=>U>0)?f.jsxs(f.Fragment,{children:[f.jsx(g$,{data:[{label:"Revenue",value:$.revenue},{label:"Paid Exp",value:$.paidExpenses},{label:"Inv. Usage",value:$.invUsageCost},{label:"Profit",value:Math.max(0,$.profit)}]}),f.jsx("div",{className:"mt-4 grid grid-cols-2 gap-2 text-xs",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 bg-indigo-500 rounded"}),f.jsx("span",{className:"text-slate-600",children:"Data Values"})]})})]}):f.jsx("div",{className:"h-40 flex items-center justify-center text-slate-400 text-sm",children:"No financial data for selected period"})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Expense Breakdown (Paid)"}),j.length>0||W.length>0?f.jsxs(f.Fragment,{children:[f.jsx(y$,{data:(()=>{const U=j.reduce((J,R)=>({...J,[R.category]:(J[R.category]||0)+R.amount}),{}),K=W.reduce((J,R)=>J+(R.cost||0),0);return K>0&&(U.Inventory=K),Object.entries(U).map(([J,R],A)=>({label:J,value:R,color:["#6366f1","#ec4899","#f59e0b","#10b981","#8b5cf6"][A%5]}))})()}),f.jsx("div",{className:"mt-4 grid grid-cols-2 gap-2 text-xs",children:(()=>{const U=j.reduce((J,R)=>({...J,[R.category]:(J[R.category]||0)+R.amount}),{}),K=W.reduce((J,R)=>J+(R.cost||0),0);return K>0&&(U.Inventory=K),Object.entries(U).map(([J,R],A)=>f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:["#6366f1","#ec4899","#f59e0b","#10b981","#8b5cf6"][A%5]}}),f.jsxs("span",{className:"text-slate-600",children:[J,": $",R.toFixed(0)]})]},J))})()})]}):f.jsx("div",{className:"h-40 flex items-center justify-center text-slate-400 text-sm",children:"No paid expenses for selected period"})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsx("div",{className:"flex justify-between items-center mb-4",children:f.jsxs("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[f.jsx(zT,{className:"w-5 h-5 text-indigo-600"})," Financial Reports"]})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsxs("button",{onClick:()=>{const U=new Date,K=i.filter(A=>(A.createdAt.toDate?A.createdAt.toDate():new Date(A.createdAt)).toDateString()===U.toDateString()),J=a.filter(A=>A.status==="paid"&&A.paidAt&&(A.paidAt.toDate?A.paidAt.toDate():new Date(A.paidAt)).toDateString()===U.toDateString()),R=`DAILY FINANCIAL REPORT - ${U.toDateString()}

REVENUE
Total Sales: $${K.reduce((A,C)=>A+C.totalAmount,0).toFixed(2)}
Number of Orders: ${K.length}

EXPENSES
Total Paid: $${J.reduce((A,C)=>A+C.amount,0).toFixed(2)}
Number of Expenses: ${J.length}

NET: $${(K.reduce((A,C)=>A+C.totalAmount,0)-J.reduce((A,C)=>A+C.amount,0)).toFixed(2)}`;xd([{Report:R}],`daily_report_${U.toISOString().split("T")[0]}.csv`),n("success","Daily report exported!")},className:"p-4 border-2 border-slate-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-all text-left group",children:[f.jsx(i7,{className:"w-6 h-6 text-indigo-600 mb-2"}),f.jsx("p",{className:"font-bold text-slate-800 group-hover:text-indigo-600",children:"Daily Report"}),f.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Today's summary"})]}),f.jsxs("button",{onClick:()=>{const U=new Date,K=new Date(U.setDate(U.getDate()-7)),J=i.filter(R=>(R.createdAt.toDate?R.createdAt.toDate():new Date(R.createdAt))>K);a.filter(R=>R.status==="paid"&&R.paidAt&&(R.paidAt.toDate?R.paidAt.toDate():new Date(R.paidAt))>K),xd(J.map(R=>({Date:Ln(R.createdAt),Patient:R.patientName,Amount:R.totalAmount})),`weekly_sales_${new Date().toISOString().split("T")[0]}.csv`),n("success","Weekly report exported!")},className:"p-4 border-2 border-slate-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-all text-left group",children:[f.jsx(t7,{className:"w-6 h-6 text-indigo-600 mb-2"}),f.jsx("p",{className:"font-bold text-slate-800 group-hover:text-indigo-600",children:"Weekly Report"}),f.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Last 7 days"})]}),f.jsxs("button",{onClick:()=>{const U=new Date,K=i.filter(J=>{const R=J.createdAt.toDate?J.createdAt.toDate():new Date(J.createdAt);return R.getMonth()===U.getMonth()&&R.getFullYear()===U.getFullYear()});a.filter(J=>{if(J.status!=="paid"||!J.paidAt)return!1;const R=J.paidAt.toDate?J.paidAt.toDate():new Date(J.paidAt);return R.getMonth()===U.getMonth()&&R.getFullYear()===U.getFullYear()}),xd(K.map(J=>({Date:Ln(J.createdAt),Patient:J.patientName,Amount:J.totalAmount})),`monthly_sales_${U.getFullYear()}_${U.getMonth()+1}.csv`),n("success","Monthly report exported!")},className:"p-4 border-2 border-slate-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-all text-left group",children:[f.jsx(r7,{className:"w-6 h-6 text-indigo-600 mb-2"}),f.jsx("p",{className:"font-bold text-slate-800 group-hover:text-indigo-600",children:"Monthly Report"}),f.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Current month"})]}),f.jsxs("button",{onClick:()=>{const U={Generated:new Date().toLocaleString(),Period:S,"Total Revenue":$.revenue,"Total Expenses":$.paidExpenses,"Inventory Cost":$.invUsageCost,"Net Profit":$.profit,"Pending Commissions":$.pendingCommissions,"Total Orders":O.length,"Paid Expenses Count":j.length},K=[...O.map(J=>({Type:"Revenue",Date:Ln(J.createdAt),Description:`Order - ${J.patientName}`,Amount:J.totalAmount})),...j.map(J=>({Type:"Expense",Date:Ln(J.paidAt),Description:`${J.category} - ${J.title}`,Amount:-J.amount}))];xd([U,...K],`master_financial_report_${new Date().toISOString().split("T")[0]}.csv`),n("success","Master report with all financial data exported!")},className:"p-4 border-2 border-indigo-500 bg-indigo-50 rounded-lg hover:bg-indigo-100 transition-all text-left group",children:[f.jsx(MD,{className:"w-6 h-6 text-indigo-600 mb-2"}),f.jsx("p",{className:"font-bold text-indigo-800",children:"Master Report"}),f.jsx("p",{className:"text-xs text-indigo-600 mt-1 font-medium",children:"Complete financial data"})]})]}),f.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 flex items-center justify-between",children:[f.jsx("p",{className:"text-xs text-slate-500",children:"All reports are exported as CSV files for Excel/Sheets"}),f.jsxs("button",{onClick:()=>window.print(),className:"text-sm font-bold text-indigo-600 hover:text-indigo-800 flex items-center gap-1",children:[f.jsx(kh,{className:"w-4 h-4"})," Print Dashboard"]})]})]}),f.jsxs("div",{className:"bg-amber-50 p-4 rounded-xl border border-amber-100 flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-bold text-amber-900",children:"Outstanding Liabilities"}),f.jsxs("p",{className:"text-sm text-amber-700",children:["Pending Commissions: ",f.jsxs("b",{children:["$",$.pendingCommissions.toLocaleString()]}),"  Due Expenses: ",f.jsxs("b",{children:["$",a.filter(U=>U.status!=="paid").reduce((U,K)=>U+K.amount,0).toLocaleString()]})]})]}),f.jsx("button",{onClick:()=>t("expenses"),className:"px-4 py-2 bg-white text-amber-700 text-sm font-bold rounded shadow-sm hover:bg-amber-100",children:"Manage Due Expenses"})]})]}),e==="expenses"&&f.jsx(T$,{expenses:a}),e==="doctors"&&f.jsx(x$,{doctors:u,orders:i}),e==="sales"&&f.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Date"}),f.jsx("th",{className:"p-4",children:"Bill #"}),f.jsx("th",{className:"p-4",children:"Patient"}),f.jsx("th",{className:"p-4",children:"Referred By"}),f.jsx("th",{className:"p-4 text-right",children:"Amount"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-100",children:O.map(U=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 text-xs font-mono text-slate-500",children:Ln(U.createdAt)}),f.jsx("td",{className:"p-4 text-xs font-bold",children:U.id.slice(0,8).toUpperCase()}),f.jsx("td",{className:"p-4 font-bold text-slate-800",children:U.patientName}),f.jsx("td",{className:"p-4 text-slate-600",children:U.doctorName||"Self"}),f.jsxs("td",{className:"p-4 text-right font-bold text-slate-800",children:["$",U.totalAmount]})]},U.id))})]})}),e==="inventory"&&f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"bg-indigo-50 p-6 rounded-xl border border-indigo-100",children:[f.jsx("h3",{className:"font-bold text-indigo-900 mb-2",children:"Total Current Inventory Value"}),f.jsxs("p",{className:"text-4xl font-bold text-indigo-600",children:["$",m.toLocaleString()]}),f.jsx("p",{className:"text-sm text-indigo-400 mt-2",children:"Valuation of current stock (Purchase Price  Quantity)."})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsxs("h3",{className:"font-bold text-slate-800 mb-4",children:["Inventory Usage Cost (",S,")"]}),f.jsxs("p",{className:"text-4xl font-bold text-slate-800 mb-4",children:["$",$.invUsageCost.toLocaleString()]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-slate-500",children:"Used in Tests"}),f.jsxs("span",{className:"font-bold",children:["$",W.filter(U=>U.type==="deduction").reduce((U,K)=>U+(K.cost||0),0).toFixed(2)]})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-slate-500",children:"Issued to Staff"}),f.jsxs("span",{className:"font-bold",children:["$",W.filter(U=>U.type==="issue").reduce((U,K)=>U+(K.cost||0),0).toFixed(2)]})]})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[f.jsx("div",{className:"p-4 border-b bg-slate-50 font-bold text-slate-700",children:"Inventory Cost Ledger"}),f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"border-b",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Date"}),f.jsx("th",{className:"p-4",children:"Item"}),f.jsx("th",{className:"p-4",children:"Type"}),f.jsx("th",{className:"p-4",children:"Reason"}),f.jsx("th",{className:"p-4 text-right",children:"Cost"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-100",children:W.map(U=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 text-xs font-mono text-slate-500",children:Ln(U.timestamp)}),f.jsx("td",{className:"p-4 font-bold text-slate-700",children:U.itemName}),f.jsx("td",{className:"p-4",children:f.jsx("span",{className:"bg-slate-100 px-2 py-1 rounded text-xs uppercase",children:U.type})}),f.jsx("td",{className:"p-4 text-slate-600",children:U.reason}),f.jsxs("td",{className:"p-4 text-right font-bold text-slate-800",children:["$",(U.cost||0).toFixed(2)]})]},U.id))})]})]})]})]})]})},E$=()=>{const[n,e]=oe.useState([]);return oe.useEffect(()=>{const t=Te.collection("orders").orderBy("createdAt","desc").limit(50).onSnapshot(i=>e(i.docs.map(s=>({id:s.id,...s.data()}))));return()=>t()},[]),f.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Date"}),f.jsx("th",{className:"p-4",children:"Order ID"}),f.jsx("th",{className:"p-4",children:"Patient"}),f.jsx("th",{className:"p-4",children:"Amount"}),f.jsx("th",{className:"p-4",children:"Status"})]})}),f.jsxs("tbody",{className:"divide-y divide-slate-50",children:[n.map(t=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 text-xs text-slate-500",children:Ln(t.createdAt)}),f.jsx("td",{className:"p-4 font-mono text-xs font-bold",children:t.id.slice(0,8).toUpperCase()}),f.jsx("td",{className:"p-4 font-bold text-slate-800",children:t.patientName}),f.jsxs("td",{className:"p-4 font-bold text-slate-800",children:["$",t.totalAmount]}),f.jsx("td",{className:"p-4",children:f.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${t.status==="completed"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:t.status})})]},t.id)),n.length===0&&f.jsx("tr",{children:f.jsx("td",{colSpan:5,className:"p-8 text-center text-slate-400",children:"No recent orders found."})})]})]})})},w$=({onPrint:n})=>{const[e,t]=oe.useState([]);return oe.useEffect(()=>{const i=Te.collection("samples").where("status","==","reported").orderBy("reportedAt","desc").limit(50).onSnapshot(s=>t(s.docs.map(a=>({id:a.id,...a.data()}))));return()=>i()},[]),f.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Reported Date"}),f.jsx("th",{className:"p-4",children:"Patient"}),f.jsx("th",{className:"p-4",children:"Test"}),f.jsx("th",{className:"p-4 text-right",children:"Action"})]})}),f.jsxs("tbody",{className:"divide-y divide-slate-50",children:[e.map(i=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 text-xs text-slate-500",children:Ln(i.reportedAt)}),f.jsx("td",{className:"p-4 font-bold text-slate-800",children:i.patientName}),f.jsx("td",{className:"p-4 text-slate-600",children:i.testName}),f.jsx("td",{className:"p-4 text-right",children:f.jsxs("button",{onClick:()=>n(i),className:"bg-indigo-50 text-indigo-600 px-3 py-1.5 rounded text-xs font-bold hover:bg-indigo-100 flex items-center gap-1 ml-auto transition-colors",children:[f.jsx(kh,{className:"w-3 h-3"})," Print Report"]})})]},i.id)),e.length===0&&f.jsx("tr",{children:f.jsx("td",{colSpan:4,className:"p-8 text-center text-slate-400",children:"No completed reports yet."})})]})]})})},b$=({onSelect:n})=>{const[e,t]=oe.useState(""),[i,s]=oe.useState([]),[a,l]=oe.useState(!1),u=async()=>{if(e){l(!0);try{const h=await Te.collection("patients").where("fullName",">=",e).where("fullName","<=",e+"").limit(20).get();s(h.docs.map(m=>({id:m.id,...m.data()})))}catch(h){console.error(h)}l(!1)}};return f.jsxs("div",{className:"p-6 h-full flex flex-col bg-white rounded-xl border border-slate-200 shadow-sm",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"Search Patient Database"}),f.jsxs("div",{className:"flex gap-2 mb-6",children:[f.jsxs("div",{className:"relative flex-1",children:[f.jsx(Od,{className:"absolute left-3 top-3 text-slate-400 w-4 h-4"}),f.jsx("input",{className:"w-full pl-9 p-3 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter Patient Name...",value:e,onChange:h=>t(h.target.value),onKeyDown:h=>h.key==="Enter"&&u()})]}),f.jsx("button",{onClick:u,disabled:a,className:"px-6 bg-indigo-600 text-white rounded-lg font-bold shadow hover:bg-indigo-700 disabled:opacity-50",children:a?f.jsx(Qa,{className:"w-4 h-4 animate-spin"}):"Search"})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.map(h=>f.jsxs("div",{className:"p-4 border-b border-slate-100 last:border-0 hover:bg-slate-50 flex justify-between items-center transition-colors",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-bold text-slate-800",children:h.fullName}),f.jsxs("p",{className:"text-xs text-slate-500",children:[h.phone,"  ",h.gender,"  ",pp(h.dob)," yrs"]})]}),f.jsx("button",{onClick:()=>n(h),className:"px-3 py-1.5 bg-indigo-50 text-indigo-700 rounded text-xs font-bold hover:bg-indigo-100",children:"Select"})]},h.id)),i.length===0&&!a&&f.jsxs("div",{className:"p-12 text-center text-slate-400 flex flex-col items-center",children:[f.jsx(Od,{className:"w-8 h-8 mb-2 opacity-20"}),f.jsx("p",{children:"No patients found. Search by name."})]})]})]})},I$=({role:n})=>f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-indigo-600 rounded-2xl p-8 text-white shadow-xl shadow-indigo-200 relative overflow-hidden",children:[f.jsxs("div",{className:"relative z-10",children:[f.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Welcome Back, ",n]}),f.jsx("p",{className:"text-indigo-100",children:"Here is what's happening in your lab today."})]}),f.jsx(KT,{className:"absolute right-0 bottom-0 text-indigo-500 w-48 h-48 -mr-8 -mb-8 opacity-20 rotate-12"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[f.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"w-12 h-12 rounded-full bg-green-50 flex items-center justify-center text-green-600",children:f.jsx(PD,{className:"w-6 h-6"})}),f.jsxs("div",{children:[f.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"System Status"}),f.jsx("p",{className:"text-xl font-bold text-slate-800",children:"Operational"})]})]})}),f.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-50 flex items-center justify-center text-blue-600",children:f.jsx(DD,{className:"w-6 h-6"})}),f.jsxs("div",{children:[f.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Server Time"}),f.jsx("p",{className:"text-xl font-bold text-slate-800",children:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})}),f.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-50 flex items-center justify-center text-amber-600",children:f.jsx(QT,{className:"w-6 h-6"})}),f.jsxs("div",{children:[f.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Security Level"}),f.jsx("p",{className:"text-xl font-bold text-slate-800",children:"High"})]})]})})]})]}),S$=()=>{const[n,e]=oe.useState([]);return oe.useEffect(()=>{const t=Te.collection("patients").orderBy("createdAt","desc").limit(50).onSnapshot(i=>e(i.docs.map(s=>({id:s.id,...s.data()}))));return()=>t()},[]),f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[f.jsx(ch,{className:"w-6 h-6 text-indigo-600"})," Patient Directory"]}),f.jsx("div",{className:"bg-white rounded-xl border border-slate-200 flex-1 overflow-hidden shadow-sm flex flex-col",children:f.jsx("div",{className:"overflow-y-auto flex-1",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Name"}),f.jsx("th",{className:"p-4",children:"Phone"}),f.jsx("th",{className:"p-4",children:"Gender"}),f.jsx("th",{className:"p-4",children:"Age"}),f.jsx("th",{className:"p-4",children:"Registered"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-50",children:n.map(t=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 font-bold text-slate-800",children:t.fullName}),f.jsx("td",{className:"p-4 text-slate-600",children:t.phone}),f.jsx("td",{className:"p-4 capitalize text-slate-600",children:t.gender}),f.jsxs("td",{className:"p-4 text-slate-600",children:[pp(t.dob)," yrs"]}),f.jsx("td",{className:"p-4 text-slate-500 text-xs",children:Ln(t.createdAt)})]},t.id))})]})})})]})},A$=({role:n})=>{const{showAlert:e,showConfirm:t,showPrompt:i,showToast:s}=fg(),a=h$(n),[l,u]=oe.useState(a?"dashboard":"requests"),[h,m]=oe.useState([]),[_,T]=oe.useState([]),[E,S]=oe.useState([]),[k,V]=oe.useState([]),[O,j]=oe.useState(!1),[W,$]=oe.useState(null),[U,K]=oe.useState({category:"General",unit:"pcs",status:"in_stock"}),[J,R]=oe.useState(null),[A,C]=oe.useState(!1),[M,L]=oe.useState(null),[F,D]=oe.useState({quantity:0,unitPrice:0,vendorName:"",vendorPhone:"",invoiceNumber:"",expiryDate:"",manufactureDate:"",remarks:""});oe.useEffect(()=>{const z=Te.collection("inventory_items").onSnapshot(H=>m(H.docs.map(ge=>({id:ge.id,...ge.data()})))),pe=Te.collection("inventory_requests").orderBy("createdAt","desc").limit(50).onSnapshot(H=>T(H.docs.map(ge=>({id:ge.id,...ge.data()})))),we=Te.collection("vendors").onSnapshot(H=>S(H.docs.map(ge=>({id:ge.id,...ge.data()})))),Ie=Te.collection("inventory_wastages").orderBy("reportedAt","desc").limit(50).onSnapshot(H=>V(H.docs.map(ge=>({id:ge.id,...ge.data()}))));return()=>{z(),pe(),we(),Ie()}},[]);const ye=oe.useMemo(()=>{const z=new Date,pe=h.length,we=h.filter(qe=>qe.quantity<qe.minLevel).length,Ie=h.filter(qe=>qe.quantity===0).length,H=h.filter(qe=>qe.expiryDate?(qe.expiryDate.toDate?qe.expiryDate.toDate():new Date(qe.expiryDate))<z:!1).length,ge=h.filter(qe=>{if(!qe.expiryDate)return!1;const $e=((qe.expiryDate.toDate?qe.expiryDate.toDate():new Date(qe.expiryDate)).getTime()-z.getTime())/(1e3*3600*24);return $e>0&&$e<=30}).length,Se=h.reduce((qe,st)=>qe+(st.purchasePrice||0)*st.quantity,0),Le=_.filter(qe=>qe.status==="pending").length;return{totalItems:pe,lowStock:we,outOfStock:Ie,expired:H,expiringSoon:ge,totalValue:Se,pendingRequests:Le}},[h,_]),Oe=async()=>{var pe,we,Ie,H,ge,Se,Le,qe,st,$e,Ot,ai;const z=[];if((pe=U.name)!=null&&pe.trim()||z.push("Item Name"),U.category||z.push("Category"),(we=U.unit)!=null&&we.trim()||z.push("Unit"),(U.quantity===void 0||U.quantity===null)&&z.push("Quantity"),(U.minLevel===void 0||U.minLevel===null)&&z.push("Min Level"),(!U.purchasePrice||U.purchasePrice<=0)&&z.push("Purchase Price"),(Ie=U.vendorName)!=null&&Ie.trim()||z.push("Vendor Name"),(H=U.batchNumber)!=null&&H.trim()||z.push("Batch Number"),!((ge=U.barcode)!=null&&ge.trim())&&!((Se=U.sku)!=null&&Se.trim())&&z.push("Barcode or SKU (at least one is required)"),z.length>0){e("error",`Please fill in the following required fields:

${z.map(cn=>` ${cn}`).join(`
`)}`,"Missing Required Fields");return}if(U.quantity<0){e("error","Quantity cannot be negative","Invalid Quantity");return}if(U.minLevel<0){e("error","Min Level cannot be negative","Invalid Min Level");return}try{const cn=ke.firestore.Timestamp.now(),Bi={...U,name:(Le=U.name)==null?void 0:Le.trim(),vendorName:(qe=U.vendorName)==null?void 0:qe.trim(),batchNumber:(st=U.batchNumber)==null?void 0:st.trim(),barcode:(($e=U.barcode)==null?void 0:$e.trim())||void 0,sku:((Ot=U.sku)==null?void 0:Ot.trim())||void 0,updatedAt:cn,status:(U.quantity||0)===0?"out_of_stock":(U.quantity||0)<(U.minLevel||0)?"low_stock":"in_stock",createdBy:((ai=Et.currentUser)==null?void 0:ai.email)||"admin"};W?(await Te.collection("inventory_items").doc(W.id).update(Bi),await Ia("UPDATE_INVENTORY","Inventory",`Updated item: ${U.name}`,Et.currentUser),s("success","Inventory item updated successfully")):(await Te.collection("inventory_items").add({...Bi,createdAt:cn}),await Ia("ADD_INVENTORY","Inventory",`Added new item: ${U.name}`,Et.currentUser),s("success","Inventory item added successfully")),j(!1),$(null),K({category:"General",unit:"pcs",status:"in_stock"})}catch(cn){console.error(cn),e("error","Failed to save item: "+(cn instanceof Error?cn.message:String(cn)),"Save Failed")}},X=z=>{L(z),D({quantity:0,unitPrice:z.purchasePrice||0,vendorName:z.vendorName||"",vendorPhone:z.vendorPhone||"",invoiceNumber:"",expiryDate:"",manufactureDate:"",remarks:""}),C(!0)},fe=async()=>{var z,pe,we;if(!M||F.quantity<=0){e("error","Please enter a valid quantity","Invalid Input");return}if(!((z=F.vendorName)!=null&&z.trim())){e("error","Please enter vendor name","Missing Vendor");return}try{const Ie=Te.batch(),H=M.batchNumber||"B0",ge=H.match(/\d+/),Se=ge?parseInt(ge[0])+1:1,Le=H.replace(/\d+/,Se.toString().padStart((ge==null?void 0:ge[0].length)||3,"0")),qe=Te.collection("inventory_batches").doc();Ie.set(qe,{id:qe.id,itemId:M.id,itemName:M.name,batchNumber:Le,quantityPurchased:F.quantity,unitPrice:F.unitPrice,totalCost:F.quantity*F.unitPrice,vendorName:F.vendorName,vendorPhone:F.vendorPhone||"",invoiceNumber:F.invoiceNumber||"",purchaseDate:ke.firestore.Timestamp.now(),expiryDate:F.expiryDate?ke.firestore.Timestamp.fromDate(new Date(F.expiryDate)):null,manufactureDate:F.manufactureDate?ke.firestore.Timestamp.fromDate(new Date(F.manufactureDate)):null,remarks:F.remarks||"",createdAt:ke.firestore.Timestamp.now(),createdBy:((pe=Et.currentUser)==null?void 0:pe.email)||"admin"});const st=Te.collection("inventory_items").doc(M.id);Ie.update(st,{quantity:ke.firestore.FieldValue.increment(F.quantity),batchNumber:Le,purchasePrice:F.unitPrice,vendorName:F.vendorName,vendorPhone:F.vendorPhone||"",purchaseDate:ke.firestore.Timestamp.now(),expiryDate:F.expiryDate?ke.firestore.Timestamp.fromDate(new Date(F.expiryDate)):M.expiryDate,updatedAt:ke.firestore.Timestamp.now()});const $e=Te.collection("inventory_transactions").doc();Ie.set($e,{itemId:M.id,itemName:M.name,type:"purchase",quantity:F.quantity,cost:F.quantity*F.unitPrice,performedBy:((we=Et.currentUser)==null?void 0:we.uid)||"admin",reason:`Purchase: Batch ${Le}`,timestamp:ke.firestore.Timestamp.now()}),await Ie.commit(),await Ia("PURCHASE_INVENTORY","Inventory",`Purchased ${F.quantity} x ${M.name} (Batch ${Le})`,Et.currentUser),s("success",`Successfully purchased ${F.quantity} ${M.unit}! New batch: ${Le}`),C(!1),L(null)}catch(Ie){console.error(Ie),e("error","Failed to record purchase: "+(Ie instanceof Error?Ie.message:String(Ie)),"Purchase Failed")}},Re=async z=>{var ge,Se;const pe=h.find(Le=>Le.id===z.itemId);if(!pe){e("error","Item not found","Error");return}if(pe.quantity<z.quantity){e("warning",`Insufficient stock. Available: ${pe.quantity} ${pe.unit}`,"Low Stock");return}const we=Math.min(z.quantity,pe.quantity),Ie=await i(`Approve and release quantity (max ${we}):`,{title:"Approve Request",defaultValue:we.toString(),placeholder:"Enter quantity"});if(!Ie)return;const H=parseInt(Ie);if(isNaN(H)||H<=0||H>we){e("error",`Invalid quantity. Must be between 1 and ${we}`,"Invalid Input");return}try{const Le=Te.batch(),qe=Te.collection("inventory_requests").doc(z.id);Le.update(qe,{status:"released",releasedQuantity:H,releasedAt:ke.firestore.Timestamp.now(),respondedBy:((ge=Et.currentUser)==null?void 0:ge.email)||"manager"});const st=Te.collection("inventory_items").doc(z.itemId);Le.update(st,{quantity:ke.firestore.FieldValue.increment(-H)});const $e=Te.collection("inventory_transactions").doc(),Ot=(pe.purchasePrice||0)*H;Le.set($e,{itemId:z.itemId,itemName:z.itemName,type:"issue",quantity:-H,cost:Ot,performedBy:((Se=Et.currentUser)==null?void 0:Se.uid)||"manager",reason:`Approved request from ${z.requesterName}: ${z.purpose}`,timestamp:ke.firestore.Timestamp.now()}),await Le.commit(),await Ia("APPROVE_REQUEST","Inventory",`Approved & released ${H} x ${z.itemName} to ${z.requesterName}`,Et.currentUser),s("success",`Request approved! ${H} items released from stock`)}catch(Le){console.error(Le),e("error","Failed to approve request: "+(Le instanceof Error?Le.message:String(Le)),"Approval Failed")}},Ke=async z=>{var Ie;if(!await t(`Reject inventory request from ${z.requesterName} for ${z.quantity} ${z.itemName}?`,{title:"Confirm Rejection",confirmText:"Reject",cancelText:"Cancel",type:"danger"}))return;const we=await i("Enter reason for rejection:",{title:"Rejection Reason",placeholder:"Why is this request being rejected?",defaultValue:""});if(!(we!=null&&we.trim())){e("warning","Rejection cancelled - reason is required","No Reason Provided");return}try{await Te.collection("inventory_requests").doc(z.id).update({status:"rejected",rejectionReason:we.trim(),rejectedAt:ke.firestore.Timestamp.now(),respondedBy:((Ie=Et.currentUser)==null?void 0:Ie.email)||"manager"}),await Ia("REJECT_REQUEST","Inventory",`Rejected request from ${z.requesterName}: ${we}`,Et.currentUser),s("success",`Request rejected. ${z.requesterName} will be notified.`)}catch(H){console.error(H),e("error","Failed to reject request: "+(H instanceof Error?H.message:String(H)),"Rejection Failed")}},nt=()=>f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Total Items"}),f.jsx(ur,{className:"w-5 h-5 text-indigo-600"})]}),f.jsx("p",{className:"text-3xl font-bold text-slate-800",children:ye.totalItems})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Low Stock"}),f.jsx(dg,{className:"w-5 h-5 text-amber-600"})]}),f.jsx("p",{className:"text-3xl font-bold text-amber-600",children:ye.lowStock})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Expired Items"}),f.jsx(lh,{className:"w-5 h-5 text-red-600"})]}),f.jsx("p",{className:"text-3xl font-bold text-red-600",children:ye.expired})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Total Value"}),f.jsx(Lc,{className:"w-5 h-5 text-green-600"})]}),f.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["$",ye.totalValue.toLocaleString()]})]})]}),(ye.lowStock>0||ye.expired>0||ye.expiringSoon>0)&&f.jsxs("div",{className:"bg-amber-50 p-4 rounded-xl border border-amber-100",children:[f.jsxs("h3",{className:"font-bold text-amber-900 mb-3 flex items-center gap-2",children:[f.jsx(lg,{className:"w-4 h-4"})," Inventory Alerts"]}),f.jsxs("div",{className:"space-y-2",children:[ye.lowStock>0&&f.jsxs("p",{className:"text-sm text-amber-700",children:[" ",ye.lowStock," items below minimum stock level"]}),ye.expired>0&&f.jsxs("p",{className:"text-sm text-red-700",children:[" ",ye.expired," items have expired"]}),ye.expiringSoon>0&&f.jsxs("p",{className:"text-sm text-amber-700",children:[" ",ye.expiringSoon," items expiring within 30 days"]})]}),f.jsx("button",{onClick:()=>u("items"),className:"mt-3 text-sm font-bold text-amber-900 hover:underline",children:"View Items "})]}),ye.pendingRequests>0&&f.jsxs("div",{className:"bg-indigo-50 p-4 rounded-xl border border-indigo-100",children:[f.jsxs("h3",{className:"font-bold text-indigo-900 mb-2 flex items-center gap-2",children:[f.jsx(Fd,{className:"w-4 h-4"})," Pending Requests"]}),f.jsxs("p",{className:"text-sm text-indigo-700",children:[ye.pendingRequests," requests awaiting your approval"]}),f.jsx("button",{onClick:()=>u("requests"),className:"mt-2 text-sm font-bold text-indigo-900 hover:underline",children:"Review Requests "})]})]}),G=()=>f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Inventory Items"}),f.jsxs("button",{onClick:()=>{$(null),K({category:"General",unit:"pcs"}),j(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2",children:[f.jsx(ka,{className:"w-4 h-4"})," Add Item"]})]}),O&&f.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[f.jsx("h3",{className:"font-bold text-lg mb-4",children:W?"Edit Item":"Add New Item"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[f.jsxs("div",{className:"col-span-2",children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Item Name *"}),f.jsx("input",{className:"w-full p-2 border rounded",value:U.name||"",onChange:z=>K({...U,name:z.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Category"}),f.jsx("select",{className:"w-full p-2 border rounded",value:U.category,onChange:z=>K({...U,category:z.target.value}),children:d$.map(z=>f.jsx("option",{value:z,children:z},z))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Unit"}),f.jsx("input",{className:"w-full p-2 border rounded",placeholder:"e.g., pcs, ml, boxes",value:U.unit||"",onChange:z=>K({...U,unit:z.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Quantity *"}),f.jsx("input",{type:"number",className:"w-full p-2 border rounded",value:U.quantity||"",onChange:z=>K({...U,quantity:parseInt(z.target.value)||0})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Min Level"}),f.jsx("input",{type:"number",className:"w-full p-2 border rounded",value:U.minLevel||"",onChange:z=>K({...U,minLevel:parseInt(z.target.value)||0})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Purchase Price ($)"}),f.jsx("input",{type:"number",step:"0.01",className:"w-full p-2 border rounded",value:U.purchasePrice||"",onChange:z=>K({...U,purchasePrice:parseFloat(z.target.value)||0})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Batch Number"}),f.jsx("input",{className:"w-full p-2 border rounded",value:U.batchNumber||"",onChange:z=>K({...U,batchNumber:z.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Expiry Date"}),f.jsx("input",{type:"date",className:"w-full p-2 border rounded",value:U.expiryDate&&U.expiryDate.toDate?U.expiryDate.toDate().toISOString().split("T")[0]:"",onChange:z=>K({...U,expiryDate:z.target.value?ke.firestore.Timestamp.fromDate(new Date(z.target.value)):void 0})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Barcode/SKU"}),f.jsx("input",{className:"w-full p-2 border rounded",value:U.barcode||U.sku||"",onChange:z=>K({...U,barcode:z.target.value})})]}),f.jsxs("div",{className:"col-span-2",children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Vendor"}),f.jsx("input",{className:"w-full p-2 border rounded",value:U.vendorName||"",onChange:z=>K({...U,vendorName:z.target.value})})]})]}),f.jsxs("div",{className:"flex justify-end gap-2",children:[f.jsx("button",{onClick:()=>j(!1),className:"px-4 py-2 text-slate-500",children:"Cancel"}),f.jsx("button",{onClick:Oe,className:"bg-indigo-600 text-white px-4 py-2 rounded font-bold",children:"Save"})]})]})}),A&&M&&f.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h3",{className:"font-bold text-lg",children:"Purchase More Stock"}),f.jsx("button",{onClick:()=>C(!1),className:"text-slate-400 hover:text-slate-600",children:f.jsx(Zc,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg mb-4 border border-indigo-100",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(ur,{className:"w-5 h-5 text-indigo-600"}),f.jsx("span",{className:"font-bold text-slate-800",children:M.name})]}),f.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-slate-500",children:"Current Stock:"})," ",f.jsxs("span",{className:"font-bold",children:[M.quantity," ",M.unit]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-slate-500",children:"Current Batch:"})," ",f.jsx("span",{className:"font-bold",children:M.batchNumber})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-slate-500",children:"SKU/Barcode:"})," ",f.jsx("span",{className:"font-bold",children:M.sku||M.barcode||"N/A"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Quantity Purchased *"}),f.jsx("input",{type:"number",min:"1",className:"w-full p-2 border rounded",placeholder:"Enter quantity",value:F.quantity||"",onChange:z=>D({...F,quantity:parseInt(z.target.value)||0}),autoFocus:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Unit Price ($) *"}),f.jsx("input",{type:"number",step:"0.01",min:"0",className:"w-full p-2 border rounded",placeholder:"Price per unit",value:F.unitPrice||"",onChange:z=>D({...F,unitPrice:parseFloat(z.target.value)||0})})]}),f.jsxs("div",{className:"col-span-2 bg-slate-50 p-3 rounded border border-slate-200",children:[f.jsx("span",{className:"text-sm text-slate-600",children:"Total Cost:"})," ",f.jsxs("span",{className:"font-bold text-lg text-slate-800",children:["$",(F.quantity*F.unitPrice).toFixed(2)]})]}),f.jsxs("div",{className:"col-span-2",children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Vendor Name *"}),f.jsx("input",{type:"text",className:"w-full p-2 border rounded",placeholder:"Enter or confirm vendor",value:F.vendorName,onChange:z=>D({...F,vendorName:z.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Vendor Phone"}),f.jsx("input",{type:"tel",className:"w-full p-2 border rounded",placeholder:"Optional",value:F.vendorPhone,onChange:z=>D({...F,vendorPhone:z.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Invoice Number"}),f.jsx("input",{type:"text",className:"w-full p-2 border rounded",placeholder:"Optional",value:F.invoiceNumber,onChange:z=>D({...F,invoiceNumber:z.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Manufacture Date"}),f.jsx("input",{type:"date",className:"w-full p-2 border rounded",value:F.manufactureDate,onChange:z=>D({...F,manufactureDate:z.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Expiry Date"}),f.jsx("input",{type:"date",className:"w-full p-2 border rounded",value:F.expiryDate,onChange:z=>D({...F,expiryDate:z.target.value})})]}),f.jsxs("div",{className:"col-span-2",children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Remarks"}),f.jsx("textarea",{className:"w-full p-2 border rounded",rows:2,placeholder:"Optional notes",value:F.remarks,onChange:z=>D({...F,remarks:z.target.value})})]})]}),f.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[f.jsx("button",{onClick:()=>C(!1),className:"px-4 py-2 text-slate-500 hover:bg-slate-100 rounded",children:"Cancel"}),f.jsxs("button",{onClick:fe,className:"bg-green-600 text-white px-6 py-2 rounded font-bold hover:bg-green-700 flex items-center gap-2",children:[f.jsx(ka,{className:"w-4 h-4"})," Confirm Purchase"]})]})]})}),f.jsx("div",{className:"bg-white rounded-xl border border-slate-200 flex-1 overflow-hidden shadow-sm flex flex-col",children:f.jsx("div",{className:"overflow-y-auto flex-1",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Item Name"}),f.jsx("th",{className:"p-4",children:"Category"}),f.jsx("th",{className:"p-4",children:"Stock"}),f.jsx("th",{className:"p-4",children:"Batch"}),f.jsx("th",{className:"p-4",children:"Expiry"}),f.jsx("th",{className:"p-4",children:"Value"}),f.jsx("th",{className:"p-4",children:"Status"}),f.jsx("th",{className:"p-4 text-right",children:"Actions"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-50",children:h.map(z=>{const pe=z.expiryDate&&(z.expiryDate.toDate?z.expiryDate.toDate():new Date(z.expiryDate))<new Date;return f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsxs("td",{className:"p-4 font-bold text-slate-800",children:[z.name,f.jsx("div",{className:"text-xs text-slate-400 font-normal",children:z.vendorName||"No vendor"})]}),f.jsx("td",{className:"p-4 text-slate-500",children:z.category}),f.jsxs("td",{className:"p-4 font-mono font-bold",children:[z.quantity," ",f.jsx("span",{className:"text-xs text-slate-400 font-normal",children:z.unit})]}),f.jsx("td",{className:"p-4 text-xs text-slate-500",children:z.batchNumber||"-"}),f.jsx("td",{className:"p-4 text-xs text-slate-500",children:z.expiryDate?Ln(z.expiryDate):"-"}),f.jsxs("td",{className:"p-4 font-mono text-slate-600",children:["$",((z.purchasePrice||0)*z.quantity).toLocaleString()]}),f.jsx("td",{className:"p-4",children:f.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${pe?"bg-red-100 text-red-700":z.quantity===0?"bg-gray-100 text-gray-700":z.quantity<z.minLevel?"bg-amber-100 text-amber-700":"bg-green-100 text-green-700"}`,children:pe?"Expired":z.quantity===0?"Out":z.quantity<z.minLevel?"Low":"OK"})}),f.jsx("td",{className:"p-4 text-right",children:f.jsxs("button",{onClick:()=>X(z),className:"text-green-600 hover:bg-green-50 p-2 rounded font-bold text-sm flex items-center gap-1 ml-auto",children:[f.jsx(ka,{className:"w-4 h-4"})," Purchase More"]})})]},z.id)})})]})})})]}),le=()=>{var we,Ie;const z=a?_:_.filter(H=>{var ge;return H.requesterId===(((ge=Et.currentUser)==null?void 0:ge.uid)||"")}),pe=a?_.filter(H=>H.status==="pending"):[];return f.jsxs("div",{className:"space-y-6",children:[!a&&f.jsx(VD,{isOpen:!0,onClose:()=>{},userId:((we=Et.currentUser)==null?void 0:we.uid)||"user",userName:((Ie=Et.currentUser)==null?void 0:Ie.email)||"User",userRole:n}),a&&pe.length>0&&f.jsxs("div",{children:[f.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:["Pending Approvals (",pe.length,")"]}),f.jsx("div",{className:"space-y-3",children:pe.map(H=>{const ge=h.find(Le=>Le.id===H.itemId),Se=ge?ge.quantity:0;return f.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex justify-between items-start",children:[f.jsxs("div",{children:[f.jsxs("p",{className:"font-bold text-slate-800",children:[H.itemName," ",f.jsxs("span",{className:"text-sm font-normal text-slate-500",children:["(x",H.quantity,")"]})]}),f.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Requested by: ",H.requesterName," (",H.requesterRole,")"]}),f.jsxs("p",{className:"text-xs text-slate-500",children:["Reason: ",H.purpose]}),f.jsxs("p",{className:"text-xs text-slate-600 mt-1",children:["Available: ",Se," ",(ge==null?void 0:ge.unit)||"units"]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>Re(H),className:"bg-green-600 text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-green-700",children:[f.jsx(BT,{className:"w-3 h-3 inline mr-1"})," Approve"]}),f.jsxs("button",{onClick:()=>Ke(H),className:"bg-red-600 text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-red-700",children:[f.jsx(lh,{className:"w-3 h-3 inline mr-1"})," Reject"]})]})]},H.id)})})]}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:a?"All Requests":"My Request History"}),f.jsx("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg- slate-50 border-b",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Date"}),f.jsx("th",{className:"p-4",children:"Item"}),f.jsx("th",{className:"p-4",children:"Qty"}),a&&f.jsx("th",{className:"p-4",children:"Requester"}),f.jsx("th",{className:"p-4",children:"Purpose"}),f.jsx("th",{className:"p-4",children:"Status"})]})}),f.jsx("tbody",{className:"divide-y",children:z.map(H=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 text-xs text-slate-500",children:Ln(H.createdAt)}),f.jsx("td",{className:"p-4 font-bold text-slate-700",children:H.itemName}),f.jsx("td",{className:"p-4",children:H.quantity}),a&&f.jsx("td",{className:"p-4 text-slate-600",children:H.requesterName}),f.jsx("td",{className:"p-4 text-slate-600 text-xs",children:H.purpose}),f.jsx("td",{className:"p-4",children:f.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${H.status==="pending"?"bg-blue-100 text-blue-700":H.status==="released"?"bg-green-100 text-green-700":H.status==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:H.status})})]},H.id))})]})})]})]})};return a?f.jsxs("div",{className:"p-6 h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[f.jsx(ur,{className:"w-6 h-6 text-indigo-600"})," Inventory Management"]}),f.jsx("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[{id:"dashboard",label:"Dashboard",icon:cg},{id:"items",label:"Items",icon:ur},{id:"requests",label:"Requests",icon:Fd},{id:"wastage",label:"Wastage",icon:GT}].map(z=>f.jsxs("button",{onClick:()=>u(z.id),className:`px-3 py-1.5 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${l===z.id?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-800"}`,children:[f.jsx(z.icon,{className:"w-4 h-4"})," ",f.jsx("span",{children:z.label})]},z.id))})]}),f.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto",children:[l==="dashboard"&&nt(),l==="items"&&G(),l==="requests"&&le(),l==="wastage"&&f.jsx("div",{className:"bg-white p-8 rounded-xl border text-center text-slate-400",children:"Wastage tracking coming soon..."})]})]}):f.jsxs("div",{className:"p-6 h-full",children:[f.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[f.jsx(Fd,{className:"w-6 h-6 text-indigo-600"})," Request Inventory"]}),le()]})},N$=({onBack:n})=>{const[e,t]=oe.useState([]),[i,s]=oe.useState(!1),[a,l]=oe.useState({role:"receptionist",status:"active"});oe.useEffect(()=>{const m=Te.collection("users").onSnapshot(_=>t(_.docs.map(T=>({id:T.id,...T.data()}))));return()=>m()},[]);const u=async()=>{if(!(!a.username||!a.password))try{await Te.collection("users").add({...a,createdAt:ke.firestore.Timestamp.now()}),s(!1),l({role:"receptionist",status:"active"})}catch(m){console.error(m)}},h=async m=>{window.confirm("Remove user?")&&await Te.collection("users").doc(m).delete()};return f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"User Management"}),f.jsxs("button",{onClick:()=>s(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2",children:[f.jsx(hg,{className:"w-4 h-4"})," Add User"]})]}),i&&f.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-md",children:[f.jsx("h3",{className:"font-bold text-lg mb-4",children:"Create New User"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Full Name"}),f.jsx("input",{className:"w-full p-2 border rounded",value:a.fullName||"",onChange:m=>l({...a,fullName:m.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Username"}),f.jsx("input",{className:"w-full p-2 border rounded",value:a.username||"",onChange:m=>l({...a,username:m.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Password"}),f.jsx("input",{className:"w-full p-2 border rounded",type:"password",value:a.password||"",onChange:m=>l({...a,password:m.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Role"}),f.jsx("select",{className:"w-full p-2 border rounded",value:a.role,onChange:m=>l({...a,role:m.target.value}),children:mp.filter(m=>!m.disabled).map(m=>f.jsx("option",{value:m.id,children:m.label},m.id))})]})]}),f.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[f.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 text-slate-500",children:"Cancel"}),f.jsx("button",{onClick:u,className:"bg-indigo-600 text-white px-4 py-2 rounded font-bold",children:"Create User"})]})]})}),f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex-1 overflow-hidden flex flex-col",children:f.jsx("div",{className:"overflow-y-auto flex-1",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Name"}),f.jsx("th",{className:"p-4",children:"Username"}),f.jsx("th",{className:"p-4",children:"Role"}),f.jsx("th",{className:"p-4",children:"Status"}),f.jsx("th",{className:"p-4 text-right",children:"Action"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-50",children:e.map(m=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 font-bold text-slate-800",children:m.fullName}),f.jsx("td",{className:"p-4 text-slate-600",children:m.username}),f.jsx("td",{className:"p-4 capitalize text-slate-600",children:m.role}),f.jsx("td",{className:"p-4",children:f.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${m.status==="active"?"bg-green-100 text-green-700":"bg-slate-100 text-slate-500"}`,children:m.status})}),f.jsx("td",{className:"p-4 text-right",children:f.jsx("button",{onClick:()=>h(m.id),className:"text-red-500 hover:bg-red-50 p-2 rounded",children:f.jsx(ug,{className:"w-4 h-4"})})})]},m.id))})]})})})]})},C$=({onBack:n})=>{const[e,t]=oe.useState([]),[i,s]=oe.useState(!1),[a,l]=oe.useState({isActive:!0,category:"General",sampleType:"Blood"});oe.useEffect(()=>{const _=Te.collection("tests").onSnapshot(T=>t(T.docs.map(E=>({id:E.id,...E.data()}))));return()=>_()},[]);const u=async()=>{if(!(!a.name||!a.code||!a.price))try{await Te.collection("tests").add({...a,parameters:[],createdAt:ke.firestore.Timestamp.now()}),s(!1),l({isActive:!0,category:"General",sampleType:"Blood"})}catch(_){console.error(_)}},h=async _=>{await Te.collection("tests").doc(_.id).update({isActive:!_.isActive})},m=async _=>{window.confirm("Delete test?")&&await Te.collection("tests").doc(_).delete()};return f.jsxs("div",{className:"p-6 h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Test Catalog"}),f.jsxs("button",{onClick:()=>s(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2",children:[f.jsx(ka,{className:"w-4 h-4"})," Add Test"]})]}),i&&f.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-lg",children:[f.jsx("h3",{className:"font-bold text-lg mb-4",children:"Add New Test"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[f.jsxs("div",{className:"col-span-2",children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Test Name"}),f.jsx("input",{className:"w-full p-2 border rounded",value:a.name||"",onChange:_=>l({...a,name:_.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Test Code"}),f.jsx("input",{className:"w-full p-2 border rounded",value:a.code||"",onChange:_=>l({...a,code:_.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Price ($)"}),f.jsx("input",{type:"number",className:"w-full p-2 border rounded",value:a.price||"",onChange:_=>l({...a,price:parseFloat(_.target.value)})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Sample Type"}),f.jsxs("select",{className:"w-full p-2 border rounded",value:a.sampleType,onChange:_=>l({...a,sampleType:_.target.value}),children:[f.jsx("option",{children:"Blood"}),f.jsx("option",{children:"Urine"}),f.jsx("option",{children:"Stool"}),f.jsx("option",{children:"Swab"}),f.jsx("option",{children:"Tissue"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Category"}),f.jsx("input",{className:"w-full p-2 border rounded",value:a.category||"",onChange:_=>l({...a,category:_.target.value})})]})]}),f.jsxs("div",{className:"flex justify-end gap-2",children:[f.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 text-slate-500",children:"Cancel"}),f.jsx("button",{onClick:u,className:"bg-indigo-600 text-white px-4 py-2 rounded font-bold",children:"Save Test"})]})]})}),f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex-1 overflow-hidden flex flex-col",children:f.jsx("div",{className:"overflow-y-auto flex-1",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Name"}),f.jsx("th",{className:"p-4",children:"Code"}),f.jsx("th",{className:"p-4",children:"Price"}),f.jsx("th",{className:"p-4",children:"Category"}),f.jsx("th",{className:"p-4",children:"Status"}),f.jsx("th",{className:"p-4 text-right",children:"Action"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-50",children:e.map(_=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 font-bold text-slate-800",children:_.name}),f.jsx("td",{className:"p-4 text-xs font-mono text-slate-500",children:_.code}),f.jsxs("td",{className:"p-4 font-bold text-slate-800",children:["$",_.price]}),f.jsx("td",{className:"p-4 text-slate-500",children:_.category}),f.jsx("td",{className:"p-4",children:f.jsx("button",{onClick:()=>h(_),className:`flex items-center gap-1 text-xs font-bold px-2 py-1 rounded ${_.isActive?"bg-green-100 text-green-700":"bg-slate-100 text-slate-500"}`,children:_.isActive?"Active":"Inactive"})}),f.jsx("td",{className:"p-4 text-right",children:f.jsx("button",{onClick:()=>m(_.id),className:"text-red-500 hover:bg-red-50 p-2 rounded",children:f.jsx(ug,{className:"w-4 h-4"})})})]},_.id))})]})})})]})},R$=({onBack:n,onNavigate:e})=>f.jsxs("div",{className:"h-full flex flex-col p-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-6",children:"Admin Finance Control"}),f.jsx("div",{className:"flex-1 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:f.jsx(UD,{})})]}),P$=({onBack:n})=>f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-800",children:"Analytics & Reports"}),f.jsxs("div",{className:"bg-white p-12 text-center rounded-xl border border-slate-200 flex flex-col items-center justify-center flex-1",children:[f.jsx(zT,{className:"w-16 h-16 text-slate-200 mb-4"}),f.jsx("p",{className:"text-slate-500 font-medium",children:"Detailed analytics module is currently under development."}),f.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Please use the Finance or Dashboard views for current summaries."})]})]}),D$=({onBack:n})=>{const[e,t]=oe.useState([]);return oe.useEffect(()=>{const i=Te.collection("audit_logs").orderBy("timestamp","desc").limit(50).onSnapshot(s=>t(s.docs.map(a=>({id:a.id,...a.data()}))));return()=>i()},[]),f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-800",children:"System Audit Logs"}),f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex-1 overflow-hidden flex flex-col",children:f.jsx("div",{className:"overflow-y-auto flex-1",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Time"}),f.jsx("th",{className:"p-4",children:"User"}),f.jsx("th",{className:"p-4",children:"Action"}),f.jsx("th",{className:"p-4",children:"Details"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-50",children:e.map(i=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 text-xs font-mono text-slate-500",children:m$(i.timestamp)}),f.jsx("td",{className:"p-4 font-bold text-slate-800",children:i.userName}),f.jsx("td",{className:"p-4 font-bold text-indigo-600",children:i.action}),f.jsx("td",{className:"p-4 text-slate-600",children:i.details})]},i.id))})]})})})]})},M$=({onBack:n})=>f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-800",children:"System Configuration"}),f.jsxs("div",{className:"bg-white p-8 rounded-xl border border-slate-200 max-w-2xl space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-bold text-slate-700 mb-2",children:"Laboratory Name"}),f.jsx("input",{className:"border border-slate-300 p-3 rounded-lg w-full outline-none focus:ring-2 focus:ring-indigo-500",defaultValue:"LabPro Diagnostics"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-bold text-slate-700 mb-2",children:"Address"}),f.jsx("input",{className:"border border-slate-300 p-3 rounded-lg w-full outline-none focus:ring-2 focus:ring-indigo-500",defaultValue:"123 Medical Plaza, NY"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-bold text-slate-700 mb-2",children:"Contact Phone"}),f.jsx("input",{className:"border border-slate-300 p-3 rounded-lg w-full outline-none focus:ring-2 focus:ring-indigo-500",defaultValue:"+1 (555) 123-4567"})]}),f.jsx("div",{className:"pt-4",children:f.jsx("button",{className:"bg-indigo-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-indigo-700 transition-colors",children:"Save Changes"})})]})]}),k$=({onBack:n})=>{const[e,t]=oe.useState("dashboard"),[i,s]=oe.useState([]),[a,l]=oe.useState(!1),[u,h]=oe.useState({todayPatients:0,todayOrders:0,pendingPayments:0,completed:0,todaySales:0}),[m,_]=oe.useState([]),[T,E]=oe.useState(""),[S,k]=oe.useState([]),[V,O]=oe.useState([]),[j,W]=oe.useState(null),[$,U]=oe.useState(null),[K,J]=oe.useState({fullName:"",phone:"",age:"",ageUnit:"Years",gender:"male",address:"",referralType:"self",doctorName:"",clinicName:"",existingId:""}),[R,A]=oe.useState([]),[C,M]=oe.useState({method:"cash",paidAmount:"",discount:0,discountReason:""}),[L,F]=oe.useState(""),[D,ye]=oe.useState("All"),Oe=R.reduce((H,ge)=>H+ge.price,0),X=Math.max(0,Oe-C.discount),fe=parseFloat(C.paidAmount)||0,Re=Math.max(0,X-fe);oe.useEffect(()=>{M(H=>({...H,paidAmount:X.toString()}))},[X]),oe.useEffect(()=>{const H=Te.collection("tests").where("isActive","==",!0).onSnapshot(st=>s(st.docs.map($e=>({id:$e.id,...$e.data()})))),ge=Te.collection("doctors").where("status","==","active").onSnapshot(st=>_(st.docs.map($e=>({id:$e.id,...$e.data()})))),Se=new Date;Se.setHours(0,0,0,0);const Le=ke.firestore.Timestamp.fromDate(Se),qe=Te.collection("orders").where("createdAt",">=",Le).onSnapshot(st=>{const $e=st.docs.reduce((Ot,ai)=>Ot+(ai.data().totalAmount||0),0);h(Ot=>({...Ot,todayOrders:st.size,todaySales:$e}))});return()=>{H(),qe(),ge()}},[]),oe.useEffect(()=>{const H=Te.collection("samples").orderBy("createdAt","desc").limit(20).onSnapshot(ge=>{const Se=ge.docs.map($e=>({id:$e.id,...$e.data()}));k(Se);const Le=[];Se.filter($e=>$e.status==="rejected").forEach($e=>{Le.push({id:$e.id,text:`Sample rejected for ${$e.patientName} (${$e.testName})`,type:"alert"})});const st=Se.filter($e=>$e.status==="reported").length;st>0&&Le.push({id:"reports-ready",text:`${st} recent reports ready for printing.`,type:"info"}),O(Le)});return()=>H()},[]);const Ke=async(H=!1)=>{const ge=K.phone.trim();if(!(ge.length<3)){l(!0);try{const Se=await Te.collection("patients").where("phone",">=",ge).limit(1).get();if(Se.empty)H||alert("Patient not found. Please enter details manually.");else{const Le=Se.docs[0].data();let qe="",st="Years";Le.dob&&(qe=pp(Le.dob).toString()),J($e=>({...$e,fullName:Le.fullName,gender:Le.gender,address:Le.address||"",age:qe,existingId:Se.docs[0].id})),H||alert("Patient Found: "+Le.fullName)}}catch(Se){console.error(Se),H||alert("Error searching for patient.")}finally{l(!1)}}},nt=i.filter(H=>{const ge=H.name.toLowerCase().includes(L.toLowerCase())||H.code.toLowerCase().includes(L.toLowerCase()),Se=D==="All"||H.category===D;return ge&&Se}),G=["All",...Array.from(new Set(i.map(H=>H.category||"General")))],le=async()=>{if(!K.fullName||R.length===0){alert("Please enter patient details and select at least one test.");return}l(!0);try{let H=K.existingId,ge=new Date;if(K.age){const un=parseInt(K.age);K.ageUnit==="Years"&&ge.setFullYear(ge.getFullYear()-un),K.ageUnit==="Months"&&ge.setMonth(ge.getMonth()-un),K.ageUnit==="Days"&&ge.setDate(ge.getDate()-un)}const Se=ge.toISOString().split("T")[0],Le={fullName:K.fullName,phone:K.phone,gender:K.gender,address:K.address,dob:Se,updatedAt:ke.firestore.Timestamp.now()};H?await Te.collection("patients").doc(H).update(Le):H=(await Te.collection("patients").add({...Le,createdAt:ke.firestore.Timestamp.now()})).id;let qe="Self",st=null,$e=0;if(K.referralType==="doctor"&&T){const un=m.find(Ct=>Ct.id===T);un&&(qe=un.name,st=un.id,$e=X*(un.commissionRate||0)/100)}else K.referralType==="doctor"&&K.doctorName&&(qe=K.doctorName);const Ot=Re===0?"paid":fe>0?"partial":"unpaid",ai=await Te.collection("orders").add({patientId:H,patientName:K.fullName,doctorName:qe,doctorId:st,doctorCommission:$e,commissionPaid:!1,totalAmount:X,status:"ordered",paymentStatus:Ot,testCount:R.length,createdAt:ke.firestore.Timestamp.now()}),cn=await Te.collection("invoices").add({orderId:ai.id,patientName:K.fullName,amount:X,discount:C.discount,paidAmount:fe,status:Ot,createdAt:ke.firestore.Timestamp.now(),payments:fe>0?[{amount:fe,method:C.method,date:new Date}]:[]}),Bi=Te.batch();R.forEach(un=>{const Ct=Te.collection("samples").doc();Bi.set(Ct,{orderId:ai.id,patientId:H,patientName:K.fullName,testId:un.id,testName:un.name,sampleType:un.sampleType,status:"ordered",createdAt:ke.firestore.Timestamp.now()})}),await Bi.commit(),W({invoiceId:cn.id,patientName:K.fullName,patientPhone:K.phone,age:K.age+" "+K.ageUnit,gender:K.gender,date:new Date().toLocaleDateString(),doctor:qe,items:[...R],subtotal:Oe,discount:C.discount,total:X,paid:fe,due:Re,paymentMethod:C.method}),A([]),J({fullName:"",phone:"",age:"",ageUnit:"Years",gender:"male",address:"",referralType:"self",doctorName:"",clinicName:"",existingId:""}),M({method:"cash",paidAmount:"",discount:0,discountReason:""}),E("")}catch(H){console.error(H),alert("Failed to book order.")}finally{l(!1)}},z=H=>{let ge="";H.dob&&(ge=pp(H.dob).toString()),J({fullName:H.fullName,phone:H.phone,age:ge,ageUnit:"Years",gender:H.gender,address:H.address||"",referralType:"self",doctorName:"",clinicName:"",existingId:H.id}),t("new-order")},pe=async H=>{const ge=prompt("Enter rejection reason (e.g., Hemolyzed, Wrong Tube):");if(ge)try{await Te.collection("samples").doc(H.id).update({status:"ordered",notes:`RECOLLECTION REQUESTED: ${ge}`,rejectedAt:ke.firestore.Timestamp.now(),rejectedBy:"Receptionist"}),alert("Sample flagged for recollection.")}catch(Se){console.error(Se),alert("Failed to reject sample")}},we=()=>f.jsxs("div",{className:"h-full flex flex-col md:flex-row overflow-hidden",children:[f.jsxs("div",{className:"w-full md:w-1/3 bg-white border-r border-slate-200 overflow-y-auto p-6 scrollbar-thin",children:[f.jsxs("h3",{className:"font-bold text-lg mb-6 flex items-center gap-2 text-slate-800",children:[f.jsx(n$,{className:"w-5 h-5 text-indigo-600"})," Patient Details"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Phone Number"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("div",{className:"relative flex-1",children:[f.jsx(kD,{className:"w-4 h-4 absolute left-3 top-3 text-slate-400"}),f.jsx("input",{type:"tel",value:K.phone,onChange:H=>J({...K,phone:H.target.value}),onBlur:()=>Ke(!0),placeholder:"Search or Enter Phone",className:"w-full pl-9 p-2.5 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none transition-all"})]}),f.jsx("button",{onClick:()=>Ke(),className:"bg-indigo-100 text-indigo-600 p-2.5 rounded-lg hover:bg-indigo-200 transition-colors",children:f.jsx(Od,{className:"w-4 h-4"})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Full Name"}),f.jsx("input",{value:K.fullName,onChange:H=>J({...K,fullName:H.target.value}),placeholder:"Patient Name",className:"w-full p-2.5 bg-white border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none"})]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Age"}),f.jsxs("div",{className:"flex",children:[f.jsx("input",{type:"number",value:K.age,onChange:H=>J({...K,age:H.target.value}),className:"w-full p-2.5 border border-r-0 border-slate-200 rounded-l-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none"}),f.jsxs("select",{value:K.ageUnit,onChange:H=>J({...K,ageUnit:H.target.value}),className:"bg-slate-100 border border-slate-200 rounded-r-lg text-xs px-2 outline-none text-slate-600 font-medium",children:[f.jsx("option",{children:"Years"}),f.jsx("option",{children:"Months"}),f.jsx("option",{children:"Days"})]})]})]}),f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Gender"}),f.jsxs("select",{value:K.gender,onChange:H=>J({...K,gender:H.target.value}),className:"w-full p-2.5 bg-white border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none",children:[f.jsx("option",{value:"male",children:"Male"}),f.jsx("option",{value:"female",children:"Female"}),f.jsx("option",{value:"other",children:"Other"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Referral By"}),f.jsxs("div",{className:"flex p-1 bg-slate-100 rounded-lg mb-2",children:[f.jsx("button",{onClick:()=>J({...K,referralType:"self"}),className:`flex-1 py-1.5 text-xs font-bold rounded-md transition-all ${K.referralType==="self"?"bg-white text-indigo-600 shadow-sm":"text-slate-500"}`,children:"Self"}),f.jsx("button",{onClick:()=>J({...K,referralType:"doctor"}),className:`flex-1 py-1.5 text-xs font-bold rounded-md transition-all ${K.referralType==="doctor"?"bg-white text-indigo-600 shadow-sm":"text-slate-500"}`,children:"Doctor"})]}),K.referralType==="doctor"&&f.jsxs("div",{className:"animate-in fade-in slide-in-from-top-1 space-y-2",children:[f.jsxs("select",{value:T,onChange:H=>{E(H.target.value),H.target.value&&J({...K,doctorName:""})},className:"w-full p-2.5 bg-white border border-slate-200 rounded-lg text-sm outline-none",children:[f.jsx("option",{value:"",children:"-- Select Registered Doctor --"}),m.map(H=>f.jsxs("option",{value:H.id,children:[H.name," (",H.clinic,")"]},H.id))]}),f.jsx("p",{className:"text-center text-xs text-slate-400 font-bold",children:"- OR -"}),f.jsx("input",{value:K.doctorName,onChange:H=>{J({...K,doctorName:H.target.value}),E("")},placeholder:"Enter Manual Name",className:"w-full p-2.5 bg-white border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none"})]})]})]}),f.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-200",children:[f.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2 text-slate-800",children:[f.jsx(g7,{className:"w-5 h-5 text-indigo-600"})," Payment"]}),f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-100 space-y-3",children:[f.jsxs("div",{className:"flex justify-between text-sm text-slate-600",children:[f.jsxs("span",{children:["Subtotal (",R.length," tests)"]}),f.jsxs("span",{className:"font-mono font-bold",children:["$",Oe]})]}),f.jsxs("div",{className:"flex justify-between items-center text-sm text-slate-600",children:[f.jsx("span",{children:"Discount"}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-slate-400 font-bold",children:"-"}),f.jsx("input",{type:"number",value:C.discount,onChange:H=>M({...C,discount:parseFloat(H.target.value)||0}),className:"w-16 p-1 text-right border rounded bg-white font-mono text-xs"})]})]}),f.jsxs("div",{className:"flex justify-between items-center text-lg font-bold text-slate-900 pt-3 border-t border-slate-200",children:[f.jsx("span",{children:"Total Payable"}),f.jsxs("span",{children:["$",X]})]})]}),f.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Amount Paid"}),f.jsxs("div",{className:"relative",children:[f.jsx("span",{className:"absolute left-3 top-2.5 text-slate-400 font-bold",children:"$"}),f.jsx("input",{type:"number",value:C.paidAmount,onChange:H=>M({...C,paidAmount:H.target.value}),className:"w-full pl-6 pr-2 py-2 border border-slate-200 rounded-lg text-sm font-bold text-slate-800 focus:ring-2 focus:ring-green-500 outline-none"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Method"}),f.jsxs("select",{value:C.method,onChange:H=>M({...C,method:H.target.value}),className:"w-full p-2 border border-slate-200 rounded-lg text-sm outline-none bg-white",children:[f.jsx("option",{value:"cash",children:"Cash"}),f.jsx("option",{value:"card",children:"Card"}),f.jsx("option",{value:"upi",children:"UPI/Online"})]})]})]}),f.jsxs("div",{className:"mt-6",children:[f.jsxs("button",{onClick:le,disabled:a||R.length===0||!K.fullName,className:"w-full bg-indigo-600 text-white py-3.5 rounded-xl font-bold shadow-lg shadow-indigo-200 hover:bg-indigo-700 disabled:opacity-50 disabled:shadow-none transition-all flex justify-center items-center gap-2",children:[a?f.jsx(Qa,{className:"w-5 h-5 animate-spin"}):f.jsx(Ei,{className:"w-5 h-5"})," Confirm Order"]}),R.length===0&&f.jsx("p",{className:"text-xs text-center text-slate-400 mt-2",children:"Add tests to proceed"})]})]})]}),f.jsxs("div",{className:"flex-1 bg-slate-50 flex flex-col h-full overflow-hidden",children:[f.jsx("div",{className:"p-4 bg-white border-b border-slate-200 shadow-sm z-10",children:f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-bold text-lg text-slate-800",children:"Test Catalog"}),f.jsxs("p",{className:"text-xs text-slate-500",children:[R.length," tests selected"]})]}),f.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[f.jsxs("div",{className:"relative flex-1 sm:w-64",children:[f.jsx(Od,{className:"w-4 h-4 absolute left-3 top-2.5 text-slate-400"}),f.jsx("input",{value:L,onChange:H=>F(H.target.value),placeholder:"Search test name or code...",className:"w-full pl-9 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none"})]}),f.jsx("select",{value:D,onChange:H=>ye(H.target.value),className:"p-2 border border-slate-200 rounded-lg text-sm outline-none bg-slate-50 max-w-[140px]",children:G.map(H=>f.jsx("option",{value:H,children:H},H))})]})]})}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:nt.map(H=>{const ge=R.some(Se=>Se.id===H.id);return f.jsxs("div",{onClick:()=>{A(ge?R.filter(Se=>Se.id!==H.id):[...R,H])},className:`bg-white p-4 rounded-xl border cursor-pointer transition-all group ${ge?"border-indigo-500 ring-1 ring-indigo-500 bg-indigo-50/50":"border-slate-200 hover:border-indigo-300 hover:shadow-md"}`,children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsx("h4",{className:"font-bold text-sm text-slate-800 line-clamp-2 leading-tight pr-2",children:H.name}),f.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center shrink-0 transition-colors ${ge?"bg-indigo-600 border-indigo-600":"border-slate-300 bg-white group-hover:border-indigo-400"}`,children:ge&&f.jsx(BT,{className:"w-3 h-3 text-white"})})]}),f.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[f.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider bg-slate-100 text-slate-500 px-1.5 py-0.5 rounded",children:H.code}),f.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider bg-slate-100 text-slate-500 px-1.5 py-0.5 rounded",children:H.sampleType})]}),f.jsxs("div",{className:"flex justify-between items-end border-t border-slate-100 pt-2 mt-auto",children:[f.jsx("span",{className:"text-[10px] font-medium text-slate-400",children:H.category}),f.jsxs("span",{className:"font-bold text-slate-800",children:["$",H.price]})]})]},H.id)})}),nt.length===0&&f.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-slate-400",children:[f.jsx($T,{className:"w-12 h-12 mb-3 opacity-20"}),f.jsx("p",{children:"No tests found matching your search."})]})]})]})]}),Ie=()=>f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-in fade-in p-6",children:[f.jsxs("div",{className:"lg:col-span-3 grid grid-cols-1 md:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase",children:"Today's Orders"}),f.jsx("p",{className:"text-2xl font-bold text-slate-800",children:u.todayOrders})]}),f.jsx("div",{className:"w-10 h-10 bg-indigo-50 text-indigo-600 rounded-full flex items-center justify-center",children:f.jsx(f7,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase",children:"Pending Dues"}),f.jsx("p",{className:"text-2xl font-bold text-amber-600",children:"3"})]}),f.jsx("div",{className:"w-10 h-10 bg-amber-50 text-amber-600 rounded-full flex items-center justify-center",children:f.jsx(GT,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase",children:"Completed"}),f.jsx("p",{className:"text-2xl font-bold text-green-600",children:"12"})]}),f.jsx("div",{className:"w-10 h-10 bg-green-50 text-green-600 rounded-full flex items-center justify-center",children:f.jsx(Ei,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase",children:"Revenue Today"}),f.jsxs("p",{className:"text-2xl font-bold text-slate-800",children:["$",u.todaySales.toLocaleString()]})]}),f.jsx("div",{className:"w-10 h-10 bg-blue-50 text-blue-600 rounded-full flex items-center justify-center",children:f.jsx(Lc,{className:"w-5 h-5"})})]})]}),f.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[f.jsxs("button",{onClick:()=>t("new-order"),className:"p-6 bg-indigo-600 text-white rounded-xl shadow-lg shadow-indigo-200 hover:bg-indigo-700 transition-all text-left group",children:[f.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:f.jsx(ka,{className:"w-6 h-6"})}),f.jsx("h3",{className:"font-bold text-lg",children:"Book New Order"}),f.jsx("p",{className:"text-indigo-200 text-sm mt-1",children:"Register patient & tests"})]}),f.jsxs("button",{onClick:()=>t("reports"),className:"p-6 bg-white border border-slate-200 rounded-xl hover:border-indigo-200 hover:shadow-md transition-all text-left group",children:[f.jsx("div",{className:"w-10 h-10 bg-emerald-50 text-emerald-600 rounded-lg flex items-center justify-center mb-4",children:f.jsx(kh,{className:"w-6 h-6"})}),f.jsx("h3",{className:"font-bold text-slate-800",children:"Print Reports"}),f.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"View & Print Results"})]}),f.jsxs("button",{onClick:()=>t("search-patients"),className:"p-6 bg-white border border-slate-200 rounded-xl hover:border-indigo-200 hover:shadow-md transition-all text-left group",children:[f.jsx("div",{className:"w-10 h-10 bg-amber-50 text-amber-600 rounded-lg flex items-center justify-center mb-4",children:f.jsx(Od,{className:"w-6 h-6"})}),f.jsx("h3",{className:"font-bold text-slate-800",children:"Patient Search"}),f.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"History & records"})]})]}),f.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm",children:[f.jsxs("h3",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[f.jsx(PD,{className:"w-5 h-5 text-indigo-600"})," Live Test Tracker"]}),f.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto",children:[S.map(H=>{let ge="bg-slate-100 text-slate-600",Se=H.status;return H.status==="ordered"?(Se="Pending Collection",ge="bg-gray-100 text-gray-700 border border-gray-200"):H.status==="collected"?(Se="In Lab / Analyzing",ge="bg-blue-50 text-blue-700 border border-blue-100"):H.status==="reported"?(Se="Ready",ge="bg-green-50 text-green-700 border border-green-100"):H.status==="rejected"&&(Se="Rejected",ge="bg-red-50 text-red-700 border border-red-100"),f.jsxs("div",{className:"flex gap-4 items-center p-3 hover:bg-slate-50 rounded-lg transition-colors border-b border-slate-50 last:border-0 group/row",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 font-bold text-xs",children:H.patientName.slice(0,2).toUpperCase()}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm font-bold text-slate-800",children:H.patientName}),f.jsx("p",{className:"text-xs text-slate-500",children:H.testName})]}),H.status==="collected"?f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:`text-[10px] uppercase font-bold px-2 py-1 rounded-full whitespace-nowrap ${ge}`,children:Se}),f.jsx("button",{onClick:()=>pe(H),className:"opacity-0 group-hover/row:opacity-100 p-1.5 text-red-500 hover:bg-red-50 rounded-full transition-all",title:"Reject Sample",children:f.jsx(lh,{className:"w-4 h-4"})})]}):f.jsx("span",{className:`text-[10px] uppercase font-bold px-2 py-1 rounded-full whitespace-nowrap ${ge}`,children:Se})]},H.id)}),S.length===0&&f.jsx("p",{className:"text-center text-slate-400 text-sm py-4",children:"No recent test activity."})]})]})]}),f.jsx("div",{className:"space-y-6",children:f.jsxs("div",{className:"bg-indigo-50 p-5 rounded-xl border border-indigo-100",children:[f.jsxs("h3",{className:"font-bold text-indigo-900 mb-2 flex items-center gap-2",children:[f.jsx(lg,{className:"w-4 h-4"})," Notifications"]}),f.jsx("div",{className:"space-y-3",children:V.length>0?V.map((H,ge)=>f.jsxs("div",{className:`flex gap-2 items-start text-sm p-2 rounded border ${H.type==="alert"?"bg-red-50 text-red-800 border-red-100":"bg-white/50 text-indigo-800 border-indigo-100"}`,children:[H.type==="alert"?f.jsx(dg,{className:"w-4 h-4 mt-0.5 shrink-0 text-red-600"}):f.jsx(Ei,{className:"w-4 h-4 mt-0.5 shrink-0 text-indigo-600"}),f.jsx("span",{className:"leading-snug",children:H.text})]},H.id||ge)):f.jsx("p",{className:"text-xs text-indigo-400 italic",children:"No new notifications."})})]})})]});return f.jsxs("div",{className:"h-full flex flex-col bg-slate-50",children:[j&&f.jsx(_$,{data:j,onClose:()=>W(null)}),$&&f.jsx(LD,{data:$,onClose:()=>U(null)}),f.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-b border-slate-200 bg-white shrink-0 shadow-sm z-30",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[n&&f.jsx("button",{onClick:n,className:"p-2 hover:bg-slate-200 rounded-full",children:f.jsx(XH,{className:"w-5 h-5 rotate-180"})}),f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Reception Desk"}),f.jsx("div",{className:"hidden md:flex bg-slate-100 p-1 rounded-lg",children:["dashboard","new-order","history","reports","search-patients"].map(H=>f.jsx("button",{onClick:()=>t(H),className:`px-4 py-1.5 rounded-md text-sm font-bold capitalize transition-all ${e===H?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:H.replace("-"," ")},H))})]}),e==="dashboard"&&f.jsxs("button",{onClick:()=>t("new-order"),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 font-bold shadow hover:bg-indigo-700",children:[f.jsx(ka,{className:"w-4 h-4"})," New Order"]})]}),f.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden relative",children:[e==="dashboard"&&f.jsx("div",{className:"overflow-y-auto h-full pb-20",children:Ie()}),e==="new-order"&&we(),e==="history"&&f.jsx("div",{className:"overflow-y-auto h-full p-6 pb-20",children:f.jsx(E$,{})}),e==="reports"&&f.jsx("div",{className:"overflow-y-auto h-full p-6 pb-20",children:f.jsx(w$,{onPrint:H=>U(H)})}),e==="search-patients"&&f.jsx(b$,{onSelect:z})]})]})},V$=()=>{const[n,e]=oe.useState([]),[t,i]=oe.useState([]),[s,a]=oe.useState(null),[l,u]=oe.useState([]);oe.useEffect(()=>{const T=Te.collection("samples").where("status","==","ordered").onSnapshot(S=>e(S.docs.map(k=>({id:k.id,...k.data()})))),E=Te.collection("inventory_items").where("status","!=","out_of_stock").onSnapshot(S=>i(S.docs.map(k=>({id:k.id,...k.data()}))));return()=>{T(),E()}},[]);const h=async T=>{a(T),u([]);try{const E=await Te.collection("tests").doc(T.testId).get();if(E.exists){const S=E.data();S.inventoryRequirements&&u(S.inventoryRequirements.map(k=>({itemId:k.itemId,itemName:k.itemName,quantity:k.quantity})))}}catch(E){console.error("Error fetching test defaults",E)}},m=async()=>{var T,E;if(s){console.log("[PHLEBOTOMY] Starting collection confirmation"),console.log("[PHLEBOTOMY] Sample:",s.testName),console.log("[PHLEBOTOMY] Consumed items count:",l.length),console.log("[PHLEBOTOMY] Consumed items:",l),l.length===0&&(console.warn("[PHLEBOTOMY] WARNING: No inventory items to deduct!"),alert("Warning: No inventory items selected. Collection will proceed without deducting inventory."));try{const S=Te.batch(),k=p$(s.orderId,Math.floor(Math.random()*100)),V=Te.collection("samples").doc(s.id);S.update(V,{status:"collected",collectedAt:ke.firestore.Timestamp.now(),sampleLabelId:k,collectorName:((T=Et.currentUser)==null?void 0:T.email)||"Phlebotomist",notes:(E=s.notes)!=null&&E.includes("RECOLLECTION")?`Recollected after rejection. ${s.notes}`:""});let O=0;l.forEach(j=>{var W;if(console.log("[PHLEBOTOMY] Processing item:",j.itemName,"qty:",j.quantity),j.quantity>0){const $=t.find(U=>U.id===j.itemId);if($){console.log("[PHLEBOTOMY] Found inventory item:",$.name,"current qty:",$.quantity);const U=Te.collection("inventory_items").doc(j.itemId);S.update(U,{quantity:ke.firestore.FieldValue.increment(-j.quantity)});const K=($.purchasePrice||0)*j.quantity,J=Te.collection("inventory_transactions").doc();S.set(J,{itemId:j.itemId,itemName:j.itemName,type:"deduction",quantity:-j.quantity,cost:K,performedBy:((W=Et.currentUser)==null?void 0:W.uid)||"sys",reason:`Sample Collection: ${s.testName}`,relatedSampleId:s.id,relatedTestId:s.testId,timestamp:ke.firestore.Timestamp.now()}),O++,console.log("[PHLEBOTOMY] Added deduction to batch for:",j.itemName)}else console.error("[PHLEBOTOMY] ERROR: Inventory item not found in database:",j.itemId)}else console.warn("[PHLEBOTOMY] Skipping item with zero quantity:",j.itemName)}),console.log("[PHLEBOTOMY] Total items to deduct:",O),console.log("[PHLEBOTOMY] Committing batch..."),await S.commit(),console.log("[PHLEBOTOMY]  Batch committed successfully!"),console.log("[PHLEBOTOMY] Collection completed, inventory updated"),a(null)}catch(S){console.error("[PHLEBOTOMY]  Collection failed:",S),console.error("[PHLEBOTOMY] Error details:",S instanceof Error?S.message:String(S)),alert("Failed to confirm collection. Error: "+(S instanceof Error?S.message:String(S)))}}},_=()=>s?f.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",children:[f.jsxs("div",{className:"p-5 border-b bg-slate-50 flex justify-between items-center",children:[f.jsx("h3",{className:"font-bold text-lg text-slate-800",children:"Confirm Collection"}),f.jsx("button",{onClick:()=>a(null),children:f.jsx(Zc,{className:"w-5 h-5 text-slate-500"})})]}),f.jsxs("div",{className:"p-6 overflow-y-auto space-y-6",children:[f.jsxs("div",{className:"bg-indigo-50 p-3 rounded border border-indigo-100",children:[f.jsx("p",{className:"font-bold text-indigo-900",children:s.patientName}),f.jsxs("p",{className:"text-sm text-indigo-700",children:[s.testName," (",s.sampleType,")"]})]}),f.jsxs("div",{children:[f.jsxs("h4",{className:"font-bold text-sm text-slate-700 mb-2 flex items-center gap-2",children:[f.jsx(ur,{className:"w-4 h-4"})," Consumables Used"]}),f.jsxs("div",{className:"space-y-2 mb-4",children:[l.map((T,E)=>f.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 p-2 rounded border border-slate-200",children:[f.jsx("span",{className:"flex-1 text-sm font-medium",children:T.itemName}),f.jsx("input",{type:"number",className:"w-16 p-1 border rounded text-right text-sm",value:T.quantity,onChange:S=>{const k=[...l];k[E].quantity=parseFloat(S.target.value),u(k)}}),f.jsx("button",{onClick:()=>{const S=[...l];S.splice(E,1),u(S)},className:"text-red-500 hover:bg-red-50 p-1 rounded",children:f.jsx(ug,{className:"w-4 h-4"})})]},E)),l.length===0&&f.jsx("p",{className:"text-xs text-slate-400 italic",children:"No items selected."})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("select",{id:"phleb-inv-select",className:"flex-1 p-2 border rounded text-sm bg-white",children:[f.jsx("option",{value:"",children:"Select Item..."}),t.map(T=>f.jsxs("option",{value:T.id,children:[T.name," (",T.quantity,")"]},T.id))]}),f.jsx("button",{onClick:()=>{const T=document.getElementById("phleb-inv-select"),E=t.find(S=>S.id===T.value);E&&u([...l,{itemId:E.id,itemName:E.name,quantity:1}])},className:"px-3 py-2 bg-slate-800 text-white rounded text-sm font-bold",children:"Add"})]})]})]}),f.jsxs("div",{className:"p-5 border-t bg-slate-50 flex justify-end gap-3",children:[f.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 text-slate-600 font-bold text-sm",children:"Cancel"}),f.jsxs("button",{onClick:m,className:"bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold shadow-lg shadow-indigo-200 flex items-center gap-2",children:[f.jsx(B7,{className:"w-4 h-4"})," Confirm & Print Label"]})]})]})}):null;return f.jsxs("div",{className:"p-6 space-y-6 h-full flex flex-col",children:[_(),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[f.jsx(WT,{className:"w-6 h-6 text-indigo-600"})," Sample Collection"]}),f.jsxs("div",{className:"bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold",children:[n.length," Pending"]})]}),f.jsx("div",{className:"flex-1 overflow-y-auto",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[n.map(T=>f.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all group",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-600 font-bold group-hover:bg-indigo-100 group-hover:text-indigo-600 transition-colors",children:T.patientName.substring(0,2).toUpperCase()}),f.jsx("span",{className:"bg-slate-100 text-slate-600 text-[10px] px-2 py-1 rounded font-bold uppercase tracking-wider",children:T.sampleType})]}),f.jsx("h4",{className:"font-bold text-slate-800 truncate",title:T.patientName,children:T.patientName}),f.jsx("p",{className:"text-sm text-slate-500 mb-4 truncate",title:T.testName,children:T.testName}),T.notes&&T.notes.includes("RECOLLECTION")&&f.jsxs("div",{className:"mb-4 bg-red-50 p-2 rounded text-xs text-red-600 font-bold border border-red-100",children:[" ",T.notes]}),f.jsx("div",{className:"pt-4 border-t border-slate-100",children:f.jsxs("button",{onClick:()=>h(T),className:"w-full py-2.5 bg-indigo-600 text-white rounded-lg font-bold text-sm hover:bg-indigo-700 transition-colors shadow-sm flex items-center justify-center gap-2",children:[f.jsx(Ei,{className:"w-4 h-4"})," Start Collection"]})})]},T.id)),n.length===0&&f.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center h-64 text-slate-400 bg-white rounded-xl border border-dashed border-slate-300",children:[f.jsx(Ei,{className:"w-12 h-12 mb-2 opacity-20"}),f.jsx("p",{children:"All samples collected."})]})]})})]})},L$=()=>{const[n,e]=oe.useState([]),[t,i]=oe.useState({}),[s,a]=oe.useState([]),[l,u]=oe.useState(null),[h,m]=oe.useState({}),[_,T]=oe.useState([]);oe.useEffect(()=>{const V=Te.collection("samples").where("status","in",["collected","analyzing"]).onSnapshot(W=>e(W.docs.map($=>({id:$.id,...$.data()})))),O=Te.collection("tests").onSnapshot(W=>{const $={};W.docs.forEach(U=>{$[U.id]={id:U.id,...U.data()}}),i($)}),j=Te.collection("inventory_items").where("status","!=","out_of_stock").onSnapshot(W=>a(W.docs.map($=>({id:$.id,...$.data()}))));return()=>{V(),O(),j()}},[]);const E=V=>{u(V),m(V.results||{});const O=t[V.testId];O&&O.inventoryRequirements?T(O.inventoryRequirements.map(j=>({itemId:j.itemId,itemName:j.itemName,quantity:j.quantity}))):T([])},S=async()=>{if(l)try{const V=Te.batch(),O=Te.collection("samples").doc(l.id);V.update(O,{status:"review",results:h}),_.forEach(j=>{var W;if(j.quantity>0){const $=s.find(U=>U.id===j.itemId);if($){const U=Te.collection("inventory_items").doc(j.itemId);V.update(U,{quantity:ke.firestore.FieldValue.increment(-j.quantity)});const K=($.purchasePrice||0)*j.quantity,J=Te.collection("inventory_transactions").doc();V.set(J,{itemId:j.itemId,itemName:j.itemName,type:"deduction",quantity:-j.quantity,cost:K,performedBy:((W=Et.currentUser)==null?void 0:W.uid)||"sys",reason:`Test Analysis: ${l.testName}`,relatedSampleId:l.id,relatedTestId:l.testId,timestamp:ke.firestore.Timestamp.now()})}}}),await V.commit(),u(null)}catch(V){console.error("Save results failed:",V),alert("Error saving results: "+(V instanceof Error?V.message:String(V)))}},k=()=>{if(!l)return null;const V=t[l.testId];return V?f.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",children:[f.jsxs("div",{className:"p-5 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-bold text-lg text-slate-800",children:"Enter Results"}),f.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:l.testName})]}),f.jsx("button",{onClick:()=>u(null),className:"p-2 hover:bg-slate-200 rounded-full",children:f.jsx(Zc,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-6",children:[f.jsxs("div",{className:"bg-indigo-50 p-3 rounded-lg border border-indigo-100 mb-4",children:[f.jsxs("p",{className:"text-xs font-bold text-indigo-800",children:["Sample ID: ",f.jsx("span",{className:"font-mono",children:l.sampleLabelId})]}),f.jsxs("p",{className:"text-xs text-indigo-700",children:["Patient: ",l.patientName," (",l.patientAge," / ",l.patientGender,")"]})]}),!V.parameters||V.parameters.length===0?f.jsxs("div",{className:"text-center py-4",children:[f.jsx("p",{className:"text-slate-500 mb-2",children:"No specific parameters defined."}),f.jsx("textarea",{className:"w-full border rounded p-2",placeholder:"Enter general result text...",value:h.main||"",onChange:O=>m({...h,main:O.target.value})})]}):V.parameters.map(O=>f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between mb-1",children:[f.jsx("label",{className:"text-sm font-bold text-slate-700",children:O.name}),f.jsx("span",{className:"text-xs text-slate-400 font-mono",children:O.unit})]}),O.type==="dropdown"&&O.options?f.jsxs("select",{className:"w-full p-2 border border-slate-200 rounded-lg",value:h[O.name]||"",onChange:j=>m({...h,[O.name]:j.target.value}),children:[f.jsx("option",{value:"",children:"Select..."}),O.options.map(j=>f.jsx("option",{value:j,children:j},j))]}):f.jsx("input",{type:O.type==="numeric"?"number":"text",className:"w-full p-2 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",placeholder:`Enter ${O.name}`,value:h[O.name]||"",onChange:j=>m({...h,[O.name]:j.target.value})})]},O.id)),f.jsxs("div",{className:"pt-4 border-t border-slate-100",children:[f.jsxs("h4",{className:"font-bold text-sm text-slate-700 mb-2 flex items-center gap-2",children:[f.jsx(ur,{className:"w-4 h-4"})," Inventory Used"]}),f.jsx("div",{className:"space-y-2 mb-4",children:_.map((O,j)=>f.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 p-2 rounded border border-slate-200",children:[f.jsx("span",{className:"flex-1 text-sm font-medium",children:O.itemName}),f.jsx("input",{type:"number",className:"w-16 p-1 border rounded text-right text-sm",value:O.quantity,onChange:W=>{const $=[..._];$[j].quantity=parseFloat(W.target.value),T($)}}),f.jsx("button",{onClick:()=>{const W=[..._];W.splice(j,1),T(W)},className:"text-red-500 hover:bg-red-50 p-1 rounded",children:f.jsx(ug,{className:"w-4 h-4"})})]},j))}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("select",{id:"tech-inv-select",className:"flex-1 p-2 border rounded text-sm bg-white",children:[f.jsx("option",{value:"",children:"Select Item..."}),s.map(O=>f.jsxs("option",{value:O.id,children:[O.name," (",O.quantity,")"]},O.id))]}),f.jsx("button",{onClick:()=>{const O=document.getElementById("tech-inv-select"),j=s.find(W=>W.id===O.value);j&&T([..._,{itemId:j.id,itemName:j.name,quantity:1}])},className:"px-3 py-2 bg-slate-800 text-white rounded text-sm font-bold",children:"Add"})]})]})]}),f.jsxs("div",{className:"p-5 border-t border-slate-100 flex justify-end gap-3 bg-slate-50",children:[f.jsx("button",{onClick:()=>u(null),className:"px-4 py-2 text-slate-600 font-bold text-sm",children:"Cancel"}),f.jsx("button",{onClick:S,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg font-bold text-sm hover:bg-indigo-700 shadow-lg shadow-indigo-200",children:"Save & Submit"})]})]})}):f.jsxs("div",{className:"p-4 text-center",children:[f.jsx("p",{children:"Test definition not found."}),f.jsx("button",{onClick:()=>u(null),children:"Close"})]})};return f.jsxs("div",{className:"p-6 space-y-6 h-full flex flex-col",children:[k(),f.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[f.jsx(JT,{className:"w-6 h-6 text-indigo-600"})," Lab Processing"]}),f.jsx("div",{className:"flex-1 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden flex flex-col",children:f.jsx("div",{className:"overflow-y-auto",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b sticky top-0 z-10",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Sample ID"}),f.jsx("th",{className:"p-4",children:"Test"}),f.jsx("th",{className:"p-4",children:"Patient"}),f.jsx("th",{className:"p-4",children:"Status"}),f.jsx("th",{className:"p-4 text-right",children:"Action"})]})}),f.jsxs("tbody",{className:"divide-y divide-slate-100",children:[n.map(V=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"p-4 font-mono font-bold text-slate-600",children:V.sampleLabelId||"---"}),f.jsx("td",{className:"p-4 font-bold text-slate-800",children:V.testName}),f.jsx("td",{className:"p-4",children:V.patientName}),f.jsx("td",{className:"p-4",children:f.jsx("span",{className:"bg-blue-50 text-blue-700 px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider",children:V.status})}),f.jsx("td",{className:"p-4 text-right",children:f.jsx("button",{onClick:()=>E(V),className:"bg-indigo-50 text-indigo-700 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-indigo-600 hover:text-white transition-colors",children:"Enter Results"})})]},V.id)),n.length===0&&f.jsx("tr",{children:f.jsx("td",{colSpan:5,className:"p-8 text-center text-slate-400",children:"No samples to process."})})]})]})})})]})},U$=()=>{const[n,e]=oe.useState("review"),[t,i]=oe.useState([]),[s,a]=oe.useState([]),[l,u]=oe.useState(null),[h,m]=oe.useState(!1),[_,T]=oe.useState(""),[E,S]=oe.useState(""),[k,V]=oe.useState(!1),[O,j]=oe.useState(null);oe.useEffect(()=>{const A=Te.collection("samples").where("status","==","review").onSnapshot(M=>i(M.docs.map(L=>({id:L.id,...L.data()})))),C=Te.collection("samples").where("status","in",["ordered","collected","analyzing"]).onSnapshot(M=>a(M.docs.map(L=>({id:L.id,...L.data()}))));return()=>{A(),C()}},[]);const W=A=>{u(A),T(A.pathologistRemarks||""),S(A.conclusion||"")},$=()=>{u(null),T(""),S("")},U=async()=>{var A;if(l){m(!0);try{await Te.collection("samples").doc(l.id).update({status:"reported",verifiedBy:((A=Et.currentUser)==null?void 0:A.email)||"Pathologist",reportedAt:ke.firestore.Timestamp.now(),pathologistRemarks:_,conclusion:E}),$()}catch(C){console.error(C)}finally{m(!1)}}},K=async()=>{if(l&&window.confirm("Reject this result and send back to Technician?")){m(!0);try{await Te.collection("samples").doc(l.id).update({status:"analyzing",notes:"Result rejected by Pathologist. Please re-run."}),$()}catch(A){console.error(A)}finally{m(!1)}}},J=async()=>{if(l){V(!0);try{const A=new zH({apiKey:"PLACEHOLDER_API_KEY"}),C=`Act as a clinical pathologist. Analyze the following lab results for test "${l.testName}". Results: ${JSON.stringify(l.results)}. Patient Age: ${l.patientAge}, Gender: ${l.patientGender}. Provide a professional, concise medical conclusion (max 3 sentences) and a separate short remark if necessary. Format: JSON with keys "conclusion" and "remark".`,L=(await A.models.generateContent({model:"gemini-2.5-flash",contents:C})).response.text;try{const F=L.replace(/```json/g,"").replace(/```/g,"").trim(),D=JSON.parse(F);D.conclusion&&S(D.conclusion),D.remark&&T(D.remark)}catch{S(L)}}catch(A){console.error("AI Error:",A),alert("AI Generation failed. Please try again or type manually.")}finally{V(!1)}}},R=()=>{l&&j({...l,pathologistRemarks:_,conclusion:E})};return f.jsxs("div",{className:"p-6 space-y-6 h-full flex flex-col",children:[O&&f.jsx(LD,{data:O,onClose:()=>j(null)}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[f.jsx(HT,{className:"w-6 h-6 text-indigo-600"})," Pathologist Verification"]}),f.jsxs("div",{className:"bg-slate-100 p-1 rounded-lg flex gap-1",children:[f.jsxs("button",{onClick:()=>e("review"),className:`px-4 py-1.5 text-sm font-bold rounded-md transition-all ${n==="review"?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-800"}`,children:["Pending Review (",t.length,")"]}),f.jsxs("button",{onClick:()=>e("upcoming"),className:`px-4 py-1.5 text-sm font-bold rounded-md transition-all ${n==="upcoming"?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-800"}`,children:["Upcoming Work (",s.length,")"]})]})]}),f.jsx("div",{className:"flex-1 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden flex flex-col",children:f.jsx("div",{className:"overflow-y-auto",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b sticky top-0 z-10",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:"Sample ID"}),f.jsx("th",{className:"p-4",children:"Patient"}),f.jsx("th",{className:"p-4",children:"Test"}),f.jsx("th",{className:"p-4",children:"Status"}),f.jsx("th",{className:"p-4 text-right",children:"Action"})]})}),f.jsxs("tbody",{className:"divide-y divide-slate-100",children:[(n==="review"?t:s).map(A=>f.jsxs("tr",{className:"hover:bg-slate-50 group",children:[f.jsx("td",{className:"p-4 font-mono text-xs text-slate-500",children:A.sampleLabelId||A.id.slice(0,6)}),f.jsx("td",{className:"p-4 font-bold text-slate-800",children:A.patientName}),f.jsxs("td",{className:"p-4",children:[f.jsx("p",{className:"font-bold",children:A.testName}),f.jsx("p",{className:"text-xs text-slate-500",children:A.sampleType})]}),f.jsx("td",{className:"p-4",children:f.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase ${A.status==="review"?"bg-amber-50 text-amber-700":"bg-slate-100 text-slate-500"}`,children:A.status==="review"?"Waiting Approval":A.status})}),f.jsx("td",{className:"p-4 text-right",children:n==="review"&&f.jsx("button",{onClick:()=>W(A),className:"bg-indigo-50 text-indigo-700 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-indigo-600 hover:text-white transition-colors",children:"Review & Approve"})})]},A.id)),(n==="review"?t:s).length===0&&f.jsx("tr",{children:f.jsx("td",{colSpan:5,className:"p-10 text-center text-slate-400",children:"No samples found."})})]})]})})}),l&&f.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl h-[90vh] flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-100",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Review Sample Result"}),f.jsxs("p",{className:"text-sm text-slate-500",children:[l.sampleLabelId,"  ",l.patientName]})]}),f.jsx("button",{onClick:$,className:"p-2 hover:bg-slate-100 rounded-full",children:f.jsx(Zc,{className:"w-5 h-5 text-slate-500"})})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-6 grid grid-cols-1 md:grid-cols-2 gap-8",children:[f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[f.jsxs("h4",{className:"font-bold text-slate-700 mb-4 flex items-center gap-2",children:[f.jsx(R7,{className:"w-4 h-4"})," Technical Results"]}),f.jsx("table",{className:"w-full text-sm",children:f.jsx("tbody",{className:"divide-y divide-slate-200 border-t border-slate-200",children:l.results&&Object.entries(l.results).map(([A,C])=>f.jsxs("tr",{children:[f.jsx("td",{className:"py-2 text-slate-600 font-medium",children:A}),f.jsx("td",{className:"py-2 text-right font-bold text-slate-900",children:C})]},A))})})]}),f.jsxs("div",{className:"text-xs text-slate-400",children:[f.jsxs("p",{children:["Patient ID: ",l.patientId]}),f.jsxs("p",{children:["Age/Gender: ",l.patientAge,"/",l.patientGender]}),f.jsxs("p",{children:["Collected: ",Ln(l.collectedAt)]})]})]}),f.jsxs("div",{className:"space-y-4 flex flex-col h-full",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h4",{className:"font-bold text-slate-700",children:"Clinical Evaluation"}),f.jsxs("button",{onClick:J,disabled:k,className:"text-xs bg-purple-50 text-purple-700 px-2 py-1 rounded border border-purple-100 font-bold flex items-center gap-1 hover:bg-purple-100",children:[k?f.jsx(Qa,{className:"w-3 h-3 animate-spin"}):f.jsx(K7,{className:"w-3 h-3"})," Auto-Generate"]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Conclusion / Impression"}),f.jsx("textarea",{className:"w-full p-3 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none h-24 resize-none",placeholder:"Enter medical conclusion...",value:E,onChange:A=>S(A.target.value)})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Remarks (Optional)"}),f.jsx("textarea",{className:"w-full p-3 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none h-20 resize-none",placeholder:"Any additional notes...",value:_,onChange:A=>T(A.target.value)})]}),f.jsxs("div",{className:"mt-auto pt-6 border-t border-slate-100 flex gap-3 justify-end",children:[f.jsx("button",{onClick:K,disabled:h,className:"px-4 py-2 border border-red-200 text-red-600 rounded-lg font-bold text-sm hover:bg-red-50",children:"Reject"}),f.jsxs("button",{onClick:R,className:"px-4 py-2 border border-slate-200 text-slate-600 rounded-lg font-bold text-sm hover:bg-slate-50 flex items-center gap-2",children:[f.jsx(v7,{className:"w-4 h-4"})," Preview Report"]}),f.jsxs("button",{onClick:U,disabled:h,className:"px-6 py-2 bg-green-600 text-white rounded-lg font-bold text-sm hover:bg-green-700 shadow-lg shadow-green-200 flex items-center gap-2",children:[h?f.jsx(Qa,{className:"w-4 h-4 animate-spin"}):f.jsx(Ei,{className:"w-4 h-4"})," Approve & Publish"]})]})]})]})]})})]})},O$=({role:n,userId:e,currentView:t,onChangeView:i,onLogout:s,onRequestInventory:a})=>{const l=qv[n]||[],[u,h]=oe.useState(0);oe.useEffect(()=>{const T=Te.collection("inventory_requests").where("requesterId","==",e).where("status","==","released").onSnapshot(E=>h(E.size));return()=>T()},[e]);const m=T=>{switch(T){case"dashboard":return cg;case"patients":return ch;case"reception":return lg;case"collection":return WT;case"lab_tech":return JT;case"lab_path":return HT;case"finance":return Lc;case"inventory":return ur;case"settings":return _N;default:return Ei}},_=T=>T.startsWith("admin_")?T.replace("admin_","Mgmt: "):T==="finance"?"Finance & Billing":T.replace("_"," ");return f.jsxs("div",{className:"w-64 bg-slate-900 text-slate-300 flex flex-col h-full shrink-0 transition-all duration-300",children:[f.jsxs("div",{className:"h-16 flex items-center gap-3 px-6 border-b border-slate-800",children:[f.jsx("div",{className:"w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white font-bold shadow-lg shadow-indigo-900/50",children:"L"}),f.jsx("span",{className:"font-bold text-white text-lg tracking-tight",children:"LabPro"})]}),f.jsxs("div",{className:"flex-1 py-6 px-3 space-y-1 overflow-y-auto custom-scrollbar",children:[f.jsx("p",{className:"px-3 text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Main Menu"}),l.map(T=>{if(T.startsWith("admin_"))return null;const E=m(T);return f.jsxs("button",{onClick:()=>i(T),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all ${t===T?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/20":"hover:bg-slate-800 hover:text-white"}`,children:[f.jsx(E,{className:"w-5 h-5 opacity-80"}),f.jsx("span",{className:"capitalize",children:_(T)})]},T)}),f.jsx("div",{className:"pt-2 mt-2 border-t border-slate-800/50",children:f.jsxs("button",{onClick:a,className:"w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm font-medium text-slate-300 hover:bg-slate-800 hover:text-white transition-all group",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Fd,{className:"w-5 h-5 opacity-80"}),f.jsx("span",{children:"Request Inventory"})]}),u>0&&f.jsx("span",{className:"bg-red-500 text-white text-[10px] w-5 h-5 rounded-full flex items-center justify-center font-bold shadow-md animate-pulse",children:u})]})}),(n==="admin"||n==="inventory_manager"||n==="accountant")&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"my-4 border-t border-slate-800/50 mx-3"}),f.jsx("p",{className:"px-3 text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Administration"}),qv[n].filter(T=>T.startsWith("admin_")).map(T=>{const E=T==="admin_finance"?Lc:T==="admin_users"?ch:T==="admin_tests"?KT:T==="admin_reports"?zT:T==="admin_logs"?QT:_N;return f.jsxs("button",{onClick:()=>i(T),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all ${t===T?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/20":"hover:bg-slate-800 hover:text-white"}`,children:[f.jsx(E,{className:"w-5 h-5 opacity-80"}),f.jsx("span",{children:_(T)})]},T)})]})]}),f.jsx("div",{className:"p-4 border-t border-slate-800 bg-slate-900/50",children:f.jsxs("button",{onClick:s,className:"w-full flex items-center gap-2 px-4 py-2.5 text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:[f.jsx(M7,{className:"w-4 h-4"}),f.jsx("span",{children:"Sign Out"})]})})]})},OD=Bv.createContext(null),fg=()=>{const n=Bv.useContext(OD);if(!n)throw new Error("useDialog must be used within DialogProvider");return n},F$=()=>{var M,L,F;const[n,e]=oe.useState(null),[t,i]=oe.useState(null),[s,a]=oe.useState("dashboard"),[l,u]=oe.useState(!0),[h,m]=oe.useState(!1),[_,T]=oe.useState({isOpen:!1,type:"info",message:""}),[E,S]=oe.useState({isOpen:!1,message:"",onConfirm:()=>{},onCancel:()=>{}}),[k,V]=oe.useState({isOpen:!1,message:"",defaultValue:"",onConfirm:()=>{},onCancel:()=>{}}),[O,j]=oe.useState([]),W=(D,ye,Oe)=>{T({isOpen:!0,type:D,message:ye,title:Oe})},$=(D,ye)=>new Promise(Oe=>{S({isOpen:!0,message:D,title:ye==null?void 0:ye.title,confirmText:ye==null?void 0:ye.confirmText,cancelText:ye==null?void 0:ye.cancelText,type:ye==null?void 0:ye.type,onConfirm:()=>{S(X=>({...X,isOpen:!1})),Oe(!0)},onCancel:()=>{S(X=>({...X,isOpen:!1})),Oe(!1)}})}),U=(D,ye)=>new Promise(Oe=>{V({isOpen:!0,message:D,title:ye==null?void 0:ye.title,defaultValue:(ye==null?void 0:ye.defaultValue)||"",placeholder:ye==null?void 0:ye.placeholder,onConfirm:X=>{V(fe=>({...fe,isOpen:!1})),Oe(X)},onCancel:()=>{V(X=>({...X,isOpen:!1})),Oe(null)}})}),K=(D,ye)=>{const Oe=Date.now().toString()+Math.random().toString(36);j(X=>[...X,{id:Oe,type:D,message:ye}]),setTimeout(()=>{j(X=>X.filter(fe=>fe.id!==Oe))},4e3)},J=D=>{j(ye=>ye.filter(Oe=>Oe.id!==D))},R={showAlert:W,showConfirm:$,showPrompt:U,showToast:K};oe.useEffect(()=>{const D=Et.onAuthStateChanged(ye=>{var Oe;if(!ye)e(null),i(null);else{e(ye);const X=localStorage.getItem("labpro_role"),fe=localStorage.getItem("labpro_view");X&&mp.some(Re=>Re.id===X)?(i(X),fe&&((Oe=qv[X])!=null&&Oe.includes(fe))&&a(fe)):i(null)}u(!1)});return()=>D()},[]);const A=(D,ye)=>{i(D),e(ye),a("dashboard"),localStorage.setItem("labpro_role",D),localStorage.setItem("labpro_view","dashboard")},C=()=>{Et.signOut(),localStorage.removeItem("labpro_role"),localStorage.removeItem("labpro_view"),e(null),i(null),a("dashboard")};return oe.useEffect(()=>{t&&s&&localStorage.setItem("labpro_view",s)},[s,t]),l?f.jsx("div",{className:"h-screen w-full flex items-center justify-center bg-slate-50",children:f.jsx(Qa,{className:"w-8 h-8 text-indigo-600 animate-spin"})}):!n||!t?f.jsx(v$,{onLoginSuccess:A}):f.jsxs(OD.Provider,{value:R,children:[f.jsx(l$,{isOpen:_.isOpen,type:_.type,title:_.title,message:_.message,onClose:()=>T(D=>({...D,isOpen:!1}))}),f.jsx(c$,{isOpen:E.isOpen,title:E.title,message:E.message,confirmText:E.confirmText,cancelText:E.cancelText,type:E.type,onConfirm:E.onConfirm,onCancel:E.onCancel}),f.jsx(u$,{isOpen:k.isOpen,title:k.title,message:k.message,defaultValue:k.defaultValue,placeholder:k.placeholder,onConfirm:k.onConfirm,onCancel:k.onCancel}),f.jsx(a$,{toasts:O,onClose:J}),f.jsxs("div",{className:"flex h-screen w-full bg-slate-100 font-sans text-slate-900 overflow-hidden",children:[f.jsx(VD,{isOpen:h,onClose:()=>m(!1),userId:n.uid,userName:n.username||n.email||"User",userRole:t}),f.jsx(O$,{role:t,userId:n.uid,currentView:s,onChangeView:a,onLogout:C,onRequestInventory:()=>m(!0)}),f.jsxs("main",{className:"flex-1 h-full overflow-hidden relative flex flex-col",children:[f.jsxs("header",{className:"h-16 bg-white border-b border-slate-200 flex items-center justify-between px-6 shrink-0 shadow-sm z-20",children:[f.jsxs("h1",{className:"text-xl font-bold text-slate-800 capitalize flex items-center gap-2",children:[s==="dashboard"?f.jsx(cg,{className:"w-5 h-5 text-indigo-600"}):s==="patients"?f.jsx(ch,{className:"w-5 h-5 text-indigo-600"}):f.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),s==="finance"?"Finance & Billing":s.replace(/_/g," ")]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"text-right hidden sm:block",children:[f.jsx("p",{className:"text-sm font-bold text-slate-800",children:n.username||n.email}),f.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-bold tracking-wider",children:((M=mp.find(D=>D.id===t))==null?void 0:M.label)||t})]}),f.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-700 font-bold border border-indigo-200",children:((F=(L=n.username||n.email)==null?void 0:L[0])==null?void 0:F.toUpperCase())||"U"})]})]}),f.jsxs("div",{className:"flex-1 overflow-auto p-0 relative",children:[s==="dashboard"&&f.jsx("div",{className:"p-6",children:f.jsx(I$,{role:t})}),s==="patients"&&f.jsx("div",{className:"p-6",children:f.jsx(S$,{})}),s==="reception"&&f.jsx(k$,{}),s==="collection"&&f.jsx(V$,{}),s==="lab_tech"&&f.jsx(L$,{}),s==="lab_path"&&f.jsx(U$,{}),s==="inventory"&&f.jsx(A$,{role:t}),s==="finance"&&f.jsx(UD,{}),s==="admin_users"&&f.jsx("div",{className:"p-6",children:f.jsx(N$,{onBack:()=>a("dashboard")})}),s==="admin_tests"&&f.jsx("div",{className:"h-full",children:f.jsx(C$,{onBack:()=>a("dashboard")})}),s==="admin_finance"&&f.jsx("div",{className:"p-6",children:f.jsx(R$,{onBack:()=>a("dashboard")})}),s==="admin_reports"&&f.jsx("div",{className:"p-6",children:f.jsx(P$,{onBack:()=>a("dashboard")})}),s==="admin_logs"&&f.jsx("div",{className:"p-6",children:f.jsx(D$,{onBack:()=>a("dashboard")})}),s==="admin_settings"&&f.jsx("div",{className:"p-6",children:f.jsx(M$,{onBack:()=>a("dashboard")})})]})]})]})]})},FD=document.getElementById("root");if(!FD)throw new Error("Could not find root element to mount to");const q$=S2.createRoot(FD);q$.render(f.jsx(Bv.StrictMode,{children:f.jsx(F$,{})}));
