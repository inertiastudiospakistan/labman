(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function ES(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var p_={exports:{}},id={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vb;function E2(){if(vb)return id;vb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var u in i)u!=="key"&&(a[u]=i[u])}else a=i;return i=a.ref,{$$typeof:n,type:s,key:l,ref:i!==void 0?i:null,props:a}}return id.Fragment=e,id.jsx=t,id.jsxs=t,id}var Eb;function T2(){return Eb||(Eb=1,p_.exports=E2()),p_.exports}var d=T2(),g_={exports:{}},$e={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tb;function x2(){if(Tb)return $e;Tb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),T=Symbol.for("react.activity"),x=Symbol.iterator;function b(B){return B===null||typeof B!="object"?null:(B=x&&B[x]||B["@@iterator"],typeof B=="function"?B:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G=Object.assign,F={};function Y(B,q,me){this.props=B,this.context=q,this.refs=F,this.updater=me||k}Y.prototype.isReactComponent={},Y.prototype.setState=function(B,q){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,q,"setState")},Y.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function K(){}K.prototype=Y.prototype;function H(B,q,me){this.props=B,this.context=q,this.refs=F,this.updater=me||k}var U=H.prototype=new K;U.constructor=H,G(U,Y.prototype),U.isPureReactComponent=!0;var z=Array.isArray;function J(){}var P={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function S(B,q,me){var _e=me.ref;return{$$typeof:n,type:B,key:q,ref:_e!==void 0?_e:null,props:me}}function L(B,q){return S(B.type,q,B.props)}function V(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function O(B){var q={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(me){return q[me]})}var M=/\/+/g;function ae(B,q){return typeof B=="object"&&B!==null&&B.key!=null?O(""+B.key):q.toString(36)}function Ie(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(J,J):(B.status="pending",B.then(function(q){B.status==="pending"&&(B.status="fulfilled",B.value=q)},function(q){B.status==="pending"&&(B.status="rejected",B.reason=q)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function Q(B,q,me,_e,Ce){var ye=typeof B;(ye==="undefined"||ye==="boolean")&&(B=null);var Ne=!1;if(B===null)Ne=!0;else switch(ye){case"bigint":case"string":case"number":Ne=!0;break;case"object":switch(B.$$typeof){case n:case e:Ne=!0;break;case _:return Ne=B._init,Q(Ne(B._payload),q,me,_e,Ce)}}if(Ne)return Ce=Ce(B),Ne=_e===""?"."+ae(B,0):_e,z(Ce)?(me="",Ne!=null&&(me=Ne.replace(M,"$&/")+"/"),Q(Ce,q,me,"",function(at){return at})):Ce!=null&&(V(Ce)&&(Ce=L(Ce,me+(Ce.key==null||B&&B.key===Ce.key?"":(""+Ce.key).replace(M,"$&/")+"/")+Ne)),q.push(Ce)),1;Ne=0;var ht=_e===""?".":_e+":";if(z(B))for(var qe=0;qe<B.length;qe++)_e=B[qe],ye=ht+ae(_e,qe),Ne+=Q(_e,q,me,ye,Ce);else if(qe=b(B),typeof qe=="function")for(B=qe.call(B),qe=0;!(_e=B.next()).done;)_e=_e.value,ye=ht+ae(_e,qe++),Ne+=Q(_e,q,me,ye,Ce);else if(ye==="object"){if(typeof B.then=="function")return Q(Ie(B),q,me,_e,Ce);throw q=String(B),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return Ne}function ge(B,q,me){if(B==null)return B;var _e=[],Ce=0;return Q(B,_e,"","",function(ye){return q.call(me,ye,Ce++)}),_e}function Ee(B){if(B._status===-1){var q=B._result;q=q(),q.then(function(me){(B._status===0||B._status===-1)&&(B._status=1,B._result=me)},function(me){(B._status===0||B._status===-1)&&(B._status=2,B._result=me)}),B._status===-1&&(B._status=0,B._result=q)}if(B._status===1)return B._result.default;throw B._result}var ke=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},Ve={map:ge,forEach:function(B,q,me){ge(B,function(){q.apply(this,arguments)},me)},count:function(B){var q=0;return ge(B,function(){q++}),q},toArray:function(B){return ge(B,function(q){return q})||[]},only:function(B){if(!V(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return $e.Activity=T,$e.Children=Ve,$e.Component=Y,$e.Fragment=t,$e.Profiler=i,$e.PureComponent=H,$e.StrictMode=s,$e.Suspense=f,$e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,$e.__COMPILER_RUNTIME={__proto__:null,c:function(B){return P.H.useMemoCache(B)}},$e.cache=function(B){return function(){return B.apply(null,arguments)}},$e.cacheSignal=function(){return null},$e.cloneElement=function(B,q,me){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var _e=G({},B.props),Ce=B.key;if(q!=null)for(ye in q.key!==void 0&&(Ce=""+q.key),q)!C.call(q,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&q.ref===void 0||(_e[ye]=q[ye]);var ye=arguments.length-2;if(ye===1)_e.children=me;else if(1<ye){for(var Ne=Array(ye),ht=0;ht<ye;ht++)Ne[ht]=arguments[ht+2];_e.children=Ne}return S(B.type,Ce,_e)},$e.createContext=function(B){return B={$$typeof:l,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:a,_context:B},B},$e.createElement=function(B,q,me){var _e,Ce={},ye=null;if(q!=null)for(_e in q.key!==void 0&&(ye=""+q.key),q)C.call(q,_e)&&_e!=="key"&&_e!=="__self"&&_e!=="__source"&&(Ce[_e]=q[_e]);var Ne=arguments.length-2;if(Ne===1)Ce.children=me;else if(1<Ne){for(var ht=Array(Ne),qe=0;qe<Ne;qe++)ht[qe]=arguments[qe+2];Ce.children=ht}if(B&&B.defaultProps)for(_e in Ne=B.defaultProps,Ne)Ce[_e]===void 0&&(Ce[_e]=Ne[_e]);return S(B,ye,Ce)},$e.createRef=function(){return{current:null}},$e.forwardRef=function(B){return{$$typeof:u,render:B}},$e.isValidElement=V,$e.lazy=function(B){return{$$typeof:_,_payload:{_status:-1,_result:B},_init:Ee}},$e.memo=function(B,q){return{$$typeof:m,type:B,compare:q===void 0?null:q}},$e.startTransition=function(B){var q=P.T,me={};P.T=me;try{var _e=B(),Ce=P.S;Ce!==null&&Ce(me,_e),typeof _e=="object"&&_e!==null&&typeof _e.then=="function"&&_e.then(J,ke)}catch(ye){ke(ye)}finally{q!==null&&me.types!==null&&(q.types=me.types),P.T=q}},$e.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},$e.use=function(B){return P.H.use(B)},$e.useActionState=function(B,q,me){return P.H.useActionState(B,q,me)},$e.useCallback=function(B,q){return P.H.useCallback(B,q)},$e.useContext=function(B){return P.H.useContext(B)},$e.useDebugValue=function(){},$e.useDeferredValue=function(B,q){return P.H.useDeferredValue(B,q)},$e.useEffect=function(B,q){return P.H.useEffect(B,q)},$e.useEffectEvent=function(B){return P.H.useEffectEvent(B)},$e.useId=function(){return P.H.useId()},$e.useImperativeHandle=function(B,q,me){return P.H.useImperativeHandle(B,q,me)},$e.useInsertionEffect=function(B,q){return P.H.useInsertionEffect(B,q)},$e.useLayoutEffect=function(B,q){return P.H.useLayoutEffect(B,q)},$e.useMemo=function(B,q){return P.H.useMemo(B,q)},$e.useOptimistic=function(B,q){return P.H.useOptimistic(B,q)},$e.useReducer=function(B,q,me){return P.H.useReducer(B,q,me)},$e.useRef=function(B){return P.H.useRef(B)},$e.useState=function(B){return P.H.useState(B)},$e.useSyncExternalStore=function(B,q,me){return P.H.useSyncExternalStore(B,q,me)},$e.useTransition=function(){return P.H.useTransition()},$e.version="19.2.1",$e}var xb;function zv(){return xb||(xb=1,g_.exports=x2()),g_.exports}var le=zv();const $v=ES(le);var y_={exports:{}},rd={},__={exports:{}},v_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ib;function I2(){return Ib||(Ib=1,(function(n){function e(Q,ge){var Ee=Q.length;Q.push(ge);e:for(;0<Ee;){var ke=Ee-1>>>1,Ve=Q[ke];if(0<i(Ve,ge))Q[ke]=ge,Q[Ee]=Ve,Ee=ke;else break e}}function t(Q){return Q.length===0?null:Q[0]}function s(Q){if(Q.length===0)return null;var ge=Q[0],Ee=Q.pop();if(Ee!==ge){Q[0]=Ee;e:for(var ke=0,Ve=Q.length,B=Ve>>>1;ke<B;){var q=2*(ke+1)-1,me=Q[q],_e=q+1,Ce=Q[_e];if(0>i(me,Ee))_e<Ve&&0>i(Ce,me)?(Q[ke]=Ce,Q[_e]=Ee,ke=_e):(Q[ke]=me,Q[q]=Ee,ke=q);else if(_e<Ve&&0>i(Ce,Ee))Q[ke]=Ce,Q[_e]=Ee,ke=_e;else break e}}return ge}function i(Q,ge){var Ee=Q.sortIndex-ge.sortIndex;return Ee!==0?Ee:Q.id-ge.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var f=[],m=[],_=1,T=null,x=3,b=!1,k=!1,G=!1,F=!1,Y=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;function U(Q){for(var ge=t(m);ge!==null;){if(ge.callback===null)s(m);else if(ge.startTime<=Q)s(m),ge.sortIndex=ge.expirationTime,e(f,ge);else break;ge=t(m)}}function z(Q){if(G=!1,U(Q),!k)if(t(f)!==null)k=!0,J||(J=!0,O());else{var ge=t(m);ge!==null&&Ie(z,ge.startTime-Q)}}var J=!1,P=-1,C=5,S=-1;function L(){return F?!0:!(n.unstable_now()-S<C)}function V(){if(F=!1,J){var Q=n.unstable_now();S=Q;var ge=!0;try{e:{k=!1,G&&(G=!1,K(P),P=-1),b=!0;var Ee=x;try{t:{for(U(Q),T=t(f);T!==null&&!(T.expirationTime>Q&&L());){var ke=T.callback;if(typeof ke=="function"){T.callback=null,x=T.priorityLevel;var Ve=ke(T.expirationTime<=Q);if(Q=n.unstable_now(),typeof Ve=="function"){T.callback=Ve,U(Q),ge=!0;break t}T===t(f)&&s(f),U(Q)}else s(f);T=t(f)}if(T!==null)ge=!0;else{var B=t(m);B!==null&&Ie(z,B.startTime-Q),ge=!1}}break e}finally{T=null,x=Ee,b=!1}ge=void 0}}finally{ge?O():J=!1}}}var O;if(typeof H=="function")O=function(){H(V)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,ae=M.port2;M.port1.onmessage=V,O=function(){ae.postMessage(null)}}else O=function(){Y(V,0)};function Ie(Q,ge){P=Y(function(){Q(n.unstable_now())},ge)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_next=function(Q){switch(x){case 1:case 2:case 3:var ge=3;break;default:ge=x}var Ee=x;x=ge;try{return Q()}finally{x=Ee}},n.unstable_requestPaint=function(){F=!0},n.unstable_runWithPriority=function(Q,ge){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var Ee=x;x=Q;try{return ge()}finally{x=Ee}},n.unstable_scheduleCallback=function(Q,ge,Ee){var ke=n.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?ke+Ee:ke):Ee=ke,Q){case 1:var Ve=-1;break;case 2:Ve=250;break;case 5:Ve=1073741823;break;case 4:Ve=1e4;break;default:Ve=5e3}return Ve=Ee+Ve,Q={id:_++,callback:ge,priorityLevel:Q,startTime:Ee,expirationTime:Ve,sortIndex:-1},Ee>ke?(Q.sortIndex=Ee,e(m,Q),t(f)===null&&Q===t(m)&&(G?(K(P),P=-1):G=!0,Ie(z,Ee-ke))):(Q.sortIndex=Ve,e(f,Q),k||b||(k=!0,J||(J=!0,O()))),Q},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(Q){var ge=x;return function(){var Ee=x;x=ge;try{return Q.apply(this,arguments)}finally{x=Ee}}}})(v_)),v_}var bb;function b2(){return bb||(bb=1,__.exports=I2()),__.exports}var E_={exports:{}},Fn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ab;function A2(){if(Ab)return Fn;Ab=1;var n=zv();function e(f){var m="https://react.dev/errors/"+f;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(f,m,_){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:T==null?null:""+T,children:f,containerInfo:m,implementation:_}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,m){if(f==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Fn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Fn.createPortal=function(f,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return a(f,m,null,_)},Fn.flushSync=function(f){var m=l.T,_=s.p;try{if(l.T=null,s.p=2,f)return f()}finally{l.T=m,s.p=_,s.d.f()}},Fn.preconnect=function(f,m){typeof f=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(f,m))},Fn.prefetchDNS=function(f){typeof f=="string"&&s.d.D(f)},Fn.preinit=function(f,m){if(typeof f=="string"&&m&&typeof m.as=="string"){var _=m.as,T=u(_,m.crossOrigin),x=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?s.d.S(f,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:T,integrity:x,fetchPriority:b}):_==="script"&&s.d.X(f,{crossOrigin:T,integrity:x,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Fn.preinitModule=function(f,m){if(typeof f=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=u(m.as,m.crossOrigin);s.d.M(f,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(f)},Fn.preload=function(f,m){if(typeof f=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,T=u(_,m.crossOrigin);s.d.L(f,_,{crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Fn.preloadModule=function(f,m){if(typeof f=="string")if(m){var _=u(m.as,m.crossOrigin);s.d.m(f,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(f)},Fn.requestFormReset=function(f){s.d.r(f)},Fn.unstable_batchedUpdates=function(f,m){return f(m)},Fn.useFormState=function(f,m,_){return l.H.useFormState(f,m,_)},Fn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Fn.version="19.2.1",Fn}var wb;function w2(){if(wb)return E_.exports;wb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),E_.exports=A2(),E_.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nb;function N2(){if(Nb)return rd;Nb=1;var n=b2(),e=zv(),t=w2();function s(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,c=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(c=o.return),r=o.return;while(r)}return o.tag===3?c:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function u(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function f(r){if(a(r)!==r)throw Error(s(188))}function m(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(s(188));return o!==r?null:r}for(var c=r,h=o;;){var v=c.return;if(v===null)break;var E=v.alternate;if(E===null){if(h=v.return,h!==null){c=h;continue}break}if(v.child===E.child){for(E=v.child;E;){if(E===c)return f(v),r;if(E===h)return f(v),o;E=E.sibling}throw Error(s(188))}if(c.return!==h.return)c=v,h=E;else{for(var A=!1,R=v.child;R;){if(R===c){A=!0,c=v,h=E;break}if(R===h){A=!0,h=v,c=E;break}R=R.sibling}if(!A){for(R=E.child;R;){if(R===c){A=!0,c=E,h=v;break}if(R===h){A=!0,h=E,c=v;break}R=R.sibling}if(!A)throw Error(s(189))}}if(c.alternate!==h)throw Error(s(190))}if(c.tag!==3)throw Error(s(188));return c.stateNode.current===c?r:o}function _(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=_(r),o!==null)return o;r=r.sibling}return null}var T=Object.assign,x=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),k=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),K=Symbol.for("react.consumer"),H=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function O(r){return r===null||typeof r!="object"?null:(r=V&&r[V]||r["@@iterator"],typeof r=="function"?r:null)}var M=Symbol.for("react.client.reference");function ae(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===M?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case G:return"Fragment";case Y:return"Profiler";case F:return"StrictMode";case z:return"Suspense";case J:return"SuspenseList";case S:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case k:return"Portal";case H:return r.displayName||"Context";case K:return(r._context.displayName||"Context")+".Consumer";case U:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case P:return o=r.displayName||null,o!==null?o:ae(r.type)||"Memo";case C:o=r._payload,r=r._init;try{return ae(r(o))}catch{}}return null}var Ie=Array.isArray,Q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ee={pending:!1,data:null,method:null,action:null},ke=[],Ve=-1;function B(r){return{current:r}}function q(r){0>Ve||(r.current=ke[Ve],ke[Ve]=null,Ve--)}function me(r,o){Ve++,ke[Ve]=r.current,r.current=o}var _e=B(null),Ce=B(null),ye=B(null),Ne=B(null);function ht(r,o){switch(me(ye,o),me(Ce,r),me(_e,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?GI(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=GI(o),r=qI(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}q(_e),me(_e,r)}function qe(){q(_e),q(Ce),q(ye)}function at(r){r.memoizedState!==null&&me(Ne,r);var o=_e.current,c=qI(o,r.type);o!==c&&(me(Ce,r),me(_e,c))}function _n(r){Ce.current===r&&(q(_e),q(Ce)),Ne.current===r&&(q(Ne),ed._currentValue=Ee)}var On,ds;function ee(r){if(On===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);On=o&&o[1]||"",ds=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+On+r+ds}var Re=!1;function Ge(r,o){if(!r||Re)return"";Re=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var de=function(){throw Error()};if(Object.defineProperty(de.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(de,[])}catch(oe){var se=oe}Reflect.construct(r,[],de)}else{try{de.call()}catch(oe){se=oe}r.call(de.prototype)}}else{try{throw Error()}catch(oe){se=oe}(de=r())&&typeof de.catch=="function"&&de.catch(function(){})}}catch(oe){if(oe&&se&&typeof oe.stack=="string")return[oe.stack,se.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=h.DetermineComponentFrameRoot(),A=E[0],R=E[1];if(A&&R){var j=A.split(`
`),ne=R.split(`
`);for(v=h=0;h<j.length&&!j[h].includes("DetermineComponentFrameRoot");)h++;for(;v<ne.length&&!ne[v].includes("DetermineComponentFrameRoot");)v++;if(h===j.length||v===ne.length)for(h=j.length-1,v=ne.length-1;1<=h&&0<=v&&j[h]!==ne[v];)v--;for(;1<=h&&0<=v;h--,v--)if(j[h]!==ne[v]){if(h!==1||v!==1)do if(h--,v--,0>v||j[h]!==ne[v]){var ce=`
`+j[h].replace(" at new "," at ");return r.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",r.displayName)),ce}while(1<=h&&0<=v);break}}}finally{Re=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?ee(c):""}function We(r,o){switch(r.tag){case 26:case 27:case 5:return ee(r.type);case 16:return ee("Lazy");case 13:return r.child!==o&&o!==null?ee("Suspense Fallback"):ee("Suspense");case 19:return ee("SuspenseList");case 0:case 15:return Ge(r.type,!1);case 11:return Ge(r.type.render,!1);case 1:return Ge(r.type,!0);case 31:return ee("Activity");default:return""}}function pt(r){try{var o="",c=null;do o+=We(r,c),c=r,r=r.return;while(r);return o}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var He=Object.prototype.hasOwnProperty,Oe=n.unstable_scheduleCallback,en=n.unstable_cancelCallback,zs=n.unstable_shouldYield,di=n.unstable_requestPaint,tn=n.unstable_now,hi=n.unstable_getCurrentPriorityLevel,nn=n.unstable_ImmediatePriority,Ji=n.unstable_UserBlockingPriority,Vr=n.unstable_NormalPriority,_g=n.unstable_LowPriority,Bh=n.unstable_IdlePriority,jh=n.log,Gh=n.unstable_setDisableYieldValue,$s=null,wn=null;function Ns(r){if(typeof jh=="function"&&Gh(r),wn&&typeof wn.setStrictMode=="function")try{wn.setStrictMode($s,r)}catch{}}var Yt=Math.clz32?Math.clz32:Hh,qh=Math.log,cl=Math.LN2;function Hh(r){return r>>>=0,r===0?32:31-(qh(r)/cl|0)|0}var fi=256,Jo=262144,sn=4194304;function mi(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function pi(r,o,c){var h=r.pendingLanes;if(h===0)return 0;var v=0,E=r.suspendedLanes,A=r.pingedLanes;r=r.warmLanes;var R=h&134217727;return R!==0?(h=R&~E,h!==0?v=mi(h):(A&=R,A!==0?v=mi(A):c||(c=R&~r,c!==0&&(v=mi(c))))):(R=h&~E,R!==0?v=mi(R):A!==0?v=mi(A):c||(c=h&~r,c!==0&&(v=mi(c)))),v===0?0:o!==0&&o!==v&&(o&E)===0&&(E=v&-v,c=o&-o,E>=c||E===32&&(c&4194048)!==0)?o:v}function Ys(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function vg(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zh(){var r=sn;return sn<<=1,(sn&62914560)===0&&(sn=4194304),r}function gi(r){for(var o=[],c=0;31>c;c++)o.push(r);return o}function Qo(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Eg(r,o,c,h,v,E){var A=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var R=r.entanglements,j=r.expirationTimes,ne=r.hiddenUpdates;for(c=A&~c;0<c;){var ce=31-Yt(c),de=1<<ce;R[ce]=0,j[ce]=-1;var se=ne[ce];if(se!==null)for(ne[ce]=null,ce=0;ce<se.length;ce++){var oe=se[ce];oe!==null&&(oe.lane&=-536870913)}c&=~de}h!==0&&Wo(r,h,0),E!==0&&v===0&&r.tag!==0&&(r.suspendedLanes|=E&~(A&~o))}function Wo(r,o,c){r.pendingLanes|=o,r.suspendedLanes&=~o;var h=31-Yt(o);r.entangledLanes|=o,r.entanglements[h]=r.entanglements[h]|1073741824|c&261930}function ru(r,o){var c=r.entangledLanes|=o;for(r=r.entanglements;c;){var h=31-Yt(c),v=1<<h;v&o|r[h]&o&&(r[h]|=o),c&=~v}}function ou(r,o){var c=o&-o;return c=(c&42)!==0?1:Xo(c),(c&(r.suspendedLanes|o))!==0?0:c}function Xo(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Qi(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function $h(){var r=ge.p;return r!==0?r:(r=window.event,r===void 0?32:hb(r.type))}function Ks(r,o){var c=ge.p;try{return ge.p=r,o()}finally{ge.p=c}}var Js=Math.random().toString(36).slice(2),rn="__reactFiber$"+Js,vn="__reactProps$"+Js,yi="__reactContainer$"+Js,ul="__reactEvents$"+Js,Tg="__reactListeners$"+Js,Yh="__reactHandles$"+Js,Kh="__reactResources$"+Js,_i="__reactMarker$"+Js;function dl(r){delete r[rn],delete r[vn],delete r[ul],delete r[Tg],delete r[Yh]}function vi(r){var o=r[rn];if(o)return o;for(var c=r.parentNode;c;){if(o=c[yi]||c[rn]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(r=QI(r);r!==null;){if(c=r[rn])return c;r=QI(r)}return o}r=c,c=r.parentNode}return null}function Ss(r){if(r=r[rn]||r[yi]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function hs(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(s(33))}function Ei(r){var o=r[Kh];return o||(o=r[Kh]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function on(r){r[_i]=!0}var au=new Set,lu={};function Ti(r,o){xi(r,o),xi(r+"Capture",o)}function xi(r,o){for(lu[r]=o,r=0;r<o.length;r++)au.add(o[r])}var cu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),uu={},du={};function Jh(r){return He.call(du,r)?!0:He.call(uu,r)?!1:cu.test(r)?du[r]=!0:(uu[r]=!0,!1)}function hl(r,o,c){if(Jh(o))if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+c)}}function fs(r,o,c){if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+c)}}function an(r,o,c,h){if(h===null)r.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(o,c,""+h)}}function En(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Lr(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function hu(r,o,c){var h=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var v=h.get,E=h.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return v.call(this)},set:function(A){c=""+A,E.call(this,A)}}),Object.defineProperty(r,o,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(A){c=""+A},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function yt(r){if(!r._valueTracker){var o=Lr(r)?"checked":"value";r._valueTracker=hu(r,o,""+r[o])}}function Zo(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var c=o.getValue(),h="";return r&&(h=Lr(r)?r.checked?"true":"false":r.value),r=h,r!==c?(o.setValue(r),!0):!1}function Ii(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var ea=/[\n"\\]/g;function es(r){return r.replace(ea,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function fl(r,o,c,h,v,E,A,R){r.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?r.type=A:r.removeAttribute("type"),o!=null?A==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+En(o)):r.value!==""+En(o)&&(r.value=""+En(o)):A!=="submit"&&A!=="reset"||r.removeAttribute("value"),o!=null?fu(r,A,En(o)):c!=null?fu(r,A,En(c)):h!=null&&r.removeAttribute("value"),v==null&&E!=null&&(r.defaultChecked=!!E),v!=null&&(r.checked=v&&typeof v!="function"&&typeof v!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?r.name=""+En(R):r.removeAttribute("name")}function Qh(r,o,c,h,v,E,A,R){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(r.type=E),o!=null||c!=null){if(!(E!=="submit"&&E!=="reset"||o!=null)){yt(r);return}c=c!=null?""+En(c):"",o=o!=null?""+En(o):c,R||o===r.value||(r.value=o),r.defaultValue=o}h=h??v,h=typeof h!="function"&&typeof h!="symbol"&&!!h,r.checked=R?r.checked:!!h,r.defaultChecked=!!h,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(r.name=A),yt(r)}function fu(r,o,c){o==="number"&&Ii(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function Ur(r,o,c,h){if(r=r.options,o){o={};for(var v=0;v<c.length;v++)o["$"+c[v]]=!0;for(c=0;c<r.length;c++)v=o.hasOwnProperty("$"+r[c].value),r[c].selected!==v&&(r[c].selected=v),v&&h&&(r[c].defaultSelected=!0)}else{for(c=""+En(c),o=null,v=0;v<r.length;v++){if(r[v].value===c){r[v].selected=!0,h&&(r[v].defaultSelected=!0);return}o!==null||r[v].disabled||(o=r[v])}o!==null&&(o.selected=!0)}}function Wh(r,o,c){if(o!=null&&(o=""+En(o),o!==r.value&&(r.value=o),c==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=c!=null?""+En(c):""}function Or(r,o,c,h){if(o==null){if(h!=null){if(c!=null)throw Error(s(92));if(Ie(h)){if(1<h.length)throw Error(s(93));h=h[0]}c=h}c==null&&(c=""),o=c}c=En(o),r.defaultValue=c,h=r.textContent,h===c&&h!==""&&h!==null&&(r.value=h),yt(r)}function ts(r,o){if(o){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=o;return}}r.textContent=o}var Xh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function mu(r,o,c){var h=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":h?r.setProperty(o,c):typeof c!="number"||c===0||Xh.has(o)?o==="float"?r.cssFloat=c:r[o]=(""+c).trim():r[o]=c+"px"}function pu(r,o,c){if(o!=null&&typeof o!="object")throw Error(s(62));if(r=r.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?r.setProperty(h,""):h==="float"?r.cssFloat="":r[h]="");for(var v in o)h=o[v],o.hasOwnProperty(v)&&c[v]!==h&&mu(r,v,h)}else for(var E in o)o.hasOwnProperty(E)&&mu(r,E,o[E])}function ml(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pl(r){return Fr.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Qs(){}var gu=null;function Cs(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Br=null,bi=null;function ta(r){var o=Ss(r);if(o&&(r=o.stateNode)){var c=r[vn]||null;e:switch(r=o.stateNode,o.type){case"input":if(fl(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+es(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var h=c[o];if(h!==r&&h.form===r.form){var v=h[vn]||null;if(!v)throw Error(s(90));fl(h,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(o=0;o<c.length;o++)h=c[o],h.form===r.form&&Zo(h)}break e;case"textarea":Wh(r,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&Ur(r,!!c.multiple,o,!1)}}}var gl=!1;function jr(r,o,c){if(gl)return r(o,c);gl=!0;try{var h=r(o);return h}finally{if(gl=!1,(Br!==null||bi!==null)&&(Yf(),Br&&(o=Br,r=bi,bi=Br=null,ta(o),r)))for(o=0;o<r.length;o++)ta(r[o])}}function Ws(r,o){var c=r.stateNode;if(c===null)return null;var h=c[vn]||null;if(h===null)return null;c=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(s(231,o,typeof c));return c}var Rs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),na=!1;if(Rs)try{var xt={};Object.defineProperty(xt,"passive",{get:function(){na=!0}}),window.addEventListener("test",xt,xt),window.removeEventListener("test",xt,xt)}catch{na=!1}var Ai=null,yu=null,sa=null;function _u(){if(sa)return sa;var r,o=yu,c=o.length,h,v="value"in Ai?Ai.value:Ai.textContent,E=v.length;for(r=0;r<c&&o[r]===v[r];r++);var A=c-r;for(h=1;h<=A&&o[c-h]===v[E-h];h++);return sa=v.slice(r,1<h?1-h:void 0)}function ia(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Wi(){return!0}function Xs(){return!1}function Nn(r){function o(c,h,v,E,A){this._reactName=c,this._targetInst=v,this.type=h,this.nativeEvent=E,this.target=A,this.currentTarget=null;for(var R in r)r.hasOwnProperty(R)&&(c=r[R],this[R]=c?c(E):E[R]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?Wi:Xs,this.isPropagationStopped=Xs,this}return T(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Wi)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Wi)},persist:function(){},isPersistent:Wi}),o}var Xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wi=Nn(Xi),Gr=T({},Xi,{view:0,detail:0}),vu=Nn(Gr),qr,yl,Ni,_l=T({},Gr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hr,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ni&&(Ni&&r.type==="mousemove"?(qr=r.screenX-Ni.screenX,yl=r.screenY-Ni.screenY):yl=qr=0,Ni=r),qr)},movementY:function(r){return"movementY"in r?r.movementY:yl}}),Eu=Nn(_l),ra=T({},_l,{dataTransfer:0}),ef=Nn(ra),tf=T({},Gr,{relatedTarget:0}),oa=Nn(tf),Tu=T({},Xi,{animationName:0,elapsedTime:0,pseudoElement:0}),nf=Nn(Tu),vl=T({},Xi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),sf=Nn(vl),rf=T({},Xi,{data:0}),Si=Nn(rf),of={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},af={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cf(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=lf[r])?!!o[r]:!1}function Hr(){return cf}var $n=T({},Gr,{key:function(r){if(r.key){var o=of[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=ia(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?af[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hr,charCode:function(r){return r.type==="keypress"?ia(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ia(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),uf=Nn($n),df=T({},_l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zi=Nn(df),y=T({},Gr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hr}),I=Nn(y),N=T({},Xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),D=Nn(N),Z=T({},_l,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),re=Nn(Z),ve=T({},Xi,{newState:0,oldState:0}),Ye=Nn(ve),Kt=[9,13,27,32],ft=Rs&&"CompositionEvent"in window,kt=null;Rs&&"documentMode"in document&&(kt=document.documentMode);var Ps=Rs&&"TextEvent"in window&&!kt,Ci=Rs&&(!ft||kt&&8<kt&&11>=kt),Zs=" ",ei=!1;function aa(r,o){switch(r){case"keyup":return Kt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function El(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Tl=!1;function HD(r,o){switch(r){case"compositionend":return El(o);case"keypress":return o.which!==32?null:(ei=!0,Zs);case"textInput":return r=o.data,r===Zs&&ei?null:r;default:return null}}function zD(r,o){if(Tl)return r==="compositionend"||!ft&&aa(r,o)?(r=_u(),sa=yu=Ai=null,Tl=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Ci&&o.locale!=="ko"?null:o.data;default:return null}}var $D={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ZE(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!$D[r.type]:o==="textarea"}function eT(r,o,c,h){Br?bi?bi.push(h):bi=[h]:Br=h,o=em(o,"onChange"),0<o.length&&(c=new wi("onChange","change",null,c,h),r.push({event:c,listeners:o}))}var xu=null,Iu=null;function YD(r){LI(r,0)}function hf(r){var o=hs(r);if(Zo(o))return r}function tT(r,o){if(r==="change")return o}var nT=!1;if(Rs){var xg;if(Rs){var Ig="oninput"in document;if(!Ig){var sT=document.createElement("div");sT.setAttribute("oninput","return;"),Ig=typeof sT.oninput=="function"}xg=Ig}else xg=!1;nT=xg&&(!document.documentMode||9<document.documentMode)}function iT(){xu&&(xu.detachEvent("onpropertychange",rT),Iu=xu=null)}function rT(r){if(r.propertyName==="value"&&hf(Iu)){var o=[];eT(o,Iu,r,Cs(r)),jr(YD,o)}}function KD(r,o,c){r==="focusin"?(iT(),xu=o,Iu=c,xu.attachEvent("onpropertychange",rT)):r==="focusout"&&iT()}function JD(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return hf(Iu)}function QD(r,o){if(r==="click")return hf(o)}function WD(r,o){if(r==="input"||r==="change")return hf(o)}function XD(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var ms=typeof Object.is=="function"?Object.is:XD;function bu(r,o){if(ms(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var c=Object.keys(r),h=Object.keys(o);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var v=c[h];if(!He.call(o,v)||!ms(r[v],o[v]))return!1}return!0}function oT(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function aT(r,o){var c=oT(r);r=0;for(var h;c;){if(c.nodeType===3){if(h=r+c.textContent.length,r<=o&&h>=o)return{node:c,offset:o-r};r=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=oT(c)}}function lT(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?lT(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function cT(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=Ii(r.document);o instanceof r.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)r=o.contentWindow;else break;o=Ii(r.document)}return o}function bg(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var ZD=Rs&&"documentMode"in document&&11>=document.documentMode,xl=null,Ag=null,Au=null,wg=!1;function uT(r,o,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;wg||xl==null||xl!==Ii(h)||(h=xl,"selectionStart"in h&&bg(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Au&&bu(Au,h)||(Au=h,h=em(Ag,"onSelect"),0<h.length&&(o=new wi("onSelect","select",null,o,c),r.push({event:o,listeners:h}),o.target=xl)))}function la(r,o){var c={};return c[r.toLowerCase()]=o.toLowerCase(),c["Webkit"+r]="webkit"+o,c["Moz"+r]="moz"+o,c}var Il={animationend:la("Animation","AnimationEnd"),animationiteration:la("Animation","AnimationIteration"),animationstart:la("Animation","AnimationStart"),transitionrun:la("Transition","TransitionRun"),transitionstart:la("Transition","TransitionStart"),transitioncancel:la("Transition","TransitionCancel"),transitionend:la("Transition","TransitionEnd")},Ng={},dT={};Rs&&(dT=document.createElement("div").style,"AnimationEvent"in window||(delete Il.animationend.animation,delete Il.animationiteration.animation,delete Il.animationstart.animation),"TransitionEvent"in window||delete Il.transitionend.transition);function ca(r){if(Ng[r])return Ng[r];if(!Il[r])return r;var o=Il[r],c;for(c in o)if(o.hasOwnProperty(c)&&c in dT)return Ng[r]=o[c];return r}var hT=ca("animationend"),fT=ca("animationiteration"),mT=ca("animationstart"),eM=ca("transitionrun"),tM=ca("transitionstart"),nM=ca("transitioncancel"),pT=ca("transitionend"),gT=new Map,Sg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Sg.push("scrollEnd");function ti(r,o){gT.set(r,o),Ti(o,[r])}var ff=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Ds=[],bl=0,Cg=0;function mf(){for(var r=bl,o=Cg=bl=0;o<r;){var c=Ds[o];Ds[o++]=null;var h=Ds[o];Ds[o++]=null;var v=Ds[o];Ds[o++]=null;var E=Ds[o];if(Ds[o++]=null,h!==null&&v!==null){var A=h.pending;A===null?v.next=v:(v.next=A.next,A.next=v),h.pending=v}E!==0&&yT(c,v,E)}}function pf(r,o,c,h){Ds[bl++]=r,Ds[bl++]=o,Ds[bl++]=c,Ds[bl++]=h,Cg|=h,r.lanes|=h,r=r.alternate,r!==null&&(r.lanes|=h)}function Rg(r,o,c,h){return pf(r,o,c,h),gf(r)}function ua(r,o){return pf(r,null,null,o),gf(r)}function yT(r,o,c){r.lanes|=c;var h=r.alternate;h!==null&&(h.lanes|=c);for(var v=!1,E=r.return;E!==null;)E.childLanes|=c,h=E.alternate,h!==null&&(h.childLanes|=c),E.tag===22&&(r=E.stateNode,r===null||r._visibility&1||(v=!0)),r=E,E=E.return;return r.tag===3?(E=r.stateNode,v&&o!==null&&(v=31-Yt(c),r=E.hiddenUpdates,h=r[v],h===null?r[v]=[o]:h.push(o),o.lane=c|536870912),E):null}function gf(r){if(50<Yu)throw Yu=0,Fy=null,Error(s(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var Al={};function sM(r,o,c,h){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ps(r,o,c,h){return new sM(r,o,c,h)}function Pg(r){return r=r.prototype,!(!r||!r.isReactComponent)}function er(r,o){var c=r.alternate;return c===null?(c=ps(r.tag,o,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=o,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,o=r.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function _T(r,o){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,o=c.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function yf(r,o,c,h,v,E){var A=0;if(h=r,typeof r=="function")Pg(r)&&(A=1);else if(typeof r=="string")A=l2(r,c,_e.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case S:return r=ps(31,c,o,v),r.elementType=S,r.lanes=E,r;case G:return da(c.children,v,E,o);case F:A=8,v|=24;break;case Y:return r=ps(12,c,o,v|2),r.elementType=Y,r.lanes=E,r;case z:return r=ps(13,c,o,v),r.elementType=z,r.lanes=E,r;case J:return r=ps(19,c,o,v),r.elementType=J,r.lanes=E,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case H:A=10;break e;case K:A=9;break e;case U:A=11;break e;case P:A=14;break e;case C:A=16,h=null;break e}A=29,c=Error(s(130,r===null?"null":typeof r,"")),h=null}return o=ps(A,c,o,v),o.elementType=r,o.type=h,o.lanes=E,o}function da(r,o,c,h){return r=ps(7,r,h,o),r.lanes=c,r}function Dg(r,o,c){return r=ps(6,r,null,o),r.lanes=c,r}function vT(r){var o=ps(18,null,null,0);return o.stateNode=r,o}function Mg(r,o,c){return o=ps(4,r.children!==null?r.children:[],r.key,o),o.lanes=c,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var ET=new WeakMap;function Ms(r,o){if(typeof r=="object"&&r!==null){var c=ET.get(r);return c!==void 0?c:(o={value:r,source:o,stack:pt(o)},ET.set(r,o),o)}return{value:r,source:o,stack:pt(o)}}var wl=[],Nl=0,_f=null,wu=0,ks=[],Vs=0,zr=null,Ri=1,Pi="";function tr(r,o){wl[Nl++]=wu,wl[Nl++]=_f,_f=r,wu=o}function TT(r,o,c){ks[Vs++]=Ri,ks[Vs++]=Pi,ks[Vs++]=zr,zr=r;var h=Ri;r=Pi;var v=32-Yt(h)-1;h&=~(1<<v),c+=1;var E=32-Yt(o)+v;if(30<E){var A=v-v%5;E=(h&(1<<A)-1).toString(32),h>>=A,v-=A,Ri=1<<32-Yt(o)+v|c<<v|h,Pi=E+r}else Ri=1<<E|c<<v|h,Pi=r}function kg(r){r.return!==null&&(tr(r,1),TT(r,1,0))}function Vg(r){for(;r===_f;)_f=wl[--Nl],wl[Nl]=null,wu=wl[--Nl],wl[Nl]=null;for(;r===zr;)zr=ks[--Vs],ks[Vs]=null,Pi=ks[--Vs],ks[Vs]=null,Ri=ks[--Vs],ks[Vs]=null}function xT(r,o){ks[Vs++]=Ri,ks[Vs++]=Pi,ks[Vs++]=zr,Ri=o.id,Pi=o.overflow,zr=r}var Sn=null,Ct=null,rt=!1,$r=null,Ls=!1,Lg=Error(s(519));function Yr(r){var o=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Nu(Ms(o,r)),Lg}function IT(r){var o=r.stateNode,c=r.type,h=r.memoizedProps;switch(o[rn]=r,o[vn]=h,c){case"dialog":Ze("cancel",o),Ze("close",o);break;case"iframe":case"object":case"embed":Ze("load",o);break;case"video":case"audio":for(c=0;c<Ju.length;c++)Ze(Ju[c],o);break;case"source":Ze("error",o);break;case"img":case"image":case"link":Ze("error",o),Ze("load",o);break;case"details":Ze("toggle",o);break;case"input":Ze("invalid",o),Qh(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Ze("invalid",o);break;case"textarea":Ze("invalid",o),Or(o,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||h.suppressHydrationWarning===!0||BI(o.textContent,c)?(h.popover!=null&&(Ze("beforetoggle",o),Ze("toggle",o)),h.onScroll!=null&&Ze("scroll",o),h.onScrollEnd!=null&&Ze("scrollend",o),h.onClick!=null&&(o.onclick=Qs),o=!0):o=!1,o||Yr(r,!0)}function bT(r){for(Sn=r.return;Sn;)switch(Sn.tag){case 5:case 31:case 13:Ls=!1;return;case 27:case 3:Ls=!0;return;default:Sn=Sn.return}}function Sl(r){if(r!==Sn)return!1;if(!rt)return bT(r),rt=!0,!1;var o=r.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||e_(r.type,r.memoizedProps)),c=!c),c&&Ct&&Yr(r),bT(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));Ct=JI(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));Ct=JI(r)}else o===27?(o=Ct,ao(r.type)?(r=r_,r_=null,Ct=r):Ct=o):Ct=Sn?Os(r.stateNode.nextSibling):null;return!0}function ha(){Ct=Sn=null,rt=!1}function Ug(){var r=$r;return r!==null&&(rs===null?rs=r:rs.push.apply(rs,r),$r=null),r}function Nu(r){$r===null?$r=[r]:$r.push(r)}var Og=B(null),fa=null,nr=null;function Kr(r,o,c){me(Og,o._currentValue),o._currentValue=c}function sr(r){r._currentValue=Og.current,q(Og)}function Fg(r,o,c){for(;r!==null;){var h=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),r===c)break;r=r.return}}function Bg(r,o,c,h){var v=r.child;for(v!==null&&(v.return=r);v!==null;){var E=v.dependencies;if(E!==null){var A=v.child;E=E.firstContext;e:for(;E!==null;){var R=E;E=v;for(var j=0;j<o.length;j++)if(R.context===o[j]){E.lanes|=c,R=E.alternate,R!==null&&(R.lanes|=c),Fg(E.return,c,r),h||(A=null);break e}E=R.next}}else if(v.tag===18){if(A=v.return,A===null)throw Error(s(341));A.lanes|=c,E=A.alternate,E!==null&&(E.lanes|=c),Fg(A,c,r),A=null}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===r){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}}function Cl(r,o,c,h){r=null;for(var v=o,E=!1;v!==null;){if(!E){if((v.flags&524288)!==0)E=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var A=v.alternate;if(A===null)throw Error(s(387));if(A=A.memoizedProps,A!==null){var R=v.type;ms(v.pendingProps.value,A.value)||(r!==null?r.push(R):r=[R])}}else if(v===Ne.current){if(A=v.alternate,A===null)throw Error(s(387));A.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(r!==null?r.push(ed):r=[ed])}v=v.return}r!==null&&Bg(o,r,c,h),o.flags|=262144}function vf(r){for(r=r.firstContext;r!==null;){if(!ms(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ma(r){fa=r,nr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Cn(r){return AT(fa,r)}function Ef(r,o){return fa===null&&ma(r),AT(r,o)}function AT(r,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},nr===null){if(r===null)throw Error(s(308));nr=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else nr=nr.next=o;return c}var iM=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(c,h){r.push(h)}};this.abort=function(){o.aborted=!0,r.forEach(function(c){return c()})}},rM=n.unstable_scheduleCallback,oM=n.unstable_NormalPriority,ln={$$typeof:H,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jg(){return{controller:new iM,data:new Map,refCount:0}}function Su(r){r.refCount--,r.refCount===0&&rM(oM,function(){r.controller.abort()})}var Cu=null,Gg=0,Rl=0,Pl=null;function aM(r,o){if(Cu===null){var c=Cu=[];Gg=0,Rl=zy(),Pl={status:"pending",value:void 0,then:function(h){c.push(h)}}}return Gg++,o.then(wT,wT),o}function wT(){if(--Gg===0&&Cu!==null){Pl!==null&&(Pl.status="fulfilled");var r=Cu;Cu=null,Rl=0,Pl=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function lM(r,o){var c=[],h={status:"pending",value:null,reason:null,then:function(v){c.push(v)}};return r.then(function(){h.status="fulfilled",h.value=o;for(var v=0;v<c.length;v++)(0,c[v])(o)},function(v){for(h.status="rejected",h.reason=v,v=0;v<c.length;v++)(0,c[v])(void 0)}),h}var NT=Q.S;Q.S=function(r,o){uI=tn(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&aM(r,o),NT!==null&&NT(r,o)};var pa=B(null);function qg(){var r=pa.current;return r!==null?r:wt.pooledCache}function Tf(r,o){o===null?me(pa,pa.current):me(pa,o.pool)}function ST(){var r=qg();return r===null?null:{parent:ln._currentValue,pool:r}}var Dl=Error(s(460)),Hg=Error(s(474)),xf=Error(s(542)),If={then:function(){}};function CT(r){return r=r.status,r==="fulfilled"||r==="rejected"}function RT(r,o,c){switch(c=r[c],c===void 0?r.push(o):c!==o&&(o.then(Qs,Qs),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,DT(r),r;default:if(typeof o.status=="string")o.then(Qs,Qs);else{if(r=wt,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=o,r.status="pending",r.then(function(h){if(o.status==="pending"){var v=o;v.status="fulfilled",v.value=h}},function(h){if(o.status==="pending"){var v=o;v.status="rejected",v.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,DT(r),r}throw ya=o,Dl}}function ga(r){try{var o=r._init;return o(r._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(ya=c,Dl):c}}var ya=null;function PT(){if(ya===null)throw Error(s(459));var r=ya;return ya=null,r}function DT(r){if(r===Dl||r===xf)throw Error(s(483))}var Ml=null,Ru=0;function bf(r){var o=Ru;return Ru+=1,Ml===null&&(Ml=[]),RT(Ml,r,o)}function Pu(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Af(r,o){throw o.$$typeof===x?Error(s(525)):(r=Object.prototype.toString.call(o),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function MT(r){function o(W,$){if(r){var te=W.deletions;te===null?(W.deletions=[$],W.flags|=16):te.push($)}}function c(W,$){if(!r)return null;for(;$!==null;)o(W,$),$=$.sibling;return null}function h(W){for(var $=new Map;W!==null;)W.key!==null?$.set(W.key,W):$.set(W.index,W),W=W.sibling;return $}function v(W,$){return W=er(W,$),W.index=0,W.sibling=null,W}function E(W,$,te){return W.index=te,r?(te=W.alternate,te!==null?(te=te.index,te<$?(W.flags|=67108866,$):te):(W.flags|=67108866,$)):(W.flags|=1048576,$)}function A(W){return r&&W.alternate===null&&(W.flags|=67108866),W}function R(W,$,te,ue){return $===null||$.tag!==6?($=Dg(te,W.mode,ue),$.return=W,$):($=v($,te),$.return=W,$)}function j(W,$,te,ue){var Ue=te.type;return Ue===G?ce(W,$,te.props.children,ue,te.key):$!==null&&($.elementType===Ue||typeof Ue=="object"&&Ue!==null&&Ue.$$typeof===C&&ga(Ue)===$.type)?($=v($,te.props),Pu($,te),$.return=W,$):($=yf(te.type,te.key,te.props,null,W.mode,ue),Pu($,te),$.return=W,$)}function ne(W,$,te,ue){return $===null||$.tag!==4||$.stateNode.containerInfo!==te.containerInfo||$.stateNode.implementation!==te.implementation?($=Mg(te,W.mode,ue),$.return=W,$):($=v($,te.children||[]),$.return=W,$)}function ce(W,$,te,ue,Ue){return $===null||$.tag!==7?($=da(te,W.mode,ue,Ue),$.return=W,$):($=v($,te),$.return=W,$)}function de(W,$,te){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Dg(""+$,W.mode,te),$.return=W,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case b:return te=yf($.type,$.key,$.props,null,W.mode,te),Pu(te,$),te.return=W,te;case k:return $=Mg($,W.mode,te),$.return=W,$;case C:return $=ga($),de(W,$,te)}if(Ie($)||O($))return $=da($,W.mode,te,null),$.return=W,$;if(typeof $.then=="function")return de(W,bf($),te);if($.$$typeof===H)return de(W,Ef(W,$),te);Af(W,$)}return null}function se(W,$,te,ue){var Ue=$!==null?$.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return Ue!==null?null:R(W,$,""+te,ue);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case b:return te.key===Ue?j(W,$,te,ue):null;case k:return te.key===Ue?ne(W,$,te,ue):null;case C:return te=ga(te),se(W,$,te,ue)}if(Ie(te)||O(te))return Ue!==null?null:ce(W,$,te,ue,null);if(typeof te.then=="function")return se(W,$,bf(te),ue);if(te.$$typeof===H)return se(W,$,Ef(W,te),ue);Af(W,te)}return null}function oe(W,$,te,ue,Ue){if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return W=W.get(te)||null,R($,W,""+ue,Ue);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case b:return W=W.get(ue.key===null?te:ue.key)||null,j($,W,ue,Ue);case k:return W=W.get(ue.key===null?te:ue.key)||null,ne($,W,ue,Ue);case C:return ue=ga(ue),oe(W,$,te,ue,Ue)}if(Ie(ue)||O(ue))return W=W.get(te)||null,ce($,W,ue,Ue,null);if(typeof ue.then=="function")return oe(W,$,te,bf(ue),Ue);if(ue.$$typeof===H)return oe(W,$,te,Ef($,ue),Ue);Af($,ue)}return null}function Se(W,$,te,ue){for(var Ue=null,lt=null,De=$,Qe=$=0,st=null;De!==null&&Qe<te.length;Qe++){De.index>Qe?(st=De,De=null):st=De.sibling;var ct=se(W,De,te[Qe],ue);if(ct===null){De===null&&(De=st);break}r&&De&&ct.alternate===null&&o(W,De),$=E(ct,$,Qe),lt===null?Ue=ct:lt.sibling=ct,lt=ct,De=st}if(Qe===te.length)return c(W,De),rt&&tr(W,Qe),Ue;if(De===null){for(;Qe<te.length;Qe++)De=de(W,te[Qe],ue),De!==null&&($=E(De,$,Qe),lt===null?Ue=De:lt.sibling=De,lt=De);return rt&&tr(W,Qe),Ue}for(De=h(De);Qe<te.length;Qe++)st=oe(De,W,Qe,te[Qe],ue),st!==null&&(r&&st.alternate!==null&&De.delete(st.key===null?Qe:st.key),$=E(st,$,Qe),lt===null?Ue=st:lt.sibling=st,lt=st);return r&&De.forEach(function(fo){return o(W,fo)}),rt&&tr(W,Qe),Ue}function Be(W,$,te,ue){if(te==null)throw Error(s(151));for(var Ue=null,lt=null,De=$,Qe=$=0,st=null,ct=te.next();De!==null&&!ct.done;Qe++,ct=te.next()){De.index>Qe?(st=De,De=null):st=De.sibling;var fo=se(W,De,ct.value,ue);if(fo===null){De===null&&(De=st);break}r&&De&&fo.alternate===null&&o(W,De),$=E(fo,$,Qe),lt===null?Ue=fo:lt.sibling=fo,lt=fo,De=st}if(ct.done)return c(W,De),rt&&tr(W,Qe),Ue;if(De===null){for(;!ct.done;Qe++,ct=te.next())ct=de(W,ct.value,ue),ct!==null&&($=E(ct,$,Qe),lt===null?Ue=ct:lt.sibling=ct,lt=ct);return rt&&tr(W,Qe),Ue}for(De=h(De);!ct.done;Qe++,ct=te.next())ct=oe(De,W,Qe,ct.value,ue),ct!==null&&(r&&ct.alternate!==null&&De.delete(ct.key===null?Qe:ct.key),$=E(ct,$,Qe),lt===null?Ue=ct:lt.sibling=ct,lt=ct);return r&&De.forEach(function(v2){return o(W,v2)}),rt&&tr(W,Qe),Ue}function At(W,$,te,ue){if(typeof te=="object"&&te!==null&&te.type===G&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case b:e:{for(var Ue=te.key;$!==null;){if($.key===Ue){if(Ue=te.type,Ue===G){if($.tag===7){c(W,$.sibling),ue=v($,te.props.children),ue.return=W,W=ue;break e}}else if($.elementType===Ue||typeof Ue=="object"&&Ue!==null&&Ue.$$typeof===C&&ga(Ue)===$.type){c(W,$.sibling),ue=v($,te.props),Pu(ue,te),ue.return=W,W=ue;break e}c(W,$);break}else o(W,$);$=$.sibling}te.type===G?(ue=da(te.props.children,W.mode,ue,te.key),ue.return=W,W=ue):(ue=yf(te.type,te.key,te.props,null,W.mode,ue),Pu(ue,te),ue.return=W,W=ue)}return A(W);case k:e:{for(Ue=te.key;$!==null;){if($.key===Ue)if($.tag===4&&$.stateNode.containerInfo===te.containerInfo&&$.stateNode.implementation===te.implementation){c(W,$.sibling),ue=v($,te.children||[]),ue.return=W,W=ue;break e}else{c(W,$);break}else o(W,$);$=$.sibling}ue=Mg(te,W.mode,ue),ue.return=W,W=ue}return A(W);case C:return te=ga(te),At(W,$,te,ue)}if(Ie(te))return Se(W,$,te,ue);if(O(te)){if(Ue=O(te),typeof Ue!="function")throw Error(s(150));return te=Ue.call(te),Be(W,$,te,ue)}if(typeof te.then=="function")return At(W,$,bf(te),ue);if(te.$$typeof===H)return At(W,$,Ef(W,te),ue);Af(W,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,$!==null&&$.tag===6?(c(W,$.sibling),ue=v($,te),ue.return=W,W=ue):(c(W,$),ue=Dg(te,W.mode,ue),ue.return=W,W=ue),A(W)):c(W,$)}return function(W,$,te,ue){try{Ru=0;var Ue=At(W,$,te,ue);return Ml=null,Ue}catch(De){if(De===Dl||De===xf)throw De;var lt=ps(29,De,null,W.mode);return lt.lanes=ue,lt.return=W,lt}finally{}}}var _a=MT(!0),kT=MT(!1),Jr=!1;function zg(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $g(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Qr(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Wr(r,o,c){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(mt&2)!==0){var v=h.pending;return v===null?o.next=o:(o.next=v.next,v.next=o),h.pending=o,o=gf(r),yT(r,null,c),o}return pf(r,h,o,c),gf(r)}function Du(r,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var h=o.lanes;h&=r.pendingLanes,c|=h,o.lanes=c,ru(r,c)}}function Yg(r,o){var c=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var v=null,E=null;if(c=c.firstBaseUpdate,c!==null){do{var A={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};E===null?v=E=A:E=E.next=A,c=c.next}while(c!==null);E===null?v=E=o:E=E.next=o}else v=E=o;c={baseState:h.baseState,firstBaseUpdate:v,lastBaseUpdate:E,shared:h.shared,callbacks:h.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=o:r.next=o,c.lastBaseUpdate=o}var Kg=!1;function Mu(){if(Kg){var r=Pl;if(r!==null)throw r}}function ku(r,o,c,h){Kg=!1;var v=r.updateQueue;Jr=!1;var E=v.firstBaseUpdate,A=v.lastBaseUpdate,R=v.shared.pending;if(R!==null){v.shared.pending=null;var j=R,ne=j.next;j.next=null,A===null?E=ne:A.next=ne,A=j;var ce=r.alternate;ce!==null&&(ce=ce.updateQueue,R=ce.lastBaseUpdate,R!==A&&(R===null?ce.firstBaseUpdate=ne:R.next=ne,ce.lastBaseUpdate=j))}if(E!==null){var de=v.baseState;A=0,ce=ne=j=null,R=E;do{var se=R.lane&-536870913,oe=se!==R.lane;if(oe?(nt&se)===se:(h&se)===se){se!==0&&se===Rl&&(Kg=!0),ce!==null&&(ce=ce.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Se=r,Be=R;se=o;var At=c;switch(Be.tag){case 1:if(Se=Be.payload,typeof Se=="function"){de=Se.call(At,de,se);break e}de=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=Be.payload,se=typeof Se=="function"?Se.call(At,de,se):Se,se==null)break e;de=T({},de,se);break e;case 2:Jr=!0}}se=R.callback,se!==null&&(r.flags|=64,oe&&(r.flags|=8192),oe=v.callbacks,oe===null?v.callbacks=[se]:oe.push(se))}else oe={lane:se,tag:R.tag,payload:R.payload,callback:R.callback,next:null},ce===null?(ne=ce=oe,j=de):ce=ce.next=oe,A|=se;if(R=R.next,R===null){if(R=v.shared.pending,R===null)break;oe=R,R=oe.next,oe.next=null,v.lastBaseUpdate=oe,v.shared.pending=null}}while(!0);ce===null&&(j=de),v.baseState=j,v.firstBaseUpdate=ne,v.lastBaseUpdate=ce,E===null&&(v.shared.lanes=0),no|=A,r.lanes=A,r.memoizedState=de}}function VT(r,o){if(typeof r!="function")throw Error(s(191,r));r.call(o)}function LT(r,o){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)VT(c[r],o)}var kl=B(null),wf=B(0);function UT(r,o){r=hr,me(wf,r),me(kl,o),hr=r|o.baseLanes}function Jg(){me(wf,hr),me(kl,kl.current)}function Qg(){hr=wf.current,q(kl),q(wf)}var gs=B(null),Us=null;function Xr(r){var o=r.alternate;me(Jt,Jt.current&1),me(gs,r),Us===null&&(o===null||kl.current!==null||o.memoizedState!==null)&&(Us=r)}function Wg(r){me(Jt,Jt.current),me(gs,r),Us===null&&(Us=r)}function OT(r){r.tag===22?(me(Jt,Jt.current),me(gs,r),Us===null&&(Us=r)):Zr()}function Zr(){me(Jt,Jt.current),me(gs,gs.current)}function ys(r){q(gs),Us===r&&(Us=null),q(Jt)}var Jt=B(0);function Nf(r){for(var o=r;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||s_(c)||i_(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var ir=0,Ke=null,It=null,cn=null,Sf=!1,Vl=!1,va=!1,Cf=0,Vu=0,Ll=null,cM=0;function Gt(){throw Error(s(321))}function Xg(r,o){if(o===null)return!1;for(var c=0;c<o.length&&c<r.length;c++)if(!ms(r[c],o[c]))return!1;return!0}function Zg(r,o,c,h,v,E){return ir=E,Ke=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Q.H=r===null||r.memoizedState===null?Tx:my,va=!1,E=c(h,v),va=!1,Vl&&(E=BT(o,c,h,v)),FT(r),E}function FT(r){Q.H=Ou;var o=It!==null&&It.next!==null;if(ir=0,cn=It=Ke=null,Sf=!1,Vu=0,Ll=null,o)throw Error(s(300));r===null||un||(r=r.dependencies,r!==null&&vf(r)&&(un=!0))}function BT(r,o,c,h){Ke=r;var v=0;do{if(Vl&&(Ll=null),Vu=0,Vl=!1,25<=v)throw Error(s(301));if(v+=1,cn=It=null,r.updateQueue!=null){var E=r.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}Q.H=xx,E=o(c,h)}while(Vl);return E}function uM(){var r=Q.H,o=r.useState()[0];return o=typeof o.then=="function"?Lu(o):o,r=r.useState()[0],(It!==null?It.memoizedState:null)!==r&&(Ke.flags|=1024),o}function ey(){var r=Cf!==0;return Cf=0,r}function ty(r,o,c){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~c}function ny(r){if(Sf){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Sf=!1}ir=0,cn=It=Ke=null,Vl=!1,Vu=Cf=0,Ll=null}function Yn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cn===null?Ke.memoizedState=cn=r:cn=cn.next=r,cn}function Qt(){if(It===null){var r=Ke.alternate;r=r!==null?r.memoizedState:null}else r=It.next;var o=cn===null?Ke.memoizedState:cn.next;if(o!==null)cn=o,It=r;else{if(r===null)throw Ke.alternate===null?Error(s(467)):Error(s(310));It=r,r={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},cn===null?Ke.memoizedState=cn=r:cn=cn.next=r}return cn}function Rf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Lu(r){var o=Vu;return Vu+=1,Ll===null&&(Ll=[]),r=RT(Ll,r,o),o=Ke,(cn===null?o.memoizedState:cn.next)===null&&(o=o.alternate,Q.H=o===null||o.memoizedState===null?Tx:my),r}function Pf(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Lu(r);if(r.$$typeof===H)return Cn(r)}throw Error(s(438,String(r)))}function sy(r){var o=null,c=Ke.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var h=Ke.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(v){return v.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=Rf(),Ke.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(r),h=0;h<r;h++)c[h]=L;return o.index++,c}function rr(r,o){return typeof o=="function"?o(r):o}function Df(r){var o=Qt();return iy(o,It,r)}function iy(r,o,c){var h=r.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=c;var v=r.baseQueue,E=h.pending;if(E!==null){if(v!==null){var A=v.next;v.next=E.next,E.next=A}o.baseQueue=v=E,h.pending=null}if(E=r.baseState,v===null)r.memoizedState=E;else{o=v.next;var R=A=null,j=null,ne=o,ce=!1;do{var de=ne.lane&-536870913;if(de!==ne.lane?(nt&de)===de:(ir&de)===de){var se=ne.revertLane;if(se===0)j!==null&&(j=j.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),de===Rl&&(ce=!0);else if((ir&se)===se){ne=ne.next,se===Rl&&(ce=!0);continue}else de={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},j===null?(R=j=de,A=E):j=j.next=de,Ke.lanes|=se,no|=se;de=ne.action,va&&c(E,de),E=ne.hasEagerState?ne.eagerState:c(E,de)}else se={lane:de,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},j===null?(R=j=se,A=E):j=j.next=se,Ke.lanes|=de,no|=de;ne=ne.next}while(ne!==null&&ne!==o);if(j===null?A=E:j.next=R,!ms(E,r.memoizedState)&&(un=!0,ce&&(c=Pl,c!==null)))throw c;r.memoizedState=E,r.baseState=A,r.baseQueue=j,h.lastRenderedState=E}return v===null&&(h.lanes=0),[r.memoizedState,h.dispatch]}function ry(r){var o=Qt(),c=o.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var h=c.dispatch,v=c.pending,E=o.memoizedState;if(v!==null){c.pending=null;var A=v=v.next;do E=r(E,A.action),A=A.next;while(A!==v);ms(E,o.memoizedState)||(un=!0),o.memoizedState=E,o.baseQueue===null&&(o.baseState=E),c.lastRenderedState=E}return[E,h]}function jT(r,o,c){var h=Ke,v=Qt(),E=rt;if(E){if(c===void 0)throw Error(s(407));c=c()}else c=o();var A=!ms((It||v).memoizedState,c);if(A&&(v.memoizedState=c,un=!0),v=v.queue,ly(HT.bind(null,h,v,r),[r]),v.getSnapshot!==o||A||cn!==null&&cn.memoizedState.tag&1){if(h.flags|=2048,Ul(9,{destroy:void 0},qT.bind(null,h,v,c,o),null),wt===null)throw Error(s(349));E||(ir&127)!==0||GT(h,o,c)}return c}function GT(r,o,c){r.flags|=16384,r={getSnapshot:o,value:c},o=Ke.updateQueue,o===null?(o=Rf(),Ke.updateQueue=o,o.stores=[r]):(c=o.stores,c===null?o.stores=[r]:c.push(r))}function qT(r,o,c,h){o.value=c,o.getSnapshot=h,zT(o)&&$T(r)}function HT(r,o,c){return c(function(){zT(o)&&$T(r)})}function zT(r){var o=r.getSnapshot;r=r.value;try{var c=o();return!ms(r,c)}catch{return!0}}function $T(r){var o=ua(r,2);o!==null&&os(o,r,2)}function oy(r){var o=Yn();if(typeof r=="function"){var c=r;if(r=c(),va){Ns(!0);try{c()}finally{Ns(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:r},o}function YT(r,o,c,h){return r.baseState=c,iy(r,It,typeof h=="function"?h:rr)}function dM(r,o,c,h,v){if(Vf(r))throw Error(s(485));if(r=o.action,r!==null){var E={payload:v,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){E.listeners.push(A)}};Q.T!==null?c(!0):E.isTransition=!1,h(E),c=o.pending,c===null?(E.next=o.pending=E,KT(o,E)):(E.next=c.next,o.pending=c.next=E)}}function KT(r,o){var c=o.action,h=o.payload,v=r.state;if(o.isTransition){var E=Q.T,A={};Q.T=A;try{var R=c(v,h),j=Q.S;j!==null&&j(A,R),JT(r,o,R)}catch(ne){ay(r,o,ne)}finally{E!==null&&A.types!==null&&(E.types=A.types),Q.T=E}}else try{E=c(v,h),JT(r,o,E)}catch(ne){ay(r,o,ne)}}function JT(r,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){QT(r,o,h)},function(h){return ay(r,o,h)}):QT(r,o,c)}function QT(r,o,c){o.status="fulfilled",o.value=c,WT(o),r.state=c,o=r.pending,o!==null&&(c=o.next,c===o?r.pending=null:(c=c.next,o.next=c,KT(r,c)))}function ay(r,o,c){var h=r.pending;if(r.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=c,WT(o),o=o.next;while(o!==h)}r.action=null}function WT(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function XT(r,o){return o}function ZT(r,o){if(rt){var c=wt.formState;if(c!==null){e:{var h=Ke;if(rt){if(Ct){t:{for(var v=Ct,E=Ls;v.nodeType!==8;){if(!E){v=null;break t}if(v=Os(v.nextSibling),v===null){v=null;break t}}E=v.data,v=E==="F!"||E==="F"?v:null}if(v){Ct=Os(v.nextSibling),h=v.data==="F!";break e}}Yr(h)}h=!1}h&&(o=c[0])}}return c=Yn(),c.memoizedState=c.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:XT,lastRenderedState:o},c.queue=h,c=_x.bind(null,Ke,h),h.dispatch=c,h=oy(!1),E=fy.bind(null,Ke,!1,h.queue),h=Yn(),v={state:o,dispatch:null,action:r,pending:null},h.queue=v,c=dM.bind(null,Ke,v,E,c),v.dispatch=c,h.memoizedState=r,[o,c,!1]}function ex(r){var o=Qt();return tx(o,It,r)}function tx(r,o,c){if(o=iy(r,o,XT)[0],r=Df(rr)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=Lu(o)}catch(A){throw A===Dl?xf:A}else h=o;o=Qt();var v=o.queue,E=v.dispatch;return c!==o.memoizedState&&(Ke.flags|=2048,Ul(9,{destroy:void 0},hM.bind(null,v,c),null)),[h,E,r]}function hM(r,o){r.action=o}function nx(r){var o=Qt(),c=It;if(c!==null)return tx(o,c,r);Qt(),o=o.memoizedState,c=Qt();var h=c.queue.dispatch;return c.memoizedState=r,[o,h,!1]}function Ul(r,o,c,h){return r={tag:r,create:c,deps:h,inst:o,next:null},o=Ke.updateQueue,o===null&&(o=Rf(),Ke.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=r.next=r:(h=c.next,c.next=r,r.next=h,o.lastEffect=r),r}function sx(){return Qt().memoizedState}function Mf(r,o,c,h){var v=Yn();Ke.flags|=r,v.memoizedState=Ul(1|o,{destroy:void 0},c,h===void 0?null:h)}function kf(r,o,c,h){var v=Qt();h=h===void 0?null:h;var E=v.memoizedState.inst;It!==null&&h!==null&&Xg(h,It.memoizedState.deps)?v.memoizedState=Ul(o,E,c,h):(Ke.flags|=r,v.memoizedState=Ul(1|o,E,c,h))}function ix(r,o){Mf(8390656,8,r,o)}function ly(r,o){kf(2048,8,r,o)}function fM(r){Ke.flags|=4;var o=Ke.updateQueue;if(o===null)o=Rf(),Ke.updateQueue=o,o.events=[r];else{var c=o.events;c===null?o.events=[r]:c.push(r)}}function rx(r){var o=Qt().memoizedState;return fM({ref:o,nextImpl:r}),function(){if((mt&2)!==0)throw Error(s(440));return o.impl.apply(void 0,arguments)}}function ox(r,o){return kf(4,2,r,o)}function ax(r,o){return kf(4,4,r,o)}function lx(r,o){if(typeof o=="function"){r=r();var c=o(r);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function cx(r,o,c){c=c!=null?c.concat([r]):null,kf(4,4,lx.bind(null,o,r),c)}function cy(){}function ux(r,o){var c=Qt();o=o===void 0?null:o;var h=c.memoizedState;return o!==null&&Xg(o,h[1])?h[0]:(c.memoizedState=[r,o],r)}function dx(r,o){var c=Qt();o=o===void 0?null:o;var h=c.memoizedState;if(o!==null&&Xg(o,h[1]))return h[0];if(h=r(),va){Ns(!0);try{r()}finally{Ns(!1)}}return c.memoizedState=[h,o],h}function uy(r,o,c){return c===void 0||(ir&1073741824)!==0&&(nt&261930)===0?r.memoizedState=o:(r.memoizedState=c,r=hI(),Ke.lanes|=r,no|=r,c)}function hx(r,o,c,h){return ms(c,o)?c:kl.current!==null?(r=uy(r,c,h),ms(r,o)||(un=!0),r):(ir&42)===0||(ir&1073741824)!==0&&(nt&261930)===0?(un=!0,r.memoizedState=c):(r=hI(),Ke.lanes|=r,no|=r,o)}function fx(r,o,c,h,v){var E=ge.p;ge.p=E!==0&&8>E?E:8;var A=Q.T,R={};Q.T=R,fy(r,!1,o,c);try{var j=v(),ne=Q.S;if(ne!==null&&ne(R,j),j!==null&&typeof j=="object"&&typeof j.then=="function"){var ce=lM(j,h);Uu(r,o,ce,Es(r))}else Uu(r,o,h,Es(r))}catch(de){Uu(r,o,{then:function(){},status:"rejected",reason:de},Es())}finally{ge.p=E,A!==null&&R.types!==null&&(A.types=R.types),Q.T=A}}function mM(){}function dy(r,o,c,h){if(r.tag!==5)throw Error(s(476));var v=mx(r).queue;fx(r,v,o,Ee,c===null?mM:function(){return px(r),c(h)})}function mx(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:Ee,baseState:Ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:Ee},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:c},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function px(r){var o=mx(r);o.next===null&&(o=r.alternate.memoizedState),Uu(r,o.next.queue,{},Es())}function hy(){return Cn(ed)}function gx(){return Qt().memoizedState}function yx(){return Qt().memoizedState}function pM(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var c=Es();r=Qr(c);var h=Wr(o,r,c);h!==null&&(os(h,o,c),Du(h,o,c)),o={cache:jg()},r.payload=o;return}o=o.return}}function gM(r,o,c){var h=Es();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Vf(r)?vx(o,c):(c=Rg(r,o,c,h),c!==null&&(os(c,r,h),Ex(c,o,h)))}function _x(r,o,c){var h=Es();Uu(r,o,c,h)}function Uu(r,o,c,h){var v={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Vf(r))vx(o,v);else{var E=r.alternate;if(r.lanes===0&&(E===null||E.lanes===0)&&(E=o.lastRenderedReducer,E!==null))try{var A=o.lastRenderedState,R=E(A,c);if(v.hasEagerState=!0,v.eagerState=R,ms(R,A))return pf(r,o,v,0),wt===null&&mf(),!1}catch{}finally{}if(c=Rg(r,o,v,h),c!==null)return os(c,r,h),Ex(c,o,h),!0}return!1}function fy(r,o,c,h){if(h={lane:2,revertLane:zy(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Vf(r)){if(o)throw Error(s(479))}else o=Rg(r,c,h,2),o!==null&&os(o,r,2)}function Vf(r){var o=r.alternate;return r===Ke||o!==null&&o===Ke}function vx(r,o){Vl=Sf=!0;var c=r.pending;c===null?o.next=o:(o.next=c.next,c.next=o),r.pending=o}function Ex(r,o,c){if((c&4194048)!==0){var h=o.lanes;h&=r.pendingLanes,c|=h,o.lanes=c,ru(r,c)}}var Ou={readContext:Cn,use:Pf,useCallback:Gt,useContext:Gt,useEffect:Gt,useImperativeHandle:Gt,useLayoutEffect:Gt,useInsertionEffect:Gt,useMemo:Gt,useReducer:Gt,useRef:Gt,useState:Gt,useDebugValue:Gt,useDeferredValue:Gt,useTransition:Gt,useSyncExternalStore:Gt,useId:Gt,useHostTransitionStatus:Gt,useFormState:Gt,useActionState:Gt,useOptimistic:Gt,useMemoCache:Gt,useCacheRefresh:Gt};Ou.useEffectEvent=Gt;var Tx={readContext:Cn,use:Pf,useCallback:function(r,o){return Yn().memoizedState=[r,o===void 0?null:o],r},useContext:Cn,useEffect:ix,useImperativeHandle:function(r,o,c){c=c!=null?c.concat([r]):null,Mf(4194308,4,lx.bind(null,o,r),c)},useLayoutEffect:function(r,o){return Mf(4194308,4,r,o)},useInsertionEffect:function(r,o){Mf(4,2,r,o)},useMemo:function(r,o){var c=Yn();o=o===void 0?null:o;var h=r();if(va){Ns(!0);try{r()}finally{Ns(!1)}}return c.memoizedState=[h,o],h},useReducer:function(r,o,c){var h=Yn();if(c!==void 0){var v=c(o);if(va){Ns(!0);try{c(o)}finally{Ns(!1)}}}else v=o;return h.memoizedState=h.baseState=v,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:v},h.queue=r,r=r.dispatch=gM.bind(null,Ke,r),[h.memoizedState,r]},useRef:function(r){var o=Yn();return r={current:r},o.memoizedState=r},useState:function(r){r=oy(r);var o=r.queue,c=_x.bind(null,Ke,o);return o.dispatch=c,[r.memoizedState,c]},useDebugValue:cy,useDeferredValue:function(r,o){var c=Yn();return uy(c,r,o)},useTransition:function(){var r=oy(!1);return r=fx.bind(null,Ke,r.queue,!0,!1),Yn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,c){var h=Ke,v=Yn();if(rt){if(c===void 0)throw Error(s(407));c=c()}else{if(c=o(),wt===null)throw Error(s(349));(nt&127)!==0||GT(h,o,c)}v.memoizedState=c;var E={value:c,getSnapshot:o};return v.queue=E,ix(HT.bind(null,h,E,r),[r]),h.flags|=2048,Ul(9,{destroy:void 0},qT.bind(null,h,E,c,o),null),c},useId:function(){var r=Yn(),o=wt.identifierPrefix;if(rt){var c=Pi,h=Ri;c=(h&~(1<<32-Yt(h)-1)).toString(32)+c,o="_"+o+"R_"+c,c=Cf++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=cM++,o="_"+o+"r_"+c.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:hy,useFormState:ZT,useActionState:ZT,useOptimistic:function(r){var o=Yn();o.memoizedState=o.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=fy.bind(null,Ke,!0,c),c.dispatch=o,[r,o]},useMemoCache:sy,useCacheRefresh:function(){return Yn().memoizedState=pM.bind(null,Ke)},useEffectEvent:function(r){var o=Yn(),c={impl:r};return o.memoizedState=c,function(){if((mt&2)!==0)throw Error(s(440));return c.impl.apply(void 0,arguments)}}},my={readContext:Cn,use:Pf,useCallback:ux,useContext:Cn,useEffect:ly,useImperativeHandle:cx,useInsertionEffect:ox,useLayoutEffect:ax,useMemo:dx,useReducer:Df,useRef:sx,useState:function(){return Df(rr)},useDebugValue:cy,useDeferredValue:function(r,o){var c=Qt();return hx(c,It.memoizedState,r,o)},useTransition:function(){var r=Df(rr)[0],o=Qt().memoizedState;return[typeof r=="boolean"?r:Lu(r),o]},useSyncExternalStore:jT,useId:gx,useHostTransitionStatus:hy,useFormState:ex,useActionState:ex,useOptimistic:function(r,o){var c=Qt();return YT(c,It,r,o)},useMemoCache:sy,useCacheRefresh:yx};my.useEffectEvent=rx;var xx={readContext:Cn,use:Pf,useCallback:ux,useContext:Cn,useEffect:ly,useImperativeHandle:cx,useInsertionEffect:ox,useLayoutEffect:ax,useMemo:dx,useReducer:ry,useRef:sx,useState:function(){return ry(rr)},useDebugValue:cy,useDeferredValue:function(r,o){var c=Qt();return It===null?uy(c,r,o):hx(c,It.memoizedState,r,o)},useTransition:function(){var r=ry(rr)[0],o=Qt().memoizedState;return[typeof r=="boolean"?r:Lu(r),o]},useSyncExternalStore:jT,useId:gx,useHostTransitionStatus:hy,useFormState:nx,useActionState:nx,useOptimistic:function(r,o){var c=Qt();return It!==null?YT(c,It,r,o):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:sy,useCacheRefresh:yx};xx.useEffectEvent=rx;function py(r,o,c,h){o=r.memoizedState,c=c(h,o),c=c==null?o:T({},o,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var gy={enqueueSetState:function(r,o,c){r=r._reactInternals;var h=Es(),v=Qr(h);v.payload=o,c!=null&&(v.callback=c),o=Wr(r,v,h),o!==null&&(os(o,r,h),Du(o,r,h))},enqueueReplaceState:function(r,o,c){r=r._reactInternals;var h=Es(),v=Qr(h);v.tag=1,v.payload=o,c!=null&&(v.callback=c),o=Wr(r,v,h),o!==null&&(os(o,r,h),Du(o,r,h))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var c=Es(),h=Qr(c);h.tag=2,o!=null&&(h.callback=o),o=Wr(r,h,c),o!==null&&(os(o,r,c),Du(o,r,c))}};function Ix(r,o,c,h,v,E,A){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,E,A):o.prototype&&o.prototype.isPureReactComponent?!bu(c,h)||!bu(v,E):!0}function bx(r,o,c,h){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,h),o.state!==r&&gy.enqueueReplaceState(o,o.state,null)}function Ea(r,o){var c=o;if("ref"in o){c={};for(var h in o)h!=="ref"&&(c[h]=o[h])}if(r=r.defaultProps){c===o&&(c=T({},c));for(var v in r)c[v]===void 0&&(c[v]=r[v])}return c}function Ax(r){ff(r)}function wx(r){console.error(r)}function Nx(r){ff(r)}function Lf(r,o){try{var c=r.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function Sx(r,o,c){try{var h=r.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function yy(r,o,c){return c=Qr(c),c.tag=3,c.payload={element:null},c.callback=function(){Lf(r,o)},c}function Cx(r){return r=Qr(r),r.tag=3,r}function Rx(r,o,c,h){var v=c.type.getDerivedStateFromError;if(typeof v=="function"){var E=h.value;r.payload=function(){return v(E)},r.callback=function(){Sx(o,c,h)}}var A=c.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(r.callback=function(){Sx(o,c,h),typeof v!="function"&&(so===null?so=new Set([this]):so.add(this));var R=h.stack;this.componentDidCatch(h.value,{componentStack:R!==null?R:""})})}function yM(r,o,c,h,v){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=c.alternate,o!==null&&Cl(o,c,v,!0),c=gs.current,c!==null){switch(c.tag){case 31:case 13:return Us===null?Kf():c.alternate===null&&qt===0&&(qt=3),c.flags&=-257,c.flags|=65536,c.lanes=v,h===If?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([h]):o.add(h),Gy(r,h,v)),!1;case 22:return c.flags|=65536,h===If?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([h]):c.add(h)),Gy(r,h,v)),!1}throw Error(s(435,c.tag))}return Gy(r,h,v),Kf(),!1}if(rt)return o=gs.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=v,h!==Lg&&(r=Error(s(422),{cause:h}),Nu(Ms(r,c)))):(h!==Lg&&(o=Error(s(423),{cause:h}),Nu(Ms(o,c))),r=r.current.alternate,r.flags|=65536,v&=-v,r.lanes|=v,h=Ms(h,c),v=yy(r.stateNode,h,v),Yg(r,v),qt!==4&&(qt=2)),!1;var E=Error(s(520),{cause:h});if(E=Ms(E,c),$u===null?$u=[E]:$u.push(E),qt!==4&&(qt=2),o===null)return!0;h=Ms(h,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,r=v&-v,c.lanes|=r,r=yy(c.stateNode,h,r),Yg(c,r),!1;case 1:if(o=c.type,E=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(so===null||!so.has(E))))return c.flags|=65536,v&=-v,c.lanes|=v,v=Cx(v),Rx(v,r,c,h),Yg(c,v),!1}c=c.return}while(c!==null);return!1}var _y=Error(s(461)),un=!1;function Rn(r,o,c,h){o.child=r===null?kT(o,null,c,h):_a(o,r.child,c,h)}function Px(r,o,c,h,v){c=c.render;var E=o.ref;if("ref"in h){var A={};for(var R in h)R!=="ref"&&(A[R]=h[R])}else A=h;return ma(o),h=Zg(r,o,c,A,E,v),R=ey(),r!==null&&!un?(ty(r,o,v),or(r,o,v)):(rt&&R&&kg(o),o.flags|=1,Rn(r,o,h,v),o.child)}function Dx(r,o,c,h,v){if(r===null){var E=c.type;return typeof E=="function"&&!Pg(E)&&E.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=E,Mx(r,o,E,h,v)):(r=yf(c.type,null,h,o,o.mode,v),r.ref=o.ref,r.return=o,o.child=r)}if(E=r.child,!wy(r,v)){var A=E.memoizedProps;if(c=c.compare,c=c!==null?c:bu,c(A,h)&&r.ref===o.ref)return or(r,o,v)}return o.flags|=1,r=er(E,h),r.ref=o.ref,r.return=o,o.child=r}function Mx(r,o,c,h,v){if(r!==null){var E=r.memoizedProps;if(bu(E,h)&&r.ref===o.ref)if(un=!1,o.pendingProps=h=E,wy(r,v))(r.flags&131072)!==0&&(un=!0);else return o.lanes=r.lanes,or(r,o,v)}return vy(r,o,c,h,v)}function kx(r,o,c,h){var v=h.children,E=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((o.flags&128)!==0){if(E=E!==null?E.baseLanes|c:c,r!==null){for(h=o.child=r.child,v=0;h!==null;)v=v|h.lanes|h.childLanes,h=h.sibling;h=v&~E}else h=0,o.child=null;return Vx(r,o,E,c,h)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Tf(o,E!==null?E.cachePool:null),E!==null?UT(o,E):Jg(),OT(o);else return h=o.lanes=536870912,Vx(r,o,E!==null?E.baseLanes|c:c,c,h)}else E!==null?(Tf(o,E.cachePool),UT(o,E),Zr(),o.memoizedState=null):(r!==null&&Tf(o,null),Jg(),Zr());return Rn(r,o,v,c),o.child}function Fu(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function Vx(r,o,c,h,v){var E=qg();return E=E===null?null:{parent:ln._currentValue,pool:E},o.memoizedState={baseLanes:c,cachePool:E},r!==null&&Tf(o,null),Jg(),OT(o),r!==null&&Cl(r,o,h,!0),o.childLanes=v,null}function Uf(r,o){return o=Ff({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function Lx(r,o,c){return _a(o,r.child,null,c),r=Uf(o,o.pendingProps),r.flags|=2,ys(o),o.memoizedState=null,r}function _M(r,o,c){var h=o.pendingProps,v=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(rt){if(h.mode==="hidden")return r=Uf(o,h),o.lanes=536870912,Fu(null,r);if(Wg(o),(r=Ct)?(r=KI(r,Ls),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:zr!==null?{id:Ri,overflow:Pi}:null,retryLane:536870912,hydrationErrors:null},c=vT(r),c.return=o,o.child=c,Sn=o,Ct=null)):r=null,r===null)throw Yr(o);return o.lanes=536870912,null}return Uf(o,h)}var E=r.memoizedState;if(E!==null){var A=E.dehydrated;if(Wg(o),v)if(o.flags&256)o.flags&=-257,o=Lx(r,o,c);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(s(558));else if(un||Cl(r,o,c,!1),v=(c&r.childLanes)!==0,un||v){if(h=wt,h!==null&&(A=ou(h,c),A!==0&&A!==E.retryLane))throw E.retryLane=A,ua(r,A),os(h,r,A),_y;Kf(),o=Lx(r,o,c)}else r=E.treeContext,Ct=Os(A.nextSibling),Sn=o,rt=!0,$r=null,Ls=!1,r!==null&&xT(o,r),o=Uf(o,h),o.flags|=4096;return o}return r=er(r.child,{mode:h.mode,children:h.children}),r.ref=o.ref,o.child=r,r.return=o,r}function Of(r,o){var c=o.ref;if(c===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(s(284));(r===null||r.ref!==c)&&(o.flags|=4194816)}}function vy(r,o,c,h,v){return ma(o),c=Zg(r,o,c,h,void 0,v),h=ey(),r!==null&&!un?(ty(r,o,v),or(r,o,v)):(rt&&h&&kg(o),o.flags|=1,Rn(r,o,c,v),o.child)}function Ux(r,o,c,h,v,E){return ma(o),o.updateQueue=null,c=BT(o,h,c,v),FT(r),h=ey(),r!==null&&!un?(ty(r,o,E),or(r,o,E)):(rt&&h&&kg(o),o.flags|=1,Rn(r,o,c,E),o.child)}function Ox(r,o,c,h,v){if(ma(o),o.stateNode===null){var E=Al,A=c.contextType;typeof A=="object"&&A!==null&&(E=Cn(A)),E=new c(h,E),o.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=gy,o.stateNode=E,E._reactInternals=o,E=o.stateNode,E.props=h,E.state=o.memoizedState,E.refs={},zg(o),A=c.contextType,E.context=typeof A=="object"&&A!==null?Cn(A):Al,E.state=o.memoizedState,A=c.getDerivedStateFromProps,typeof A=="function"&&(py(o,c,A,h),E.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(A=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),A!==E.state&&gy.enqueueReplaceState(E,E.state,null),ku(o,h,E,v),Mu(),E.state=o.memoizedState),typeof E.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(r===null){E=o.stateNode;var R=o.memoizedProps,j=Ea(c,R);E.props=j;var ne=E.context,ce=c.contextType;A=Al,typeof ce=="object"&&ce!==null&&(A=Cn(ce));var de=c.getDerivedStateFromProps;ce=typeof de=="function"||typeof E.getSnapshotBeforeUpdate=="function",R=o.pendingProps!==R,ce||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(R||ne!==A)&&bx(o,E,h,A),Jr=!1;var se=o.memoizedState;E.state=se,ku(o,h,E,v),Mu(),ne=o.memoizedState,R||se!==ne||Jr?(typeof de=="function"&&(py(o,c,de,h),ne=o.memoizedState),(j=Jr||Ix(o,c,j,h,se,ne,A))?(ce||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(o.flags|=4194308)):(typeof E.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=ne),E.props=h,E.state=ne,E.context=A,h=j):(typeof E.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{E=o.stateNode,$g(r,o),A=o.memoizedProps,ce=Ea(c,A),E.props=ce,de=o.pendingProps,se=E.context,ne=c.contextType,j=Al,typeof ne=="object"&&ne!==null&&(j=Cn(ne)),R=c.getDerivedStateFromProps,(ne=typeof R=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(A!==de||se!==j)&&bx(o,E,h,j),Jr=!1,se=o.memoizedState,E.state=se,ku(o,h,E,v),Mu();var oe=o.memoizedState;A!==de||se!==oe||Jr||r!==null&&r.dependencies!==null&&vf(r.dependencies)?(typeof R=="function"&&(py(o,c,R,h),oe=o.memoizedState),(ce=Jr||Ix(o,c,ce,h,se,oe,j)||r!==null&&r.dependencies!==null&&vf(r.dependencies))?(ne||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(h,oe,j),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(h,oe,j)),typeof E.componentDidUpdate=="function"&&(o.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof E.componentDidUpdate!="function"||A===r.memoizedProps&&se===r.memoizedState||(o.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||A===r.memoizedProps&&se===r.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=oe),E.props=h,E.state=oe,E.context=j,h=ce):(typeof E.componentDidUpdate!="function"||A===r.memoizedProps&&se===r.memoizedState||(o.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||A===r.memoizedProps&&se===r.memoizedState||(o.flags|=1024),h=!1)}return E=h,Of(r,o),h=(o.flags&128)!==0,E||h?(E=o.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:E.render(),o.flags|=1,r!==null&&h?(o.child=_a(o,r.child,null,v),o.child=_a(o,null,c,v)):Rn(r,o,c,v),o.memoizedState=E.state,r=o.child):r=or(r,o,v),r}function Fx(r,o,c,h){return ha(),o.flags|=256,Rn(r,o,c,h),o.child}var Ey={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ty(r){return{baseLanes:r,cachePool:ST()}}function xy(r,o,c){return r=r!==null?r.childLanes&~c:0,o&&(r|=vs),r}function Bx(r,o,c){var h=o.pendingProps,v=!1,E=(o.flags&128)!==0,A;if((A=E)||(A=r!==null&&r.memoizedState===null?!1:(Jt.current&2)!==0),A&&(v=!0,o.flags&=-129),A=(o.flags&32)!==0,o.flags&=-33,r===null){if(rt){if(v?Xr(o):Zr(),(r=Ct)?(r=KI(r,Ls),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:zr!==null?{id:Ri,overflow:Pi}:null,retryLane:536870912,hydrationErrors:null},c=vT(r),c.return=o,o.child=c,Sn=o,Ct=null)):r=null,r===null)throw Yr(o);return i_(r)?o.lanes=32:o.lanes=536870912,null}var R=h.children;return h=h.fallback,v?(Zr(),v=o.mode,R=Ff({mode:"hidden",children:R},v),h=da(h,v,c,null),R.return=o,h.return=o,R.sibling=h,o.child=R,h=o.child,h.memoizedState=Ty(c),h.childLanes=xy(r,A,c),o.memoizedState=Ey,Fu(null,h)):(Xr(o),Iy(o,R))}var j=r.memoizedState;if(j!==null&&(R=j.dehydrated,R!==null)){if(E)o.flags&256?(Xr(o),o.flags&=-257,o=by(r,o,c)):o.memoizedState!==null?(Zr(),o.child=r.child,o.flags|=128,o=null):(Zr(),R=h.fallback,v=o.mode,h=Ff({mode:"visible",children:h.children},v),R=da(R,v,c,null),R.flags|=2,h.return=o,R.return=o,h.sibling=R,o.child=h,_a(o,r.child,null,c),h=o.child,h.memoizedState=Ty(c),h.childLanes=xy(r,A,c),o.memoizedState=Ey,o=Fu(null,h));else if(Xr(o),i_(R)){if(A=R.nextSibling&&R.nextSibling.dataset,A)var ne=A.dgst;A=ne,h=Error(s(419)),h.stack="",h.digest=A,Nu({value:h,source:null,stack:null}),o=by(r,o,c)}else if(un||Cl(r,o,c,!1),A=(c&r.childLanes)!==0,un||A){if(A=wt,A!==null&&(h=ou(A,c),h!==0&&h!==j.retryLane))throw j.retryLane=h,ua(r,h),os(A,r,h),_y;s_(R)||Kf(),o=by(r,o,c)}else s_(R)?(o.flags|=192,o.child=r.child,o=null):(r=j.treeContext,Ct=Os(R.nextSibling),Sn=o,rt=!0,$r=null,Ls=!1,r!==null&&xT(o,r),o=Iy(o,h.children),o.flags|=4096);return o}return v?(Zr(),R=h.fallback,v=o.mode,j=r.child,ne=j.sibling,h=er(j,{mode:"hidden",children:h.children}),h.subtreeFlags=j.subtreeFlags&65011712,ne!==null?R=er(ne,R):(R=da(R,v,c,null),R.flags|=2),R.return=o,h.return=o,h.sibling=R,o.child=h,Fu(null,h),h=o.child,R=r.child.memoizedState,R===null?R=Ty(c):(v=R.cachePool,v!==null?(j=ln._currentValue,v=v.parent!==j?{parent:j,pool:j}:v):v=ST(),R={baseLanes:R.baseLanes|c,cachePool:v}),h.memoizedState=R,h.childLanes=xy(r,A,c),o.memoizedState=Ey,Fu(r.child,h)):(Xr(o),c=r.child,r=c.sibling,c=er(c,{mode:"visible",children:h.children}),c.return=o,c.sibling=null,r!==null&&(A=o.deletions,A===null?(o.deletions=[r],o.flags|=16):A.push(r)),o.child=c,o.memoizedState=null,c)}function Iy(r,o){return o=Ff({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function Ff(r,o){return r=ps(22,r,null,o),r.lanes=0,r}function by(r,o,c){return _a(o,r.child,null,c),r=Iy(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function jx(r,o,c){r.lanes|=o;var h=r.alternate;h!==null&&(h.lanes|=o),Fg(r.return,o,c)}function Ay(r,o,c,h,v,E){var A=r.memoizedState;A===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:v,treeForkCount:E}:(A.isBackwards=o,A.rendering=null,A.renderingStartTime=0,A.last=h,A.tail=c,A.tailMode=v,A.treeForkCount=E)}function Gx(r,o,c){var h=o.pendingProps,v=h.revealOrder,E=h.tail;h=h.children;var A=Jt.current,R=(A&2)!==0;if(R?(A=A&1|2,o.flags|=128):A&=1,me(Jt,A),Rn(r,o,h,c),h=rt?wu:0,!R&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&jx(r,c,o);else if(r.tag===19)jx(r,c,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(v){case"forwards":for(c=o.child,v=null;c!==null;)r=c.alternate,r!==null&&Nf(r)===null&&(v=c),c=c.sibling;c=v,c===null?(v=o.child,o.child=null):(v=c.sibling,c.sibling=null),Ay(o,!1,v,c,E,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,v=o.child,o.child=null;v!==null;){if(r=v.alternate,r!==null&&Nf(r)===null){o.child=v;break}r=v.sibling,v.sibling=c,c=v,v=r}Ay(o,!0,c,null,E,h);break;case"together":Ay(o,!1,null,null,void 0,h);break;default:o.memoizedState=null}return o.child}function or(r,o,c){if(r!==null&&(o.dependencies=r.dependencies),no|=o.lanes,(c&o.childLanes)===0)if(r!==null){if(Cl(r,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(s(153));if(o.child!==null){for(r=o.child,c=er(r,r.pendingProps),o.child=c,c.return=o;r.sibling!==null;)r=r.sibling,c=c.sibling=er(r,r.pendingProps),c.return=o;c.sibling=null}return o.child}function wy(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&vf(r)))}function vM(r,o,c){switch(o.tag){case 3:ht(o,o.stateNode.containerInfo),Kr(o,ln,r.memoizedState.cache),ha();break;case 27:case 5:at(o);break;case 4:ht(o,o.stateNode.containerInfo);break;case 10:Kr(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Wg(o),null;break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(Xr(o),o.flags|=128,null):(c&o.child.childLanes)!==0?Bx(r,o,c):(Xr(o),r=or(r,o,c),r!==null?r.sibling:null);Xr(o);break;case 19:var v=(r.flags&128)!==0;if(h=(c&o.childLanes)!==0,h||(Cl(r,o,c,!1),h=(c&o.childLanes)!==0),v){if(h)return Gx(r,o,c);o.flags|=128}if(v=o.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),me(Jt,Jt.current),h)break;return null;case 22:return o.lanes=0,kx(r,o,c,o.pendingProps);case 24:Kr(o,ln,r.memoizedState.cache)}return or(r,o,c)}function qx(r,o,c){if(r!==null)if(r.memoizedProps!==o.pendingProps)un=!0;else{if(!wy(r,c)&&(o.flags&128)===0)return un=!1,vM(r,o,c);un=(r.flags&131072)!==0}else un=!1,rt&&(o.flags&1048576)!==0&&TT(o,wu,o.index);switch(o.lanes=0,o.tag){case 16:e:{var h=o.pendingProps;if(r=ga(o.elementType),o.type=r,typeof r=="function")Pg(r)?(h=Ea(r,h),o.tag=1,o=Ox(null,o,r,h,c)):(o.tag=0,o=vy(null,o,r,h,c));else{if(r!=null){var v=r.$$typeof;if(v===U){o.tag=11,o=Px(null,o,r,h,c);break e}else if(v===P){o.tag=14,o=Dx(null,o,r,h,c);break e}}throw o=ae(r)||r,Error(s(306,o,""))}}return o;case 0:return vy(r,o,o.type,o.pendingProps,c);case 1:return h=o.type,v=Ea(h,o.pendingProps),Ox(r,o,h,v,c);case 3:e:{if(ht(o,o.stateNode.containerInfo),r===null)throw Error(s(387));h=o.pendingProps;var E=o.memoizedState;v=E.element,$g(r,o),ku(o,h,null,c);var A=o.memoizedState;if(h=A.cache,Kr(o,ln,h),h!==E.cache&&Bg(o,[ln],c,!0),Mu(),h=A.element,E.isDehydrated)if(E={element:h,isDehydrated:!1,cache:A.cache},o.updateQueue.baseState=E,o.memoizedState=E,o.flags&256){o=Fx(r,o,h,c);break e}else if(h!==v){v=Ms(Error(s(424)),o),Nu(v),o=Fx(r,o,h,c);break e}else{switch(r=o.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Ct=Os(r.firstChild),Sn=o,rt=!0,$r=null,Ls=!0,c=kT(o,null,h,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(ha(),h===v){o=or(r,o,c);break e}Rn(r,o,h,c)}o=o.child}return o;case 26:return Of(r,o),r===null?(c=eb(o.type,null,o.pendingProps,null))?o.memoizedState=c:rt||(c=o.type,r=o.pendingProps,h=tm(ye.current).createElement(c),h[rn]=o,h[vn]=r,Pn(h,c,r),on(h),o.stateNode=h):o.memoizedState=eb(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return at(o),r===null&&rt&&(h=o.stateNode=WI(o.type,o.pendingProps,ye.current),Sn=o,Ls=!0,v=Ct,ao(o.type)?(r_=v,Ct=Os(h.firstChild)):Ct=v),Rn(r,o,o.pendingProps.children,c),Of(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&rt&&((v=h=Ct)&&(h=JM(h,o.type,o.pendingProps,Ls),h!==null?(o.stateNode=h,Sn=o,Ct=Os(h.firstChild),Ls=!1,v=!0):v=!1),v||Yr(o)),at(o),v=o.type,E=o.pendingProps,A=r!==null?r.memoizedProps:null,h=E.children,e_(v,E)?h=null:A!==null&&e_(v,A)&&(o.flags|=32),o.memoizedState!==null&&(v=Zg(r,o,uM,null,null,c),ed._currentValue=v),Of(r,o),Rn(r,o,h,c),o.child;case 6:return r===null&&rt&&((r=c=Ct)&&(c=QM(c,o.pendingProps,Ls),c!==null?(o.stateNode=c,Sn=o,Ct=null,r=!0):r=!1),r||Yr(o)),null;case 13:return Bx(r,o,c);case 4:return ht(o,o.stateNode.containerInfo),h=o.pendingProps,r===null?o.child=_a(o,null,h,c):Rn(r,o,h,c),o.child;case 11:return Px(r,o,o.type,o.pendingProps,c);case 7:return Rn(r,o,o.pendingProps,c),o.child;case 8:return Rn(r,o,o.pendingProps.children,c),o.child;case 12:return Rn(r,o,o.pendingProps.children,c),o.child;case 10:return h=o.pendingProps,Kr(o,o.type,h.value),Rn(r,o,h.children,c),o.child;case 9:return v=o.type._context,h=o.pendingProps.children,ma(o),v=Cn(v),h=h(v),o.flags|=1,Rn(r,o,h,c),o.child;case 14:return Dx(r,o,o.type,o.pendingProps,c);case 15:return Mx(r,o,o.type,o.pendingProps,c);case 19:return Gx(r,o,c);case 31:return _M(r,o,c);case 22:return kx(r,o,c,o.pendingProps);case 24:return ma(o),h=Cn(ln),r===null?(v=qg(),v===null&&(v=wt,E=jg(),v.pooledCache=E,E.refCount++,E!==null&&(v.pooledCacheLanes|=c),v=E),o.memoizedState={parent:h,cache:v},zg(o),Kr(o,ln,v)):((r.lanes&c)!==0&&($g(r,o),ku(o,null,null,c),Mu()),v=r.memoizedState,E=o.memoizedState,v.parent!==h?(v={parent:h,cache:h},o.memoizedState=v,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=v),Kr(o,ln,h)):(h=E.cache,Kr(o,ln,h),h!==v.cache&&Bg(o,[ln],c,!0))),Rn(r,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(s(156,o.tag))}function ar(r){r.flags|=4}function Ny(r,o,c,h,v){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(v&335544128)===v)if(r.stateNode.complete)r.flags|=8192;else if(gI())r.flags|=8192;else throw ya=If,Hg}else r.flags&=-16777217}function Hx(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!rb(o))if(gI())r.flags|=8192;else throw ya=If,Hg}function Bf(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?zh():536870912,r.lanes|=o,jl|=o)}function Bu(r,o){if(!rt)switch(r.tailMode){case"hidden":o=r.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function Rt(r){var o=r.alternate!==null&&r.alternate.child===r.child,c=0,h=0;if(o)for(var v=r.child;v!==null;)c|=v.lanes|v.childLanes,h|=v.subtreeFlags&65011712,h|=v.flags&65011712,v.return=r,v=v.sibling;else for(v=r.child;v!==null;)c|=v.lanes|v.childLanes,h|=v.subtreeFlags,h|=v.flags,v.return=r,v=v.sibling;return r.subtreeFlags|=h,r.childLanes=c,o}function EM(r,o,c){var h=o.pendingProps;switch(Vg(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(o),null;case 1:return Rt(o),null;case 3:return c=o.stateNode,h=null,r!==null&&(h=r.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),sr(ln),qe(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(Sl(o)?ar(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Ug())),Rt(o),null;case 26:var v=o.type,E=o.memoizedState;return r===null?(ar(o),E!==null?(Rt(o),Hx(o,E)):(Rt(o),Ny(o,v,null,h,c))):E?E!==r.memoizedState?(ar(o),Rt(o),Hx(o,E)):(Rt(o),o.flags&=-16777217):(r=r.memoizedProps,r!==h&&ar(o),Rt(o),Ny(o,v,r,h,c)),null;case 27:if(_n(o),c=ye.current,v=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==h&&ar(o);else{if(!h){if(o.stateNode===null)throw Error(s(166));return Rt(o),null}r=_e.current,Sl(o)?IT(o):(r=WI(v,h,c),o.stateNode=r,ar(o))}return Rt(o),null;case 5:if(_n(o),v=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==h&&ar(o);else{if(!h){if(o.stateNode===null)throw Error(s(166));return Rt(o),null}if(E=_e.current,Sl(o))IT(o);else{var A=tm(ye.current);switch(E){case 1:E=A.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:E=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":E=A.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":E=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":E=A.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof h.is=="string"?A.createElement("select",{is:h.is}):A.createElement("select"),h.multiple?E.multiple=!0:h.size&&(E.size=h.size);break;default:E=typeof h.is=="string"?A.createElement(v,{is:h.is}):A.createElement(v)}}E[rn]=o,E[vn]=h;e:for(A=o.child;A!==null;){if(A.tag===5||A.tag===6)E.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===o)break e;for(;A.sibling===null;){if(A.return===null||A.return===o)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}o.stateNode=E;e:switch(Pn(E,v,h),v){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&ar(o)}}return Rt(o),Ny(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,c),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==h&&ar(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(s(166));if(r=ye.current,Sl(o)){if(r=o.stateNode,c=o.memoizedProps,h=null,v=Sn,v!==null)switch(v.tag){case 27:case 5:h=v.memoizedProps}r[rn]=o,r=!!(r.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||BI(r.nodeValue,c)),r||Yr(o,!0)}else r=tm(r).createTextNode(h),r[rn]=o,o.stateNode=r}return Rt(o),null;case 31:if(c=o.memoizedState,r===null||r.memoizedState!==null){if(h=Sl(o),c!==null){if(r===null){if(!h)throw Error(s(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(557));r[rn]=o}else ha(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Rt(o),r=!1}else c=Ug(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=c),r=!0;if(!r)return o.flags&256?(ys(o),o):(ys(o),null);if((o.flags&128)!==0)throw Error(s(558))}return Rt(o),null;case 13:if(h=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(v=Sl(o),h!==null&&h.dehydrated!==null){if(r===null){if(!v)throw Error(s(318));if(v=o.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(s(317));v[rn]=o}else ha(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Rt(o),v=!1}else v=Ug(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=v),v=!0;if(!v)return o.flags&256?(ys(o),o):(ys(o),null)}return ys(o),(o.flags&128)!==0?(o.lanes=c,o):(c=h!==null,r=r!==null&&r.memoizedState!==null,c&&(h=o.child,v=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(v=h.alternate.memoizedState.cachePool.pool),E=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(E=h.memoizedState.cachePool.pool),E!==v&&(h.flags|=2048)),c!==r&&c&&(o.child.flags|=8192),Bf(o,o.updateQueue),Rt(o),null);case 4:return qe(),r===null&&Jy(o.stateNode.containerInfo),Rt(o),null;case 10:return sr(o.type),Rt(o),null;case 19:if(q(Jt),h=o.memoizedState,h===null)return Rt(o),null;if(v=(o.flags&128)!==0,E=h.rendering,E===null)if(v)Bu(h,!1);else{if(qt!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(E=Nf(r),E!==null){for(o.flags|=128,Bu(h,!1),r=E.updateQueue,o.updateQueue=r,Bf(o,r),o.subtreeFlags=0,r=c,c=o.child;c!==null;)_T(c,r),c=c.sibling;return me(Jt,Jt.current&1|2),rt&&tr(o,h.treeForkCount),o.child}r=r.sibling}h.tail!==null&&tn()>zf&&(o.flags|=128,v=!0,Bu(h,!1),o.lanes=4194304)}else{if(!v)if(r=Nf(E),r!==null){if(o.flags|=128,v=!0,r=r.updateQueue,o.updateQueue=r,Bf(o,r),Bu(h,!0),h.tail===null&&h.tailMode==="hidden"&&!E.alternate&&!rt)return Rt(o),null}else 2*tn()-h.renderingStartTime>zf&&c!==536870912&&(o.flags|=128,v=!0,Bu(h,!1),o.lanes=4194304);h.isBackwards?(E.sibling=o.child,o.child=E):(r=h.last,r!==null?r.sibling=E:o.child=E,h.last=E)}return h.tail!==null?(r=h.tail,h.rendering=r,h.tail=r.sibling,h.renderingStartTime=tn(),r.sibling=null,c=Jt.current,me(Jt,v?c&1|2:c&1),rt&&tr(o,h.treeForkCount),r):(Rt(o),null);case 22:case 23:return ys(o),Qg(),h=o.memoizedState!==null,r!==null?r.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(c&536870912)!==0&&(o.flags&128)===0&&(Rt(o),o.subtreeFlags&6&&(o.flags|=8192)):Rt(o),c=o.updateQueue,c!==null&&Bf(o,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==c&&(o.flags|=2048),r!==null&&q(pa),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),sr(ln),Rt(o),null;case 25:return null;case 30:return null}throw Error(s(156,o.tag))}function TM(r,o){switch(Vg(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return sr(ln),qe(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return _n(o),null;case 31:if(o.memoizedState!==null){if(ys(o),o.alternate===null)throw Error(s(340));ha()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(ys(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(s(340));ha()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return q(Jt),null;case 4:return qe(),null;case 10:return sr(o.type),null;case 22:case 23:return ys(o),Qg(),r!==null&&q(pa),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return sr(ln),null;case 25:return null;default:return null}}function zx(r,o){switch(Vg(o),o.tag){case 3:sr(ln),qe();break;case 26:case 27:case 5:_n(o);break;case 4:qe();break;case 31:o.memoizedState!==null&&ys(o);break;case 13:ys(o);break;case 19:q(Jt);break;case 10:sr(o.type);break;case 22:case 23:ys(o),Qg(),r!==null&&q(pa);break;case 24:sr(ln)}}function ju(r,o){try{var c=o.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var v=h.next;c=v;do{if((c.tag&r)===r){h=void 0;var E=c.create,A=c.inst;h=E(),A.destroy=h}c=c.next}while(c!==v)}}catch(R){vt(o,o.return,R)}}function eo(r,o,c){try{var h=o.updateQueue,v=h!==null?h.lastEffect:null;if(v!==null){var E=v.next;h=E;do{if((h.tag&r)===r){var A=h.inst,R=A.destroy;if(R!==void 0){A.destroy=void 0,v=o;var j=c,ne=R;try{ne()}catch(ce){vt(v,j,ce)}}}h=h.next}while(h!==E)}}catch(ce){vt(o,o.return,ce)}}function $x(r){var o=r.updateQueue;if(o!==null){var c=r.stateNode;try{LT(o,c)}catch(h){vt(r,r.return,h)}}}function Yx(r,o,c){c.props=Ea(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(h){vt(r,o,h)}}function Gu(r,o){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var h=r.stateNode;break;case 30:h=r.stateNode;break;default:h=r.stateNode}typeof c=="function"?r.refCleanup=c(h):c.current=h}}catch(v){vt(r,o,v)}}function Di(r,o){var c=r.ref,h=r.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(v){vt(r,o,v)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(v){vt(r,o,v)}else c.current=null}function Kx(r){var o=r.type,c=r.memoizedProps,h=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(v){vt(r,r.return,v)}}function Sy(r,o,c){try{var h=r.stateNode;qM(h,r.type,c,o),h[vn]=o}catch(v){vt(r,r.return,v)}}function Jx(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&ao(r.type)||r.tag===4}function Cy(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Jx(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&ao(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Ry(r,o,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(r),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Qs));else if(h!==4&&(h===27&&ao(r.type)&&(c=r.stateNode,o=null),r=r.child,r!==null))for(Ry(r,o,c),r=r.sibling;r!==null;)Ry(r,o,c),r=r.sibling}function jf(r,o,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,o?c.insertBefore(r,o):c.appendChild(r);else if(h!==4&&(h===27&&ao(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(jf(r,o,c),r=r.sibling;r!==null;)jf(r,o,c),r=r.sibling}function Qx(r){var o=r.stateNode,c=r.memoizedProps;try{for(var h=r.type,v=o.attributes;v.length;)o.removeAttributeNode(v[0]);Pn(o,h,c),o[rn]=r,o[vn]=c}catch(E){vt(r,r.return,E)}}var lr=!1,dn=!1,Py=!1,Wx=typeof WeakSet=="function"?WeakSet:Set,Tn=null;function xM(r,o){if(r=r.containerInfo,Xy=lm,r=cT(r),bg(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var v=h.anchorOffset,E=h.focusNode;h=h.focusOffset;try{c.nodeType,E.nodeType}catch{c=null;break e}var A=0,R=-1,j=-1,ne=0,ce=0,de=r,se=null;t:for(;;){for(var oe;de!==c||v!==0&&de.nodeType!==3||(R=A+v),de!==E||h!==0&&de.nodeType!==3||(j=A+h),de.nodeType===3&&(A+=de.nodeValue.length),(oe=de.firstChild)!==null;)se=de,de=oe;for(;;){if(de===r)break t;if(se===c&&++ne===v&&(R=A),se===E&&++ce===h&&(j=A),(oe=de.nextSibling)!==null)break;de=se,se=de.parentNode}de=oe}c=R===-1||j===-1?null:{start:R,end:j}}else c=null}c=c||{start:0,end:0}}else c=null;for(Zy={focusedElem:r,selectionRange:c},lm=!1,Tn=o;Tn!==null;)if(o=Tn,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Tn=r;else for(;Tn!==null;){switch(o=Tn,E=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(c=0;c<r.length;c++)v=r[c],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&E!==null){r=void 0,c=o,v=E.memoizedProps,E=E.memoizedState,h=c.stateNode;try{var Se=Ea(c.type,v);r=h.getSnapshotBeforeUpdate(Se,E),h.__reactInternalSnapshotBeforeUpdate=r}catch(Be){vt(c,c.return,Be)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,c=r.nodeType,c===9)n_(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":n_(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=o.sibling,r!==null){r.return=o.return,Tn=r;break}Tn=o.return}}function Xx(r,o,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:ur(r,c),h&4&&ju(5,c);break;case 1:if(ur(r,c),h&4)if(r=c.stateNode,o===null)try{r.componentDidMount()}catch(A){vt(c,c.return,A)}else{var v=Ea(c.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(v,o,r.__reactInternalSnapshotBeforeUpdate)}catch(A){vt(c,c.return,A)}}h&64&&$x(c),h&512&&Gu(c,c.return);break;case 3:if(ur(r,c),h&64&&(r=c.updateQueue,r!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{LT(r,o)}catch(A){vt(c,c.return,A)}}break;case 27:o===null&&h&4&&Qx(c);case 26:case 5:ur(r,c),o===null&&h&4&&Kx(c),h&512&&Gu(c,c.return);break;case 12:ur(r,c);break;case 31:ur(r,c),h&4&&tI(r,c);break;case 13:ur(r,c),h&4&&nI(r,c),h&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=PM.bind(null,c),WM(r,c))));break;case 22:if(h=c.memoizedState!==null||lr,!h){o=o!==null&&o.memoizedState!==null||dn,v=lr;var E=dn;lr=h,(dn=o)&&!E?dr(r,c,(c.subtreeFlags&8772)!==0):ur(r,c),lr=v,dn=E}break;case 30:break;default:ur(r,c)}}function Zx(r){var o=r.alternate;o!==null&&(r.alternate=null,Zx(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&dl(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Vt=null,ns=!1;function cr(r,o,c){for(c=c.child;c!==null;)eI(r,o,c),c=c.sibling}function eI(r,o,c){if(wn&&typeof wn.onCommitFiberUnmount=="function")try{wn.onCommitFiberUnmount($s,c)}catch{}switch(c.tag){case 26:dn||Di(c,o),cr(r,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:dn||Di(c,o);var h=Vt,v=ns;ao(c.type)&&(Vt=c.stateNode,ns=!1),cr(r,o,c),Wu(c.stateNode),Vt=h,ns=v;break;case 5:dn||Di(c,o);case 6:if(h=Vt,v=ns,Vt=null,cr(r,o,c),Vt=h,ns=v,Vt!==null)if(ns)try{(Vt.nodeType===9?Vt.body:Vt.nodeName==="HTML"?Vt.ownerDocument.body:Vt).removeChild(c.stateNode)}catch(E){vt(c,o,E)}else try{Vt.removeChild(c.stateNode)}catch(E){vt(c,o,E)}break;case 18:Vt!==null&&(ns?(r=Vt,$I(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),Jl(r)):$I(Vt,c.stateNode));break;case 4:h=Vt,v=ns,Vt=c.stateNode.containerInfo,ns=!0,cr(r,o,c),Vt=h,ns=v;break;case 0:case 11:case 14:case 15:eo(2,c,o),dn||eo(4,c,o),cr(r,o,c);break;case 1:dn||(Di(c,o),h=c.stateNode,typeof h.componentWillUnmount=="function"&&Yx(c,o,h)),cr(r,o,c);break;case 21:cr(r,o,c);break;case 22:dn=(h=dn)||c.memoizedState!==null,cr(r,o,c),dn=h;break;default:cr(r,o,c)}}function tI(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Jl(r)}catch(c){vt(o,o.return,c)}}}function nI(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Jl(r)}catch(c){vt(o,o.return,c)}}function IM(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new Wx),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new Wx),o;default:throw Error(s(435,r.tag))}}function Gf(r,o){var c=IM(r);o.forEach(function(h){if(!c.has(h)){c.add(h);var v=DM.bind(null,r,h);h.then(v,v)}})}function ss(r,o){var c=o.deletions;if(c!==null)for(var h=0;h<c.length;h++){var v=c[h],E=r,A=o,R=A;e:for(;R!==null;){switch(R.tag){case 27:if(ao(R.type)){Vt=R.stateNode,ns=!1;break e}break;case 5:Vt=R.stateNode,ns=!1;break e;case 3:case 4:Vt=R.stateNode.containerInfo,ns=!0;break e}R=R.return}if(Vt===null)throw Error(s(160));eI(E,A,v),Vt=null,ns=!1,E=v.alternate,E!==null&&(E.return=null),v.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)sI(o,r),o=o.sibling}var ni=null;function sI(r,o){var c=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:ss(o,r),is(r),h&4&&(eo(3,r,r.return),ju(3,r),eo(5,r,r.return));break;case 1:ss(o,r),is(r),h&512&&(dn||c===null||Di(c,c.return)),h&64&&lr&&(r=r.updateQueue,r!==null&&(h=r.callbacks,h!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var v=ni;if(ss(o,r),is(r),h&512&&(dn||c===null||Di(c,c.return)),h&4){var E=c!==null?c.memoizedState:null;if(h=r.memoizedState,c===null)if(h===null)if(r.stateNode===null){e:{h=r.type,c=r.memoizedProps,v=v.ownerDocument||v;t:switch(h){case"title":E=v.getElementsByTagName("title")[0],(!E||E[_i]||E[rn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=v.createElement(h),v.head.insertBefore(E,v.querySelector("head > title"))),Pn(E,h,c),E[rn]=r,on(E),h=E;break e;case"link":var A=sb("link","href",v).get(h+(c.href||""));if(A){for(var R=0;R<A.length;R++)if(E=A[R],E.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&E.getAttribute("rel")===(c.rel==null?null:c.rel)&&E.getAttribute("title")===(c.title==null?null:c.title)&&E.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){A.splice(R,1);break t}}E=v.createElement(h),Pn(E,h,c),v.head.appendChild(E);break;case"meta":if(A=sb("meta","content",v).get(h+(c.content||""))){for(R=0;R<A.length;R++)if(E=A[R],E.getAttribute("content")===(c.content==null?null:""+c.content)&&E.getAttribute("name")===(c.name==null?null:c.name)&&E.getAttribute("property")===(c.property==null?null:c.property)&&E.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&E.getAttribute("charset")===(c.charSet==null?null:c.charSet)){A.splice(R,1);break t}}E=v.createElement(h),Pn(E,h,c),v.head.appendChild(E);break;default:throw Error(s(468,h))}E[rn]=r,on(E),h=E}r.stateNode=h}else ib(v,r.type,r.stateNode);else r.stateNode=nb(v,h,r.memoizedProps);else E!==h?(E===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):E.count--,h===null?ib(v,r.type,r.stateNode):nb(v,h,r.memoizedProps)):h===null&&r.stateNode!==null&&Sy(r,r.memoizedProps,c.memoizedProps)}break;case 27:ss(o,r),is(r),h&512&&(dn||c===null||Di(c,c.return)),c!==null&&h&4&&Sy(r,r.memoizedProps,c.memoizedProps);break;case 5:if(ss(o,r),is(r),h&512&&(dn||c===null||Di(c,c.return)),r.flags&32){v=r.stateNode;try{ts(v,"")}catch(Se){vt(r,r.return,Se)}}h&4&&r.stateNode!=null&&(v=r.memoizedProps,Sy(r,v,c!==null?c.memoizedProps:v)),h&1024&&(Py=!0);break;case 6:if(ss(o,r),is(r),h&4){if(r.stateNode===null)throw Error(s(162));h=r.memoizedProps,c=r.stateNode;try{c.nodeValue=h}catch(Se){vt(r,r.return,Se)}}break;case 3:if(im=null,v=ni,ni=nm(o.containerInfo),ss(o,r),ni=v,is(r),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Jl(o.containerInfo)}catch(Se){vt(r,r.return,Se)}Py&&(Py=!1,iI(r));break;case 4:h=ni,ni=nm(r.stateNode.containerInfo),ss(o,r),is(r),ni=h;break;case 12:ss(o,r),is(r);break;case 31:ss(o,r),is(r),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,Gf(r,h)));break;case 13:ss(o,r),is(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Hf=tn()),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,Gf(r,h)));break;case 22:v=r.memoizedState!==null;var j=c!==null&&c.memoizedState!==null,ne=lr,ce=dn;if(lr=ne||v,dn=ce||j,ss(o,r),dn=ce,lr=ne,is(r),h&8192)e:for(o=r.stateNode,o._visibility=v?o._visibility&-2:o._visibility|1,v&&(c===null||j||lr||dn||Ta(r)),c=null,o=r;;){if(o.tag===5||o.tag===26){if(c===null){j=c=o;try{if(E=j.stateNode,v)A=E.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{R=j.stateNode;var de=j.memoizedProps.style,se=de!=null&&de.hasOwnProperty("display")?de.display:null;R.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Se){vt(j,j.return,Se)}}}else if(o.tag===6){if(c===null){j=o;try{j.stateNode.nodeValue=v?"":j.memoizedProps}catch(Se){vt(j,j.return,Se)}}}else if(o.tag===18){if(c===null){j=o;try{var oe=j.stateNode;v?YI(oe,!0):YI(j.stateNode,!1)}catch(Se){vt(j,j.return,Se)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=r.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Gf(r,c))));break;case 19:ss(o,r),is(r),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,Gf(r,h)));break;case 30:break;case 21:break;default:ss(o,r),is(r)}}function is(r){var o=r.flags;if(o&2){try{for(var c,h=r.return;h!==null;){if(Jx(h)){c=h;break}h=h.return}if(c==null)throw Error(s(160));switch(c.tag){case 27:var v=c.stateNode,E=Cy(r);jf(r,E,v);break;case 5:var A=c.stateNode;c.flags&32&&(ts(A,""),c.flags&=-33);var R=Cy(r);jf(r,R,A);break;case 3:case 4:var j=c.stateNode.containerInfo,ne=Cy(r);Ry(r,ne,j);break;default:throw Error(s(161))}}catch(ce){vt(r,r.return,ce)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function iI(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;iI(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function ur(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Xx(r,o.alternate,o),o=o.sibling}function Ta(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:eo(4,o,o.return),Ta(o);break;case 1:Di(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&Yx(o,o.return,c),Ta(o);break;case 27:Wu(o.stateNode);case 26:case 5:Di(o,o.return),Ta(o);break;case 22:o.memoizedState===null&&Ta(o);break;case 30:Ta(o);break;default:Ta(o)}r=r.sibling}}function dr(r,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,v=r,E=o,A=E.flags;switch(E.tag){case 0:case 11:case 15:dr(v,E,c),ju(4,E);break;case 1:if(dr(v,E,c),h=E,v=h.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(ne){vt(h,h.return,ne)}if(h=E,v=h.updateQueue,v!==null){var R=h.stateNode;try{var j=v.shared.hiddenCallbacks;if(j!==null)for(v.shared.hiddenCallbacks=null,v=0;v<j.length;v++)VT(j[v],R)}catch(ne){vt(h,h.return,ne)}}c&&A&64&&$x(E),Gu(E,E.return);break;case 27:Qx(E);case 26:case 5:dr(v,E,c),c&&h===null&&A&4&&Kx(E),Gu(E,E.return);break;case 12:dr(v,E,c);break;case 31:dr(v,E,c),c&&A&4&&tI(v,E);break;case 13:dr(v,E,c),c&&A&4&&nI(v,E);break;case 22:E.memoizedState===null&&dr(v,E,c),Gu(E,E.return);break;case 30:break;default:dr(v,E,c)}o=o.sibling}}function Dy(r,o){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&Su(c))}function My(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Su(r))}function si(r,o,c,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)rI(r,o,c,h),o=o.sibling}function rI(r,o,c,h){var v=o.flags;switch(o.tag){case 0:case 11:case 15:si(r,o,c,h),v&2048&&ju(9,o);break;case 1:si(r,o,c,h);break;case 3:si(r,o,c,h),v&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Su(r)));break;case 12:if(v&2048){si(r,o,c,h),r=o.stateNode;try{var E=o.memoizedProps,A=E.id,R=E.onPostCommit;typeof R=="function"&&R(A,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(j){vt(o,o.return,j)}}else si(r,o,c,h);break;case 31:si(r,o,c,h);break;case 13:si(r,o,c,h);break;case 23:break;case 22:E=o.stateNode,A=o.alternate,o.memoizedState!==null?E._visibility&2?si(r,o,c,h):qu(r,o):E._visibility&2?si(r,o,c,h):(E._visibility|=2,Ol(r,o,c,h,(o.subtreeFlags&10256)!==0||!1)),v&2048&&Dy(A,o);break;case 24:si(r,o,c,h),v&2048&&My(o.alternate,o);break;default:si(r,o,c,h)}}function Ol(r,o,c,h,v){for(v=v&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var E=r,A=o,R=c,j=h,ne=A.flags;switch(A.tag){case 0:case 11:case 15:Ol(E,A,R,j,v),ju(8,A);break;case 23:break;case 22:var ce=A.stateNode;A.memoizedState!==null?ce._visibility&2?Ol(E,A,R,j,v):qu(E,A):(ce._visibility|=2,Ol(E,A,R,j,v)),v&&ne&2048&&Dy(A.alternate,A);break;case 24:Ol(E,A,R,j,v),v&&ne&2048&&My(A.alternate,A);break;default:Ol(E,A,R,j,v)}o=o.sibling}}function qu(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=r,h=o,v=h.flags;switch(h.tag){case 22:qu(c,h),v&2048&&Dy(h.alternate,h);break;case 24:qu(c,h),v&2048&&My(h.alternate,h);break;default:qu(c,h)}o=o.sibling}}var Hu=8192;function Fl(r,o,c){if(r.subtreeFlags&Hu)for(r=r.child;r!==null;)oI(r,o,c),r=r.sibling}function oI(r,o,c){switch(r.tag){case 26:Fl(r,o,c),r.flags&Hu&&r.memoizedState!==null&&c2(c,ni,r.memoizedState,r.memoizedProps);break;case 5:Fl(r,o,c);break;case 3:case 4:var h=ni;ni=nm(r.stateNode.containerInfo),Fl(r,o,c),ni=h;break;case 22:r.memoizedState===null&&(h=r.alternate,h!==null&&h.memoizedState!==null?(h=Hu,Hu=16777216,Fl(r,o,c),Hu=h):Fl(r,o,c));break;default:Fl(r,o,c)}}function aI(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function zu(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];Tn=h,cI(h,r)}aI(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)lI(r),r=r.sibling}function lI(r){switch(r.tag){case 0:case 11:case 15:zu(r),r.flags&2048&&eo(9,r,r.return);break;case 3:zu(r);break;case 12:zu(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,qf(r)):zu(r);break;default:zu(r)}}function qf(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];Tn=h,cI(h,r)}aI(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:eo(8,o,o.return),qf(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,qf(o));break;default:qf(o)}r=r.sibling}}function cI(r,o){for(;Tn!==null;){var c=Tn;switch(c.tag){case 0:case 11:case 15:eo(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Su(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,Tn=h;else e:for(c=r;Tn!==null;){h=Tn;var v=h.sibling,E=h.return;if(Zx(h),h===c){Tn=null;break e}if(v!==null){v.return=E,Tn=v;break e}Tn=E}}}var bM={getCacheForType:function(r){var o=Cn(ln),c=o.data.get(r);return c===void 0&&(c=r(),o.data.set(r,c)),c},cacheSignal:function(){return Cn(ln).controller.signal}},AM=typeof WeakMap=="function"?WeakMap:Map,mt=0,wt=null,Xe=null,nt=0,_t=0,_s=null,to=!1,Bl=!1,ky=!1,hr=0,qt=0,no=0,xa=0,Vy=0,vs=0,jl=0,$u=null,rs=null,Ly=!1,Hf=0,uI=0,zf=1/0,$f=null,so=null,pn=0,io=null,Gl=null,fr=0,Uy=0,Oy=null,dI=null,Yu=0,Fy=null;function Es(){return(mt&2)!==0&&nt!==0?nt&-nt:Q.T!==null?zy():$h()}function hI(){if(vs===0)if((nt&536870912)===0||rt){var r=Jo;Jo<<=1,(Jo&3932160)===0&&(Jo=262144),vs=r}else vs=536870912;return r=gs.current,r!==null&&(r.flags|=32),vs}function os(r,o,c){(r===wt&&(_t===2||_t===9)||r.cancelPendingCommit!==null)&&(ql(r,0),ro(r,nt,vs,!1)),Qo(r,c),((mt&2)===0||r!==wt)&&(r===wt&&((mt&2)===0&&(xa|=c),qt===4&&ro(r,nt,vs,!1)),Mi(r))}function fI(r,o,c){if((mt&6)!==0)throw Error(s(327));var h=!c&&(o&127)===0&&(o&r.expiredLanes)===0||Ys(r,o),v=h?SM(r,o):jy(r,o,!0),E=h;do{if(v===0){Bl&&!h&&ro(r,o,0,!1);break}else{if(c=r.current.alternate,E&&!wM(c)){v=jy(r,o,!1),E=!1;continue}if(v===2){if(E=o,r.errorRecoveryDisabledLanes&E)var A=0;else A=r.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){o=A;e:{var R=r;v=$u;var j=R.current.memoizedState.isDehydrated;if(j&&(ql(R,A).flags|=256),A=jy(R,A,!1),A!==2){if(ky&&!j){R.errorRecoveryDisabledLanes|=E,xa|=E,v=4;break e}E=rs,rs=v,E!==null&&(rs===null?rs=E:rs.push.apply(rs,E))}v=A}if(E=!1,v!==2)continue}}if(v===1){ql(r,0),ro(r,o,0,!0);break}e:{switch(h=r,E=v,E){case 0:case 1:throw Error(s(345));case 4:if((o&4194048)!==o)break;case 6:ro(h,o,vs,!to);break e;case 2:rs=null;break;case 3:case 5:break;default:throw Error(s(329))}if((o&62914560)===o&&(v=Hf+300-tn(),10<v)){if(ro(h,o,vs,!to),pi(h,0,!0)!==0)break e;fr=o,h.timeoutHandle=HI(mI.bind(null,h,c,rs,$f,Ly,o,vs,xa,jl,to,E,"Throttled",-0,0),v);break e}mI(h,c,rs,$f,Ly,o,vs,xa,jl,to,E,null,-0,0)}}break}while(!0);Mi(r)}function mI(r,o,c,h,v,E,A,R,j,ne,ce,de,se,oe){if(r.timeoutHandle=-1,de=o.subtreeFlags,de&8192||(de&16785408)===16785408){de={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Qs},oI(o,E,de);var Se=(E&62914560)===E?Hf-tn():(E&4194048)===E?uI-tn():0;if(Se=u2(de,Se),Se!==null){fr=E,r.cancelPendingCommit=Se(xI.bind(null,r,o,E,c,h,v,A,R,j,ce,de,null,se,oe)),ro(r,E,A,!ne);return}}xI(r,o,E,c,h,v,A,R,j)}function wM(r){for(var o=r;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var v=c[h],E=v.getSnapshot;v=v.value;try{if(!ms(E(),v))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ro(r,o,c,h){o&=~Vy,o&=~xa,r.suspendedLanes|=o,r.pingedLanes&=~o,h&&(r.warmLanes|=o),h=r.expirationTimes;for(var v=o;0<v;){var E=31-Yt(v),A=1<<E;h[E]=-1,v&=~A}c!==0&&Wo(r,c,o)}function Yf(){return(mt&6)===0?(Ku(0),!1):!0}function By(){if(Xe!==null){if(_t===0)var r=Xe.return;else r=Xe,nr=fa=null,ny(r),Ml=null,Ru=0,r=Xe;for(;r!==null;)zx(r.alternate,r),r=r.return;Xe=null}}function ql(r,o){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,$M(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),fr=0,By(),wt=r,Xe=c=er(r.current,null),nt=o,_t=0,_s=null,to=!1,Bl=Ys(r,o),ky=!1,jl=vs=Vy=xa=no=qt=0,rs=$u=null,Ly=!1,(o&8)!==0&&(o|=o&32);var h=r.entangledLanes;if(h!==0)for(r=r.entanglements,h&=o;0<h;){var v=31-Yt(h),E=1<<v;o|=r[v],h&=~E}return hr=o,mf(),c}function pI(r,o){Ke=null,Q.H=Ou,o===Dl||o===xf?(o=PT(),_t=3):o===Hg?(o=PT(),_t=4):_t=o===_y?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,_s=o,Xe===null&&(qt=1,Lf(r,Ms(o,r.current)))}function gI(){var r=gs.current;return r===null?!0:(nt&4194048)===nt?Us===null:(nt&62914560)===nt||(nt&536870912)!==0?r===Us:!1}function yI(){var r=Q.H;return Q.H=Ou,r===null?Ou:r}function _I(){var r=Q.A;return Q.A=bM,r}function Kf(){qt=4,to||(nt&4194048)!==nt&&gs.current!==null||(Bl=!0),(no&134217727)===0&&(xa&134217727)===0||wt===null||ro(wt,nt,vs,!1)}function jy(r,o,c){var h=mt;mt|=2;var v=yI(),E=_I();(wt!==r||nt!==o)&&($f=null,ql(r,o)),o=!1;var A=qt;e:do try{if(_t!==0&&Xe!==null){var R=Xe,j=_s;switch(_t){case 8:By(),A=6;break e;case 3:case 2:case 9:case 6:gs.current===null&&(o=!0);var ne=_t;if(_t=0,_s=null,Hl(r,R,j,ne),c&&Bl){A=0;break e}break;default:ne=_t,_t=0,_s=null,Hl(r,R,j,ne)}}NM(),A=qt;break}catch(ce){pI(r,ce)}while(!0);return o&&r.shellSuspendCounter++,nr=fa=null,mt=h,Q.H=v,Q.A=E,Xe===null&&(wt=null,nt=0,mf()),A}function NM(){for(;Xe!==null;)vI(Xe)}function SM(r,o){var c=mt;mt|=2;var h=yI(),v=_I();wt!==r||nt!==o?($f=null,zf=tn()+500,ql(r,o)):Bl=Ys(r,o);e:do try{if(_t!==0&&Xe!==null){o=Xe;var E=_s;t:switch(_t){case 1:_t=0,_s=null,Hl(r,o,E,1);break;case 2:case 9:if(CT(E)){_t=0,_s=null,EI(o);break}o=function(){_t!==2&&_t!==9||wt!==r||(_t=7),Mi(r)},E.then(o,o);break e;case 3:_t=7;break e;case 4:_t=5;break e;case 7:CT(E)?(_t=0,_s=null,EI(o)):(_t=0,_s=null,Hl(r,o,E,7));break;case 5:var A=null;switch(Xe.tag){case 26:A=Xe.memoizedState;case 5:case 27:var R=Xe;if(A?rb(A):R.stateNode.complete){_t=0,_s=null;var j=R.sibling;if(j!==null)Xe=j;else{var ne=R.return;ne!==null?(Xe=ne,Jf(ne)):Xe=null}break t}}_t=0,_s=null,Hl(r,o,E,5);break;case 6:_t=0,_s=null,Hl(r,o,E,6);break;case 8:By(),qt=6;break e;default:throw Error(s(462))}}CM();break}catch(ce){pI(r,ce)}while(!0);return nr=fa=null,Q.H=h,Q.A=v,mt=c,Xe!==null?0:(wt=null,nt=0,mf(),qt)}function CM(){for(;Xe!==null&&!zs();)vI(Xe)}function vI(r){var o=qx(r.alternate,r,hr);r.memoizedProps=r.pendingProps,o===null?Jf(r):Xe=o}function EI(r){var o=r,c=o.alternate;switch(o.tag){case 15:case 0:o=Ux(c,o,o.pendingProps,o.type,void 0,nt);break;case 11:o=Ux(c,o,o.pendingProps,o.type.render,o.ref,nt);break;case 5:ny(o);default:zx(c,o),o=Xe=_T(o,hr),o=qx(c,o,hr)}r.memoizedProps=r.pendingProps,o===null?Jf(r):Xe=o}function Hl(r,o,c,h){nr=fa=null,ny(o),Ml=null,Ru=0;var v=o.return;try{if(yM(r,v,o,c,nt)){qt=1,Lf(r,Ms(c,r.current)),Xe=null;return}}catch(E){if(v!==null)throw Xe=v,E;qt=1,Lf(r,Ms(c,r.current)),Xe=null;return}o.flags&32768?(rt||h===1?r=!0:Bl||(nt&536870912)!==0?r=!1:(to=r=!0,(h===2||h===9||h===3||h===6)&&(h=gs.current,h!==null&&h.tag===13&&(h.flags|=16384))),TI(o,r)):Jf(o)}function Jf(r){var o=r;do{if((o.flags&32768)!==0){TI(o,to);return}r=o.return;var c=EM(o.alternate,o,hr);if(c!==null){Xe=c;return}if(o=o.sibling,o!==null){Xe=o;return}Xe=o=r}while(o!==null);qt===0&&(qt=5)}function TI(r,o){do{var c=TM(r.alternate,r);if(c!==null){c.flags&=32767,Xe=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(r=r.sibling,r!==null)){Xe=r;return}Xe=r=c}while(r!==null);qt=6,Xe=null}function xI(r,o,c,h,v,E,A,R,j){r.cancelPendingCommit=null;do Qf();while(pn!==0);if((mt&6)!==0)throw Error(s(327));if(o!==null){if(o===r.current)throw Error(s(177));if(E=o.lanes|o.childLanes,E|=Cg,Eg(r,c,E,A,R,j),r===wt&&(Xe=wt=null,nt=0),Gl=o,io=r,fr=c,Uy=E,Oy=v,dI=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,MM(Vr,function(){return NI(),null})):(r.callbackNode=null,r.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=Q.T,Q.T=null,v=ge.p,ge.p=2,A=mt,mt|=4;try{xM(r,o,c)}finally{mt=A,ge.p=v,Q.T=h}}pn=1,II(),bI(),AI()}}function II(){if(pn===1){pn=0;var r=io,o=Gl,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=Q.T,Q.T=null;var h=ge.p;ge.p=2;var v=mt;mt|=4;try{sI(o,r);var E=Zy,A=cT(r.containerInfo),R=E.focusedElem,j=E.selectionRange;if(A!==R&&R&&R.ownerDocument&&lT(R.ownerDocument.documentElement,R)){if(j!==null&&bg(R)){var ne=j.start,ce=j.end;if(ce===void 0&&(ce=ne),"selectionStart"in R)R.selectionStart=ne,R.selectionEnd=Math.min(ce,R.value.length);else{var de=R.ownerDocument||document,se=de&&de.defaultView||window;if(se.getSelection){var oe=se.getSelection(),Se=R.textContent.length,Be=Math.min(j.start,Se),At=j.end===void 0?Be:Math.min(j.end,Se);!oe.extend&&Be>At&&(A=At,At=Be,Be=A);var W=aT(R,Be),$=aT(R,At);if(W&&$&&(oe.rangeCount!==1||oe.anchorNode!==W.node||oe.anchorOffset!==W.offset||oe.focusNode!==$.node||oe.focusOffset!==$.offset)){var te=de.createRange();te.setStart(W.node,W.offset),oe.removeAllRanges(),Be>At?(oe.addRange(te),oe.extend($.node,$.offset)):(te.setEnd($.node,$.offset),oe.addRange(te))}}}}for(de=[],oe=R;oe=oe.parentNode;)oe.nodeType===1&&de.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<de.length;R++){var ue=de[R];ue.element.scrollLeft=ue.left,ue.element.scrollTop=ue.top}}lm=!!Xy,Zy=Xy=null}finally{mt=v,ge.p=h,Q.T=c}}r.current=o,pn=2}}function bI(){if(pn===2){pn=0;var r=io,o=Gl,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=Q.T,Q.T=null;var h=ge.p;ge.p=2;var v=mt;mt|=4;try{Xx(r,o.alternate,o)}finally{mt=v,ge.p=h,Q.T=c}}pn=3}}function AI(){if(pn===4||pn===3){pn=0,di();var r=io,o=Gl,c=fr,h=dI;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?pn=5:(pn=0,Gl=io=null,wI(r,r.pendingLanes));var v=r.pendingLanes;if(v===0&&(so=null),Qi(c),o=o.stateNode,wn&&typeof wn.onCommitFiberRoot=="function")try{wn.onCommitFiberRoot($s,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=Q.T,v=ge.p,ge.p=2,Q.T=null;try{for(var E=r.onRecoverableError,A=0;A<h.length;A++){var R=h[A];E(R.value,{componentStack:R.stack})}}finally{Q.T=o,ge.p=v}}(fr&3)!==0&&Qf(),Mi(r),v=r.pendingLanes,(c&261930)!==0&&(v&42)!==0?r===Fy?Yu++:(Yu=0,Fy=r):Yu=0,Ku(0)}}function wI(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,Su(o)))}function Qf(){return II(),bI(),AI(),NI()}function NI(){if(pn!==5)return!1;var r=io,o=Uy;Uy=0;var c=Qi(fr),h=Q.T,v=ge.p;try{ge.p=32>c?32:c,Q.T=null,c=Oy,Oy=null;var E=io,A=fr;if(pn=0,Gl=io=null,fr=0,(mt&6)!==0)throw Error(s(331));var R=mt;if(mt|=4,lI(E.current),rI(E,E.current,A,c),mt=R,Ku(0,!1),wn&&typeof wn.onPostCommitFiberRoot=="function")try{wn.onPostCommitFiberRoot($s,E)}catch{}return!0}finally{ge.p=v,Q.T=h,wI(r,o)}}function SI(r,o,c){o=Ms(c,o),o=yy(r.stateNode,o,2),r=Wr(r,o,2),r!==null&&(Qo(r,2),Mi(r))}function vt(r,o,c){if(r.tag===3)SI(r,r,c);else for(;o!==null;){if(o.tag===3){SI(o,r,c);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(so===null||!so.has(h))){r=Ms(c,r),c=Cx(2),h=Wr(o,c,2),h!==null&&(Rx(c,h,o,r),Qo(h,2),Mi(h));break}}o=o.return}}function Gy(r,o,c){var h=r.pingCache;if(h===null){h=r.pingCache=new AM;var v=new Set;h.set(o,v)}else v=h.get(o),v===void 0&&(v=new Set,h.set(o,v));v.has(c)||(ky=!0,v.add(c),r=RM.bind(null,r,o,c),o.then(r,r))}function RM(r,o,c){var h=r.pingCache;h!==null&&h.delete(o),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,wt===r&&(nt&c)===c&&(qt===4||qt===3&&(nt&62914560)===nt&&300>tn()-Hf?(mt&2)===0&&ql(r,0):Vy|=c,jl===nt&&(jl=0)),Mi(r)}function CI(r,o){o===0&&(o=zh()),r=ua(r,o),r!==null&&(Qo(r,o),Mi(r))}function PM(r){var o=r.memoizedState,c=0;o!==null&&(c=o.retryLane),CI(r,c)}function DM(r,o){var c=0;switch(r.tag){case 31:case 13:var h=r.stateNode,v=r.memoizedState;v!==null&&(c=v.retryLane);break;case 19:h=r.stateNode;break;case 22:h=r.stateNode._retryCache;break;default:throw Error(s(314))}h!==null&&h.delete(o),CI(r,c)}function MM(r,o){return Oe(r,o)}var Wf=null,zl=null,qy=!1,Xf=!1,Hy=!1,oo=0;function Mi(r){r!==zl&&r.next===null&&(zl===null?Wf=zl=r:zl=zl.next=r),Xf=!0,qy||(qy=!0,VM())}function Ku(r,o){if(!Hy&&Xf){Hy=!0;do for(var c=!1,h=Wf;h!==null;){if(r!==0){var v=h.pendingLanes;if(v===0)var E=0;else{var A=h.suspendedLanes,R=h.pingedLanes;E=(1<<31-Yt(42|r)+1)-1,E&=v&~(A&~R),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(c=!0,MI(h,E))}else E=nt,E=pi(h,h===wt?E:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(E&3)===0||Ys(h,E)||(c=!0,MI(h,E));h=h.next}while(c);Hy=!1}}function kM(){RI()}function RI(){Xf=qy=!1;var r=0;oo!==0&&zM()&&(r=oo);for(var o=tn(),c=null,h=Wf;h!==null;){var v=h.next,E=PI(h,o);E===0?(h.next=null,c===null?Wf=v:c.next=v,v===null&&(zl=c)):(c=h,(r!==0||(E&3)!==0)&&(Xf=!0)),h=v}pn!==0&&pn!==5||Ku(r),oo!==0&&(oo=0)}function PI(r,o){for(var c=r.suspendedLanes,h=r.pingedLanes,v=r.expirationTimes,E=r.pendingLanes&-62914561;0<E;){var A=31-Yt(E),R=1<<A,j=v[A];j===-1?((R&c)===0||(R&h)!==0)&&(v[A]=vg(R,o)):j<=o&&(r.expiredLanes|=R),E&=~R}if(o=wt,c=nt,c=pi(r,r===o?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h=r.callbackNode,c===0||r===o&&(_t===2||_t===9)||r.cancelPendingCommit!==null)return h!==null&&h!==null&&en(h),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||Ys(r,c)){if(o=c&-c,o===r.callbackPriority)return o;switch(h!==null&&en(h),Qi(c)){case 2:case 8:c=Ji;break;case 32:c=Vr;break;case 268435456:c=Bh;break;default:c=Vr}return h=DI.bind(null,r),c=Oe(c,h),r.callbackPriority=o,r.callbackNode=c,o}return h!==null&&h!==null&&en(h),r.callbackPriority=2,r.callbackNode=null,2}function DI(r,o){if(pn!==0&&pn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(Qf()&&r.callbackNode!==c)return null;var h=nt;return h=pi(r,r===wt?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h===0?null:(fI(r,h,o),PI(r,tn()),r.callbackNode!=null&&r.callbackNode===c?DI.bind(null,r):null)}function MI(r,o){if(Qf())return null;fI(r,o,!0)}function VM(){YM(function(){(mt&6)!==0?Oe(nn,kM):RI()})}function zy(){if(oo===0){var r=Rl;r===0&&(r=fi,fi<<=1,(fi&261888)===0&&(fi=256)),oo=r}return oo}function kI(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:pl(""+r)}function VI(r,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,r.id&&c.setAttribute("form",r.id),o.parentNode.insertBefore(c,o),r=new FormData(r),c.parentNode.removeChild(c),r}function LM(r,o,c,h,v){if(o==="submit"&&c&&c.stateNode===v){var E=kI((v[vn]||null).action),A=h.submitter;A&&(o=(o=A[vn]||null)?kI(o.formAction):A.getAttribute("formAction"),o!==null&&(E=o,A=null));var R=new wi("action","action",null,h,v);r.push({event:R,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(oo!==0){var j=A?VI(v,A):new FormData(v);dy(c,{pending:!0,data:j,method:v.method,action:E},null,j)}}else typeof E=="function"&&(R.preventDefault(),j=A?VI(v,A):new FormData(v),dy(c,{pending:!0,data:j,method:v.method,action:E},E,j))},currentTarget:v}]})}}for(var $y=0;$y<Sg.length;$y++){var Yy=Sg[$y],UM=Yy.toLowerCase(),OM=Yy[0].toUpperCase()+Yy.slice(1);ti(UM,"on"+OM)}ti(hT,"onAnimationEnd"),ti(fT,"onAnimationIteration"),ti(mT,"onAnimationStart"),ti("dblclick","onDoubleClick"),ti("focusin","onFocus"),ti("focusout","onBlur"),ti(eM,"onTransitionRun"),ti(tM,"onTransitionStart"),ti(nM,"onTransitionCancel"),ti(pT,"onTransitionEnd"),xi("onMouseEnter",["mouseout","mouseover"]),xi("onMouseLeave",["mouseout","mouseover"]),xi("onPointerEnter",["pointerout","pointerover"]),xi("onPointerLeave",["pointerout","pointerover"]),Ti("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ti("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ti("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ti("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ti("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ti("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ju="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FM=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ju));function LI(r,o){o=(o&4)!==0;for(var c=0;c<r.length;c++){var h=r[c],v=h.event;h=h.listeners;e:{var E=void 0;if(o)for(var A=h.length-1;0<=A;A--){var R=h[A],j=R.instance,ne=R.currentTarget;if(R=R.listener,j!==E&&v.isPropagationStopped())break e;E=R,v.currentTarget=ne;try{E(v)}catch(ce){ff(ce)}v.currentTarget=null,E=j}else for(A=0;A<h.length;A++){if(R=h[A],j=R.instance,ne=R.currentTarget,R=R.listener,j!==E&&v.isPropagationStopped())break e;E=R,v.currentTarget=ne;try{E(v)}catch(ce){ff(ce)}v.currentTarget=null,E=j}}}}function Ze(r,o){var c=o[ul];c===void 0&&(c=o[ul]=new Set);var h=r+"__bubble";c.has(h)||(UI(o,r,2,!1),c.add(h))}function Ky(r,o,c){var h=0;o&&(h|=4),UI(c,r,h,o)}var Zf="_reactListening"+Math.random().toString(36).slice(2);function Jy(r){if(!r[Zf]){r[Zf]=!0,au.forEach(function(c){c!=="selectionchange"&&(FM.has(c)||Ky(c,!1,r),Ky(c,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[Zf]||(o[Zf]=!0,Ky("selectionchange",!1,o))}}function UI(r,o,c,h){switch(hb(o)){case 2:var v=f2;break;case 8:v=m2;break;default:v=u_}c=v.bind(null,o,c,r),v=void 0,!na||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(v=!0),h?v!==void 0?r.addEventListener(o,c,{capture:!0,passive:v}):r.addEventListener(o,c,!0):v!==void 0?r.addEventListener(o,c,{passive:v}):r.addEventListener(o,c,!1)}function Qy(r,o,c,h,v){var E=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var A=h.tag;if(A===3||A===4){var R=h.stateNode.containerInfo;if(R===v)break;if(A===4)for(A=h.return;A!==null;){var j=A.tag;if((j===3||j===4)&&A.stateNode.containerInfo===v)return;A=A.return}for(;R!==null;){if(A=vi(R),A===null)return;if(j=A.tag,j===5||j===6||j===26||j===27){h=E=A;continue e}R=R.parentNode}}h=h.return}jr(function(){var ne=E,ce=Cs(c),de=[];e:{var se=gT.get(r);if(se!==void 0){var oe=wi,Se=r;switch(r){case"keypress":if(ia(c)===0)break e;case"keydown":case"keyup":oe=uf;break;case"focusin":Se="focus",oe=oa;break;case"focusout":Se="blur",oe=oa;break;case"beforeblur":case"afterblur":oe=oa;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Eu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=ef;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=I;break;case hT:case fT:case mT:oe=nf;break;case pT:oe=D;break;case"scroll":case"scrollend":oe=vu;break;case"wheel":oe=re;break;case"copy":case"cut":case"paste":oe=sf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=Zi;break;case"toggle":case"beforetoggle":oe=Ye}var Be=(o&4)!==0,At=!Be&&(r==="scroll"||r==="scrollend"),W=Be?se!==null?se+"Capture":null:se;Be=[];for(var $=ne,te;$!==null;){var ue=$;if(te=ue.stateNode,ue=ue.tag,ue!==5&&ue!==26&&ue!==27||te===null||W===null||(ue=Ws($,W),ue!=null&&Be.push(Qu($,ue,te))),At)break;$=$.return}0<Be.length&&(se=new oe(se,Se,null,c,ce),de.push({event:se,listeners:Be}))}}if((o&7)===0){e:{if(se=r==="mouseover"||r==="pointerover",oe=r==="mouseout"||r==="pointerout",se&&c!==gu&&(Se=c.relatedTarget||c.fromElement)&&(vi(Se)||Se[yi]))break e;if((oe||se)&&(se=ce.window===ce?ce:(se=ce.ownerDocument)?se.defaultView||se.parentWindow:window,oe?(Se=c.relatedTarget||c.toElement,oe=ne,Se=Se?vi(Se):null,Se!==null&&(At=a(Se),Be=Se.tag,Se!==At||Be!==5&&Be!==27&&Be!==6)&&(Se=null)):(oe=null,Se=ne),oe!==Se)){if(Be=Eu,ue="onMouseLeave",W="onMouseEnter",$="mouse",(r==="pointerout"||r==="pointerover")&&(Be=Zi,ue="onPointerLeave",W="onPointerEnter",$="pointer"),At=oe==null?se:hs(oe),te=Se==null?se:hs(Se),se=new Be(ue,$+"leave",oe,c,ce),se.target=At,se.relatedTarget=te,ue=null,vi(ce)===ne&&(Be=new Be(W,$+"enter",Se,c,ce),Be.target=te,Be.relatedTarget=At,ue=Be),At=ue,oe&&Se)t:{for(Be=BM,W=oe,$=Se,te=0,ue=W;ue;ue=Be(ue))te++;ue=0;for(var Ue=$;Ue;Ue=Be(Ue))ue++;for(;0<te-ue;)W=Be(W),te--;for(;0<ue-te;)$=Be($),ue--;for(;te--;){if(W===$||$!==null&&W===$.alternate){Be=W;break t}W=Be(W),$=Be($)}Be=null}else Be=null;oe!==null&&OI(de,se,oe,Be,!1),Se!==null&&At!==null&&OI(de,At,Se,Be,!0)}}e:{if(se=ne?hs(ne):window,oe=se.nodeName&&se.nodeName.toLowerCase(),oe==="select"||oe==="input"&&se.type==="file")var lt=tT;else if(ZE(se))if(nT)lt=WD;else{lt=JD;var De=KD}else oe=se.nodeName,!oe||oe.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?ne&&ml(ne.elementType)&&(lt=tT):lt=QD;if(lt&&(lt=lt(r,ne))){eT(de,lt,c,ce);break e}De&&De(r,se,ne),r==="focusout"&&ne&&se.type==="number"&&ne.memoizedProps.value!=null&&fu(se,"number",se.value)}switch(De=ne?hs(ne):window,r){case"focusin":(ZE(De)||De.contentEditable==="true")&&(xl=De,Ag=ne,Au=null);break;case"focusout":Au=Ag=xl=null;break;case"mousedown":wg=!0;break;case"contextmenu":case"mouseup":case"dragend":wg=!1,uT(de,c,ce);break;case"selectionchange":if(ZD)break;case"keydown":case"keyup":uT(de,c,ce)}var Qe;if(ft)e:{switch(r){case"compositionstart":var st="onCompositionStart";break e;case"compositionend":st="onCompositionEnd";break e;case"compositionupdate":st="onCompositionUpdate";break e}st=void 0}else Tl?aa(r,c)&&(st="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(st="onCompositionStart");st&&(Ci&&c.locale!=="ko"&&(Tl||st!=="onCompositionStart"?st==="onCompositionEnd"&&Tl&&(Qe=_u()):(Ai=ce,yu="value"in Ai?Ai.value:Ai.textContent,Tl=!0)),De=em(ne,st),0<De.length&&(st=new Si(st,r,null,c,ce),de.push({event:st,listeners:De}),Qe?st.data=Qe:(Qe=El(c),Qe!==null&&(st.data=Qe)))),(Qe=Ps?HD(r,c):zD(r,c))&&(st=em(ne,"onBeforeInput"),0<st.length&&(De=new Si("onBeforeInput","beforeinput",null,c,ce),de.push({event:De,listeners:st}),De.data=Qe)),LM(de,r,ne,c,ce)}LI(de,o)})}function Qu(r,o,c){return{instance:r,listener:o,currentTarget:c}}function em(r,o){for(var c=o+"Capture",h=[];r!==null;){var v=r,E=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||E===null||(v=Ws(r,c),v!=null&&h.unshift(Qu(r,v,E)),v=Ws(r,o),v!=null&&h.push(Qu(r,v,E))),r.tag===3)return h;r=r.return}return[]}function BM(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function OI(r,o,c,h,v){for(var E=o._reactName,A=[];c!==null&&c!==h;){var R=c,j=R.alternate,ne=R.stateNode;if(R=R.tag,j!==null&&j===h)break;R!==5&&R!==26&&R!==27||ne===null||(j=ne,v?(ne=Ws(c,E),ne!=null&&A.unshift(Qu(c,ne,j))):v||(ne=Ws(c,E),ne!=null&&A.push(Qu(c,ne,j)))),c=c.return}A.length!==0&&r.push({event:o,listeners:A})}var jM=/\r\n?/g,GM=/\u0000|\uFFFD/g;function FI(r){return(typeof r=="string"?r:""+r).replace(jM,`
`).replace(GM,"")}function BI(r,o){return o=FI(o),FI(r)===o}function bt(r,o,c,h,v,E){switch(c){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||ts(r,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&ts(r,""+h);break;case"className":fs(r,"class",h);break;case"tabIndex":fs(r,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":fs(r,c,h);break;case"style":pu(r,h,E);break;case"data":if(o!=="object"){fs(r,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||c!=="href")){r.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(c);break}h=pl(""+h),r.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(c==="formAction"?(o!=="input"&&bt(r,o,"name",v.name,v,null),bt(r,o,"formEncType",v.formEncType,v,null),bt(r,o,"formMethod",v.formMethod,v,null),bt(r,o,"formTarget",v.formTarget,v,null)):(bt(r,o,"encType",v.encType,v,null),bt(r,o,"method",v.method,v,null),bt(r,o,"target",v.target,v,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(c);break}h=pl(""+h),r.setAttribute(c,h);break;case"onClick":h!=null&&(r.onclick=Qs);break;case"onScroll":h!=null&&Ze("scroll",r);break;case"onScrollEnd":h!=null&&Ze("scrollend",r);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(s(61));if(c=h.__html,c!=null){if(v.children!=null)throw Error(s(60));r.innerHTML=c}}break;case"multiple":r.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":r.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){r.removeAttribute("xlink:href");break}c=pl(""+h),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(c,""+h):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":h===!0?r.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(c,h):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?r.setAttribute(c,h):r.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?r.removeAttribute(c):r.setAttribute(c,h);break;case"popover":Ze("beforetoggle",r),Ze("toggle",r),hl(r,"popover",h);break;case"xlinkActuate":an(r,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":an(r,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":an(r,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":an(r,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":an(r,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":an(r,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":an(r,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":an(r,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":an(r,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":hl(r,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Zh.get(c)||c,hl(r,c,h))}}function Wy(r,o,c,h,v,E){switch(c){case"style":pu(r,h,E);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(s(61));if(c=h.__html,c!=null){if(v.children!=null)throw Error(s(60));r.innerHTML=c}}break;case"children":typeof h=="string"?ts(r,h):(typeof h=="number"||typeof h=="bigint")&&ts(r,""+h);break;case"onScroll":h!=null&&Ze("scroll",r);break;case"onScrollEnd":h!=null&&Ze("scrollend",r);break;case"onClick":h!=null&&(r.onclick=Qs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!lu.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(v=c.endsWith("Capture"),o=c.slice(2,v?c.length-7:void 0),E=r[vn]||null,E=E!=null?E[c]:null,typeof E=="function"&&r.removeEventListener(o,E,v),typeof h=="function")){typeof E!="function"&&E!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(o,h,v);break e}c in r?r[c]=h:h===!0?r.setAttribute(c,""):hl(r,c,h)}}}function Pn(r,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ze("error",r),Ze("load",r);var h=!1,v=!1,E;for(E in c)if(c.hasOwnProperty(E)){var A=c[E];if(A!=null)switch(E){case"src":h=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:bt(r,o,E,A,c,null)}}v&&bt(r,o,"srcSet",c.srcSet,c,null),h&&bt(r,o,"src",c.src,c,null);return;case"input":Ze("invalid",r);var R=E=A=v=null,j=null,ne=null;for(h in c)if(c.hasOwnProperty(h)){var ce=c[h];if(ce!=null)switch(h){case"name":v=ce;break;case"type":A=ce;break;case"checked":j=ce;break;case"defaultChecked":ne=ce;break;case"value":E=ce;break;case"defaultValue":R=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(s(137,o));break;default:bt(r,o,h,ce,c,null)}}Qh(r,E,R,j,ne,A,v,!1);return;case"select":Ze("invalid",r),h=A=E=null;for(v in c)if(c.hasOwnProperty(v)&&(R=c[v],R!=null))switch(v){case"value":E=R;break;case"defaultValue":A=R;break;case"multiple":h=R;default:bt(r,o,v,R,c,null)}o=E,c=A,r.multiple=!!h,o!=null?Ur(r,!!h,o,!1):c!=null&&Ur(r,!!h,c,!0);return;case"textarea":Ze("invalid",r),E=v=h=null;for(A in c)if(c.hasOwnProperty(A)&&(R=c[A],R!=null))switch(A){case"value":h=R;break;case"defaultValue":v=R;break;case"children":E=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(s(91));break;default:bt(r,o,A,R,c,null)}Or(r,h,v,E);return;case"option":for(j in c)if(c.hasOwnProperty(j)&&(h=c[j],h!=null))switch(j){case"selected":r.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:bt(r,o,j,h,c,null)}return;case"dialog":Ze("beforetoggle",r),Ze("toggle",r),Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":Ze("load",r);break;case"video":case"audio":for(h=0;h<Ju.length;h++)Ze(Ju[h],r);break;case"image":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"embed":case"source":case"link":Ze("error",r),Ze("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in c)if(c.hasOwnProperty(ne)&&(h=c[ne],h!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:bt(r,o,ne,h,c,null)}return;default:if(ml(o)){for(ce in c)c.hasOwnProperty(ce)&&(h=c[ce],h!==void 0&&Wy(r,o,ce,h,c,void 0));return}}for(R in c)c.hasOwnProperty(R)&&(h=c[R],h!=null&&bt(r,o,R,h,c,null))}function qM(r,o,c,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,E=null,A=null,R=null,j=null,ne=null,ce=null;for(oe in c){var de=c[oe];if(c.hasOwnProperty(oe)&&de!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":j=de;default:h.hasOwnProperty(oe)||bt(r,o,oe,null,h,de)}}for(var se in h){var oe=h[se];if(de=c[se],h.hasOwnProperty(se)&&(oe!=null||de!=null))switch(se){case"type":E=oe;break;case"name":v=oe;break;case"checked":ne=oe;break;case"defaultChecked":ce=oe;break;case"value":A=oe;break;case"defaultValue":R=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(s(137,o));break;default:oe!==de&&bt(r,o,se,oe,h,de)}}fl(r,A,R,j,ne,ce,E,v);return;case"select":oe=A=R=se=null;for(E in c)if(j=c[E],c.hasOwnProperty(E)&&j!=null)switch(E){case"value":break;case"multiple":oe=j;default:h.hasOwnProperty(E)||bt(r,o,E,null,h,j)}for(v in h)if(E=h[v],j=c[v],h.hasOwnProperty(v)&&(E!=null||j!=null))switch(v){case"value":se=E;break;case"defaultValue":R=E;break;case"multiple":A=E;default:E!==j&&bt(r,o,v,E,h,j)}o=R,c=A,h=oe,se!=null?Ur(r,!!c,se,!1):!!h!=!!c&&(o!=null?Ur(r,!!c,o,!0):Ur(r,!!c,c?[]:"",!1));return;case"textarea":oe=se=null;for(R in c)if(v=c[R],c.hasOwnProperty(R)&&v!=null&&!h.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:bt(r,o,R,null,h,v)}for(A in h)if(v=h[A],E=c[A],h.hasOwnProperty(A)&&(v!=null||E!=null))switch(A){case"value":se=v;break;case"defaultValue":oe=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(s(91));break;default:v!==E&&bt(r,o,A,v,h,E)}Wh(r,se,oe);return;case"option":for(var Se in c)if(se=c[Se],c.hasOwnProperty(Se)&&se!=null&&!h.hasOwnProperty(Se))switch(Se){case"selected":r.selected=!1;break;default:bt(r,o,Se,null,h,se)}for(j in h)if(se=h[j],oe=c[j],h.hasOwnProperty(j)&&se!==oe&&(se!=null||oe!=null))switch(j){case"selected":r.selected=se&&typeof se!="function"&&typeof se!="symbol";break;default:bt(r,o,j,se,h,oe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Be in c)se=c[Be],c.hasOwnProperty(Be)&&se!=null&&!h.hasOwnProperty(Be)&&bt(r,o,Be,null,h,se);for(ne in h)if(se=h[ne],oe=c[ne],h.hasOwnProperty(ne)&&se!==oe&&(se!=null||oe!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(s(137,o));break;default:bt(r,o,ne,se,h,oe)}return;default:if(ml(o)){for(var At in c)se=c[At],c.hasOwnProperty(At)&&se!==void 0&&!h.hasOwnProperty(At)&&Wy(r,o,At,void 0,h,se);for(ce in h)se=h[ce],oe=c[ce],!h.hasOwnProperty(ce)||se===oe||se===void 0&&oe===void 0||Wy(r,o,ce,se,h,oe);return}}for(var W in c)se=c[W],c.hasOwnProperty(W)&&se!=null&&!h.hasOwnProperty(W)&&bt(r,o,W,null,h,se);for(de in h)se=h[de],oe=c[de],!h.hasOwnProperty(de)||se===oe||se==null&&oe==null||bt(r,o,de,se,h,oe)}function jI(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function HM(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var v=c[h],E=v.transferSize,A=v.initiatorType,R=v.duration;if(E&&R&&jI(A)){for(A=0,R=v.responseEnd,h+=1;h<c.length;h++){var j=c[h],ne=j.startTime;if(ne>R)break;var ce=j.transferSize,de=j.initiatorType;ce&&jI(de)&&(j=j.responseEnd,A+=ce*(j<R?1:(R-ne)/(j-ne)))}if(--h,o+=8*(E+A)/(v.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Xy=null,Zy=null;function tm(r){return r.nodeType===9?r:r.ownerDocument}function GI(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qI(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function e_(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var t_=null;function zM(){var r=window.event;return r&&r.type==="popstate"?r===t_?!1:(t_=r,!0):(t_=null,!1)}var HI=typeof setTimeout=="function"?setTimeout:void 0,$M=typeof clearTimeout=="function"?clearTimeout:void 0,zI=typeof Promise=="function"?Promise:void 0,YM=typeof queueMicrotask=="function"?queueMicrotask:typeof zI<"u"?function(r){return zI.resolve(null).then(r).catch(KM)}:HI;function KM(r){setTimeout(function(){throw r})}function ao(r){return r==="head"}function $I(r,o){var c=o,h=0;do{var v=c.nextSibling;if(r.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"||c==="/&"){if(h===0){r.removeChild(v),Jl(o);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")Wu(r.ownerDocument.documentElement);else if(c==="head"){c=r.ownerDocument.head,Wu(c);for(var E=c.firstChild;E;){var A=E.nextSibling,R=E.nodeName;E[_i]||R==="SCRIPT"||R==="STYLE"||R==="LINK"&&E.rel.toLowerCase()==="stylesheet"||c.removeChild(E),E=A}}else c==="body"&&Wu(r.ownerDocument.body);c=v}while(c);Jl(o)}function YI(r,o){var c=r;r=0;do{var h=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(r===0)break;r--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||r++;c=h}while(c)}function n_(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":n_(c),dl(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function JM(r,o,c,h){for(;r.nodeType===1;){var v=c;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(h){if(!r[_i])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(E=r.getAttribute("rel"),E==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(E!==v.rel||r.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||r.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||r.getAttribute("title")!==(v.title==null?null:v.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(E=r.getAttribute("src"),(E!==(v.src==null?null:v.src)||r.getAttribute("type")!==(v.type==null?null:v.type)||r.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&E&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var E=v.name==null?null:""+v.name;if(v.type==="hidden"&&r.getAttribute("name")===E)return r}else return r;if(r=Os(r.nextSibling),r===null)break}return null}function QM(r,o,c){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=Os(r.nextSibling),r===null))return null;return r}function KI(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Os(r.nextSibling),r===null))return null;return r}function s_(r){return r.data==="$?"||r.data==="$~"}function i_(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function WM(r,o){var c=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||c.readyState!=="loading")o();else{var h=function(){o(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),r._reactRetry=h}}function Os(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var r_=null;function JI(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"||c==="/&"){if(o===0)return Os(r.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}r=r.nextSibling}return null}function QI(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return r;o--}else c!=="/$"&&c!=="/&"||o++}r=r.previousSibling}return null}function WI(r,o,c){switch(o=tm(c),r){case"html":if(r=o.documentElement,!r)throw Error(s(452));return r;case"head":if(r=o.head,!r)throw Error(s(453));return r;case"body":if(r=o.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function Wu(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);dl(r)}var Fs=new Map,XI=new Set;function nm(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var mr=ge.d;ge.d={f:XM,r:ZM,D:e2,C:t2,L:n2,m:s2,X:r2,S:i2,M:o2};function XM(){var r=mr.f(),o=Yf();return r||o}function ZM(r){var o=Ss(r);o!==null&&o.tag===5&&o.type==="form"?px(o):mr.r(r)}var $l=typeof document>"u"?null:document;function ZI(r,o,c){var h=$l;if(h&&typeof o=="string"&&o){var v=es(o);v='link[rel="'+r+'"][href="'+v+'"]',typeof c=="string"&&(v+='[crossorigin="'+c+'"]'),XI.has(v)||(XI.add(v),r={rel:r,crossOrigin:c,href:o},h.querySelector(v)===null&&(o=h.createElement("link"),Pn(o,"link",r),on(o),h.head.appendChild(o)))}}function e2(r){mr.D(r),ZI("dns-prefetch",r,null)}function t2(r,o){mr.C(r,o),ZI("preconnect",r,o)}function n2(r,o,c){mr.L(r,o,c);var h=$l;if(h&&r&&o){var v='link[rel="preload"][as="'+es(o)+'"]';o==="image"&&c&&c.imageSrcSet?(v+='[imagesrcset="'+es(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(v+='[imagesizes="'+es(c.imageSizes)+'"]')):v+='[href="'+es(r)+'"]';var E=v;switch(o){case"style":E=Yl(r);break;case"script":E=Kl(r)}Fs.has(E)||(r=T({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:r,as:o},c),Fs.set(E,r),h.querySelector(v)!==null||o==="style"&&h.querySelector(Xu(E))||o==="script"&&h.querySelector(Zu(E))||(o=h.createElement("link"),Pn(o,"link",r),on(o),h.head.appendChild(o)))}}function s2(r,o){mr.m(r,o);var c=$l;if(c&&r){var h=o&&typeof o.as=="string"?o.as:"script",v='link[rel="modulepreload"][as="'+es(h)+'"][href="'+es(r)+'"]',E=v;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Kl(r)}if(!Fs.has(E)&&(r=T({rel:"modulepreload",href:r},o),Fs.set(E,r),c.querySelector(v)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Zu(E)))return}h=c.createElement("link"),Pn(h,"link",r),on(h),c.head.appendChild(h)}}}function i2(r,o,c){mr.S(r,o,c);var h=$l;if(h&&r){var v=Ei(h).hoistableStyles,E=Yl(r);o=o||"default";var A=v.get(E);if(!A){var R={loading:0,preload:null};if(A=h.querySelector(Xu(E)))R.loading=5;else{r=T({rel:"stylesheet",href:r,"data-precedence":o},c),(c=Fs.get(E))&&o_(r,c);var j=A=h.createElement("link");on(j),Pn(j,"link",r),j._p=new Promise(function(ne,ce){j.onload=ne,j.onerror=ce}),j.addEventListener("load",function(){R.loading|=1}),j.addEventListener("error",function(){R.loading|=2}),R.loading|=4,sm(A,o,h)}A={type:"stylesheet",instance:A,count:1,state:R},v.set(E,A)}}}function r2(r,o){mr.X(r,o);var c=$l;if(c&&r){var h=Ei(c).hoistableScripts,v=Kl(r),E=h.get(v);E||(E=c.querySelector(Zu(v)),E||(r=T({src:r,async:!0},o),(o=Fs.get(v))&&a_(r,o),E=c.createElement("script"),on(E),Pn(E,"link",r),c.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},h.set(v,E))}}function o2(r,o){mr.M(r,o);var c=$l;if(c&&r){var h=Ei(c).hoistableScripts,v=Kl(r),E=h.get(v);E||(E=c.querySelector(Zu(v)),E||(r=T({src:r,async:!0,type:"module"},o),(o=Fs.get(v))&&a_(r,o),E=c.createElement("script"),on(E),Pn(E,"link",r),c.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},h.set(v,E))}}function eb(r,o,c,h){var v=(v=ye.current)?nm(v):null;if(!v)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=Yl(c.href),c=Ei(v).hoistableStyles,h=c.get(o),h||(h={type:"style",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=Yl(c.href);var E=Ei(v).hoistableStyles,A=E.get(r);if(A||(v=v.ownerDocument||v,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(r,A),(E=v.querySelector(Xu(r)))&&!E._p&&(A.instance=E,A.state.loading=5),Fs.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Fs.set(r,c),E||a2(v,r,c,A.state))),o&&h===null)throw Error(s(528,""));return A}if(o&&h!==null)throw Error(s(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Kl(c),c=Ei(v).hoistableScripts,h=c.get(o),h||(h={type:"script",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function Yl(r){return'href="'+es(r)+'"'}function Xu(r){return'link[rel="stylesheet"]['+r+"]"}function tb(r){return T({},r,{"data-precedence":r.precedence,precedence:null})}function a2(r,o,c,h){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=r.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),Pn(o,"link",c),on(o),r.head.appendChild(o))}function Kl(r){return'[src="'+es(r)+'"]'}function Zu(r){return"script[async]"+r}function nb(r,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var h=r.querySelector('style[data-href~="'+es(c.href)+'"]');if(h)return o.instance=h,on(h),h;var v=T({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(r.ownerDocument||r).createElement("style"),on(h),Pn(h,"style",v),sm(h,c.precedence,r),o.instance=h;case"stylesheet":v=Yl(c.href);var E=r.querySelector(Xu(v));if(E)return o.state.loading|=4,o.instance=E,on(E),E;h=tb(c),(v=Fs.get(v))&&o_(h,v),E=(r.ownerDocument||r).createElement("link"),on(E);var A=E;return A._p=new Promise(function(R,j){A.onload=R,A.onerror=j}),Pn(E,"link",h),o.state.loading|=4,sm(E,c.precedence,r),o.instance=E;case"script":return E=Kl(c.src),(v=r.querySelector(Zu(E)))?(o.instance=v,on(v),v):(h=c,(v=Fs.get(E))&&(h=T({},c),a_(h,v)),r=r.ownerDocument||r,v=r.createElement("script"),on(v),Pn(v,"link",h),r.head.appendChild(v),o.instance=v);case"void":return null;default:throw Error(s(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,sm(h,c.precedence,r));return o.instance}function sm(r,o,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=h.length?h[h.length-1]:null,E=v,A=0;A<h.length;A++){var R=h[A];if(R.dataset.precedence===o)E=R;else if(E!==v)break}E?E.parentNode.insertBefore(r,E.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(r,o.firstChild))}function o_(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function a_(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var im=null;function sb(r,o,c){if(im===null){var h=new Map,v=im=new Map;v.set(c,h)}else v=im,h=v.get(c),h||(h=new Map,v.set(c,h));if(h.has(r))return h;for(h.set(r,null),c=c.getElementsByTagName(r),v=0;v<c.length;v++){var E=c[v];if(!(E[_i]||E[rn]||r==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var A=E.getAttribute(o)||"";A=r+A;var R=h.get(A);R?R.push(E):h.set(A,[E])}}return h}function ib(r,o,c){r=r.ownerDocument||r,r.head.insertBefore(c,o==="title"?r.querySelector("head > title"):null)}function l2(r,o,c){if(c===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function rb(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function c2(r,o,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var v=Yl(h.href),E=o.querySelector(Xu(v));if(E){o=E._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=rm.bind(r),o.then(r,r)),c.state.loading|=4,c.instance=E,on(E);return}E=o.ownerDocument||o,h=tb(h),(v=Fs.get(v))&&o_(h,v),E=E.createElement("link"),on(E);var A=E;A._p=new Promise(function(R,j){A.onload=R,A.onerror=j}),Pn(E,"link",h),c.instance=E}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(r.count++,c=rm.bind(r),o.addEventListener("load",c),o.addEventListener("error",c))}}var l_=0;function u2(r,o){return r.stylesheets&&r.count===0&&am(r,r.stylesheets),0<r.count||0<r.imgCount?function(c){var h=setTimeout(function(){if(r.stylesheets&&am(r,r.stylesheets),r.unsuspend){var E=r.unsuspend;r.unsuspend=null,E()}},6e4+o);0<r.imgBytes&&l_===0&&(l_=62500*HM());var v=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&am(r,r.stylesheets),r.unsuspend)){var E=r.unsuspend;r.unsuspend=null,E()}},(r.imgBytes>l_?50:800)+o);return r.unsuspend=c,function(){r.unsuspend=null,clearTimeout(h),clearTimeout(v)}}:null}function rm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)am(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var om=null;function am(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,om=new Map,o.forEach(d2,r),om=null,rm.call(r))}function d2(r,o){if(!(o.state.loading&4)){var c=om.get(r);if(c)var h=c.get(null);else{c=new Map,om.set(r,c);for(var v=r.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<v.length;E++){var A=v[E];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(c.set(A.dataset.precedence,A),h=A)}h&&c.set(null,h)}v=o.instance,A=v.getAttribute("data-precedence"),E=c.get(A)||h,E===h&&c.set(null,v),c.set(A,v),this.count++,h=rm.bind(this),v.addEventListener("load",h),v.addEventListener("error",h),E?E.parentNode.insertBefore(v,E.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(v,r.firstChild)),o.state.loading|=4}}var ed={$$typeof:H,Provider:null,Consumer:null,_currentValue:Ee,_currentValue2:Ee,_threadCount:0};function h2(r,o,c,h,v,E,A,R,j){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gi(0),this.hiddenUpdates=gi(null),this.identifierPrefix=h,this.onUncaughtError=v,this.onCaughtError=E,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=j,this.incompleteTransitions=new Map}function ob(r,o,c,h,v,E,A,R,j,ne,ce,de){return r=new h2(r,o,c,A,j,ne,ce,de,R),o=1,E===!0&&(o|=24),E=ps(3,null,null,o),r.current=E,E.stateNode=r,o=jg(),o.refCount++,r.pooledCache=o,o.refCount++,E.memoizedState={element:h,isDehydrated:c,cache:o},zg(E),r}function ab(r){return r?(r=Al,r):Al}function lb(r,o,c,h,v,E){v=ab(v),h.context===null?h.context=v:h.pendingContext=v,h=Qr(o),h.payload={element:c},E=E===void 0?null:E,E!==null&&(h.callback=E),c=Wr(r,h,o),c!==null&&(os(c,r,o),Du(c,r,o))}function cb(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<o?c:o}}function c_(r,o){cb(r,o),(r=r.alternate)&&cb(r,o)}function ub(r){if(r.tag===13||r.tag===31){var o=ua(r,67108864);o!==null&&os(o,r,67108864),c_(r,67108864)}}function db(r){if(r.tag===13||r.tag===31){var o=Es();o=Xo(o);var c=ua(r,o);c!==null&&os(c,r,o),c_(r,o)}}var lm=!0;function f2(r,o,c,h){var v=Q.T;Q.T=null;var E=ge.p;try{ge.p=2,u_(r,o,c,h)}finally{ge.p=E,Q.T=v}}function m2(r,o,c,h){var v=Q.T;Q.T=null;var E=ge.p;try{ge.p=8,u_(r,o,c,h)}finally{ge.p=E,Q.T=v}}function u_(r,o,c,h){if(lm){var v=d_(h);if(v===null)Qy(r,o,h,cm,c),fb(r,h);else if(g2(v,r,o,c,h))h.stopPropagation();else if(fb(r,h),o&4&&-1<p2.indexOf(r)){for(;v!==null;){var E=Ss(v);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var A=mi(E.pendingLanes);if(A!==0){var R=E;for(R.pendingLanes|=2,R.entangledLanes|=2;A;){var j=1<<31-Yt(A);R.entanglements[1]|=j,A&=~j}Mi(E),(mt&6)===0&&(zf=tn()+500,Ku(0))}}break;case 31:case 13:R=ua(E,2),R!==null&&os(R,E,2),Yf(),c_(E,2)}if(E=d_(h),E===null&&Qy(r,o,h,cm,c),E===v)break;v=E}v!==null&&h.stopPropagation()}else Qy(r,o,h,null,c)}}function d_(r){return r=Cs(r),h_(r)}var cm=null;function h_(r){if(cm=null,r=vi(r),r!==null){var o=a(r);if(o===null)r=null;else{var c=o.tag;if(c===13){if(r=l(o),r!==null)return r;r=null}else if(c===31){if(r=u(o),r!==null)return r;r=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return cm=r,null}function hb(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(hi()){case nn:return 2;case Ji:return 8;case Vr:case _g:return 32;case Bh:return 268435456;default:return 32}default:return 32}}var f_=!1,lo=null,co=null,uo=null,td=new Map,nd=new Map,ho=[],p2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function fb(r,o){switch(r){case"focusin":case"focusout":lo=null;break;case"dragenter":case"dragleave":co=null;break;case"mouseover":case"mouseout":uo=null;break;case"pointerover":case"pointerout":td.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":nd.delete(o.pointerId)}}function sd(r,o,c,h,v,E){return r===null||r.nativeEvent!==E?(r={blockedOn:o,domEventName:c,eventSystemFlags:h,nativeEvent:E,targetContainers:[v]},o!==null&&(o=Ss(o),o!==null&&ub(o)),r):(r.eventSystemFlags|=h,o=r.targetContainers,v!==null&&o.indexOf(v)===-1&&o.push(v),r)}function g2(r,o,c,h,v){switch(o){case"focusin":return lo=sd(lo,r,o,c,h,v),!0;case"dragenter":return co=sd(co,r,o,c,h,v),!0;case"mouseover":return uo=sd(uo,r,o,c,h,v),!0;case"pointerover":var E=v.pointerId;return td.set(E,sd(td.get(E)||null,r,o,c,h,v)),!0;case"gotpointercapture":return E=v.pointerId,nd.set(E,sd(nd.get(E)||null,r,o,c,h,v)),!0}return!1}function mb(r){var o=vi(r.target);if(o!==null){var c=a(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){r.blockedOn=o,Ks(r.priority,function(){db(c)});return}}else if(o===31){if(o=u(c),o!==null){r.blockedOn=o,Ks(r.priority,function(){db(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function um(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var c=d_(r.nativeEvent);if(c===null){c=r.nativeEvent;var h=new c.constructor(c.type,c);gu=h,c.target.dispatchEvent(h),gu=null}else return o=Ss(c),o!==null&&ub(o),r.blockedOn=c,!1;o.shift()}return!0}function pb(r,o,c){um(r)&&c.delete(o)}function y2(){f_=!1,lo!==null&&um(lo)&&(lo=null),co!==null&&um(co)&&(co=null),uo!==null&&um(uo)&&(uo=null),td.forEach(pb),nd.forEach(pb)}function dm(r,o){r.blockedOn===o&&(r.blockedOn=null,f_||(f_=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,y2)))}var hm=null;function gb(r){hm!==r&&(hm=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){hm===r&&(hm=null);for(var o=0;o<r.length;o+=3){var c=r[o],h=r[o+1],v=r[o+2];if(typeof h!="function"){if(h_(h||c)===null)continue;break}var E=Ss(c);E!==null&&(r.splice(o,3),o-=3,dy(E,{pending:!0,data:v,method:c.method,action:h},h,v))}}))}function Jl(r){function o(j){return dm(j,r)}lo!==null&&dm(lo,r),co!==null&&dm(co,r),uo!==null&&dm(uo,r),td.forEach(o),nd.forEach(o);for(var c=0;c<ho.length;c++){var h=ho[c];h.blockedOn===r&&(h.blockedOn=null)}for(;0<ho.length&&(c=ho[0],c.blockedOn===null);)mb(c),c.blockedOn===null&&ho.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var v=c[h],E=c[h+1],A=v[vn]||null;if(typeof E=="function")A||gb(c);else if(A){var R=null;if(E&&E.hasAttribute("formAction")){if(v=E,A=E[vn]||null)R=A.formAction;else if(h_(v)!==null)continue}else R=A.action;typeof R=="function"?c[h+1]=R:(c.splice(h,3),h-=3),gb(c)}}}function yb(){function r(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(A){return v=A})},focusReset:"manual",scroll:"manual"})}function o(){v!==null&&(v(),v=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,v=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),v!==null&&(v(),v=null)}}}function m_(r){this._internalRoot=r}fm.prototype.render=m_.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(s(409));var c=o.current,h=Es();lb(c,h,r,o,null,null)},fm.prototype.unmount=m_.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;lb(r.current,2,null,r,null,null),Yf(),o[yi]=null}};function fm(r){this._internalRoot=r}fm.prototype.unstable_scheduleHydration=function(r){if(r){var o=$h();r={blockedOn:null,target:r,priority:o};for(var c=0;c<ho.length&&o!==0&&o<ho[c].priority;c++);ho.splice(c,0,r),c===0&&mb(r)}};var _b=e.version;if(_b!=="19.2.1")throw Error(s(527,_b,"19.2.1"));ge.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=m(o),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var _2={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mm.isDisabled&&mm.supportsFiber)try{$s=mm.inject(_2),wn=mm}catch{}}return rd.createRoot=function(r,o){if(!i(r))throw Error(s(299));var c=!1,h="",v=Ax,E=wx,A=Nx;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(v=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(A=o.onRecoverableError)),o=ob(r,1,!1,null,null,c,h,null,v,E,A,yb),r[yi]=o.current,Jy(r),new m_(o)},rd.hydrateRoot=function(r,o,c){if(!i(r))throw Error(s(299));var h=!1,v="",E=Ax,A=wx,R=Nx,j=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onUncaughtError!==void 0&&(E=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(R=c.onRecoverableError),c.formState!==void 0&&(j=c.formState)),o=ob(r,1,!0,o,c??null,h,v,j,E,A,R,yb),o.context=ab(null),c=o.current,h=Es(),h=Xo(h),v=Qr(h),v.callback=null,Wr(c,v,h),c=h,o.current.lanes=c,Qo(o,c),Mi(o),r[yi]=o.current,Jy(r),new fm(o)},rd.version="19.2.1",rd}var Sb;function S2(){if(Sb)return y_.exports;Sb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),y_.exports=N2(),y_.exports}var C2=S2();const R2=ES(C2),P2=()=>{};var Cb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TS=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},D2=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const i=n[t++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[s++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],l=n[t++],u=n[t++],f=((i&7)<<18|(a&63)<<12|(l&63)<<6|u&63)-65536;e[s++]=String.fromCharCode(55296+(f>>10)),e[s++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],l=n[t++];e[s++]=String.fromCharCode((i&15)<<12|(a&63)<<6|l&63)}}return e.join("")},xS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<n.length;i+=3){const a=n[i],l=i+1<n.length,u=l?n[i+1]:0,f=i+2<n.length,m=f?n[i+2]:0,_=a>>2,T=(a&3)<<4|u>>4;let x=(u&15)<<2|m>>6,b=m&63;f||(b=64,l||(x=64)),s.push(t[_],t[T],t[x],t[b])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(TS(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):D2(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;const m=i<n.length?t[n.charAt(i)]:64;++i;const T=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||u==null||m==null||T==null)throw new M2;const x=a<<2|u>>4;if(s.push(x),m!==64){const b=u<<4&240|m>>2;if(s.push(b),T!==64){const k=m<<6&192|T;s.push(k)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class M2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const k2=function(n){const e=TS(n);return xS.encodeByteArray(e,!0)},Gm=function(n){return k2(n).replace(/\./g,"")},Yv=function(n){try{return xS.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function qm(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!V2(t)||(n[t]=qm(n[t],e[t]));return n}function V2(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2=()=>Kv().__FIREBASE_DEFAULTS__,U2=()=>{if(typeof process>"u"||typeof Cb>"u")return;const n=Cb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},O2=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Yv(n[1]);return e&&JSON.parse(e)},Jv=()=>{try{return P2()||L2()||U2()||O2()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Qv=()=>{var n;return(n=Jv())==null?void 0:n.config},F2=n=>{var e;return(e=Jv())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gc(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function IS(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j2(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Gm(JSON.stringify(t)),Gm(JSON.stringify(l)),""].join(".")}const Ad={};function G2(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ad))Ad[e]?n.emulator.push(e):n.prod.push(e);return n}function q2(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Rb=!1;function bS(n,e){if(typeof window>"u"||typeof document>"u"||!Gc(window.location.host)||Ad[n]===e||Ad[n]||Rb)return;Ad[n]=e;function t(x){return`__firebase__banner__${x}`}const s="__firebase__banner",a=G2().prod.length>0;function l(){const x=document.getElementById(s);x&&x.remove()}function u(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function f(x,b){x.setAttribute("width","24"),x.setAttribute("id",b),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function m(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{Rb=!0,l()},x}function _(x,b){x.setAttribute("id",b),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function T(){const x=q2(s),b=t("text"),k=document.getElementById(b)||document.createElement("span"),G=t("learnmore"),F=document.getElementById(G)||document.createElement("a"),Y=t("preprendIcon"),K=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const H=x.element;u(H),_(F,G);const U=m();f(K,Y),H.append(K,k,F,U),document.body.appendChild(H)}a?(k.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function H2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Bt())}function Ep(){var e;const n=(e=Jv())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function z2(){return typeof window<"u"||AS()}function AS(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function $2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Tp(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Wv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wS(){const n=Bt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function NS(){return!Ep()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SS(){return!Ep()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ja(){try{return typeof indexedDB=="object"}catch{return!1}}function Xv(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var a;e(((a=i.error)==null?void 0:a.message)||"")}}catch(t){e(t)}})}function CS(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2="FirebaseError";class Vn extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=Y2,Object.setPrototypeOf(this,Vn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wr.prototype.create)}}class wr{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],l=a?K2(a,s):"Error",u=`${this.serviceName}: ${l} (${i}).`;return new Vn(i,u,s)}}function K2(n,e){return n.replace(J2,(t,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const J2=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pb(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Q2(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Co(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const i of t){if(!s.includes(i))return!1;const a=n[i],l=e[i];if(Db(a)&&Db(l)){if(!Co(a,l))return!1}else if(a!==l)return!1}for(const i of s)if(!t.includes(i))return!1;return!0}function Db(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function lc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[i,a]=s.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function gd(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function RS(n,e){const t=new W2(n,e);return t.subscribe.bind(t)}class W2{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let i;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");X2(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:s},i.next===void 0&&(i.next=T_),i.error===void 0&&(i.error=T_),i.complete===void 0&&(i.complete=T_);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function X2(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function T_(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2=1e3,ek=2,tk=14400*1e3,nk=.5;function Mb(n,e=Z2,t=ek){const s=e*Math.pow(t,n),i=Math.round(nk*s*(Math.random()-.5)*2);return Math.min(tk,s+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(n){return n&&n._delegate?n._delegate:n}class Xn{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new B2;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(rk(e))try{this.getOrInitializeService({instanceIdentifier:ba})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});s.resolve(a)}catch{}}}}clearInstance(e=ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ba){return this.instances.has(e)}getOptions(e=ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[a,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(a);s===u&&l.resolve(i)}return i}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(s)??new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const i of s)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:ik(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ba){return this.component?this.component.multipleInstances?e:ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ik(n){return n===ba?void 0:n}function rk(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new sk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv=[];var et;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(et||(et={}));const DS={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},ok=et.INFO,ak={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},lk=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),i=ak[e];if(i)console[i](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class mh{constructor(e){this.name=e,this._logLevel=ok,this._logHandler=lk,this._userLogHandler=null,Zv.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?DS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...e),this._logHandler(this,et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...e),this._logHandler(this,et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,et.INFO,...e),this._logHandler(this,et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,et.WARN,...e),this._logHandler(this,et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...e),this._logHandler(this,et.ERROR,...e)}}function ck(n){Zv.forEach(e=>{e.setLogLevel(n)})}function uk(n,e){for(const t of Zv){let s=null;e&&e.level&&(s=DS[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,a,...l)=>{const u=l.map(f=>{if(f==null)return null;if(typeof f=="string")return f;if(typeof f=="number"||typeof f=="boolean")return f.toString();if(f instanceof Error)return f.message;try{return JSON.stringify(f)}catch{return null}}).filter(f=>f).join(" ");a>=(s??i.logLevel)&&n({level:et[a].toLowerCase(),message:u,args:l,type:i.name})}}}const dk=(n,e)=>e.some(t=>n instanceof t);let kb,Vb;function hk(){return kb||(kb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fk(){return Vb||(Vb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const MS=new WeakMap,H_=new WeakMap,kS=new WeakMap,x_=new WeakMap,e0=new WeakMap;function mk(n){const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(bo(n.result)),i()},l=()=>{s(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&MS.set(t,n)}).catch(()=>{}),e0.set(e,n),e}function pk(n){if(H_.has(n))return;const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),i()},l=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});H_.set(n,e)}let z_={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return H_.get(n);if(e==="objectStoreNames")return n.objectStoreNames||kS.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function gk(n){z_=n(z_)}function yk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(I_(this),e,...t);return kS.set(s,e.sort?e.sort():[e]),bo(s)}:fk().includes(n)?function(...e){return n.apply(I_(this),e),bo(MS.get(this))}:function(...e){return bo(n.apply(I_(this),e))}}function _k(n){return typeof n=="function"?yk(n):(n instanceof IDBTransaction&&pk(n),dk(n,hk())?new Proxy(n,z_):n)}function bo(n){if(n instanceof IDBRequest)return mk(n);if(x_.has(n))return x_.get(n);const e=_k(n);return e!==n&&(x_.set(n,e),e0.set(e,n)),e}const I_=n=>e0.get(n);function VS(n,e,{blocked:t,upgrade:s,blocking:i,terminated:a}={}){const l=indexedDB.open(n,e),u=bo(l);return s&&l.addEventListener("upgradeneeded",f=>{s(bo(l.result),f.oldVersion,f.newVersion,bo(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),u.then(f=>{a&&f.addEventListener("close",()=>a()),i&&f.addEventListener("versionchange",m=>i(m.oldVersion,m.newVersion,m))}).catch(()=>{}),u}const vk=["get","getKey","getAll","getAllKeys","count"],Ek=["put","add","delete","clear"],b_=new Map;function Lb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(b_.get(e))return b_.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,i=Ek.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(i||vk.includes(t)))return;const a=async function(l,...u){const f=this.transaction(l,i?"readwrite":"readonly");let m=f.store;return s&&(m=m.index(u.shift())),(await Promise.all([m[t](...u),i&&f.done]))[0]};return b_.set(e,a),a}gk(n=>({...n,get:(e,t,s)=>Lb(e,t)||n.get(e,t,s),has:(e,t)=>!!Lb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(xk(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function xk(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Hm="@firebase/app",$_="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tr=new mh("@firebase/app"),Ik="@firebase/app-compat",bk="@firebase/analytics-compat",Ak="@firebase/analytics",wk="@firebase/app-check-compat",Nk="@firebase/app-check",Sk="@firebase/auth",Ck="@firebase/auth-compat",Rk="@firebase/database",Pk="@firebase/data-connect",Dk="@firebase/database-compat",Mk="@firebase/functions",kk="@firebase/functions-compat",Vk="@firebase/installations",Lk="@firebase/installations-compat",Uk="@firebase/messaging",Ok="@firebase/messaging-compat",Fk="@firebase/performance",Bk="@firebase/performance-compat",jk="@firebase/remote-config",Gk="@firebase/remote-config-compat",qk="@firebase/storage",Hk="@firebase/storage-compat",zk="@firebase/firestore",$k="@firebase/ai",Yk="@firebase/firestore-compat",Kk="firebase",Jk="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro="[DEFAULT]",Qk={[Hm]:"fire-core",[Ik]:"fire-core-compat",[Ak]:"fire-analytics",[bk]:"fire-analytics-compat",[Nk]:"fire-app-check",[wk]:"fire-app-check-compat",[Sk]:"fire-auth",[Ck]:"fire-auth-compat",[Rk]:"fire-rtdb",[Pk]:"fire-data-connect",[Dk]:"fire-rtdb-compat",[Mk]:"fire-fn",[kk]:"fire-fn-compat",[Vk]:"fire-iid",[Lk]:"fire-iid-compat",[Uk]:"fire-fcm",[Ok]:"fire-fcm-compat",[Fk]:"fire-perf",[Bk]:"fire-perf-compat",[jk]:"fire-rc",[Gk]:"fire-rc-compat",[qk]:"fire-gcs",[Hk]:"fire-gcs-compat",[zk]:"fire-fst",[Yk]:"fire-fst-compat",[$k]:"fire-vertex","fire-js":"fire-js",[Kk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po=new Map,vc=new Map,Ec=new Map;function Hd(n,e){try{n.container.addComponent(e)}catch(t){Tr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function LS(n,e){n.container.addOrOverwriteComponent(e)}function qs(n){const e=n.name;if(Ec.has(e))return Tr.debug(`There were multiple attempts to register component ${e}.`),!1;Ec.set(e,n);for(const t of Po.values())Hd(t,n);for(const t of vc.values())Hd(t,n);return!0}function xp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Wk(n,e,t=Ro){xp(n,e).clearInstance(t)}function t0(n){return n.options!==void 0}function US(n){return t0(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function Ut(n){return n==null?!1:n.settings!==void 0}function Xk(){Ec.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bs=new wr("app","Firebase",Zk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OS=class{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Xn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bs.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ub(n,e){const t=Yv(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const i=JSON.parse(t).exp*1e3,a=new Date().getTime();i-a<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class eV extends OS{constructor(e,t,s,i){const a=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,l={name:s,automaticDataCollectionEnabled:a};if(e.apiKey!==void 0)super(e,l,i);else{const u=e;super(u.options,l,i)}this._serverConfig={automaticDataCollectionEnabled:a,...t},this._serverConfig.authIdToken&&Ub(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&Ub(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Qn(Hm,$_,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){s0(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw bs.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jo=Jk;function n0(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:Ro,automaticDataCollectionEnabled:!0,...e},i=s.name;if(typeof i!="string"||!i)throw bs.create("bad-app-name",{appName:String(i)});if(t||(t=Qv()),!t)throw bs.create("no-options");const a=Po.get(i);if(a){if(Co(t,a.options)&&Co(s,a.config))return a;throw bs.create("duplicate-app",{appName:i})}const l=new PS(i);for(const f of Ec.values())l.addComponent(f);const u=new OS(t,s,l);return Po.set(i,u),u}function tV(n,e={}){if(z2()&&!AS())throw bs.create("invalid-server-app-environment");let t,s=e||{};if(n&&(t0(n)?t=n.options:US(n)?s=n:t=n),s.automaticDataCollectionEnabled===void 0&&(s.automaticDataCollectionEnabled=!0),t||(t=Qv()),!t)throw bs.create("no-options");const i={...s,...t};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const a=_=>[..._].reduce((T,x)=>Math.imul(31,T)+x.charCodeAt(0)|0,0);if(s.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw bs.create("finalization-registry-not-supported",{});const l=""+a(JSON.stringify(i)),u=vc.get(l);if(u)return u.incRefCount(s.releaseOnDeref),u;const f=new PS(l);for(const _ of Ec.values())f.addComponent(_);const m=new eV(t,s,l,f);return vc.set(l,m),m}function nV(n=Ro){const e=Po.get(n);if(!e&&n===Ro&&Qv())return n0();if(!e)throw bs.create("no-app",{appName:n});return e}function sV(){return Array.from(Po.values())}async function s0(n){let e=!1;const t=n.name;Po.has(t)?(e=!0,Po.delete(t)):vc.has(t)&&n.decRefCount()<=0&&(vc.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(s=>s.delete())),n.isDeleted=!0)}function Qn(n,e,t){let s=Qk[n]??n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Tr.warn(l.join(" "));return}qs(new Xn(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function FS(n,e){if(n!==null&&typeof n!="function")throw bs.create("invalid-log-argument");uk(n,e)}function BS(n){ck(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iV="firebase-heartbeat-database",rV=1,zd="firebase-heartbeat-store";let A_=null;function jS(){return A_||(A_=VS(iV,rV,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(zd)}catch(t){console.warn(t)}}}}).catch(n=>{throw bs.create("idb-open",{originalErrorMessage:n.message})})),A_}async function oV(n){try{const t=(await jS()).transaction(zd),s=await t.objectStore(zd).get(GS(n));return await t.done,s}catch(e){if(e instanceof Vn)Tr.warn(e.message);else{const t=bs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Tr.warn(t.message)}}}async function Ob(n,e){try{const s=(await jS()).transaction(zd,"readwrite");await s.objectStore(zd).put(e,GS(n)),await s.done}catch(t){if(t instanceof Vn)Tr.warn(t.message);else{const s=bs.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Tr.warn(s.message)}}}function GS(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aV=1024,lV=30;class cV{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new dV(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Fb();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>lV){const l=hV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Tr.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Fb(),{heartbeatsToSend:s,unsentEntries:i}=uV(this._heartbeatsCache.heartbeats),a=Gm(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return Tr.warn(t),""}}}function Fb(){return new Date().toISOString().substring(0,10)}function uV(n,e=aV){const t=[];let s=n.slice();for(const i of n){const a=t.find(l=>l.agent===i.agent);if(a){if(a.dates.push(i.date),Bb(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Bb(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class dV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ja()?Xv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await oV(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Ob(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Ob(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Bb(n){return Gm(JSON.stringify({version:2,heartbeats:n})).length}function hV(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fV(n){qs(new Xn("platform-logger",e=>new Tk(e),"PRIVATE")),qs(new Xn("heartbeat",e=>new cV(e),"PRIVATE")),Qn(Hm,$_,n),Qn(Hm,$_,"esm2020"),Qn("fire-js","")}fV("");const mV=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Vn,SDK_VERSION:jo,_DEFAULT_ENTRY_NAME:Ro,_addComponent:Hd,_addOrOverwriteComponent:LS,_apps:Po,_clearComponents:Xk,_components:Ec,_getProvider:xp,_isFirebaseApp:t0,_isFirebaseServerApp:Ut,_isFirebaseServerAppSettings:US,_registerComponent:qs,_removeServiceInstance:Wk,_serverApps:vc,deleteApp:s0,getApp:nV,getApps:sV,initializeApp:n0,initializeServerApp:tV,onLog:FS,registerVersion:Qn,setLogLevel:BS},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(e,t){this._delegate=e,this.firebase=t,Hd(e,new Xn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),s0(this._delegate)))}_getService(e,t=Ro){var i;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&((i=s.getComponent())==null?void 0:i.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:t})}_removeServiceInstance(e,t=Ro){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Hd(this._delegate,e)}_addOrOverwriteComponent(e){LS(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gV={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},jb=new wr("app-compat","Firebase",gV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yV(n){const e={},t={__esModule:!0,initializeApp:a,app:i,registerVersion:Qn,setLogLevel:BS,onLog:FS,apps:null,SDK_VERSION:jo,INTERNAL:{registerComponent:u,removeApp:s,useAsService:f,modularAPIs:mV}};t.default=t,Object.defineProperty(t,"apps",{get:l});function s(m){delete e[m]}function i(m){if(m=m||Ro,!Pb(e,m))throw jb.create("no-app",{appName:m});return e[m]}i.App=n;function a(m,_={}){const T=n0(m,_);if(Pb(e,T.name))return e[T.name];const x=new n(T,t);return e[T.name]=x,x}function l(){return Object.keys(e).map(m=>e[m])}function u(m){const _=m.name,T=_.replace("-compat","");if(qs(m)&&m.type==="PUBLIC"){const x=(b=i())=>{if(typeof b[T]!="function")throw jb.create("invalid-app-argument",{appName:_});return b[T]()};m.serviceProps!==void 0&&qm(x,m.serviceProps),t[T]=x,n.prototype[T]=function(...b){return this._getService.bind(this,_).apply(this,m.multipleInstances?b:[])}}return m.type==="PUBLIC"?t[T]:null}function f(m,_){return _==="serverAuth"?null:_}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS(){const n=yV(pV);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:qS,extendNamespace:e,createSubscribe:RS,ErrorFactory:wr,deepExtend:qm};function e(t){qm(n,t)}return n}const _V=qS();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gb=new mh("@firebase/app-compat"),vV="@firebase/app-compat",EV="0.5.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TV(n){Qn(vV,EV,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=Kv();if(n.firebase!==void 0){Gb.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&Gb.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const je=_V;TV();var xV="firebase",IV="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */je.registerVersion(xV,IV,"app-compat");const od={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Ql={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bV(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function HS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const AV=bV,wV=HS,zS=new wr("auth","Firebase",HS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zm=new mh("@firebase/auth");function NV(n,...e){zm.logLevel<=et.WARN&&zm.warn(`Auth (${jo}): ${n}`,...e)}function Im(n,...e){zm.logLevel<=et.ERROR&&zm.error(`Auth (${jo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Un(n,...e){throw r0(n,...e)}function gn(n,...e){return r0(n,...e)}function i0(n,e,t){const s={...wV(),[e]:t};return new wr("auth","Firebase",s).create(e,{appName:n.name})}function bn(n){return i0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hc(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Un(n,"argument-error"),i0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function r0(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return zS.create(n,...e)}function pe(n,e,...t){if(!n)throw r0(e,...t)}function Bi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Im(e),new Error(e)}function ci(n,e){n||Bi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $d(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function o0(){return qb()==="http:"||qb()==="https:"}function qb(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(o0()||Tp()||"connection"in navigator)?navigator.onLine:!0}function CV(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,t){this.shortDelay=e,this.longDelay=t,ci(t>e,"Short delay should be less than long delay!"),this.isMobile=H2()||Wv()}get(){return SV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a0(n,e){ci(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],DV=new ph(3e4,6e4);function zt(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function $t(n,e,t,s,i={}){return YS(n,i,async()=>{let a={},l={};s&&(e==="GET"?l=s:a={body:JSON.stringify(s)});const u=qc({key:n.config.apiKey,...l}).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const m={method:e,headers:f,...a};return $2()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&Gc(n.emulatorConfig.host)&&(m.credentials="include"),$S.fetch()(await KS(n,n.config.apiHost,t,u),m)})}async function YS(n,e,t){n._canInitEmulator=!1;const s={...RV,...e};try{const i=new kV(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw yd(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const u=a.ok?l.errorMessage:l.error.message,[f,m]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw yd(n,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw yd(n,"email-already-in-use",l);if(f==="USER_DISABLED")throw yd(n,"user-disabled",l);const _=s[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw i0(n,_,m);Un(n,_)}}catch(i){if(i instanceof Vn)throw i;Un(n,"network-request-failed",{message:String(i)})}}async function Nr(n,e,t,s,i={}){const a=await $t(n,e,t,s,i);return"mfaPendingCredential"in a&&Un(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function KS(n,e,t,s){const i=`${e}${t}?${s}`,a=n,l=a.config.emulator?a0(n.config,i):`${n.config.apiScheme}://${i}`;return PV.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function MV(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class kV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(gn(this.auth,"network-request-failed")),DV.get())})}}function yd(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const i=gn(n,e,s);return i.customData._tokenResponse=t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hb(n){return n!==void 0&&n.getResponse!==void 0}function zb(n){return n!==void 0&&n.enterprise!==void 0}class JS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return MV(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VV(n){return(await $t(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function QS(n,e){return $t(n,"GET","/v2/recaptchaConfig",zt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LV(n,e){return $t(n,"POST","/v1/accounts:delete",e)}async function UV(n,e){return $t(n,"POST","/v1/accounts:update",e)}async function $m(n,e){return $t(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function OV(n,e=!1){const t=Le(n),s=await t.getIdToken(e),i=Ip(s);pe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:i,token:s,authTime:wd(w_(i.auth_time)),issuedAtTime:wd(w_(i.iat)),expirationTime:wd(w_(i.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function w_(n){return Number(n)*1e3}function Ip(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Im("JWT malformed, contained fewer than 3 sections"),null;try{const i=Yv(t);return i?JSON.parse(i):(Im("Failed to decode base64 JWT payload"),null)}catch(i){return Im("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function $b(n){const e=Ip(n);return pe(e,"internal-error"),pe(typeof e.exp<"u","internal-error"),pe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xr(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof Vn&&FV(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function FV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=wd(this.lastLoginAt),this.creationTime=wd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yd(n){var T;const e=n.auth,t=await n.getIdToken(),s=await xr(n,$m(e,{idToken:t}));pe(s==null?void 0:s.users.length,e,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const a=(T=i.providerUserInfo)!=null&&T.length?WS(i.providerUserInfo):[],l=GV(n.providerData,a),u=n.isAnonymous,f=!(n.email&&i.passwordHash)&&!(l!=null&&l.length),m=u?f:!1,_={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Y_(i.createdAt,i.lastLoginAt),isAnonymous:m};Object.assign(n,_)}async function jV(n){const e=Le(n);await Yd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function GV(n,e){return[...n.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function WS(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qV(n,e){const t=await YS(n,{},async()=>{const s=qc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,l=await KS(n,i,"/v1/token",`key=${a}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:s};return n.emulatorConfig&&Gc(n.emulatorConfig.host)&&(f.credentials="include"),$S.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function HV(n,e){return $t(n,"POST","/v2/accounts:revokeToken",zt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pe(e.idToken,"internal-error"),pe(typeof e.idToken<"u","internal-error"),pe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$b(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){pe(e.length!==0,"internal-error");const t=$b(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(pe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:i,expiresIn:a}=await qV(e,t);this.updateTokensAndExpiration(s,i,Number(a))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:i,expirationTime:a}=t,l=new uc;return s&&(pe(typeof s=="string","internal-error",{appName:e}),l.refreshToken=s),i&&(pe(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),a&&(pe(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new uc,this.toJSON())}_performRefresh(){return Bi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(n,e){pe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ri{constructor({uid:e,auth:t,stsTokenManager:s,...i}){this.providerId="firebase",this.proactiveRefresh=new BV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Y_(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await xr(this,this.stsTokenManager.getToken(this.auth,e));return pe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return OV(this,e)}reload(){return jV(this)}_assign(e){this!==e&&(pe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ri({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){pe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Yd(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ut(this.auth.app))return Promise.reject(bn(this.auth));const e=await this.getIdToken();return await xr(this,LV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,u=t.tenantId??void 0,f=t._redirectEventId??void 0,m=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:T,emailVerified:x,isAnonymous:b,providerData:k,stsTokenManager:G}=t;pe(T&&G,e,"internal-error");const F=uc.fromJSON(this.name,G);pe(typeof T=="string",e,"internal-error"),mo(s,e.name),mo(i,e.name),pe(typeof x=="boolean",e,"internal-error"),pe(typeof b=="boolean",e,"internal-error"),mo(a,e.name),mo(l,e.name),mo(u,e.name),mo(f,e.name),mo(m,e.name),mo(_,e.name);const Y=new ri({uid:T,auth:e,email:i,emailVerified:x,displayName:s,isAnonymous:b,photoURL:l,phoneNumber:a,tenantId:u,stsTokenManager:F,createdAt:m,lastLoginAt:_});return k&&Array.isArray(k)&&(Y.providerData=k.map(K=>({...K}))),f&&(Y._redirectEventId=f),Y}static async _fromIdTokenResponse(e,t,s=!1){const i=new uc;i.updateFromServerResponse(t);const a=new ri({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await Yd(a),a}static async _fromGetAccountInfoResponse(e,t,s){const i=t.users[0];pe(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?WS(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!(a!=null&&a.length),u=new uc;u.updateFromIdToken(s);const f=new ri({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:l}),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Y_(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(a!=null&&a.length)};return Object.assign(f,m),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb=new Map;function Is(n){ci(n instanceof Function,"Expected a class definition");let e=Yb.get(n);return e?(ci(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Yb.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}XS.type="NONE";const Tc=XS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oa(n,e,t){return`firebase:${n}:${e}:${t}`}class dc{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:i,name:a}=this.auth;this.fullUserKey=Oa(this.userKey,i.apiKey,a),this.fullPersistenceKey=Oa("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await $m(this.auth,{idToken:e}).catch(()=>{});return t?ri._fromGetAccountInfoResponse(this.auth,t,e):null}return ri._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new dc(Is(Tc),e,s);const i=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let a=i[0]||Is(Tc);const l=Oa(s,e.config.apiKey,e.name);let u=null;for(const m of t)try{const _=await m._get(l);if(_){let T;if(typeof _=="string"){const x=await $m(e,{idToken:_}).catch(()=>{});if(!x)break;T=await ri._fromGetAccountInfoResponse(e,x,_)}else T=ri._fromJSON(e,_);m!==a&&(u=T),a=m;break}}catch{}const f=i.filter(m=>m._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new dc(a,e,s):(a=f[0],u&&await a._set(l,u.toJSON()),await Promise.all(t.map(async m=>{if(m!==a)try{await m._remove(l)}catch{}})),new dc(a,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kb(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ZS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sC(e))return"Blackberry";if(iC(e))return"Webos";if(eC(e))return"Safari";if((e.includes("chrome/")||tC(e))&&!e.includes("edge/"))return"Chrome";if(gh(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function ZS(n=Bt()){return/firefox\//i.test(n)}function eC(n=Bt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tC(n=Bt()){return/crios\//i.test(n)}function nC(n=Bt()){return/iemobile/i.test(n)}function gh(n=Bt()){return/android/i.test(n)}function sC(n=Bt()){return/blackberry/i.test(n)}function iC(n=Bt()){return/webos/i.test(n)}function yh(n=Bt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function zV(n=Bt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function $V(n=Bt()){var e;return yh(n)&&!!((e=window.navigator)!=null&&e.standalone)}function YV(){return wS()&&document.documentMode===10}function rC(n=Bt()){return yh(n)||gh(n)||iC(n)||sC(n)||/windows phone/i.test(n)||nC(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(n,e=[]){let t;switch(n){case"Browser":t=Kb(Bt());break;case"Worker":t=`${Kb(Bt())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${jo}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=a=>new Promise((l,u)=>{try{const f=e(a);l(f)}catch(f){u(f)}});s.onAbort=t,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JV(n,e={}){return $t(n,"GET","/v2/passwordPolicy",zt(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QV=6;class WV{constructor(e){var s;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??QV,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((s=e.allowedNonAlphanumericCharacters)==null?void 0:s.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(e,t,s,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jb(this),this.idTokenSubscription=new Jb(this),this.beforeStateQueue=new KV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=zS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Is(t)),this._initializationPromise=this.queue(async()=>{var s,i,a;if(!this._deleted&&(this.persistenceManager=await dc.create(this,e),(s=this._resolvePersistenceManagerAvailable)==null||s.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await $m(this,{idToken:e}),s=await ri._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(Ut(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(a=this.redirectUser)==null?void 0:a._redirectEventId,u=s==null?void 0:s._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===u)&&(f!=null&&f.user)&&(s=f.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(l){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return pe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Yd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=CV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ut(this.app))return Promise.reject(bn(this));const t=e?Le(e):null;return t&&pe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&pe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ut(this.app)?Promise.reject(bn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ut(this.app)?Promise.reject(bn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Is(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await JV(this),t=new WV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new wr("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await HV(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Is(e)||this._popupRedirectResolver;pe(t,this,"argument-error"),this.redirectPersistenceManager=await dc.create(this,[Is(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)==null?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(pe(u,this,"internal-error"),u.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,s,i);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=oC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){var t;if(Ut(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&NV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function jt(n){return Le(n)}class Jb{constructor(e){this.auth=e,this.observer=null,this.addObserver=RS(t=>this.observer=t)}get next(){return pe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _h={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ZV(n){_h=n}function l0(n){return _h.loadJS(n)}function eL(){return _h.recaptchaV2Script}function tL(){return _h.recaptchaEnterpriseScript}function nL(){return _h.gapiScript}function aC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL=500,iL=6e4,pm=1e12;class rL{constructor(e){this.auth=e,this.counter=pm,this._widgets=new Map}render(e,t){const s=this.counter;return this._widgets.set(s,new lL(e,this.auth.name,t||{})),this.counter++,s}reset(e){var s;const t=e||pm;(s=this._widgets.get(t))==null||s.delete(),this._widgets.delete(t)}getResponse(e){var s;const t=e||pm;return((s=this._widgets.get(t))==null?void 0:s.getResponse())||""}async execute(e){var s;const t=e||pm;return(s=this._widgets.get(t))==null||s.execute(),""}}class oL{constructor(){this.enterprise=new aL}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class aL{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class lL{constructor(e,t,s){this.params=s,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;pe(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=cL(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},iL)},sL))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function cL(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let s=0;s<n;s++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const uL="recaptcha-enterprise",Nd="NO_RECAPTCHA";class lC{constructor(e){this.type=uL,this.auth=jt(e)}async verify(e="verify",t=!1){async function s(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,u)=>{QS(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const m=new JS(f);return a.tenantId==null?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,l(m.siteKey)}}).catch(f=>{u(f)})})}function i(a,l,u){const f=window.grecaptcha;zb(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(m=>{l(m)}).catch(()=>{l(Nd)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new oL().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{s(this.auth).then(u=>{if(!t&&zb(window.grecaptcha))i(u,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=tL();f.length!==0&&(f+=u),l0(f).then(()=>{i(u,a,l)}).catch(m=>{l(m)})}}).catch(u=>{l(u)})})}}async function ad(n,e,t,s=!1,i=!1){const a=new lC(n);let l;if(i)l=Nd;else try{l=await a.verify(t)}catch{l=await a.verify(t,!0)}const u={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const f=u.phoneEnrollmentInfo.phoneNumber,m=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:m,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const f=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return s?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function Ao(n,e,t,s,i){var a,l;if(i==="EMAIL_PASSWORD_PROVIDER")if((a=n._getRecaptchaConfig())!=null&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await ad(n,e,t,t==="getOobCode");return s(n,u)}else return s(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await ad(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(u)});else if(i==="PHONE_PROVIDER")if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("PHONE_PROVIDER")){const u=await ad(n,e,t);return s(n,u).catch(async f=>{var m;if(((m=n._getRecaptchaConfig())==null?void 0:m.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(f.code==="auth/missing-recaptcha-token"||f.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const _=await ad(n,e,t,!1,!0);return s(n,_)}return Promise.reject(f)})}else{const u=await ad(n,e,t,!1,!0);return s(n,u)}else return Promise.reject(i+" provider is not supported.")}async function dL(n){const e=jt(n),t=await QS(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),s=new JS(t);e.tenantId==null?e._agentRecaptchaConfig=s:e._tenantRecaptchaConfigs[e.tenantId]=s,s.isAnyProviderEnabled()&&new lC(e).verify()}function hL(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(Is);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function fL(n,e,t){const s=jt(n);pe(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),a=cC(e),{host:l,port:u}=mL(e),f=u===null?"":`:${u}`,m={url:`${a}//${l}${f}/`},_=Object.freeze({host:l,port:u,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){pe(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),pe(Co(m,s.config.emulator)&&Co(_,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=m,s.emulatorConfig=_,s.settings.appVerificationDisabledForTesting=!0,Gc(l)?(IS(`${a}//${l}${f}`),bS("Auth",!0)):i||pL()}function cC(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function mL(n){const e=cC(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const a=i[1];return{host:a,port:Qb(s.substr(a.length+1))}}else{const[a,l]=s.split(":");return{host:a,port:Qb(l)}}}function Qb(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function pL(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Bi("not implemented")}_getIdTokenResponse(e){return Bi("not implemented")}_linkToIdToken(e,t){return Bi("not implemented")}_getReauthenticationResolver(e){return Bi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uC(n,e){return $t(n,"POST","/v1/accounts:resetPassword",zt(n,e))}async function gL(n,e){return $t(n,"POST","/v1/accounts:update",e)}async function yL(n,e){return $t(n,"POST","/v1/accounts:signUp",e)}async function _L(n,e){return $t(n,"POST","/v1/accounts:update",zt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vL(n,e){return Nr(n,"POST","/v1/accounts:signInWithPassword",zt(n,e))}async function bp(n,e){return $t(n,"POST","/v1/accounts:sendOobCode",zt(n,e))}async function EL(n,e){return bp(n,e)}async function TL(n,e){return bp(n,e)}async function xL(n,e){return bp(n,e)}async function IL(n,e){return bp(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bL(n,e){return Nr(n,"POST","/v1/accounts:signInWithEmailLink",zt(n,e))}async function AL(n,e){return Nr(n,"POST","/v1/accounts:signInWithEmailLink",zt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd extends zc{constructor(e,t,s,i=null){super("password",s),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Kd(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new Kd(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ao(e,t,"signInWithPassword",vL,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return bL(e,{email:this._email,oobCode:this._password});default:Un(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ao(e,s,"signUpPassword",yL,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return AL(e,{idToken:t,email:this._email,oobCode:this._password});default:Un(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _r(n,e){return Nr(n,"POST","/v1/accounts:signInWithIdp",zt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wL="http://localhost";class $i extends zc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new $i(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Un("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i,...a}=t;if(!s||!i)return null;const l=new $i(s,i);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return _r(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,_r(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,_r(e,t)}buildRequest(){const e={requestUri:wL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=qc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wb(n,e){return $t(n,"POST","/v1/accounts:sendVerificationCode",zt(n,e))}async function NL(n,e){return Nr(n,"POST","/v1/accounts:signInWithPhoneNumber",zt(n,e))}async function SL(n,e){const t=await Nr(n,"POST","/v1/accounts:signInWithPhoneNumber",zt(n,e));if(t.temporaryProof)throw yd(n,"account-exists-with-different-credential",t);return t}const CL={USER_NOT_FOUND:"user-not-found"};async function RL(n,e){const t={...e,operation:"REAUTH"};return Nr(n,"POST","/v1/accounts:signInWithPhoneNumber",zt(n,t),CL)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa extends zc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Fa({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Fa({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return NL(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return SL(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return RL(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:s,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:s,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:s,phoneNumber:i,temporaryProof:a}=e;return!s&&!t&&!i&&!a?null:new Fa({verificationId:t,verificationCode:s,phoneNumber:i,temporaryProof:a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function DL(n){const e=lc(gd(n)).link,t=e?lc(gd(e)).deep_link_id:null,s=lc(gd(n)).deep_link_id;return(s?lc(gd(s)).link:null)||s||t||e||n}class Ap{constructor(e){const t=lc(gd(e)),s=t.apiKey??null,i=t.oobCode??null,a=PL(t.mode??null);pe(s&&i&&a,"argument-error"),this.apiKey=s,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=DL(e);try{return new Ap(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(){this.providerId=Go.PROVIDER_ID}static credential(e,t){return Kd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=Ap.parseLink(t);return pe(s,"argument-error"),Kd._fromEmailAndCode(e,s.code,s.tenantId)}}Go.PROVIDER_ID="password";Go.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Go.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c extends Sr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class hc extends $c{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return pe("providerId"in t&&"signInMethod"in t,"argument-error"),$i._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return pe(e.idToken||e.accessToken,"argument-error"),$i._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return hc.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return hc.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:i,pendingToken:a,nonce:l,providerId:u}=e;if(!s&&!i&&!t&&!a||!u)return null;try{return new hc(u)._credential({idToken:t,accessToken:s,nonce:l,pendingToken:a})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li extends $c{constructor(){super("facebook.com")}static credential(e){return $i._fromParams({providerId:Li.PROVIDER_ID,signInMethod:Li.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Li.credentialFromTaggedObject(e)}static credentialFromError(e){return Li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Li.credential(e.oauthAccessToken)}catch{return null}}}Li.FACEBOOK_SIGN_IN_METHOD="facebook.com";Li.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui extends $c{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return $i._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Ui.credential(t,s)}catch{return null}}}Ui.GOOGLE_SIGN_IN_METHOD="google.com";Ui.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi extends $c{constructor(){super("github.com")}static credential(e){return $i._fromParams({providerId:Oi.PROVIDER_ID,signInMethod:Oi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oi.credentialFromTaggedObject(e)}static credentialFromError(e){return Oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Oi.credential(e.oauthAccessToken)}catch{return null}}}Oi.GITHUB_SIGN_IN_METHOD="github.com";Oi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML="http://localhost";class xc extends zc{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return _r(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,_r(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,_r(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i,pendingToken:a}=t;return!s||!i||!a||s!==i?null:new xc(s,a)}static _create(e,t){return new xc(e,t)}buildRequest(){return{requestUri:ML,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kL="saml.";class Ym extends Sr{constructor(e){pe(e.startsWith(kL),"argument-error"),super(e)}static credentialFromResult(e){return Ym.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Ym.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=xc.fromJSON(e);return pe(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:s}=e;if(!t||!s)return null;try{return xc._create(s,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends $c{constructor(){super("twitter.com")}static credential(e,t){return $i._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Fi.credential(t,s)}catch{return null}}}Fi.TWITTER_SIGN_IN_METHOD="twitter.com";Fi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dC(n,e){return Nr(n,"POST","/v1/accounts:signUp",zt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,i=!1){const a=await ri._fromIdTokenResponse(e,s,i),l=Xb(s);return new Hs({user:a,providerId:l,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const i=Xb(s);return new Hs({user:e,providerId:i,_tokenResponse:s,operationType:t})}}function Xb(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VL(n){var i;if(Ut(n.app))return Promise.reject(bn(n));const e=jt(n);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new Hs({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await dC(e,{returnSecureToken:!0}),s=await Hs._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km extends Vn{constructor(e,t,s,i){super(t.code,t.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,Km.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,i){return new Km(e,t,s,i)}}function hC(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Km._fromErrorAndOperation(n,a,e,s):a})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fC(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LL(n,e){const t=Le(n);await wp(!0,t,e);const{providerUserInfo:s}=await UV(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=fC(s||[]);return t.providerData=t.providerData.filter(a=>i.has(a.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function c0(n,e,t=!1){const s=await xr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Hs._forOperation(n,"link",s)}async function wp(n,e,t){await Yd(e);const s=fC(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";pe(s.has(t)===n,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mC(n,e,t=!1){const{auth:s}=n;if(Ut(s.app))return Promise.reject(bn(s));const i="reauthenticate";try{const a=await xr(n,hC(s,i,e,n),t);pe(a.idToken,s,"internal-error");const l=Ip(a.idToken);pe(l,s,"internal-error");const{sub:u}=l;return pe(n.uid===u,s,"user-mismatch"),Hs._forOperation(n,i,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Un(s,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pC(n,e,t=!1){if(Ut(n.app))return Promise.reject(bn(n));const s="signIn",i=await hC(n,s,e),a=await Hs._fromIdTokenResponse(n,s,i);return t||await n._updateCurrentUser(a.user),a}async function Np(n,e){return pC(jt(n),e)}async function gC(n,e){const t=Le(n);return await wp(!1,t,e.providerId),c0(t,e)}async function yC(n,e){return mC(Le(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UL(n,e){return Nr(n,"POST","/v1/accounts:signInWithCustomToken",zt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OL(n,e){if(Ut(n.app))return Promise.reject(bn(n));const t=jt(n),s=await UL(t,{token:e,returnSecureToken:!0}),i=await Hs._fromIdTokenResponse(t,"signIn",s);return await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?u0._fromServerResponse(e,t):"totpInfo"in t?d0._fromServerResponse(e,t):Un(e,"internal-error")}}class u0 extends vh{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new u0(t)}}class d0 extends vh{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new d0(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sp(n,e,t){var s;pe(((s=t.url)==null?void 0:s.length)>0,n,"invalid-continue-uri"),pe(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),pe(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(pe(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(pe(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h0(n){const e=jt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function FL(n,e,t){const s=jt(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Sp(s,i,t),await Ao(s,i,"getOobCode",TL,"EMAIL_PASSWORD_PROVIDER")}async function BL(n,e,t){await uC(Le(n),{oobCode:e,newPassword:t}).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&h0(n),s})}async function jL(n,e){await _L(Le(n),{oobCode:e})}async function _C(n,e){const t=Le(n),s=await uC(t,{oobCode:e}),i=s.requestType;switch(pe(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":pe(s.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":pe(s.mfaInfo,t,"internal-error");default:pe(s.email,t,"internal-error")}let a=null;return s.mfaInfo&&(a=vh._fromServerResponse(jt(t),s.mfaInfo)),{data:{email:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.newEmail:s.email)||null,previousEmail:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.email:s.newEmail)||null,multiFactorInfo:a},operation:i}}async function GL(n,e){const{data:t}=await _C(Le(n),e);return t.email}async function qL(n,e,t){if(Ut(n.app))return Promise.reject(bn(n));const s=jt(n),l=await Ao(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",dC,"EMAIL_PASSWORD_PROVIDER").catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&h0(n),f}),u=await Hs._fromIdTokenResponse(s,"signIn",l);return await s._updateCurrentUser(u.user),u}function HL(n,e,t){return Ut(n.app)?Promise.reject(bn(n)):Np(Le(n),Go.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&h0(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zL(n,e,t){const s=jt(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function a(l,u){pe(u.handleCodeInApp,s,"argument-error"),u&&Sp(s,l,u)}a(i,t),await Ao(s,i,"getOobCode",xL,"EMAIL_PASSWORD_PROVIDER")}function $L(n,e){const t=Ap.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function YL(n,e,t){if(Ut(n.app))return Promise.reject(bn(n));const s=Le(n),i=Go.credentialWithLink(e,t||$d());return pe(i._tenantId===(s.tenantId||null),s,"tenant-id-mismatch"),Np(s,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KL(n,e){return $t(n,"POST","/v1/accounts:createAuthUri",zt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JL(n,e){const t=o0()?$d():"http://localhost",s={identifier:e,continueUri:t},{signinMethods:i}=await KL(Le(n),s);return i||[]}async function QL(n,e){const t=Le(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Sp(t.auth,i,e);const{email:a}=await EL(t.auth,i);a!==n.email&&await n.reload()}async function WL(n,e,t){const s=Le(n),a={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Sp(s.auth,a,t);const{email:l}=await IL(s.auth,a);l!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XL(n,e){return $t(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZL(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=Le(n),a={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await xr(s,XL(s.auth,a));s.displayName=l.displayName||null,s.photoURL=l.photoUrl||null;const u=s.providerData.find(({providerId:f})=>f==="password");u&&(u.displayName=s.displayName,u.photoURL=s.photoURL),await s._updateTokensIfNecessary(l)}function e4(n,e){const t=Le(n);return Ut(t.auth.app)?Promise.reject(bn(t.auth)):vC(t,e,null)}function t4(n,e){return vC(Le(n),null,e)}async function vC(n,e,t){const{auth:s}=n,a={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(a.email=e),t&&(a.password=t);const l=await xr(n,gL(s,a));await n._updateTokensIfNecessary(l,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(n){var i,a;if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(n!=null&&n.idToken)){const l=(a=(i=Ip(n.idToken))==null?void 0:i.firebase)==null?void 0:a.sign_in_provider;if(l){const u=l!=="anonymous"&&l!=="custom"?l:null;return new fc(s,u)}}if(!e)return null;switch(e){case"facebook.com":return new s4(s,t);case"github.com":return new i4(s,t);case"google.com":return new r4(s,t);case"twitter.com":return new o4(s,t,n.screenName||null);case"custom":case"anonymous":return new fc(s,null);default:return new fc(s,e,t)}}class fc{constructor(e,t,s={}){this.isNewUser=e,this.providerId=t,this.profile=s}}class EC extends fc{constructor(e,t,s,i){super(e,t,s),this.username=i}}class s4 extends fc{constructor(e,t){super(e,"facebook.com",t)}}class i4 extends EC{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class r4 extends fc{constructor(e,t){super(e,"google.com",t)}}class o4 extends EC{constructor(e,t,s){super(e,"twitter.com",t,s)}}function a4(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:n4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,t,s){this.type=e,this.credential=t,this.user=s}static _fromIdtoken(e,t){return new Da("enroll",e,t)}static _fromMfaPendingCredential(e){return new Da("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,s;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return Da._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((s=e.multiFactorSession)!=null&&s.idToken)return Da._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e,t,s){this.session=e,this.hints=t,this.signInResolver=s}static _fromError(e,t){const s=jt(e),i=t.customData._serverResponse,a=(i.mfaInfo||[]).map(u=>vh._fromServerResponse(s,u));pe(i.mfaPendingCredential,s,"internal-error");const l=Da._fromMfaPendingCredential(i.mfaPendingCredential);return new f0(l,a,async u=>{const f=await u._process(s,l);delete i.mfaInfo,delete i.mfaPendingCredential;const m={...i,idToken:f.idToken,refreshToken:f.refreshToken};switch(t.operationType){case"signIn":const _=await Hs._fromIdTokenResponse(s,t.operationType,m);return await s._updateCurrentUser(_.user),_;case"reauthenticate":return pe(t.user,s,"internal-error"),Hs._forOperation(t.user,t.operationType,m);default:Un(s,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function l4(n,e){var i;const t=Le(n),s=e;return pe(e.customData.operationType,t,"argument-error"),pe((i=s.customData._serverResponse)==null?void 0:i.mfaPendingCredential,t,"argument-error"),f0._fromError(t,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(n,e){return $t(n,"POST","/v2/accounts/mfaEnrollment:start",zt(n,e))}function c4(n,e){return $t(n,"POST","/v2/accounts/mfaEnrollment:finalize",zt(n,e))}function u4(n,e){return $t(n,"POST","/v2/accounts/mfaEnrollment:withdraw",zt(n,e))}class m0{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(s=>vh._fromServerResponse(e.auth,s)))})}static _fromUser(e){return new m0(e)}async getSession(){return Da._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const s=e,i=await this.getSession(),a=await xr(this.user,s._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(a),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,s=await this.user.getIdToken();try{const i=await xr(this.user,u4(this.user.auth,{idToken:s,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:a})=>a!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const N_=new WeakMap;function d4(n){const e=Le(n);return N_.has(e)||N_.set(e,m0._fromUser(e)),N_.get(e)}const Jm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Jm,"1"),this.storage.removeItem(Jm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4=1e3,f4=10;class xC extends TC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),i=this.localCache[t];s!==i&&e(t,i,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,u,f)=>{this.notifyListeners(l,f)});return}const s=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(s);!t&&this.localCache[s]===l||this.notifyListeners(s,l)},a=this.storage.getItem(s);YV()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,f4):i()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},h4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xC.type="LOCAL";const p0=xC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC extends TC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}IC.type="SESSION";const Ga=IC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const s=new Cp(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:i,data:a}=t.data,l=this.handlersMap[i];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const u=Array.from(l).map(async m=>m(t.origin,a)),f=await m4(u);t.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Cp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eh(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,l;return new Promise((u,f)=>{const m=Eh("",20);i.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},s);l={messageChannel:i,onMessage(T){const x=T;if(x.data.eventId===m)switch(x.data.status){case"ack":clearTimeout(_),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),u(x.data.response);break;default:clearTimeout(_),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(){return window}function g4(n){fn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(){return typeof fn().WorkerGlobalScope<"u"&&typeof fn().importScripts=="function"}async function y4(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _4(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function v4(){return g0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC="firebaseLocalStorageDb",E4=1,Qm="firebaseLocalStorage",AC="fbase_key";class Th{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Rp(n,e){return n.transaction([Qm],e?"readwrite":"readonly").objectStore(Qm)}function T4(){const n=indexedDB.deleteDatabase(bC);return new Th(n).toPromise()}function K_(){const n=indexedDB.open(bC,E4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Qm,{keyPath:AC})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Qm)?e(s):(s.close(),await T4(),e(await K_()))})})}async function eA(n,e,t){const s=Rp(n,!0).put({[AC]:e,value:t});return new Th(s).toPromise()}async function x4(n,e){const t=Rp(n,!1).get(e),s=await new Th(t).toPromise();return s===void 0?null:s.value}function tA(n,e){const t=Rp(n,!0).delete(e);return new Th(t).toPromise()}const I4=800,b4=3;class wC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await K_(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>b4)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return g0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cp._getInstance(v4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,s;if(this.activeServiceWorker=await y4(),!this.activeServiceWorker)return;this.sender=new p4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(s=e[0])!=null&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await K_();return await eA(e,Jm,"1"),await tA(e,Jm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>eA(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>x4(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>tA(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Rp(i,!1).getAll();return new Th(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),I4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wC.type="LOCAL";const Jd=wC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(n,e){return $t(n,"POST","/v2/accounts/mfaSignIn:start",zt(n,e))}function A4(n,e){return $t(n,"POST","/v2/accounts/mfaSignIn:finalize",zt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S_=aC("rcb"),w4=new ph(3e4,6e4);class N4{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=fn().grecaptcha)!=null&&e.render)}load(e,t=""){return pe(S4(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Hb(fn().grecaptcha)?Promise.resolve(fn().grecaptcha):new Promise((s,i)=>{const a=fn().setTimeout(()=>{i(gn(e,"network-request-failed"))},w4.get());fn()[S_]=()=>{fn().clearTimeout(a),delete fn()[S_];const u=fn().grecaptcha;if(!u||!Hb(u)){i(gn(e,"internal-error"));return}const f=u.render;u.render=(m,_)=>{const T=f(m,_);return this.counter++,T},this.hostLanguage=t,s(u)};const l=`${eL()}?${qc({onload:S_,render:"explicit",hl:t})}`;l0(l).catch(()=>{clearTimeout(a),i(gn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=fn().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function S4(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class C4{async load(e){return new rL(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sd="recaptcha",R4={theme:"light",type:"image"};let P4=class{constructor(e,t,s={...R4}){this.parameters=s,this.type=Sd,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=jt(e),this.isInvisible=this.parameters.size==="invisible",pe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;pe(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new C4:new N4,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),s=t.getResponse(e);return s||new Promise(i=>{const a=l=>{l&&(this.tokenChangeListeners.delete(a),i(l))};this.tokenChangeListeners.add(a),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){pe(!this.parameters.sitekey,this.auth,"argument-error"),pe(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),pe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(s=>s(t)),typeof e=="function")e(t);else if(typeof e=="string"){const s=fn()[e];typeof s=="function"&&s(t)}}}assertNotDestroyed(){pe(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){pe(o0()&&!g0(),this.auth,"internal-error"),await D4(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await VV(this.auth);pe(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return pe(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function D4(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Fa._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function M4(n,e,t){if(Ut(n.app))return Promise.reject(bn(n));const s=jt(n),i=await Pp(s,e,Le(t));return new y0(i,a=>Np(s,a))}async function k4(n,e,t){const s=Le(n);await wp(!1,s,"phone");const i=await Pp(s.auth,e,Le(t));return new y0(i,a=>gC(s,a))}async function V4(n,e,t){const s=Le(n);if(Ut(s.auth.app))return Promise.reject(bn(s.auth));const i=await Pp(s.auth,e,Le(t));return new y0(i,a=>yC(s,a))}async function Pp(n,e,t){var s;if(!n._getRecaptchaConfig())try{await dL(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const a=i.session;if("phoneNumber"in i){pe(a.type==="enroll",n,"internal-error");const l={idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Ao(n,l,"mfaSmsEnrollment",async(_,T)=>{if(T.phoneEnrollmentInfo.captchaResponse===Nd){pe((t==null?void 0:t.type)===Sd,_,"argument-error");const x=await C_(_,T,t);return Zb(_,x)}return Zb(_,T)},"PHONE_PROVIDER").catch(_=>Promise.reject(_))).phoneSessionInfo.sessionInfo}else{pe(a.type==="signin",n,"internal-error");const l=((s=i.multiFactorHint)==null?void 0:s.uid)||i.multiFactorUid;pe(l,n,"missing-multi-factor-info");const u={mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Ao(n,u,"mfaSmsSignIn",async(T,x)=>{if(x.phoneSignInInfo.captchaResponse===Nd){pe((t==null?void 0:t.type)===Sd,T,"argument-error");const b=await C_(T,x,t);return nA(T,b)}return nA(T,x)},"PHONE_PROVIDER").catch(T=>Promise.reject(T))).phoneResponseInfo.sessionInfo}}else{const a={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Ao(n,a,"sendVerificationCode",async(m,_)=>{if(_.captchaResponse===Nd){pe((t==null?void 0:t.type)===Sd,m,"argument-error");const T=await C_(m,_,t);return Wb(m,T)}return Wb(m,_)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).sessionInfo}}finally{t==null||t._reset()}}async function L4(n,e){const t=Le(n);if(Ut(t.auth.app))return Promise.reject(bn(t.auth));await c0(t,e)}async function C_(n,e,t){pe(t.type===Sd,n,"argument-error");const s=await t.verify();pe(typeof s=="string",n,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const a=i.phoneEnrollmentInfo.phoneNumber,l=i.phoneEnrollmentInfo.captchaResponse,u=i.phoneEnrollmentInfo.clientType,f=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:s,captchaResponse:l,clientType:u,recaptchaVersion:f}}),i}else if("phoneSignInInfo"in i){const a=i.phoneSignInInfo.captchaResponse,l=i.phoneSignInInfo.clientType,u=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:s,captchaResponse:a,clientType:l,recaptchaVersion:u}}),i}else return Object.assign(i,{recaptchaToken:s}),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qa=class bm{constructor(e){this.providerId=bm.PROVIDER_ID,this.auth=jt(e)}verifyPhoneNumber(e,t){return Pp(this.auth,e,Le(t))}static credential(e,t){return Fa._fromVerification(e,t)}static credentialFromResult(e){const t=e;return bm.credentialFromTaggedObject(t)}static credentialFromError(e){return bm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:s}=e;return t&&s?Fa._fromTokenResponse(t,s):null}};qa.PROVIDER_ID="phone";qa.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(n,e){return e?Is(e):(pe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0 extends zc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return _r(e,this._buildIdpRequest())}_linkToIdToken(e,t){return _r(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return _r(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function U4(n){return pC(n.auth,new _0(n),n.bypassAuthState)}function O4(n){const{auth:e,user:t}=n;return pe(t,e,"internal-error"),mC(t,new _0(n),n.bypassAuthState)}async function F4(n){const{auth:e,user:t}=n;return pe(t,e,"internal-error"),c0(t,new _0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,t,s,i,a=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:i,tenantId:a,error:l,type:u}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:s,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return U4;case"linkViaPopup":case"linkViaRedirect":return F4;case"reauthViaPopup":case"reauthViaRedirect":return O4;default:Un(this.auth,"internal-error")}}resolve(e){ci(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ci(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4=new ph(2e3,1e4);async function j4(n,e,t){if(Ut(n.app))return Promise.reject(gn(n,"operation-not-supported-in-this-environment"));const s=jt(n);Hc(n,e,Sr);const i=sl(s,t);return new pr(s,"signInViaPopup",e,i).executeNotNull()}async function G4(n,e,t){const s=Le(n);if(Ut(s.auth.app))return Promise.reject(gn(s.auth,"operation-not-supported-in-this-environment"));Hc(s.auth,e,Sr);const i=sl(s.auth,t);return new pr(s.auth,"reauthViaPopup",e,i,s).executeNotNull()}async function q4(n,e,t){const s=Le(n);Hc(s.auth,e,Sr);const i=sl(s.auth,t);return new pr(s.auth,"linkViaPopup",e,i,s).executeNotNull()}class pr extends NC{constructor(e,t,s,i,a){super(e,t,i,a),this.provider=s,this.authWindow=null,this.pollId=null,pr.currentPopupAction&&pr.currentPopupAction.cancel(),pr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pe(e,this.auth,"internal-error"),e}async onExecution(){ci(this.filter.length===1,"Popup operations only handle one event");const e=Eh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(gn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(gn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,pr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if((s=(t=this.authWindow)==null?void 0:t.window)!=null&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(gn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,B4.get())};e()}}pr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H4="pendingRedirect",Cd=new Map;class z4 extends NC{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Cd.get(this.auth._key());if(!e){try{const s=await $4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Cd.set(this.auth._key(),e)}return this.bypassAuthState||Cd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function $4(n,e){const t=CC(e),s=SC(n);if(!await s._isAvailable())return!1;const i=await s._get(t)==="true";return await s._remove(t),i}async function v0(n,e){return SC(n)._set(CC(e),"true")}function Y4(){Cd.clear()}function E0(n,e){Cd.set(n._key(),e)}function SC(n){return Is(n._redirectPersistence)}function CC(n){return Oa(H4,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K4(n,e,t){return J4(n,e,t)}async function J4(n,e,t){if(Ut(n.app))return Promise.reject(bn(n));const s=jt(n);Hc(n,e,Sr),await s._initializationPromise;const i=sl(s,t);return await v0(i,s),i._openRedirect(s,e,"signInViaRedirect")}function Q4(n,e,t){return W4(n,e,t)}async function W4(n,e,t){const s=Le(n);if(Hc(s.auth,e,Sr),Ut(s.auth.app))return Promise.reject(bn(s.auth));await s.auth._initializationPromise;const i=sl(s.auth,t);await v0(i,s.auth);const a=await RC(s);return i._openRedirect(s.auth,e,"reauthViaRedirect",a)}function X4(n,e,t){return Z4(n,e,t)}async function Z4(n,e,t){const s=Le(n);Hc(s.auth,e,Sr),await s.auth._initializationPromise;const i=sl(s.auth,t);await wp(!1,s,e.providerId),await v0(i,s.auth);const a=await RC(s);return i._openRedirect(s.auth,e,"linkViaRedirect",a)}async function eU(n,e){return await jt(n)._initializationPromise,Dp(n,e,!1)}async function Dp(n,e,t=!1){if(Ut(n.app))return Promise.reject(bn(n));const s=jt(n),i=sl(s,e),l=await new z4(s,i,t).execute();return l&&!t&&(delete l.user._redirectEventId,await s._persistUserIfCurrent(l.user),await s._setRedirectUser(null,e)),l}async function RC(n){const e=Eh(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tU=600*1e3;class PC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nU(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!DC(e)){const i=((s=e.error.code)==null?void 0:s.split("auth/")[1])||"internal-error";t.onError(gn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tU&&this.cachedEventUids.clear(),this.cachedEventUids.has(sA(e))}saveEventToCache(e){this.cachedEventUids.add(sA(e)),this.lastProcessedEventTime=Date.now()}}function sA(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function DC({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function nU(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return DC(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MC(n,e={}){return $t(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sU=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,iU=/^https?/;async function rU(n){if(n.config.emulator)return;const{authorizedDomains:e}=await MC(n);for(const t of e)try{if(oU(t))return}catch{}Un(n,"unauthorized-domain")}function oU(n){const e=$d(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===s}if(!iU.test(t))return!1;if(sU.test(n))return s===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aU=new ph(3e4,6e4);function iA(){const n=fn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function lU(n){return new Promise((e,t)=>{var i,a,l;function s(){iA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iA(),t(gn(n,"network-request-failed"))},timeout:aU.get()})}if((a=(i=fn().gapi)==null?void 0:i.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((l=fn().gapi)!=null&&l.load)s();else{const u=aC("iframefcb");return fn()[u]=()=>{gapi.load?s():t(gn(n,"network-request-failed"))},l0(`${nL()}?onload=${u}`).catch(f=>t(f))}}).catch(e=>{throw Am=null,e})}let Am=null;function cU(n){return Am=Am||lU(n),Am}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uU=new ph(5e3,15e3),dU="__/auth/iframe",hU="emulator/auth/iframe",fU={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mU=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pU(n){const e=n.config;pe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?a0(e,hU):`https://${n.config.authDomain}/${dU}`,s={apiKey:e.apiKey,appName:n.name,v:jo},i=mU.get(n.config.apiHost);i&&(s.eid=i);const a=n._getFrameworks();return a.length&&(s.fw=a.join(",")),`${t}?${qc(s).slice(1)}`}async function gU(n){const e=await cU(n),t=fn().gapi;return pe(t,n,"internal-error"),e.open({where:document.body,url:pU(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fU,dontclear:!0},s=>new Promise(async(i,a)=>{await s.restyle({setHideOnLeave:!1});const l=gn(n,"network-request-failed"),u=fn().setTimeout(()=>{a(l)},uU.get());function f(){fn().clearTimeout(u),i(s)}s.ping(f).then(f,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yU={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},_U=500,vU=600,EU="_blank",TU="http://localhost";class rA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function xU(n,e,t,s=_U,i=vU){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-s)/2,0).toString();let u="";const f={...yU,width:s.toString(),height:i.toString(),top:a,left:l},m=Bt().toLowerCase();t&&(u=tC(m)?EU:t),ZS(m)&&(e=e||TU,f.scrollbars="yes");const _=Object.entries(f).reduce((x,[b,k])=>`${x}${b}=${k},`,"");if($V(m)&&u!=="_self")return IU(e||"",u),new rA(null);const T=window.open(e||"",u,_);pe(T,n,"popup-blocked");try{T.focus()}catch{}return new rA(T)}function IU(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bU="__/auth/handler",AU="emulator/auth/handler",wU=encodeURIComponent("fac");async function J_(n,e,t,s,i,a){pe(n.config.authDomain,n,"auth-domain-config-required"),pe(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:jo,eventId:i};if(e instanceof Sr){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",Q2(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,T]of Object.entries(a||{}))l[_]=T}if(e instanceof $c){const _=e.getScopes().filter(T=>T!=="");_.length>0&&(l.scopes=_.join(","))}n.tenantId&&(l.tid=n.tenantId);const u=l;for(const _ of Object.keys(u))u[_]===void 0&&delete u[_];const f=await n._getAppCheckToken(),m=f?`#${wU}=${encodeURIComponent(f)}`:"";return`${NU(n)}?${qc(u).slice(1)}${m}`}function NU({config:n}){return n.emulator?a0(n,AU):`https://${n.authDomain}/${bU}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R_="webStorageSupport";class SU{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ga,this._completeRedirectFn=Dp,this._overrideRedirectResult=E0}async _openPopup(e,t,s,i){var l;ci((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const a=await J_(e,t,s,$d(),i);return xU(e,a,Eh())}async _openRedirect(e,t,s,i){await this._originValidation(e);const a=await J_(e,t,s,$d(),i);return g4(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(ci(a,"If manager is not set, promise should be"),a)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await gU(e),s=new PC(e);return t.register("authEvent",i=>(pe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(R_,{type:R_},i=>{var l;const a=(l=i==null?void 0:i[0])==null?void 0:l[R_];a!==void 0&&t(!!a),Un(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=rU(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rC()||eC()||yh()}}const CU=SU;class RU{constructor(e){this.factorId=e}_process(e,t,s){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,s);case"signin":return this._finalizeSignIn(e,t.credential);default:return Bi("unexpected MultiFactorSessionType")}}}class T0 extends RU{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new T0(e)}_finalizeEnroll(e,t,s){return c4(e,{idToken:t,displayName:s,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return A4(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class kC{constructor(){}static assertion(e){return T0._fromCredential(e)}}kC.FACTOR_ID="phone";var oA="@firebase/auth",aA="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PU{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){pe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DU(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function MU(n){qs(new Xn("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=s.options;pe(l&&!l.includes(":"),"invalid-api-key",{appName:s.name});const f={apiKey:l,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:oC(n)},m=new XV(s,i,a,f);return hL(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),qs(new Xn("auth-internal",e=>{const t=jt(e.getProvider("auth").getImmediate());return(s=>new PU(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Qn(oA,aA,DU(n)),Qn(oA,aA,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kU=300;F2("authIdTokenMaxAge");function VU(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}ZV({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=i=>{const a=gn("internal-error");a.customData=i,t(a)},s.type="text/javascript",s.charset="UTF-8",VU().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});MU("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ha(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LU=2e3;async function UU(n,e,t){const{BuildInfo:s}=Ha();ci(e.sessionId,"AuthEvent did not contain a session ID");const i=await GU(e.sessionId),a={};return yh()?a.ibi=s.packageName:gh()?a.apn=s.packageName:Un(n,"operation-not-supported-in-this-environment"),s.displayName&&(a.appDisplayName=s.displayName),a.sessionId=i,J_(n,t,e.type,void 0,e.eventId??void 0,a)}async function OU(n){const{BuildInfo:e}=Ha(),t={};yh()?t.iosBundleId=e.packageName:gh()?t.androidPackageName=e.packageName:Un(n,"operation-not-supported-in-this-environment"),await MC(n,t)}function FU(n){const{cordova:e}=Ha();return new Promise(t=>{e.plugins.browsertab.isAvailable(s=>{let i=null;s?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,zV()?"_blank":"_system","location=yes"),t(i)})})}async function BU(n,e,t){const{cordova:s}=Ha();let i=()=>{};try{await new Promise((a,l)=>{let u=null;function f(){var x;a();const T=(x=s.plugins.browsertab)==null?void 0:x.close;typeof T=="function"&&T(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function m(){u||(u=window.setTimeout(()=>{l(gn(n,"redirect-cancelled-by-user"))},LU))}function _(){(document==null?void 0:document.visibilityState)==="visible"&&m()}e.addPassiveListener(f),document.addEventListener("resume",m,!1),gh()&&document.addEventListener("visibilitychange",_,!1),i=()=>{e.removePassiveListener(f),document.removeEventListener("resume",m,!1),document.removeEventListener("visibilitychange",_,!1),u&&window.clearTimeout(u)}})}finally{i()}}function jU(n){var t,s,i,a,l,u,f,m,_,T;const e=Ha();pe(typeof((t=e==null?void 0:e.universalLinks)==null?void 0:t.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),pe(typeof((s=e==null?void 0:e.BuildInfo)==null?void 0:s.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),pe(typeof((l=(a=(i=e==null?void 0:e.cordova)==null?void 0:i.plugins)==null?void 0:a.browsertab)==null?void 0:l.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),pe(typeof((m=(f=(u=e==null?void 0:e.cordova)==null?void 0:u.plugins)==null?void 0:f.browsertab)==null?void 0:m.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),pe(typeof((T=(_=e==null?void 0:e.cordova)==null?void 0:_.InAppBrowser)==null?void 0:T.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function GU(n){const e=qU(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function qU(n){if(ci(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let s=0;s<n.length;s++)t[s]=n.charCodeAt(s);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HU=20;class zU extends PC{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function $U(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:JU(),postBody:null,tenantId:n.tenantId,error:gn(n,"no-auth-event")}}function YU(n,e){return Q_()._set(W_(n),e)}async function lA(n){const e=await Q_()._get(W_(n));return e&&await Q_()._remove(W_(n)),e}function KU(n,e){var s,i;const t=WU(e);if(t.includes("/__/auth/callback")){const a=wm(t),l=a.firebaseError?QU(decodeURIComponent(a.firebaseError)):null,u=(i=(s=l==null?void 0:l.code)==null?void 0:s.split("auth/"))==null?void 0:i[1],f=u?gn(u):null;return f?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:f,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function JU(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<HU;t++){const s=Math.floor(Math.random()*e.length);n.push(e.charAt(s))}return n.join("")}function Q_(){return Is(p0)}function W_(n){return Oa("authEvent",n.config.apiKey,n.name)}function QU(n){try{return JSON.parse(n)}catch{return null}}function WU(n){const e=wm(n),t=e.link?decodeURIComponent(e.link):void 0,s=wm(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return wm(i).link||i||s||t||n}function wm(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return lc(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XU=500;class ZU{constructor(){this._redirectPersistence=Ga,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Dp,this._overrideRedirectResult=E0}async _initialize(e){const t=e._key();let s=this.eventManagers.get(t);return s||(s=new zU(e),this.eventManagers.set(t,s),this.attachCallbackListeners(e,s)),s}_openPopup(e){Un(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,s,i){jU(e);const a=await this._initialize(e);await a.initialized(),a.resetRedirect(),Y4(),await this._originValidation(e);const l=$U(e,s,i);await YU(e,l);const u=await UU(e,l,t),f=await FU(u);return BU(e,a,f)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=OU(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:s,handleOpenURL:i,BuildInfo:a}=Ha(),l=setTimeout(async()=>{await lA(e),t.onEvent(cA())},XU),u=async _=>{clearTimeout(l);const T=await lA(e);let x=null;T&&(_!=null&&_.url)&&(x=KU(T,_.url)),t.onEvent(x||cA())};typeof s<"u"&&typeof s.subscribe=="function"&&s.subscribe(null,u);const f=i,m=`${a.packageName.toLowerCase()}://`;Ha().handleOpenURL=async _=>{if(_.toLowerCase().startsWith(m)&&u({url:_}),typeof f=="function")try{f(_)}catch(T){console.error(T)}}}}const eO=ZU;function cA(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:gn("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tO(n,e){jt(n)._logFramework(e)}var nO="@firebase/auth-compat",sO="0.6.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO=1e3;function Rd(){var n;return((n=self==null?void 0:self.location)==null?void 0:n.protocol)||null}function rO(){return Rd()==="http:"||Rd()==="https:"}function VC(n=Bt()){return!!((Rd()==="file:"||Rd()==="ionic:"||Rd()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function oO(){return Wv()||Ep()}function aO(){return wS()&&(document==null?void 0:document.documentMode)===11}function lO(n=Bt()){return/Edge\/\d+/.test(n)}function cO(n=Bt()){return aO()||lO(n)}function LC(){try{const n=self.localStorage,e=Eh();if(n)return n.setItem(e,"1"),n.removeItem(e),cO()?ja():!0}catch{return x0()&&ja()}return!1}function x0(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function P_(){return(rO()||Tp()||VC())&&!oO()&&LC()&&!x0()}function UC(){return VC()&&typeof document<"u"}async function uO(){return UC()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},iO);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function dO(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs={LOCAL:"local",NONE:"none",SESSION:"session"},ld=pe,OC="persistence";function hO(n,e){if(ld(Object.values(xs).includes(e),n,"invalid-persistence-type"),Wv()){ld(e!==xs.SESSION,n,"unsupported-persistence-type");return}if(Ep()){ld(e===xs.NONE,n,"unsupported-persistence-type");return}if(x0()){ld(e===xs.NONE||e===xs.LOCAL&&ja(),n,"unsupported-persistence-type");return}ld(e===xs.NONE||LC(),n,"unsupported-persistence-type")}async function X_(n){await n._initializationPromise;const e=FC(),t=Oa(OC,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function fO(n,e){const t=FC();if(!t)return[];const s=Oa(OC,n,e);switch(t.getItem(s)){case xs.NONE:return[Tc];case xs.LOCAL:return[Jd,Ga];case xs.SESSION:return[Ga];default:return[]}}function FC(){var n;try{return((n=dO())==null?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mO=pe;class Eo{constructor(){this.browserResolver=Is(CU),this.cordovaResolver=Is(eO),this.underlyingResolver=null,this._redirectPersistence=Ga,this._completeRedirectFn=Dp,this._overrideRedirectResult=E0}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,s,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,s,i)}async _openRedirect(e,t,s,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,s,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return UC()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return mO(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await uO();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BC(n){return n.unwrap()}function pO(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gO(n){return jC(n)}function yO(n,e){var s;const t=(s=e.customData)==null?void 0:s._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new _O(n,l4(n,e))}else if(t){const i=jC(e),a=e;i&&(a.credential=i,a.tenantId=t.tenantId||void 0,a.email=t.email||void 0,a.phoneNumber=t.phoneNumber||void 0)}}function jC(n){const{_tokenResponse:e}=n instanceof Vn?n.customData:n;if(!e)return null;if(!(n instanceof Vn)&&"temporaryProof"in e&&"phoneNumber"in e)return qa.credentialFromResult(n);const t=e.providerId;if(!t||t===od.PASSWORD)return null;let s;switch(t){case od.GOOGLE:s=Ui;break;case od.FACEBOOK:s=Li;break;case od.GITHUB:s=Oi;break;case od.TWITTER:s=Fi;break;default:const{oauthIdToken:i,oauthAccessToken:a,oauthTokenSecret:l,pendingToken:u,nonce:f}=e;return!a&&!l&&!i&&!u?null:u?t.startsWith("saml.")?xc._create(t,u):$i._fromParams({providerId:t,signInMethod:t,pendingToken:u,idToken:i,accessToken:a}):new hc(t).credential({idToken:i,accessToken:a,rawNonce:f})}return n instanceof Vn?s.credentialFromError(n):s.credentialFromResult(n)}function as(n,e){return e.catch(t=>{throw t instanceof Vn&&yO(n,t),t}).then(t=>{const s=t.operationType,i=t.user;return{operationType:s,credential:gO(t),additionalUserInfo:a4(t),user:Mp.getOrCreate(i)}})}async function Z_(n,e){const t=await e;return{verificationId:t.verificationId,confirm:s=>as(n,t.confirm(s))}}class _O{constructor(e,t){this.resolver=t,this.auth=pO(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return as(BC(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mp=class _d{constructor(e){this._delegate=e,this.multiFactor=d4(e)}static getOrCreate(e){return _d.USER_MAP.has(e)||_d.USER_MAP.set(e,new _d(e)),_d.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return as(this.auth,gC(this._delegate,e))}async linkWithPhoneNumber(e,t){return Z_(this.auth,k4(this._delegate,e,t))}async linkWithPopup(e){return as(this.auth,q4(this._delegate,e,Eo))}async linkWithRedirect(e){return await X_(jt(this.auth)),X4(this._delegate,e,Eo)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return as(this.auth,yC(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Z_(this.auth,V4(this._delegate,e,t))}reauthenticateWithPopup(e){return as(this.auth,G4(this._delegate,e,Eo))}async reauthenticateWithRedirect(e){return await X_(jt(this.auth)),Q4(this._delegate,e,Eo)}sendEmailVerification(e){return QL(this._delegate,e)}async unlink(e){return await LL(this._delegate,e),this}updateEmail(e){return e4(this._delegate,e)}updatePassword(e){return t4(this._delegate,e)}updatePhoneNumber(e){return L4(this._delegate,e)}updateProfile(e){return ZL(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return WL(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Mp.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cd=pe;class ev{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:s}=e.options;cd(s,"invalid-api-key",{appName:e.name}),cd(s,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?Eo:void 0;this._delegate=t.initialize({options:{persistence:vO(s,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(AV),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Mp.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){fL(this._delegate,e,t)}applyActionCode(e){return jL(this._delegate,e)}checkActionCode(e){return _C(this._delegate,e)}confirmPasswordReset(e,t){return BL(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return as(this._delegate,qL(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return JL(this._delegate,e)}isSignInWithEmailLink(e){return $L(this._delegate,e)}async getRedirectResult(){cd(P_(),this._delegate,"operation-not-supported-in-this-environment");const e=await eU(this._delegate,Eo);return e?as(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){tO(this._delegate,e)}onAuthStateChanged(e,t,s){const{next:i,error:a,complete:l}=uA(e,t,s);return this._delegate.onAuthStateChanged(i,a,l)}onIdTokenChanged(e,t,s){const{next:i,error:a,complete:l}=uA(e,t,s);return this._delegate.onIdTokenChanged(i,a,l)}sendSignInLinkToEmail(e,t){return zL(this._delegate,e,t)}sendPasswordResetEmail(e,t){return FL(this._delegate,e,t||void 0)}async setPersistence(e){hO(this._delegate,e);let t;switch(e){case xs.SESSION:t=Ga;break;case xs.LOCAL:t=await Is(Jd)._isAvailable()?Jd:p0;break;case xs.NONE:t=Tc;break;default:return Un("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return as(this._delegate,VL(this._delegate))}signInWithCredential(e){return as(this._delegate,Np(this._delegate,e))}signInWithCustomToken(e){return as(this._delegate,OL(this._delegate,e))}signInWithEmailAndPassword(e,t){return as(this._delegate,HL(this._delegate,e,t))}signInWithEmailLink(e,t){return as(this._delegate,YL(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Z_(this._delegate,M4(this._delegate,e,t))}async signInWithPopup(e){return cd(P_(),this._delegate,"operation-not-supported-in-this-environment"),as(this._delegate,j4(this._delegate,e,Eo))}async signInWithRedirect(e){return cd(P_(),this._delegate,"operation-not-supported-in-this-environment"),await X_(this._delegate),K4(this._delegate,e,Eo)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return GL(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}ev.Persistence=xs;function uA(n,e,t){let s=n;typeof n!="function"&&({next:s,error:e,complete:t}=n);const i=s;return{next:l=>i(l&&Mp.getOrCreate(l)),error:e,complete:t}}function vO(n,e){const t=fO(n,e);if(typeof self<"u"&&!t.includes(Jd)&&t.push(Jd),typeof window<"u")for(const s of[p0,Ga])t.includes(s)||t.push(s);return t.includes(Tc)||t.push(Tc),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{static credential(e,t){return qa.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new qa(BC(je.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}I0.PHONE_SIGN_IN_METHOD=qa.PHONE_SIGN_IN_METHOD;I0.PROVIDER_ID=qa.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EO=pe;class TO{constructor(e,t,s=je.app()){var i;EO((i=s.options)==null?void 0:i.apiKey,"invalid-api-key",{appName:s.name}),this._delegate=new P4(s.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xO="auth-compat";function IO(n){n.INTERNAL.registerComponent(new Xn(xO,e=>{const t=e.getProvider("app-compat").getImmediate(),s=e.getProvider("auth");return new ev(t,s)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Ql.EMAIL_SIGNIN,PASSWORD_RESET:Ql.PASSWORD_RESET,RECOVER_EMAIL:Ql.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Ql.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Ql.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Ql.VERIFY_EMAIL}},EmailAuthProvider:Go,FacebookAuthProvider:Li,GithubAuthProvider:Oi,GoogleAuthProvider:Ui,OAuthProvider:hc,SAMLAuthProvider:Ym,PhoneAuthProvider:I0,PhoneMultiFactorGenerator:kC,RecaptchaVerifier:TO,TwitterAuthProvider:Fi,Auth:ev,AuthCredential:zc,Error:Vn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(nO,sO)}IO(je);var dA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wo,GC;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,C){function S(){}S.prototype=C.prototype,P.F=C.prototype,P.prototype=new S,P.prototype.constructor=P,P.D=function(L,V,O){for(var M=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)M[ae-2]=arguments[ae];return C.prototype[V].apply(L,M)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,C,S){S||(S=0);const L=Array(16);if(typeof C=="string")for(var V=0;V<16;++V)L[V]=C.charCodeAt(S++)|C.charCodeAt(S++)<<8|C.charCodeAt(S++)<<16|C.charCodeAt(S++)<<24;else for(V=0;V<16;++V)L[V]=C[S++]|C[S++]<<8|C[S++]<<16|C[S++]<<24;C=P.g[0],S=P.g[1],V=P.g[2];let O=P.g[3],M;M=C+(O^S&(V^O))+L[0]+3614090360&4294967295,C=S+(M<<7&4294967295|M>>>25),M=O+(V^C&(S^V))+L[1]+3905402710&4294967295,O=C+(M<<12&4294967295|M>>>20),M=V+(S^O&(C^S))+L[2]+606105819&4294967295,V=O+(M<<17&4294967295|M>>>15),M=S+(C^V&(O^C))+L[3]+3250441966&4294967295,S=V+(M<<22&4294967295|M>>>10),M=C+(O^S&(V^O))+L[4]+4118548399&4294967295,C=S+(M<<7&4294967295|M>>>25),M=O+(V^C&(S^V))+L[5]+1200080426&4294967295,O=C+(M<<12&4294967295|M>>>20),M=V+(S^O&(C^S))+L[6]+2821735955&4294967295,V=O+(M<<17&4294967295|M>>>15),M=S+(C^V&(O^C))+L[7]+4249261313&4294967295,S=V+(M<<22&4294967295|M>>>10),M=C+(O^S&(V^O))+L[8]+1770035416&4294967295,C=S+(M<<7&4294967295|M>>>25),M=O+(V^C&(S^V))+L[9]+2336552879&4294967295,O=C+(M<<12&4294967295|M>>>20),M=V+(S^O&(C^S))+L[10]+4294925233&4294967295,V=O+(M<<17&4294967295|M>>>15),M=S+(C^V&(O^C))+L[11]+2304563134&4294967295,S=V+(M<<22&4294967295|M>>>10),M=C+(O^S&(V^O))+L[12]+1804603682&4294967295,C=S+(M<<7&4294967295|M>>>25),M=O+(V^C&(S^V))+L[13]+4254626195&4294967295,O=C+(M<<12&4294967295|M>>>20),M=V+(S^O&(C^S))+L[14]+2792965006&4294967295,V=O+(M<<17&4294967295|M>>>15),M=S+(C^V&(O^C))+L[15]+1236535329&4294967295,S=V+(M<<22&4294967295|M>>>10),M=C+(V^O&(S^V))+L[1]+4129170786&4294967295,C=S+(M<<5&4294967295|M>>>27),M=O+(S^V&(C^S))+L[6]+3225465664&4294967295,O=C+(M<<9&4294967295|M>>>23),M=V+(C^S&(O^C))+L[11]+643717713&4294967295,V=O+(M<<14&4294967295|M>>>18),M=S+(O^C&(V^O))+L[0]+3921069994&4294967295,S=V+(M<<20&4294967295|M>>>12),M=C+(V^O&(S^V))+L[5]+3593408605&4294967295,C=S+(M<<5&4294967295|M>>>27),M=O+(S^V&(C^S))+L[10]+38016083&4294967295,O=C+(M<<9&4294967295|M>>>23),M=V+(C^S&(O^C))+L[15]+3634488961&4294967295,V=O+(M<<14&4294967295|M>>>18),M=S+(O^C&(V^O))+L[4]+3889429448&4294967295,S=V+(M<<20&4294967295|M>>>12),M=C+(V^O&(S^V))+L[9]+568446438&4294967295,C=S+(M<<5&4294967295|M>>>27),M=O+(S^V&(C^S))+L[14]+3275163606&4294967295,O=C+(M<<9&4294967295|M>>>23),M=V+(C^S&(O^C))+L[3]+4107603335&4294967295,V=O+(M<<14&4294967295|M>>>18),M=S+(O^C&(V^O))+L[8]+1163531501&4294967295,S=V+(M<<20&4294967295|M>>>12),M=C+(V^O&(S^V))+L[13]+2850285829&4294967295,C=S+(M<<5&4294967295|M>>>27),M=O+(S^V&(C^S))+L[2]+4243563512&4294967295,O=C+(M<<9&4294967295|M>>>23),M=V+(C^S&(O^C))+L[7]+1735328473&4294967295,V=O+(M<<14&4294967295|M>>>18),M=S+(O^C&(V^O))+L[12]+2368359562&4294967295,S=V+(M<<20&4294967295|M>>>12),M=C+(S^V^O)+L[5]+4294588738&4294967295,C=S+(M<<4&4294967295|M>>>28),M=O+(C^S^V)+L[8]+2272392833&4294967295,O=C+(M<<11&4294967295|M>>>21),M=V+(O^C^S)+L[11]+1839030562&4294967295,V=O+(M<<16&4294967295|M>>>16),M=S+(V^O^C)+L[14]+4259657740&4294967295,S=V+(M<<23&4294967295|M>>>9),M=C+(S^V^O)+L[1]+2763975236&4294967295,C=S+(M<<4&4294967295|M>>>28),M=O+(C^S^V)+L[4]+1272893353&4294967295,O=C+(M<<11&4294967295|M>>>21),M=V+(O^C^S)+L[7]+4139469664&4294967295,V=O+(M<<16&4294967295|M>>>16),M=S+(V^O^C)+L[10]+3200236656&4294967295,S=V+(M<<23&4294967295|M>>>9),M=C+(S^V^O)+L[13]+681279174&4294967295,C=S+(M<<4&4294967295|M>>>28),M=O+(C^S^V)+L[0]+3936430074&4294967295,O=C+(M<<11&4294967295|M>>>21),M=V+(O^C^S)+L[3]+3572445317&4294967295,V=O+(M<<16&4294967295|M>>>16),M=S+(V^O^C)+L[6]+76029189&4294967295,S=V+(M<<23&4294967295|M>>>9),M=C+(S^V^O)+L[9]+3654602809&4294967295,C=S+(M<<4&4294967295|M>>>28),M=O+(C^S^V)+L[12]+3873151461&4294967295,O=C+(M<<11&4294967295|M>>>21),M=V+(O^C^S)+L[15]+530742520&4294967295,V=O+(M<<16&4294967295|M>>>16),M=S+(V^O^C)+L[2]+3299628645&4294967295,S=V+(M<<23&4294967295|M>>>9),M=C+(V^(S|~O))+L[0]+4096336452&4294967295,C=S+(M<<6&4294967295|M>>>26),M=O+(S^(C|~V))+L[7]+1126891415&4294967295,O=C+(M<<10&4294967295|M>>>22),M=V+(C^(O|~S))+L[14]+2878612391&4294967295,V=O+(M<<15&4294967295|M>>>17),M=S+(O^(V|~C))+L[5]+4237533241&4294967295,S=V+(M<<21&4294967295|M>>>11),M=C+(V^(S|~O))+L[12]+1700485571&4294967295,C=S+(M<<6&4294967295|M>>>26),M=O+(S^(C|~V))+L[3]+2399980690&4294967295,O=C+(M<<10&4294967295|M>>>22),M=V+(C^(O|~S))+L[10]+4293915773&4294967295,V=O+(M<<15&4294967295|M>>>17),M=S+(O^(V|~C))+L[1]+2240044497&4294967295,S=V+(M<<21&4294967295|M>>>11),M=C+(V^(S|~O))+L[8]+1873313359&4294967295,C=S+(M<<6&4294967295|M>>>26),M=O+(S^(C|~V))+L[15]+4264355552&4294967295,O=C+(M<<10&4294967295|M>>>22),M=V+(C^(O|~S))+L[6]+2734768916&4294967295,V=O+(M<<15&4294967295|M>>>17),M=S+(O^(V|~C))+L[13]+1309151649&4294967295,S=V+(M<<21&4294967295|M>>>11),M=C+(V^(S|~O))+L[4]+4149444226&4294967295,C=S+(M<<6&4294967295|M>>>26),M=O+(S^(C|~V))+L[11]+3174756917&4294967295,O=C+(M<<10&4294967295|M>>>22),M=V+(C^(O|~S))+L[2]+718787259&4294967295,V=O+(M<<15&4294967295|M>>>17),M=S+(O^(V|~C))+L[9]+3951481745&4294967295,P.g[0]=P.g[0]+C&4294967295,P.g[1]=P.g[1]+(V+(M<<21&4294967295|M>>>11))&4294967295,P.g[2]=P.g[2]+V&4294967295,P.g[3]=P.g[3]+O&4294967295}s.prototype.v=function(P,C){C===void 0&&(C=P.length);const S=C-this.blockSize,L=this.C;let V=this.h,O=0;for(;O<C;){if(V==0)for(;O<=S;)i(this,P,O),O+=this.blockSize;if(typeof P=="string"){for(;O<C;)if(L[V++]=P.charCodeAt(O++),V==this.blockSize){i(this,L),V=0;break}}else for(;O<C;)if(L[V++]=P[O++],V==this.blockSize){i(this,L),V=0;break}}this.h=V,this.o+=C},s.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var C=1;C<P.length-8;++C)P[C]=0;C=this.o*8;for(var S=P.length-8;S<P.length;++S)P[S]=C&255,C/=256;for(this.v(P),P=Array(16),C=0,S=0;S<4;++S)for(let L=0;L<32;L+=8)P[C++]=this.g[S]>>>L&255;return P};function a(P,C){var S=u;return Object.prototype.hasOwnProperty.call(S,P)?S[P]:S[P]=C(P)}function l(P,C){this.h=C;const S=[];let L=!0;for(let V=P.length-1;V>=0;V--){const O=P[V]|0;L&&O==C||(S[V]=O,L=!1)}this.g=S}var u={};function f(P){return-128<=P&&P<128?a(P,function(C){return new l([C|0],C<0?-1:0)}):new l([P|0],P<0?-1:0)}function m(P){if(isNaN(P)||!isFinite(P))return T;if(P<0)return F(m(-P));const C=[];let S=1;for(let L=0;P>=S;L++)C[L]=P/S|0,S*=4294967296;return new l(C,0)}function _(P,C){if(P.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(P.charAt(0)=="-")return F(_(P.substring(1),C));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=m(Math.pow(C,8));let L=T;for(let O=0;O<P.length;O+=8){var V=Math.min(8,P.length-O);const M=parseInt(P.substring(O,O+V),C);V<8?(V=m(Math.pow(C,V)),L=L.j(V).add(m(M))):(L=L.j(S),L=L.add(m(M)))}return L}var T=f(0),x=f(1),b=f(16777216);n=l.prototype,n.m=function(){if(G(this))return-F(this).m();let P=0,C=1;for(let S=0;S<this.g.length;S++){const L=this.i(S);P+=(L>=0?L:4294967296+L)*C,C*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(k(this))return"0";if(G(this))return"-"+F(this).toString(P);const C=m(Math.pow(P,6));var S=this;let L="";for(;;){const V=U(S,C).g;S=Y(S,V.j(C));let O=((S.g.length>0?S.g[0]:S.h)>>>0).toString(P);if(S=V,k(S))return O+L;for(;O.length<6;)O="0"+O;L=O+L}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function k(P){if(P.h!=0)return!1;for(let C=0;C<P.g.length;C++)if(P.g[C]!=0)return!1;return!0}function G(P){return P.h==-1}n.l=function(P){return P=Y(this,P),G(P)?-1:k(P)?0:1};function F(P){const C=P.g.length,S=[];for(let L=0;L<C;L++)S[L]=~P.g[L];return new l(S,~P.h).add(x)}n.abs=function(){return G(this)?F(this):this},n.add=function(P){const C=Math.max(this.g.length,P.g.length),S=[];let L=0;for(let V=0;V<=C;V++){let O=L+(this.i(V)&65535)+(P.i(V)&65535),M=(O>>>16)+(this.i(V)>>>16)+(P.i(V)>>>16);L=M>>>16,O&=65535,M&=65535,S[V]=M<<16|O}return new l(S,S[S.length-1]&-2147483648?-1:0)};function Y(P,C){return P.add(F(C))}n.j=function(P){if(k(this)||k(P))return T;if(G(this))return G(P)?F(this).j(F(P)):F(F(this).j(P));if(G(P))return F(this.j(F(P)));if(this.l(b)<0&&P.l(b)<0)return m(this.m()*P.m());const C=this.g.length+P.g.length,S=[];for(var L=0;L<2*C;L++)S[L]=0;for(L=0;L<this.g.length;L++)for(let V=0;V<P.g.length;V++){const O=this.i(L)>>>16,M=this.i(L)&65535,ae=P.i(V)>>>16,Ie=P.i(V)&65535;S[2*L+2*V]+=M*Ie,K(S,2*L+2*V),S[2*L+2*V+1]+=O*Ie,K(S,2*L+2*V+1),S[2*L+2*V+1]+=M*ae,K(S,2*L+2*V+1),S[2*L+2*V+2]+=O*ae,K(S,2*L+2*V+2)}for(P=0;P<C;P++)S[P]=S[2*P+1]<<16|S[2*P];for(P=C;P<2*C;P++)S[P]=0;return new l(S,0)};function K(P,C){for(;(P[C]&65535)!=P[C];)P[C+1]+=P[C]>>>16,P[C]&=65535,C++}function H(P,C){this.g=P,this.h=C}function U(P,C){if(k(C))throw Error("division by zero");if(k(P))return new H(T,T);if(G(P))return C=U(F(P),C),new H(F(C.g),F(C.h));if(G(C))return C=U(P,F(C)),new H(F(C.g),C.h);if(P.g.length>30){if(G(P)||G(C))throw Error("slowDivide_ only works with positive integers.");for(var S=x,L=C;L.l(P)<=0;)S=z(S),L=z(L);var V=J(S,1),O=J(L,1);for(L=J(L,2),S=J(S,2);!k(L);){var M=O.add(L);M.l(P)<=0&&(V=V.add(S),O=M),L=J(L,1),S=J(S,1)}return C=Y(P,V.j(C)),new H(V,C)}for(V=T;P.l(C)>=0;){for(S=Math.max(1,Math.floor(P.m()/C.m())),L=Math.ceil(Math.log(S)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),O=m(S),M=O.j(C);G(M)||M.l(P)>0;)S-=L,O=m(S),M=O.j(C);k(O)&&(O=x),V=V.add(O),P=Y(P,M)}return new H(V,P)}n.B=function(P){return U(this,P).h},n.and=function(P){const C=Math.max(this.g.length,P.g.length),S=[];for(let L=0;L<C;L++)S[L]=this.i(L)&P.i(L);return new l(S,this.h&P.h)},n.or=function(P){const C=Math.max(this.g.length,P.g.length),S=[];for(let L=0;L<C;L++)S[L]=this.i(L)|P.i(L);return new l(S,this.h|P.h)},n.xor=function(P){const C=Math.max(this.g.length,P.g.length),S=[];for(let L=0;L<C;L++)S[L]=this.i(L)^P.i(L);return new l(S,this.h^P.h)};function z(P){const C=P.g.length+1,S=[];for(let L=0;L<C;L++)S[L]=P.i(L)<<1|P.i(L-1)>>>31;return new l(S,P.h)}function J(P,C){const S=C>>5;C%=32;const L=P.g.length-S,V=[];for(let O=0;O<L;O++)V[O]=C>0?P.i(O+S)>>>C|P.i(O+S+1)<<32-C:P.i(O+S);return new l(V,P.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,GC=s,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=m,l.fromString=_,wo=l}).apply(typeof dA<"u"?dA:typeof self<"u"?self:typeof window<"u"?window:{});var gm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qC,vd,HC,Nm,tv,zC,$C,YC;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof gm=="object"&&gm];for(var I=0;I<y.length;++I){var N=y[I];if(N&&N.Math==Math)return N}throw Error("Cannot find global object")}var s=t(this);function i(y,I){if(I)e:{var N=s;y=y.split(".");for(var D=0;D<y.length-1;D++){var Z=y[D];if(!(Z in N))break e;N=N[Z]}y=y[y.length-1],D=N[y],I=I(D),I!=D&&I!=null&&e(N,y,{configurable:!0,writable:!0,value:I})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(I){var N=[],D;for(D in I)Object.prototype.hasOwnProperty.call(I,D)&&N.push([D,I[D]]);return N}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(y){var I=typeof y;return I=="object"&&y!=null||I=="function"}function f(y,I,N){return y.call.apply(y.bind,arguments)}function m(y,I,N){return m=f,m.apply(null,arguments)}function _(y,I){var N=Array.prototype.slice.call(arguments,1);return function(){var D=N.slice();return D.push.apply(D,arguments),y.apply(this,D)}}function T(y,I){function N(){}N.prototype=I.prototype,y.Z=I.prototype,y.prototype=new N,y.prototype.constructor=y,y.Ob=function(D,Z,re){for(var ve=Array(arguments.length-2),Ye=2;Ye<arguments.length;Ye++)ve[Ye-2]=arguments[Ye];return I.prototype[Z].apply(D,ve)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function b(y){const I=y.length;if(I>0){const N=Array(I);for(let D=0;D<I;D++)N[D]=y[D];return N}return[]}function k(y,I){for(let D=1;D<arguments.length;D++){const Z=arguments[D];var N=typeof Z;if(N=N!="object"?N:Z?Array.isArray(Z)?"array":N:"null",N=="array"||N=="object"&&typeof Z.length=="number"){N=y.length||0;const re=Z.length||0;y.length=N+re;for(let ve=0;ve<re;ve++)y[N+ve]=Z[ve]}else y.push(Z)}}class G{constructor(I,N){this.i=I,this.j=N,this.h=0,this.g=null}get(){let I;return this.h>0?(this.h--,I=this.g,this.g=I.next,I.next=null):I=this.i(),I}}function F(y){l.setTimeout(()=>{throw y},0)}function Y(){var y=P;let I=null;return y.g&&(I=y.g,y.g=y.g.next,y.g||(y.h=null),I.next=null),I}class K{constructor(){this.h=this.g=null}add(I,N){const D=H.get();D.set(I,N),this.h?this.h.next=D:this.g=D,this.h=D}}var H=new G(()=>new U,y=>y.reset());class U{constructor(){this.next=this.g=this.h=null}set(I,N){this.h=I,this.g=N,this.next=null}reset(){this.next=this.g=this.h=null}}let z,J=!1,P=new K,C=()=>{const y=Promise.resolve(void 0);z=()=>{y.then(S)}};function S(){for(var y;y=Y();){try{y.h.call(y.g)}catch(N){F(N)}var I=H;I.j(y),I.h<100&&(I.h++,y.next=I.g,I.g=y)}J=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(y,I){this.type=y,this.g=this.target=I,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var O=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,I=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const N=()=>{};l.addEventListener("test",N,I),l.removeEventListener("test",N,I)}catch{}return y})();function M(y){return/^[\s\xa0]*$/.test(y)}function ae(y,I){V.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,I)}T(ae,V),ae.prototype.init=function(y,I){const N=this.type=y.type,D=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=I,I=y.relatedTarget,I||(N=="mouseover"?I=y.fromElement:N=="mouseout"&&(I=y.toElement)),this.relatedTarget=I,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&ae.Z.h.call(this)},ae.prototype.h=function(){ae.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var Ie="closure_listenable_"+(Math.random()*1e6|0),Q=0;function ge(y,I,N,D,Z){this.listener=y,this.proxy=null,this.src=I,this.type=N,this.capture=!!D,this.ha=Z,this.key=++Q,this.da=this.fa=!1}function Ee(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function ke(y,I,N){for(const D in y)I.call(N,y[D],D,y)}function Ve(y,I){for(const N in y)I.call(void 0,y[N],N,y)}function B(y){const I={};for(const N in y)I[N]=y[N];return I}const q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function me(y,I){let N,D;for(let Z=1;Z<arguments.length;Z++){D=arguments[Z];for(N in D)y[N]=D[N];for(let re=0;re<q.length;re++)N=q[re],Object.prototype.hasOwnProperty.call(D,N)&&(y[N]=D[N])}}function _e(y){this.src=y,this.g={},this.h=0}_e.prototype.add=function(y,I,N,D,Z){const re=y.toString();y=this.g[re],y||(y=this.g[re]=[],this.h++);const ve=ye(y,I,D,Z);return ve>-1?(I=y[ve],N||(I.fa=!1)):(I=new ge(I,this.src,re,!!D,Z),I.fa=N,y.push(I)),I};function Ce(y,I){const N=I.type;if(N in y.g){var D=y.g[N],Z=Array.prototype.indexOf.call(D,I,void 0),re;(re=Z>=0)&&Array.prototype.splice.call(D,Z,1),re&&(Ee(I),y.g[N].length==0&&(delete y.g[N],y.h--))}}function ye(y,I,N,D){for(let Z=0;Z<y.length;++Z){const re=y[Z];if(!re.da&&re.listener==I&&re.capture==!!N&&re.ha==D)return Z}return-1}var Ne="closure_lm_"+(Math.random()*1e6|0),ht={};function qe(y,I,N,D,Z){if(Array.isArray(I)){for(let re=0;re<I.length;re++)qe(y,I[re],N,D,Z);return null}return N=pt(N),y&&y[Ie]?y.J(I,N,u(D)?!!D.capture:!1,Z):at(y,I,N,!1,D,Z)}function at(y,I,N,D,Z,re){if(!I)throw Error("Invalid event type");const ve=u(Z)?!!Z.capture:!!Z;let Ye=Ge(y);if(Ye||(y[Ne]=Ye=new _e(y)),N=Ye.add(I,N,D,ve,re),N.proxy)return N;if(D=_n(),N.proxy=D,D.src=y,D.listener=N,y.addEventListener)O||(Z=ve),Z===void 0&&(Z=!1),y.addEventListener(I.toString(),D,Z);else if(y.attachEvent)y.attachEvent(ee(I.toString()),D);else if(y.addListener&&y.removeListener)y.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return N}function _n(){function y(N){return I.call(y.src,y.listener,N)}const I=Re;return y}function On(y,I,N,D,Z){if(Array.isArray(I))for(var re=0;re<I.length;re++)On(y,I[re],N,D,Z);else D=u(D)?!!D.capture:!!D,N=pt(N),y&&y[Ie]?(y=y.i,re=String(I).toString(),re in y.g&&(I=y.g[re],N=ye(I,N,D,Z),N>-1&&(Ee(I[N]),Array.prototype.splice.call(I,N,1),I.length==0&&(delete y.g[re],y.h--)))):y&&(y=Ge(y))&&(I=y.g[I.toString()],y=-1,I&&(y=ye(I,N,D,Z)),(N=y>-1?I[y]:null)&&ds(N))}function ds(y){if(typeof y!="number"&&y&&!y.da){var I=y.src;if(I&&I[Ie])Ce(I.i,y);else{var N=y.type,D=y.proxy;I.removeEventListener?I.removeEventListener(N,D,y.capture):I.detachEvent?I.detachEvent(ee(N),D):I.addListener&&I.removeListener&&I.removeListener(D),(N=Ge(I))?(Ce(N,y),N.h==0&&(N.src=null,I[Ne]=null)):Ee(y)}}}function ee(y){return y in ht?ht[y]:ht[y]="on"+y}function Re(y,I){if(y.da)y=!0;else{I=new ae(I,this);const N=y.listener,D=y.ha||y.src;y.fa&&ds(y),y=N.call(D,I)}return y}function Ge(y){return y=y[Ne],y instanceof _e?y:null}var We="__closure_events_fn_"+(Math.random()*1e9>>>0);function pt(y){return typeof y=="function"?y:(y[We]||(y[We]=function(I){return y.handleEvent(I)}),y[We])}function He(){L.call(this),this.i=new _e(this),this.M=this,this.G=null}T(He,L),He.prototype[Ie]=!0,He.prototype.removeEventListener=function(y,I,N,D){On(this,y,I,N,D)};function Oe(y,I){var N,D=y.G;if(D)for(N=[];D;D=D.G)N.push(D);if(y=y.M,D=I.type||I,typeof I=="string")I=new V(I,y);else if(I instanceof V)I.target=I.target||y;else{var Z=I;I=new V(D,y),me(I,Z)}Z=!0;let re,ve;if(N)for(ve=N.length-1;ve>=0;ve--)re=I.g=N[ve],Z=en(re,D,!0,I)&&Z;if(re=I.g=y,Z=en(re,D,!0,I)&&Z,Z=en(re,D,!1,I)&&Z,N)for(ve=0;ve<N.length;ve++)re=I.g=N[ve],Z=en(re,D,!1,I)&&Z}He.prototype.N=function(){if(He.Z.N.call(this),this.i){var y=this.i;for(const I in y.g){const N=y.g[I];for(let D=0;D<N.length;D++)Ee(N[D]);delete y.g[I],y.h--}}this.G=null},He.prototype.J=function(y,I,N,D){return this.i.add(String(y),I,!1,N,D)},He.prototype.K=function(y,I,N,D){return this.i.add(String(y),I,!0,N,D)};function en(y,I,N,D){if(I=y.i.g[String(I)],!I)return!0;I=I.concat();let Z=!0;for(let re=0;re<I.length;++re){const ve=I[re];if(ve&&!ve.da&&ve.capture==N){const Ye=ve.listener,Kt=ve.ha||ve.src;ve.fa&&Ce(y.i,ve),Z=Ye.call(Kt,D)!==!1&&Z}}return Z&&!D.defaultPrevented}function zs(y,I){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=m(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(I)>2147483647?-1:l.setTimeout(y,I||0)}function di(y){y.g=zs(()=>{y.g=null,y.i&&(y.i=!1,di(y))},y.l);const I=y.h;y.h=null,y.m.apply(null,I)}class tn extends L{constructor(I,N){super(),this.m=I,this.l=N,this.h=null,this.i=!1,this.g=null}j(I){this.h=arguments,this.g?this.i=!0:di(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hi(y){L.call(this),this.h=y,this.g={}}T(hi,L);var nn=[];function Ji(y){ke(y.g,function(I,N){this.g.hasOwnProperty(N)&&ds(I)},y),y.g={}}hi.prototype.N=function(){hi.Z.N.call(this),Ji(this)},hi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Vr=l.JSON.stringify,_g=l.JSON.parse,Bh=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function jh(){}function Gh(){}var $s={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function wn(){V.call(this,"d")}T(wn,V);function Ns(){V.call(this,"c")}T(Ns,V);var Yt={},qh=null;function cl(){return qh=qh||new He}Yt.Ia="serverreachability";function Hh(y){V.call(this,Yt.Ia,y)}T(Hh,V);function fi(y){const I=cl();Oe(I,new Hh(I))}Yt.STAT_EVENT="statevent";function Jo(y,I){V.call(this,Yt.STAT_EVENT,y),this.stat=I}T(Jo,V);function sn(y){const I=cl();Oe(I,new Jo(I,y))}Yt.Ja="timingevent";function mi(y,I){V.call(this,Yt.Ja,y),this.size=I}T(mi,V);function pi(y,I){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},I)}function Ys(){this.g=!0}Ys.prototype.ua=function(){this.g=!1};function vg(y,I,N,D,Z,re){y.info(function(){if(y.g)if(re){var ve="",Ye=re.split("&");for(let ft=0;ft<Ye.length;ft++){var Kt=Ye[ft].split("=");if(Kt.length>1){const kt=Kt[0];Kt=Kt[1];const Ps=kt.split("_");ve=Ps.length>=2&&Ps[1]=="type"?ve+(kt+"="+Kt+"&"):ve+(kt+"=redacted&")}}}else ve=null;else ve=re;return"XMLHTTP REQ ("+D+") [attempt "+Z+"]: "+I+`
`+N+`
`+ve})}function zh(y,I,N,D,Z,re,ve){y.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+Z+"]: "+I+`
`+N+`
`+re+" "+ve})}function gi(y,I,N,D){y.info(function(){return"XMLHTTP TEXT ("+I+"): "+Eg(y,N)+(D?" "+D:"")})}function Qo(y,I){y.info(function(){return"TIMEOUT: "+I})}Ys.prototype.info=function(){};function Eg(y,I){if(!y.g)return I;if(!I)return null;try{const re=JSON.parse(I);if(re){for(y=0;y<re.length;y++)if(Array.isArray(re[y])){var N=re[y];if(!(N.length<2)){var D=N[1];if(Array.isArray(D)&&!(D.length<1)){var Z=D[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(let ve=1;ve<D.length;ve++)D[ve]=""}}}}return Vr(re)}catch{return I}}var Wo={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ru={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ou;function Xo(){}T(Xo,jh),Xo.prototype.g=function(){return new XMLHttpRequest},ou=new Xo;function Qi(y){return encodeURIComponent(String(y))}function $h(y){var I=1;y=y.split(":");const N=[];for(;I>0&&y.length;)N.push(y.shift()),I--;return y.length&&N.push(y.join(":")),N}function Ks(y,I,N,D){this.j=y,this.i=I,this.l=N,this.S=D||1,this.V=new hi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Js}function Js(){this.i=null,this.g="",this.h=!1}var rn={},vn={};function yi(y,I,N){y.M=1,y.A=Zo(an(I)),y.u=N,y.R=!0,ul(y,null)}function ul(y,I){y.F=Date.now(),_i(y),y.B=an(y.A);var N=y.B,D=y.S;Array.isArray(D)||(D=[String(D)]),ml(N.i,"t",D),y.C=0,N=y.j.L,y.h=new Js,y.g=lf(y.j,N?I:null,!y.u),y.P>0&&(y.O=new tn(m(y.Y,y,y.g),y.P)),I=y.V,N=y.g,D=y.ba;var Z="readystatechange";Array.isArray(Z)||(Z&&(nn[0]=Z.toString()),Z=nn);for(let re=0;re<Z.length;re++){const ve=qe(N,Z[re],D||I.handleEvent,!1,I.h||I);if(!ve)break;I.g[ve.key]=ve}I=y.J?B(y.J):{},y.u?(y.v||(y.v="POST"),I["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,I)):(y.v="GET",y.g.ea(y.B,y.v,null,I)),fi(),vg(y.i,y.v,y.B,y.l,y.S,y.u)}Ks.prototype.ba=function(y){y=y.target;const I=this.O;I&&Xs(y)==3?I.j():this.Y(y)},Ks.prototype.Y=function(y){try{if(y==this.g)e:{const Ye=Xs(this.g),Kt=this.g.ya(),ft=this.g.ca();if(!(Ye<3)&&(Ye!=3||this.g&&(this.h.h||this.g.la()||Nn(this.g)))){this.K||Ye!=4||Kt==7||(Kt==8||ft<=0?fi(3):fi(2)),vi(this);var I=this.g.ca();this.X=I;var N=Tg(this);if(this.o=I==200,zh(this.i,this.v,this.B,this.l,this.S,Ye,I),this.o){if(this.U&&!this.L){t:{if(this.g){var D,Z=this.g;if((D=Z.g?Z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(D)){var re=D;break t}}re=null}if(y=re)gi(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ei(this,y);else{this.o=!1,this.m=3,sn(12),hs(this),Ss(this);break e}}if(this.R){y=!0;let kt;for(;!this.K&&this.C<N.length;)if(kt=Kh(this,N),kt==vn){Ye==4&&(this.m=4,sn(14),y=!1),gi(this.i,this.l,null,"[Incomplete Response]");break}else if(kt==rn){this.m=4,sn(15),gi(this.i,this.l,N,"[Invalid Chunk]"),y=!1;break}else gi(this.i,this.l,kt,null),Ei(this,kt);if(Yh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ye!=4||N.length!=0||this.h.h||(this.m=1,sn(16),y=!1),this.o=this.o&&y,!y)gi(this.i,this.l,N,"[Invalid Chunked Response]"),hs(this),Ss(this);else if(N.length>0&&!this.W){this.W=!0;var ve=this.j;ve.g==this&&ve.aa&&!ve.P&&(ve.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),Tu(ve),ve.P=!0,sn(11))}}else gi(this.i,this.l,N,null),Ei(this,N);Ye==4&&hs(this),this.o&&!this.K&&(Ye==4?sf(this.j,this):(this.o=!1,_i(this)))}else Xi(this.g),I==400&&N.indexOf("Unknown SID")>0?(this.m=3,sn(12)):(this.m=0,sn(13)),hs(this),Ss(this)}}}catch{}finally{}};function Tg(y){if(!Yh(y))return y.g.la();const I=Nn(y.g);if(I==="")return"";let N="";const D=I.length,Z=Xs(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return hs(y),Ss(y),"";y.h.i=new l.TextDecoder}for(let re=0;re<D;re++)y.h.h=!0,N+=y.h.i.decode(I[re],{stream:!(Z&&re==D-1)});return I.length=0,y.h.g+=N,y.C=0,y.h.g}function Yh(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function Kh(y,I){var N=y.C,D=I.indexOf(`
`,N);return D==-1?vn:(N=Number(I.substring(N,D)),isNaN(N)?rn:(D+=1,D+N>I.length?vn:(I=I.slice(D,D+N),y.C=D+N,I)))}Ks.prototype.cancel=function(){this.K=!0,hs(this)};function _i(y){y.T=Date.now()+y.H,dl(y,y.H)}function dl(y,I){if(y.D!=null)throw Error("WatchDog timer not null");y.D=pi(m(y.aa,y),I)}function vi(y){y.D&&(l.clearTimeout(y.D),y.D=null)}Ks.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(Qo(this.i,this.B),this.M!=2&&(fi(),sn(17)),hs(this),this.m=2,Ss(this)):dl(this,this.T-y)};function Ss(y){y.j.I==0||y.K||sf(y.j,y)}function hs(y){vi(y);var I=y.O;I&&typeof I.dispose=="function"&&I.dispose(),y.O=null,Ji(y.V),y.g&&(I=y.g,y.g=null,I.abort(),I.dispose())}function Ei(y,I){try{var N=y.j;if(N.I!=0&&(N.g==y||xi(N.h,y))){if(!y.L&&xi(N.h,y)&&N.I==3){try{var D=N.Ba.g.parse(I)}catch{D=null}if(Array.isArray(D)&&D.length==3){var Z=D;if(Z[0]==0){e:if(!N.v){if(N.g)if(N.g.F+3e3<y.F)vl(N),qr(N);else break e;oa(N),sn(18)}}else N.xa=Z[1],0<N.xa-N.K&&Z[2]<37500&&N.F&&N.A==0&&!N.C&&(N.C=pi(m(N.Va,N),6e3));Ti(N.h)<=1&&N.ta&&(N.ta=void 0)}else Si(N,11)}else if((y.L||N.g==y)&&vl(N),!M(I))for(Z=N.Ba.g.parse(I),I=0;I<Z.length;I++){let ft=Z[I];const kt=ft[0];if(!(kt<=N.K))if(N.K=kt,ft=ft[1],N.I==2)if(ft[0]=="c"){N.M=ft[1],N.ba=ft[2];const Ps=ft[3];Ps!=null&&(N.ka=Ps,N.j.info("VER="+N.ka));const Ci=ft[4];Ci!=null&&(N.za=Ci,N.j.info("SVER="+N.za));const Zs=ft[5];Zs!=null&&typeof Zs=="number"&&Zs>0&&(D=1.5*Zs,N.O=D,N.j.info("backChannelRequestTimeoutMs_="+D)),D=N;const ei=y.g;if(ei){const aa=ei.g?ei.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(aa){var re=D.h;re.g||aa.indexOf("spdy")==-1&&aa.indexOf("quic")==-1&&aa.indexOf("h2")==-1||(re.j=re.l,re.g=new Set,re.h&&(cu(re,re.h),re.h=null))}if(D.G){const El=ei.g?ei.g.getResponseHeader("X-HTTP-Session-Id"):null;El&&(D.wa=El,yt(D.J,D.G,El))}}N.I=3,N.l&&N.l.ra(),N.aa&&(N.T=Date.now()-y.F,N.j.info("Handshake RTT: "+N.T+"ms")),D=N;var ve=y;if(D.na=af(D,D.L?D.ba:null,D.W),ve.L){uu(D.h,ve);var Ye=ve,Kt=D.O;Kt&&(Ye.H=Kt),Ye.D&&(vi(Ye),_i(Ye)),D.g=ve}else tf(D);N.i.length>0&&Ni(N)}else ft[0]!="stop"&&ft[0]!="close"||Si(N,7);else N.I==3&&(ft[0]=="stop"||ft[0]=="close"?ft[0]=="stop"?Si(N,7):vu(N):ft[0]!="noop"&&N.l&&N.l.qa(ft),N.A=0)}}fi(4)}catch{}}var on=class{constructor(y,I){this.g=y,this.map=I}};function au(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function lu(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Ti(y){return y.h?1:y.g?y.g.size:0}function xi(y,I){return y.h?y.h==I:y.g?y.g.has(I):!1}function cu(y,I){y.g?y.g.add(I):y.h=I}function uu(y,I){y.h&&y.h==I?y.h=null:y.g&&y.g.has(I)&&y.g.delete(I)}au.prototype.cancel=function(){if(this.i=du(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function du(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let I=y.i;for(const N of y.g.values())I=I.concat(N.G);return I}return b(y.i)}var Jh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hl(y,I){if(y){y=y.split("&");for(let N=0;N<y.length;N++){const D=y[N].indexOf("=");let Z,re=null;D>=0?(Z=y[N].substring(0,D),re=y[N].substring(D+1)):Z=y[N],I(Z,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function fs(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let I;y instanceof fs?(this.l=y.l,En(this,y.j),this.o=y.o,this.g=y.g,Lr(this,y.u),this.h=y.h,hu(this,Zh(y.i)),this.m=y.m):y&&(I=String(y).match(Jh))?(this.l=!1,En(this,I[1]||"",!0),this.o=Ii(I[2]||""),this.g=Ii(I[3]||"",!0),Lr(this,I[4]),this.h=Ii(I[5]||"",!0),hu(this,I[6]||"",!0),this.m=Ii(I[7]||"")):(this.l=!1,this.i=new Or(null,this.l))}fs.prototype.toString=function(){const y=[];var I=this.j;I&&y.push(ea(I,fl,!0),":");var N=this.g;return(N||I=="file")&&(y.push("//"),(I=this.o)&&y.push(ea(I,fl,!0),"@"),y.push(Qi(N).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),N=this.u,N!=null&&y.push(":",String(N))),(N=this.h)&&(this.g&&N.charAt(0)!="/"&&y.push("/"),y.push(ea(N,N.charAt(0)=="/"?fu:Qh,!0))),(N=this.i.toString())&&y.push("?",N),(N=this.m)&&y.push("#",ea(N,Wh)),y.join("")},fs.prototype.resolve=function(y){const I=an(this);let N=!!y.j;N?En(I,y.j):N=!!y.o,N?I.o=y.o:N=!!y.g,N?I.g=y.g:N=y.u!=null;var D=y.h;if(N)Lr(I,y.u);else if(N=!!y.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var Z=I.h.lastIndexOf("/");Z!=-1&&(D=I.h.slice(0,Z+1)+D)}if(Z=D,Z==".."||Z==".")D="";else if(Z.indexOf("./")!=-1||Z.indexOf("/.")!=-1){D=Z.lastIndexOf("/",0)==0,Z=Z.split("/");const re=[];for(let ve=0;ve<Z.length;){const Ye=Z[ve++];Ye=="."?D&&ve==Z.length&&re.push(""):Ye==".."?((re.length>1||re.length==1&&re[0]!="")&&re.pop(),D&&ve==Z.length&&re.push("")):(re.push(Ye),D=!0)}D=re.join("/")}else D=Z}return N?I.h=D:N=y.i.toString()!=="",N?hu(I,Zh(y.i)):N=!!y.m,N&&(I.m=y.m),I};function an(y){return new fs(y)}function En(y,I,N){y.j=N?Ii(I,!0):I,y.j&&(y.j=y.j.replace(/:$/,""))}function Lr(y,I){if(I){if(I=Number(I),isNaN(I)||I<0)throw Error("Bad port number "+I);y.u=I}else y.u=null}function hu(y,I,N){I instanceof Or?(y.i=I,pl(y.i,y.l)):(N||(I=ea(I,Ur)),y.i=new Or(I,y.l))}function yt(y,I,N){y.i.set(I,N)}function Zo(y){return yt(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function Ii(y,I){return y?I?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function ea(y,I,N){return typeof y=="string"?(y=encodeURI(y).replace(I,es),N&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function es(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var fl=/[#\/\?@]/g,Qh=/[#\?:]/g,fu=/[#\?]/g,Ur=/[#\?@]/g,Wh=/#/g;function Or(y,I){this.h=this.g=null,this.i=y||null,this.j=!!I}function ts(y){y.g||(y.g=new Map,y.h=0,y.i&&hl(y.i,function(I,N){y.add(decodeURIComponent(I.replace(/\+/g," ")),N)}))}n=Or.prototype,n.add=function(y,I){ts(this),this.i=null,y=Fr(this,y);let N=this.g.get(y);return N||this.g.set(y,N=[]),N.push(I),this.h+=1,this};function Xh(y,I){ts(y),I=Fr(y,I),y.g.has(I)&&(y.i=null,y.h-=y.g.get(I).length,y.g.delete(I))}function mu(y,I){return ts(y),I=Fr(y,I),y.g.has(I)}n.forEach=function(y,I){ts(this),this.g.forEach(function(N,D){N.forEach(function(Z){y.call(I,Z,D,this)},this)},this)};function pu(y,I){ts(y);let N=[];if(typeof I=="string")mu(y,I)&&(N=N.concat(y.g.get(Fr(y,I))));else for(y=Array.from(y.g.values()),I=0;I<y.length;I++)N=N.concat(y[I]);return N}n.set=function(y,I){return ts(this),this.i=null,y=Fr(this,y),mu(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[I]),this.h+=1,this},n.get=function(y,I){return y?(y=pu(this,y),y.length>0?String(y[0]):I):I};function ml(y,I,N){Xh(y,I),N.length>0&&(y.i=null,y.g.set(Fr(y,I),b(N)),y.h+=N.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],I=Array.from(this.g.keys());for(let D=0;D<I.length;D++){var N=I[D];const Z=Qi(N);N=pu(this,N);for(let re=0;re<N.length;re++){let ve=Z;N[re]!==""&&(ve+="="+Qi(N[re])),y.push(ve)}}return this.i=y.join("&")};function Zh(y){const I=new Or;return I.i=y.i,y.g&&(I.g=new Map(y.g),I.h=y.h),I}function Fr(y,I){return I=String(I),y.j&&(I=I.toLowerCase()),I}function pl(y,I){I&&!y.j&&(ts(y),y.i=null,y.g.forEach(function(N,D){const Z=D.toLowerCase();D!=Z&&(Xh(this,D),ml(this,Z,N))},y)),y.j=I}function Qs(y,I){const N=new Ys;if(l.Image){const D=new Image;D.onload=_(Cs,N,"TestLoadImage: loaded",!0,I,D),D.onerror=_(Cs,N,"TestLoadImage: error",!1,I,D),D.onabort=_(Cs,N,"TestLoadImage: abort",!1,I,D),D.ontimeout=_(Cs,N,"TestLoadImage: timeout",!1,I,D),l.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=y}else I(!1)}function gu(y,I){const N=new Ys,D=new AbortController,Z=setTimeout(()=>{D.abort(),Cs(N,"TestPingServer: timeout",!1,I)},1e4);fetch(y,{signal:D.signal}).then(re=>{clearTimeout(Z),re.ok?Cs(N,"TestPingServer: ok",!0,I):Cs(N,"TestPingServer: server error",!1,I)}).catch(()=>{clearTimeout(Z),Cs(N,"TestPingServer: error",!1,I)})}function Cs(y,I,N,D,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),D(N)}catch{}}function Br(){this.g=new Bh}function bi(y){this.i=y.Sb||null,this.h=y.ab||!1}T(bi,jh),bi.prototype.g=function(){return new ta(this.i,this.h)};function ta(y,I){He.call(this),this.H=y,this.o=I,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}T(ta,He),n=ta.prototype,n.open=function(y,I){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=I,this.readyState=1,Ws(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const I={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(I.body=y),(this.H||l).fetch(new Request(this.D,I)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,jr(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Ws(this)),this.g&&(this.readyState=3,Ws(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;gl(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function gl(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var I=y.value?y.value:new Uint8Array(0);(I=this.B.decode(I,{stream:!y.done}))&&(this.response=this.responseText+=I)}y.done?jr(this):Ws(this),this.readyState==3&&gl(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,jr(this))},n.Na=function(y){this.g&&(this.response=y,jr(this))},n.ga=function(){this.g&&jr(this)};function jr(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Ws(y)}n.setRequestHeader=function(y,I){this.A.append(y,I)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],I=this.h.entries();for(var N=I.next();!N.done;)N=N.value,y.push(N[0]+": "+N[1]),N=I.next();return y.join(`\r
`)};function Ws(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(ta.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Rs(y){let I="";return ke(y,function(N,D){I+=D,I+=":",I+=N,I+=`\r
`}),I}function na(y,I,N){e:{for(D in N){var D=!1;break e}D=!0}D||(N=Rs(N),typeof y=="string"?N!=null&&Qi(N):yt(y,I,N))}function xt(y){He.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}T(xt,He);var Ai=/^https?$/i,yu=["POST","PUT"];n=xt.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,I,N,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);I=I?I.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ou.g(),this.g.onreadystatechange=x(m(this.Ca,this));try{this.B=!0,this.g.open(I,String(y),!0),this.B=!1}catch(re){sa(this,re);return}if(y=N||"",N=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var Z in D)N.set(Z,D[Z]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const re of D.keys())N.set(re,D.get(re));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(N.keys()).find(re=>re.toLowerCase()=="content-type"),Z=l.FormData&&y instanceof l.FormData,!(Array.prototype.indexOf.call(yu,I,void 0)>=0)||D||Z||N.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[re,ve]of N)this.g.setRequestHeader(re,ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(re){sa(this,re)}};function sa(y,I){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=I,y.o=5,_u(y),Wi(y)}function _u(y){y.A||(y.A=!0,Oe(y,"complete"),Oe(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,Oe(this,"complete"),Oe(this,"abort"),Wi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wi(this,!0)),xt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ia(this):this.Xa())},n.Xa=function(){ia(this)};function ia(y){if(y.h&&typeof a<"u"){if(y.v&&Xs(y)==4)setTimeout(y.Ca.bind(y),0);else if(Oe(y,"readystatechange"),Xs(y)==4){y.h=!1;try{const re=y.ca();e:switch(re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var I=!0;break e;default:I=!1}var N;if(!(N=I)){var D;if(D=re===0){let ve=String(y.D).match(Jh)[1]||null;!ve&&l.self&&l.self.location&&(ve=l.self.location.protocol.slice(0,-1)),D=!Ai.test(ve?ve.toLowerCase():"")}N=D}if(N)Oe(y,"complete"),Oe(y,"success");else{y.o=6;try{var Z=Xs(y)>2?y.g.statusText:""}catch{Z=""}y.l=Z+" ["+y.ca()+"]",_u(y)}}finally{Wi(y)}}}}function Wi(y,I){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const N=y.g;y.g=null,I||Oe(y,"ready");try{N.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Xs(y){return y.g?y.g.readyState:0}n.ca=function(){try{return Xs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var I=this.g.responseText;return y&&I.indexOf(y)==0&&(I=I.substring(y.length)),_g(I)}};function Nn(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function Xi(y){const I={};y=(y.g&&Xs(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<y.length;D++){if(M(y[D]))continue;var N=$h(y[D]);const Z=N[0];if(N=N[1],typeof N!="string")continue;N=N.trim();const re=I[Z]||[];I[Z]=re,re.push(N)}Ve(I,function(D){return D.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function wi(y,I,N){return N&&N.internalChannelParams&&N.internalChannelParams[y]||I}function Gr(y){this.za=0,this.i=[],this.j=new Ys,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=wi("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=wi("baseRetryDelayMs",5e3,y),this.Za=wi("retryDelaySeedMs",1e4,y),this.Ta=wi("forwardChannelMaxRetries",2,y),this.va=wi("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new au(y&&y.concurrentRequestLimit),this.Ba=new Br,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Gr.prototype,n.ka=8,n.I=1,n.connect=function(y,I,N,D){sn(0),this.W=y,this.H=I||{},N&&D!==void 0&&(this.H.OSID=N,this.H.OAID=D),this.F=this.X,this.J=af(this,null,this.W),Ni(this)};function vu(y){if(yl(y),y.I==3){var I=y.V++,N=an(y.J);if(yt(N,"SID",y.M),yt(N,"RID",I),yt(N,"TYPE","terminate"),ra(y,N),I=new Ks(y,y.j,I),I.M=2,I.A=Zo(an(N)),N=!1,l.navigator&&l.navigator.sendBeacon)try{N=l.navigator.sendBeacon(I.A.toString(),"")}catch{}!N&&l.Image&&(new Image().src=I.A,N=!0),N||(I.g=lf(I.j,null),I.g.ea(I.A)),I.F=Date.now(),_i(I)}of(y)}function qr(y){y.g&&(Tu(y),y.g.cancel(),y.g=null)}function yl(y){qr(y),y.v&&(l.clearTimeout(y.v),y.v=null),vl(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&l.clearTimeout(y.m),y.m=null)}function Ni(y){if(!lu(y.h)&&!y.m){y.m=!0;var I=y.Ea;z||C(),J||(z(),J=!0),P.add(I,y),y.D=0}}function _l(y,I){return Ti(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=I.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=pi(m(y.Ea,y,I),rf(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const Z=new Ks(this,this.j,y);let re=this.o;if(this.U&&(re?(re=B(re),me(re,this.U)):re=this.U),this.u!==null||this.R||(Z.J=re,re=null),this.S)e:{for(var I=0,N=0;N<this.i.length;N++){t:{var D=this.i[N];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(I+=D,I>4096){I=N;break e}if(I===4096||N===this.i.length-1){I=N+1;break e}}I=1e3}else I=1e3;I=ef(this,Z,I),N=an(this.J),yt(N,"RID",y),yt(N,"CVER",22),this.G&&yt(N,"X-HTTP-Session-Id",this.G),ra(this,N),re&&(this.R?I="headers="+Qi(Rs(re))+"&"+I:this.u&&na(N,this.u,re)),cu(this.h,Z),this.Ra&&yt(N,"TYPE","init"),this.S?(yt(N,"$req",I),yt(N,"SID","null"),Z.U=!0,yi(Z,N,null)):yi(Z,N,I),this.I=2}}else this.I==3&&(y?Eu(this,y):this.i.length==0||lu(this.h)||Eu(this))};function Eu(y,I){var N;I?N=I.l:N=y.V++;const D=an(y.J);yt(D,"SID",y.M),yt(D,"RID",N),yt(D,"AID",y.K),ra(y,D),y.u&&y.o&&na(D,y.u,y.o),N=new Ks(y,y.j,N,y.D+1),y.u===null&&(N.J=y.o),I&&(y.i=I.G.concat(y.i)),I=ef(y,N,1e3),N.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),cu(y.h,N),yi(N,D,I)}function ra(y,I){y.H&&ke(y.H,function(N,D){yt(I,D,N)}),y.l&&ke({},function(N,D){yt(I,D,N)})}function ef(y,I,N){N=Math.min(y.i.length,N);const D=y.l?m(y.l.Ka,y.l,y):null;e:{var Z=y.i;let Ye=-1;for(;;){const Kt=["count="+N];Ye==-1?N>0?(Ye=Z[0].g,Kt.push("ofs="+Ye)):Ye=0:Kt.push("ofs="+Ye);let ft=!0;for(let kt=0;kt<N;kt++){var re=Z[kt].g;const Ps=Z[kt].map;if(re-=Ye,re<0)Ye=Math.max(0,Z[kt].g-100),ft=!1;else try{re="req"+re+"_"||"";try{var ve=Ps instanceof Map?Ps:Object.entries(Ps);for(const[Ci,Zs]of ve){let ei=Zs;u(Zs)&&(ei=Vr(Zs)),Kt.push(re+Ci+"="+encodeURIComponent(ei))}}catch(Ci){throw Kt.push(re+"type="+encodeURIComponent("_badmap")),Ci}}catch{D&&D(Ps)}}if(ft){ve=Kt.join("&");break e}}ve=void 0}return y=y.i.splice(0,N),I.G=y,ve}function tf(y){if(!y.g&&!y.v){y.Y=1;var I=y.Da;z||C(),J||(z(),J=!0),P.add(I,y),y.A=0}}function oa(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=pi(m(y.Da,y),rf(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,nf(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=pi(m(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,sn(10),qr(this),nf(this))};function Tu(y){y.B!=null&&(l.clearTimeout(y.B),y.B=null)}function nf(y){y.g=new Ks(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var I=an(y.na);yt(I,"RID","rpc"),yt(I,"SID",y.M),yt(I,"AID",y.K),yt(I,"CI",y.F?"0":"1"),!y.F&&y.ia&&yt(I,"TO",y.ia),yt(I,"TYPE","xmlhttp"),ra(y,I),y.u&&y.o&&na(I,y.u,y.o),y.O&&(y.g.H=y.O);var N=y.g;y=y.ba,N.M=1,N.A=Zo(an(I)),N.u=null,N.R=!0,ul(N,y)}n.Va=function(){this.C!=null&&(this.C=null,qr(this),oa(this),sn(19))};function vl(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function sf(y,I){var N=null;if(y.g==I){vl(y),Tu(y),y.g=null;var D=2}else if(xi(y.h,I))N=I.G,uu(y.h,I),D=1;else return;if(y.I!=0){if(I.o)if(D==1){N=I.u?I.u.length:0,I=Date.now()-I.F;var Z=y.D;D=cl(),Oe(D,new mi(D,N)),Ni(y)}else tf(y);else if(Z=I.m,Z==3||Z==0&&I.X>0||!(D==1&&_l(y,I)||D==2&&oa(y)))switch(N&&N.length>0&&(I=y.h,I.i=I.i.concat(N)),Z){case 1:Si(y,5);break;case 4:Si(y,10);break;case 3:Si(y,6);break;default:Si(y,2)}}}function rf(y,I){let N=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(N*=2),N*I}function Si(y,I){if(y.j.info("Error code "+I),I==2){var N=m(y.bb,y),D=y.Ua;const Z=!D;D=new fs(D||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||En(D,"https"),Zo(D),Z?Qs(D.toString(),N):gu(D.toString(),N)}else sn(2);y.I=0,y.l&&y.l.pa(I),of(y),yl(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),sn(2)):(this.j.info("Failed to ping google.com"),sn(1))};function of(y){if(y.I=0,y.ja=[],y.l){const I=du(y.h);(I.length!=0||y.i.length!=0)&&(k(y.ja,I),k(y.ja,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.oa()}}function af(y,I,N){var D=N instanceof fs?an(N):new fs(N);if(D.g!="")I&&(D.g=I+"."+D.g),Lr(D,D.u);else{var Z=l.location;D=Z.protocol,I=I?I+"."+Z.hostname:Z.hostname,Z=+Z.port;const re=new fs(null);D&&En(re,D),I&&(re.g=I),Z&&Lr(re,Z),N&&(re.h=N),D=re}return N=y.G,I=y.wa,N&&I&&yt(D,N,I),yt(D,"VER",y.ka),ra(y,D),D}function lf(y,I,N){if(I&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return I=y.Aa&&!y.ma?new xt(new bi({ab:N})):new xt(y.ma),I.Fa(y.L),I}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function cf(){}n=cf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Hr(){}Hr.prototype.g=function(y,I){return new $n(y,I)};function $n(y,I){He.call(this),this.g=new Gr(I),this.l=y,this.h=I&&I.messageUrlParams||null,y=I&&I.messageHeaders||null,I&&I.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=I&&I.initMessageHeaders||null,I&&I.messageContentType&&(y?y["X-WebChannel-Content-Type"]=I.messageContentType:y={"X-WebChannel-Content-Type":I.messageContentType}),I&&I.sa&&(y?y["X-WebChannel-Client-Profile"]=I.sa:y={"X-WebChannel-Client-Profile":I.sa}),this.g.U=y,(y=I&&I.Qb)&&!M(y)&&(this.g.u=y),this.A=I&&I.supportsCrossDomainXhr||!1,this.v=I&&I.sendRawJson||!1,(I=I&&I.httpSessionIdParam)&&!M(I)&&(this.g.G=I,y=this.h,y!==null&&I in y&&(y=this.h,I in y&&delete y[I])),this.j=new Zi(this)}T($n,He),$n.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){vu(this.g)},$n.prototype.o=function(y){var I=this.g;if(typeof y=="string"){var N={};N.__data__=y,y=N}else this.v&&(N={},N.__data__=Vr(y),y=N);I.i.push(new on(I.Ya++,y)),I.I==3&&Ni(I)},$n.prototype.N=function(){this.g.l=null,delete this.j,vu(this.g),delete this.g,$n.Z.N.call(this)};function uf(y){wn.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var I=y.__sm__;if(I){e:{for(const N in I){y=N;break e}y=void 0}(this.i=y)&&(y=this.i,I=I!==null&&y in I?I[y]:void 0),this.data=I}else this.data=y}T(uf,wn);function df(){Ns.call(this),this.status=1}T(df,Ns);function Zi(y){this.g=y}T(Zi,cf),Zi.prototype.ra=function(){Oe(this.g,"a")},Zi.prototype.qa=function(y){Oe(this.g,new uf(y))},Zi.prototype.pa=function(y){Oe(this.g,new df)},Zi.prototype.oa=function(){Oe(this.g,"b")},Hr.prototype.createWebChannel=Hr.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,YC=function(){return new Hr},$C=function(){return cl()},zC=Yt,tv={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Wo.NO_ERROR=0,Wo.TIMEOUT=8,Wo.HTTP_ERROR=6,Nm=Wo,ru.COMPLETE="complete",HC=ru,Gh.EventType=$s,$s.OPEN="a",$s.CLOSE="b",$s.ERROR="c",$s.MESSAGE="d",He.prototype.listen=He.prototype.J,vd=Gh,xt.prototype.listenOnce=xt.prototype.K,xt.prototype.getLastError=xt.prototype.Ha,xt.prototype.getLastErrorCode=xt.prototype.ya,xt.prototype.getStatus=xt.prototype.ca,xt.prototype.getResponseJson=xt.prototype.La,xt.prototype.getResponseText=xt.prototype.la,xt.prototype.send=xt.prototype.ea,xt.prototype.setWithCredentials=xt.prototype.Fa,qC=xt}).apply(typeof gm<"u"?gm:typeof self<"u"?self:typeof window<"u"?window:{});const hA="@firebase/firestore",fA="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let In=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};In.UNAUTHENTICATED=new In(null),In.GOOGLE_CREDENTIALS=new In("google-credentials-uid"),In.FIRST_PARTY=new In("first-party-uid"),In.MOCK_USER=new In("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yc="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do=new mh("@firebase/firestore");function sc(){return Do.logLevel}function bO(n){Do.setLogLevel(n)}function fe(n,...e){if(Do.logLevel<=et.DEBUG){const t=e.map(b0);Do.debug(`Firestore (${Yc}): ${n}`,...t)}}function Wt(n,...e){if(Do.logLevel<=et.ERROR){const t=e.map(b0);Do.error(`Firestore (${Yc}): ${n}`,...t)}}function Yi(n,...e){if(Do.logLevel<=et.WARN){const t=e.map(b0);Do.warn(`Firestore (${Yc}): ${n}`,...t)}}function b0(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function we(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,KC(n,s,t)}function KC(n,e,t){let s=`FIRESTORE (${Yc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Wt(s),new Error(s)}function Pe(n,e,t,s){let i="Unexpected state";typeof t=="string"?i=t:s=t,n||KC(e,i,s)}function AO(n,e){n||we(57014,e)}function be(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends Vn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class wO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(In.UNAUTHENTICATED)))}shutdown(){}}class NO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class SO{constructor(e){this.t=e,this.currentUser=In.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Pe(this.o===void 0,42304);let s=this.i;const i=f=>this.i!==s?(s=this.i,t(f)):Promise.resolve();let a=new Ln;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ln,e.enqueueRetryable((()=>i(this.currentUser)))};const l=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await i(this.currentUser)}))},u=f=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>u(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ln)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Pe(typeof s.accessToken=="string",31837,{l:s}),new JC(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pe(e===null||typeof e=="string",2055,{h:e}),new In(e)}}class CO{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=In.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class RO{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new CO(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(In.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class mA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class PO{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ut(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Pe(this.o===void 0,3512);const s=a=>{a.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,fe("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>s(a)))};const i=a=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new mA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Pe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new mA(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const i=DO(40);for(let a=0;a<i.length;++a)s.length<20&&i[a]<t&&(s+=e.charAt(i[a]%62))}return s}}function ze(n,e){return n<e?-1:n>e?1:0}function nv(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const i=n.charAt(s),a=e.charAt(s);if(i!==a)return D_(i)===D_(a)?ze(i,a):D_(i)?1:-1}return ze(n.length,e.length)}const MO=55296,kO=57343;function D_(n){const e=n.charCodeAt(0);return e>=MO&&e<=kO}function Ic(n,e,t){return n.length===e.length&&n.every(((s,i)=>t(s,e[i])))}function QC(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA="__name__";class ki{constructor(e,t,s){t===void 0?t=0:t>e.length&&we(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&we(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return ki.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ki?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let i=0;i<s;i++){const a=ki.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return ze(e.length,t.length)}static compareSegments(e,t){const s=ki.isNumericId(e),i=ki.isNumericId(t);return s&&!i?-1:!s&&i?1:s&&i?ki.extractNumericId(e).compare(ki.extractNumericId(t)):nv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return wo.fromString(e.substring(4,e.length-2))}}class tt extends ki{construct(e,t,s){return new tt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new he(ie.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((i=>i.length>0)))}return new tt(t)}static emptyPath(){return new tt([])}}const VO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ot extends ki{construct(e,t,s){return new Ot(e,t,s)}static isValidIdentifier(e){return VO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ot.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===pA}static keyField(){return new Ot([pA])}static fromServerFormat(e){const t=[];let s="",i=0;const a=()=>{if(s.length===0)throw new he(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let l=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new he(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new he(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=f,i+=2}else u==="`"?(l=!l,i++):u!=="."||l?(s+=u,i++):(a(),i++)}if(a(),l)throw new he(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ot(t)}static emptyPath(){return new Ot([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.path=e}static fromPath(e){return new Te(tt.fromString(e))}static fromName(e){return new Te(tt.fromString(e).popFirst(5))}static empty(){return new Te(tt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return tt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Te(new tt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(n,e,t){if(!t)throw new he(ie.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function WC(n,e,t,s){if(e===!0&&s===!0)throw new he(ie.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function gA(n){if(!Te.isDocumentKey(n))throw new he(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function yA(n){if(Te.isDocumentKey(n))throw new he(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function XC(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function kp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":we(12329,{type:typeof n})}function ut(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new he(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=kp(n);throw new he(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ZC(n,e){if(e<=0)throw new he(ie.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(n,e){const t={typeString:n};return e&&(t.value=e),t}function xh(n,e){if(!XC(n))throw new he(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const i=e[s].typeString,a="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const l=n[s];if(i&&typeof l!==i){t=`JSON field '${s}' must be a ${i}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${s}' field to equal '${a.value}'`;break}}if(t)throw new he(ie.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A=-62135596800,vA=1e6;class gt{static now(){return gt.fromMillis(Date.now())}static fromDate(e){return gt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*vA);return new gt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new he(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new he(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<_A)throw new he(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new he(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vA}_compareTo(e){return this.seconds===e.seconds?ze(this.nanoseconds,e.nanoseconds):ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xh(e,gt._jsonSchema))return new gt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-_A;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}gt._jsonSchemaVersion="firestore/timestamp/1.0",gt._jsonSchema={type:mn("string",gt._jsonSchemaVersion),seconds:mn("number"),nanoseconds:mn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{static fromTimestamp(e){return new Me(e)}static min(){return new Me(new gt(0,0))}static max(){return new Me(new gt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bc=-1;class Wm{constructor(e,t,s,i){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=i}}function sv(n){return n.fields.find((e=>e.kind===2))}function Aa(n){return n.fields.filter((e=>e.kind!==2))}Wm.UNKNOWN_ID=-1;class Sm{constructor(e,t){this.fieldPath=e,this.kind=t}}class Qd{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Qd(0,ws.min())}}function eR(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,i=Me.fromTimestamp(s===1e9?new gt(t+1,0):new gt(t,s));return new ws(i,Te.empty(),e)}function tR(n){return new ws(n.readTime,n.key,bc)}class ws{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new ws(Me.min(),Te.empty(),bc)}static max(){return new ws(Me.max(),Te.empty(),bc)}}function N0(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Te.comparator(n.documentKey,e.documentKey),t!==0?t:ze(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qo(n){if(n.code!==ie.FAILED_PRECONDITION||n.message!==nR)throw n;fe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&we(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new X(((s,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(s,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(s,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof X?t:X.resolve(t)}catch(t){return X.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):X.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):X.reject(t)}static resolve(e){return new X(((t,s)=>{t(e)}))}static reject(e){return new X(((t,s)=>{s(e)}))}static waitFor(e){return new X(((t,s)=>{let i=0,a=0,l=!1;e.forEach((u=>{++i,u.next((()=>{++a,l&&a===i&&t()}),(f=>s(f)))})),l=!0,a===i&&t()}))}static or(e){let t=X.resolve(!1);for(const s of e)t=t.next((i=>i?X.resolve(i):s()));return t}static forEach(e,t){const s=[];return e.forEach(((i,a)=>{s.push(t.call(this,i,a))})),this.waitFor(s)}static mapArray(e,t){return new X(((s,i)=>{const a=e.length,l=new Array(a);let u=0;for(let f=0;f<a;f++){const m=f;t(e[m]).next((_=>{l[m]=_,++u,u===a&&s(l)}),(_=>i(_)))}}))}static doWhile(e,t){return new X(((s,i)=>{const a=()=>{e()===!0?t().next((()=>{a()}),i):s()};a()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts="SimpleDb";class Vp{static open(e,t,s,i){try{return new Vp(t,e.transaction(i,s))}catch(a){throw new Pd(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ln,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Pd(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const i=S0(s.target.error);this.S.reject(new Pd(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(fe(Ts,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new UO(t)}}class qi{static delete(e){return fe(Ts,"Removing database:",e),Na(Kv().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ja())return!1;if(qi.F())return!0;const e=Bt(),t=qi.M(e),s=0<t&&t<10,i=iR(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,qi.M(Bt())===12.2&&Wt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(fe(Ts,"Opening database:",this.name),this.db=await new Promise(((t,s)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const l=a.target.result;t(l)},i.onblocked=()=>{s(new Pd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const l=a.target.error;l.name==="VersionError"?s(new he(ie.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?s(new he(ie.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):s(new Pd(e,l))},i.onupgradeneeded=a=>{fe(Ts,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;this.N.k(l,i.transaction,a.oldVersion,this.version).next((()=>{fe(Ts,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,i){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const u=Vp.open(this.db,e,a?"readonly":"readwrite",s),f=i(u).next((m=>(u.C(),m))).catch((m=>(u.abort(m),X.reject(m)))).toPromise();return f.catch((()=>{})),await u.D,f}catch(u){const f=u,m=f.name!=="FirebaseError"&&l<3;if(fe(Ts,"Transaction failed with error:",f.message,"Retrying:",m),this.close(),!m)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function iR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class LO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Na(this.U.delete())}}class Pd extends he{constructor(e,t){super(ie.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ho(n){return n.name==="IndexedDbTransactionError"}class UO{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(fe(Ts,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(fe(Ts,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Na(s)}add(e){return fe(Ts,"ADD",this.store.name,e,e),Na(this.store.add(e))}get(e){return Na(this.store.get(e)).next((t=>(t===void 0&&(t=null),fe(Ts,"GET",this.store.name,e,t),t)))}delete(e){return fe(Ts,"DELETE",this.store.name,e),Na(this.store.delete(e))}count(){return fe(Ts,"COUNT",this.store.name),Na(this.store.count())}J(e,t){const s=this.options(e,t),i=s.index?this.store.index(s.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(s.range);return new X(((l,u)=>{a.onerror=f=>{u(f.target.error)},a.onsuccess=f=>{l(f.target.result)}}))}{const a=this.cursor(s),l=[];return this.H(a,((u,f)=>{l.push(f)})).next((()=>l))}}Y(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new X(((i,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{i(l.target.result)}}))}Z(e,t){fe(Ts,"DELETE ALL",this.store.name);const s=this.options(e,t);s.X=!1;const i=this.cursor(s);return this.H(i,((a,l,u)=>u.delete()))}ee(e,t){let s;t?s=e:(s={},t=e);const i=this.cursor(s);return this.H(i,t)}te(e){const t=this.cursor({});return new X(((s,i)=>{t.onerror=a=>{const l=S0(a.target.error);i(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((u=>{u?l.continue():s()})):s()}}))}H(e,t){const s=[];return new X(((i,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const u=l.target.result;if(!u)return void i();const f=new LO(u),m=t(u.primaryKey,u.value,f);if(m instanceof X){const _=m.catch((T=>(f.done(),X.reject(T))));s.push(_)}f.isDone?i():f.G===null?u.continue():u.continue(f.G)}})).next((()=>X.waitFor(s)))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Na(n){return new X(((e,t)=>{n.onsuccess=s=>{const i=s.target.result;e(i)},n.onerror=s=>{const i=S0(s.target.error);t(i)}}))}let EA=!1;function S0(n){const e=qi.M(Bt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new he("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return EA||(EA=!0,setTimeout((()=>{throw s}),0)),s}}return n}const Dd="IndexBackfiller";class OO{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){fe(Dd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();fe(Dd,`Documents written: ${t}`)}catch(t){Ho(t)?fe(Dd,"Ignoring IndexedDB error during index backfill: ",t):await qo(t)}await this.re(6e4)}))}}class FO{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const s=new Set;let i=t,a=!0;return X.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!s.has(l))return fe(Dd,`Processing collection: ${l}`),this.oe(e,l,i).next((u=>{i-=u,s.add(l)}));a=!1})))).next((()=>t-i))}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,s).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(i,a))).next((u=>(fe(Dd,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u)))).next((()=>l.size))}))))}_e(e,t){let s=e;return t.changes.forEach(((i,a)=>{const l=tR(a);N0(l,s)>0&&(s=l)})),new ws(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ls.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No=-1;function Ih(n){return n==null}function Wd(n){return n===0&&1/n==-1/0}function rR(n){return typeof n=="number"&&Number.isInteger(n)&&!Wd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xm="";function Hn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=TA(e)),e=BO(n.get(t),e);return TA(e)}function BO(n,e){let t=e;const s=n.length;for(let i=0;i<s;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case Xm:t+="";break;default:t+=a}}return t}function TA(n){return n+Xm+""}function ji(n){const e=n.length;if(Pe(e>=2,64408,{path:n}),e===2)return Pe(n.charAt(0)===Xm&&n.charAt(1)==="",56145,{path:n}),tt.emptyPath();const t=e-2,s=[];let i="";for(let a=0;a<e;){const l=n.indexOf(Xm,a);switch((l<0||l>t)&&we(50515,{path:n}),n.charAt(l+1)){case"":const u=n.substring(a,l);let f;i.length===0?f=u:(i+=u,f=i,i=""),s.push(f);break;case"":i+=n.substring(a,l),i+="\0";break;case"":i+=n.substring(a,l+1);break;default:we(61167,{path:n})}a=l+2}return new tt(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa="remoteDocuments",bh="owner",Wl="owner",Xd="mutationQueues",jO="userId",ii="mutations",xA="batchId",Ma="userMutationsIndex",IA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cm(n,e){return[n,Hn(e)]}function oR(n,e,t){return[n,Hn(e),t]}const GO={},Ac="documentMutations",Zm="remoteDocumentsV14",qO=["prefixPath","collectionGroup","readTime","documentId"],Rm="documentKeyIndex",HO=["prefixPath","collectionGroup","documentId"],aR="collectionGroupIndex",zO=["collectionGroup","readTime","prefixPath","documentId"],Zd="remoteDocumentGlobal",iv="remoteDocumentGlobalKey",wc="targets",lR="queryTargetsIndex",$O=["canonicalId","targetId"],Nc="targetDocuments",YO=["targetId","path"],C0="documentTargetsIndex",KO=["path","targetId"],ep="targetGlobalKey",Ba="targetGlobal",eh="collectionParents",JO=["collectionId","parent"],Sc="clientMetadata",QO="clientId",Lp="bundles",WO="bundleId",Up="namedQueries",XO="name",R0="indexConfiguration",ZO="indexId",rv="collectionGroupIndex",eF="collectionGroup",Md="indexState",tF=["indexId","uid"],cR="sequenceNumberIndex",nF=["uid","sequenceNumber"],kd="indexEntries",sF=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],uR="documentKeyIndex",iF=["indexId","uid","orderedDocumentKey"],Op="documentOverlays",rF=["userId","collectionPath","documentId"],ov="collectionPathOverlayIndex",oF=["userId","collectionPath","largestBatchId"],dR="collectionGroupOverlayIndex",aF=["userId","collectionGroup","largestBatchId"],P0="globals",lF="name",hR=[Xd,ii,Ac,wa,wc,bh,Ba,Nc,Sc,Zd,eh,Lp,Up],cF=[...hR,Op],fR=[Xd,ii,Ac,Zm,wc,bh,Ba,Nc,Sc,Zd,eh,Lp,Up,Op],mR=fR,D0=[...mR,R0,Md,kd],uF=D0,pR=[...D0,P0],dF=pR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av extends sR{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function yn(n,e){const t=be(n);return qi.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function zo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function gR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,t){this.comparator=e,this.root=t||Dn.EMPTY}insert(e,t){return new St(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Dn.BLACK,null,null))}remove(e){return new St(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(e,s.key);if(i===0)return t+s.left.size;i<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ym(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ym(this.root,e,this.comparator,!1)}getReverseIterator(){return new ym(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ym(this.root,e,this.comparator,!0)}}class ym{constructor(e,t,s,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?s(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Dn{constructor(e,t,s,i,a){this.key=e,this.value=t,this.color=s??Dn.RED,this.left=i??Dn.EMPTY,this.right=a??Dn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,i,a){return new Dn(e??this.key,t??this.value,s??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let i=this;const a=s(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,s),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Dn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Dn.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw we(43730,{key:this.key,value:this.value});if(this.right.isRed())throw we(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw we(27949);return e+(this.isRed()?0:1)}}Dn.EMPTY=null,Dn.RED=!0,Dn.BLACK=!1;Dn.EMPTY=new class{constructor(){this.size=0}get key(){throw we(57766)}get value(){throw we(16141)}get color(){throw we(16727)}get left(){throw we(29726)}get right(){throw we(36894)}copy(e,t,s,i,a){return this}insert(e,t,s){return new Dn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.comparator=e,this.data=new St(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new AA(this.data.getIterator())}getIteratorFrom(e){return new AA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof Tt)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=s.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Tt(this.comparator);return t.data=e,t}}class AA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Xl(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e){this.fields=e,e.sort(Ot.comparator)}static empty(){return new cs([])}unionWith(e){let t=new Tt(Ot.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new cs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ic(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hF(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new yR("Invalid base64 string: "+a):a}})(e);return new Ht(t)}static fromUint8Array(e){const t=(function(i){let a="";for(let l=0;l<i.length;++l)a+=String.fromCharCode(i[l]);return a})(e);return new Ht(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ht.EMPTY_BYTE_STRING=new Ht("");const fF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ir(n){if(Pe(!!n,39018),typeof n=="string"){let e=0;const t=fF.exec(n);if(Pe(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Lt(n.seconds),nanos:Lt(n.nanos)}}function Lt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function br(n){return typeof n=="string"?Ht.fromBase64String(n):Ht.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R="server_timestamp",vR="__type__",ER="__previous_value__",TR="__local_write_time__";function Fp(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[vR])==null?void 0:s.stringValue)===_R}function Bp(n){const e=n.mapValue.fields[ER];return Fp(e)?Bp(e):e}function th(n){const e=Ir(n.mapValue.fields[TR].timestampValue);return new gt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(e,t,s,i,a,l,u,f,m,_){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=m,this.isUsingEmulator=_}}const lv="(default)";class Mo{constructor(e,t){this.projectId=e,this.database=t||lv}static empty(){return new Mo("","")}get isDefaultDatabase(){return this.database===lv}isEqual(e){return e instanceof Mo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0="__type__",xR="__max__",To={mapValue:{fields:{__type__:{stringValue:xR}}}},k0="__vector__",Cc="value",Pm={nullValue:"NULL_VALUE"};function ko(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fp(n)?4:IR(n)?9007199254740991:jp(n)?10:11:we(28295,{value:n})}function Ki(n,e){if(n===e)return!0;const t=ko(n);if(t!==ko(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return th(n).isEqual(th(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const l=Ir(i.timestampValue),u=Ir(a.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,a){return br(i.bytesValue).isEqual(br(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,a){return Lt(i.geoPointValue.latitude)===Lt(a.geoPointValue.latitude)&&Lt(i.geoPointValue.longitude)===Lt(a.geoPointValue.longitude)})(n,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return Lt(i.integerValue)===Lt(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const l=Lt(i.doubleValue),u=Lt(a.doubleValue);return l===u?Wd(l)===Wd(u):isNaN(l)&&isNaN(u)}return!1})(n,e);case 9:return Ic(n.arrayValue.values||[],e.arrayValue.values||[],Ki);case 10:case 11:return(function(i,a){const l=i.mapValue.fields||{},u=a.mapValue.fields||{};if(bA(l)!==bA(u))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(u[f]===void 0||!Ki(l[f],u[f])))return!1;return!0})(n,e);default:return we(52216,{left:n})}}function nh(n,e){return(n.values||[]).find((t=>Ki(t,e)))!==void 0}function Vo(n,e){if(n===e)return 0;const t=ko(n),s=ko(e);if(t!==s)return ze(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return ze(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const u=Lt(a.integerValue||a.doubleValue),f=Lt(l.integerValue||l.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1})(n,e);case 3:return wA(n.timestampValue,e.timestampValue);case 4:return wA(th(n),th(e));case 5:return nv(n.stringValue,e.stringValue);case 6:return(function(a,l){const u=br(a),f=br(l);return u.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const u=a.split("/"),f=l.split("/");for(let m=0;m<u.length&&m<f.length;m++){const _=ze(u[m],f[m]);if(_!==0)return _}return ze(u.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const u=ze(Lt(a.latitude),Lt(l.latitude));return u!==0?u:ze(Lt(a.longitude),Lt(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return NA(n.arrayValue,e.arrayValue);case 10:return(function(a,l){var x,b,k,G;const u=a.fields||{},f=l.fields||{},m=(x=u[Cc])==null?void 0:x.arrayValue,_=(b=f[Cc])==null?void 0:b.arrayValue,T=ze(((k=m==null?void 0:m.values)==null?void 0:k.length)||0,((G=_==null?void 0:_.values)==null?void 0:G.length)||0);return T!==0?T:NA(m,_)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===To.mapValue&&l===To.mapValue)return 0;if(a===To.mapValue)return 1;if(l===To.mapValue)return-1;const u=a.fields||{},f=Object.keys(u),m=l.fields||{},_=Object.keys(m);f.sort(),_.sort();for(let T=0;T<f.length&&T<_.length;++T){const x=nv(f[T],_[T]);if(x!==0)return x;const b=Vo(u[f[T]],m[_[T]]);if(b!==0)return b}return ze(f.length,_.length)})(n.mapValue,e.mapValue);default:throw we(23264,{he:t})}}function wA(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ze(n,e);const t=Ir(n),s=Ir(e),i=ze(t.seconds,s.seconds);return i!==0?i:ze(t.nanos,s.nanos)}function NA(n,e){const t=n.values||[],s=e.values||[];for(let i=0;i<t.length&&i<s.length;++i){const a=Vo(t[i],s[i]);if(a)return a}return ze(t.length,s.length)}function Rc(n){return cv(n)}function cv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Ir(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return br(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Te.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",i=!0;for(const a of t.values||[])i?i=!1:s+=",",s+=cv(a);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const l of s)a?a=!1:i+=",",i+=`${l}:${cv(t.fields[l])}`;return i+"}"})(n.mapValue):we(61005,{value:n})}function Dm(n){switch(ko(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Bp(n);return e?16+Dm(e):16;case 5:return 2*n.stringValue.length;case 6:return br(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((i,a)=>i+Dm(a)),0)})(n.arrayValue);case 10:case 11:return(function(s){let i=0;return zo(s.fields,((a,l)=>{i+=a.length+Dm(l)})),i})(n.mapValue);default:throw we(13486,{value:n})}}function za(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function uv(n){return!!n&&"integerValue"in n}function sh(n){return!!n&&"arrayValue"in n}function SA(n){return!!n&&"nullValue"in n}function CA(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Mm(n){return!!n&&"mapValue"in n}function jp(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[M0])==null?void 0:s.stringValue)===k0}function Vd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return zo(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Vd(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Vd(n.arrayValue.values[t]);return e}return{...n}}function IR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===xR}const bR={mapValue:{fields:{[M0]:{stringValue:k0},[Cc]:{arrayValue:{}}}}};function pF(n){return"nullValue"in n?Pm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?za(Mo.empty(),Te.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?jp(n)?bR:{mapValue:{}}:we(35942,{value:n})}function gF(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?za(Mo.empty(),Te.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?bR:"mapValue"in n?jp(n)?{mapValue:{}}:To:we(61959,{value:n})}function RA(n,e){const t=Vo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function PA(n,e){const t=Vo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.value=e}static empty(){return new kn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Mm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vd(t)}setAll(e){let t=Ot.emptyPath(),s={},i=[];e.forEach(((l,u)=>{if(!t.isImmediateParentOf(u)){const f=this.getFieldsMap(t);this.applyChanges(f,s,i),s={},i=[],t=u.popLast()}l?s[u.lastSegment()]=Vd(l):i.push(u.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,s,i)}delete(e){const t=this.field(e.popLast());Mm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ki(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let i=t.mapValue.fields[e.get(s)];Mm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,s){zo(t,((i,a)=>e[i]=a));for(const i of s)delete e[i]}clone(){return new kn(Vd(this.value))}}function AR(n){const e=[];return zo(n.fields,((t,s)=>{const i=new Ot([t]);if(Mm(s)){const a=AR(s.mapValue).fields;if(a.length===0)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)})),new cs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e,t,s,i,a,l,u){this.key=e,this.documentType=t,this.version=s,this.readTime=i,this.createTime=a,this.data=l,this.documentState=u}static newInvalidDocument(e){return new Mt(e,0,Me.min(),Me.min(),Me.min(),kn.empty(),0)}static newFoundDocument(e,t,s,i){return new Mt(e,1,t,Me.min(),s,i,0)}static newNoDocument(e,t){return new Mt(e,2,t,Me.min(),Me.min(),kn.empty(),0)}static newUnknownDocument(e,t){return new Mt(e,3,t,Me.min(),Me.min(),kn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Mt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Mt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,t){this.position=e,this.inclusive=t}}function DA(n,e,t){let s=0;for(let i=0;i<n.position.length;i++){const a=e[i],l=n.position[i];if(a.field.isKeyField()?s=Te.comparator(Te.fromName(l.referenceValue),t.key):s=Vo(l,t.data.field(a.field)),a.dir==="desc"&&(s*=-1),s!==0)break}return s}function MA(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ki(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(e,t="asc"){this.field=e,this.dir=t}}function yF(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{}class it extends wR{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new _F(e,t,s):t==="array-contains"?new TF(e,s):t==="in"?new DR(e,s):t==="not-in"?new xF(e,s):t==="array-contains-any"?new IF(e,s):new it(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new vF(e,s):new EF(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Vo(t,this.value)):t!==null&&ko(this.value)===ko(t)&&this.matchesComparison(Vo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return we(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Et extends wR{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Et(e,t)}matches(e){return Pc(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Pc(n){return n.op==="and"}function dv(n){return n.op==="or"}function V0(n){return NR(n)&&Pc(n)}function NR(n){for(const e of n.filters)if(e instanceof Et)return!1;return!0}function hv(n){if(n instanceof it)return n.field.canonicalString()+n.op.toString()+Rc(n.value);if(V0(n))return n.filters.map((e=>hv(e))).join(",");{const e=n.filters.map((t=>hv(t))).join(",");return`${n.op}(${e})`}}function SR(n,e){return n instanceof it?(function(s,i){return i instanceof it&&s.op===i.op&&s.field.isEqual(i.field)&&Ki(s.value,i.value)})(n,e):n instanceof Et?(function(s,i){return i instanceof Et&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce(((a,l,u)=>a&&SR(l,i.filters[u])),!0):!1})(n,e):void we(19439)}function CR(n,e){const t=n.filters.concat(e);return Et.create(t,n.op)}function RR(n){return n instanceof it?(function(t){return`${t.field.canonicalString()} ${t.op} ${Rc(t.value)}`})(n):n instanceof Et?(function(t){return t.op.toString()+" {"+t.getFilters().map(RR).join(" ,")+"}"})(n):"Filter"}class _F extends it{constructor(e,t,s){super(e,t,s),this.key=Te.fromName(s.referenceValue)}matches(e){const t=Te.comparator(e.key,this.key);return this.matchesComparison(t)}}class vF extends it{constructor(e,t){super(e,"in",t),this.keys=PR("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class EF extends it{constructor(e,t){super(e,"not-in",t),this.keys=PR("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function PR(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((s=>Te.fromName(s.referenceValue)))}class TF extends it{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return sh(t)&&nh(t.arrayValue,this.value)}}class DR extends it{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&nh(this.value.arrayValue,t)}}class xF extends it{constructor(e,t){super(e,"not-in",t)}matches(e){if(nh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!nh(this.value.arrayValue,t)}}class IF extends it{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!sh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>nh(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF{constructor(e,t=null,s=[],i=[],a=null,l=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=i,this.limit=a,this.startAt=l,this.endAt=u,this.Te=null}}function fv(n,e=null,t=[],s=[],i=null,a=null,l=null){return new bF(n,e,t,s,i,a,l)}function $a(n){const e=be(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>hv(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(a){return a.field.canonicalString()+a.dir})(s))).join(","),Ih(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>Rc(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>Rc(s))).join(",")),e.Te=t}return e.Te}function Ah(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!yF(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!SR(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!MA(n.startAt,e.startAt)&&MA(n.endAt,e.endAt)}function tp(n){return Te.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function np(n,e){return n.filters.filter((t=>t instanceof it&&t.field.isEqual(e)))}function kA(n,e,t){let s=Pm,i=!0;for(const a of np(n,e)){let l=Pm,u=!0;switch(a.op){case"<":case"<=":l=pF(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,u=!1;break;case"!=":case"not-in":l=Pm}RA({value:s,inclusive:i},{value:l,inclusive:u})<0&&(s=l,i=u)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];RA({value:s,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(s=l,i=t.inclusive);break}}return{value:s,inclusive:i}}function VA(n,e,t){let s=To,i=!0;for(const a of np(n,e)){let l=To,u=!0;switch(a.op){case">=":case">":l=gF(a.value),u=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,u=!1;break;case"!=":case"not-in":l=To}PA({value:s,inclusive:i},{value:l,inclusive:u})>0&&(s=l,i=u)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];PA({value:s,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(s=l,i=t.inclusive);break}}return{value:s,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,t=null,s=[],i=[],a=null,l="F",u=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=i,this.limit=a,this.limitType=l,this.startAt=u,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function MR(n,e,t,s,i,a,l,u){return new Cr(n,e,t,s,i,a,l,u)}function Kc(n){return new Cr(n)}function LA(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function L0(n){return n.collectionGroup!==null}function mc(n){const e=be(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new Tt(Ot.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((m=>{m.isInequality()&&(u=u.add(m.field))}))})),u})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new ih(a,s))})),t.has(Ot.keyField().canonicalString())||e.Ie.push(new ih(Ot.keyField(),s))}return e.Ie}function Wn(n){const e=be(n);return e.Ee||(e.Ee=AF(e,mc(n))),e.Ee}function AF(n,e){if(n.limitType==="F")return fv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new ih(i.field,a)}));const t=n.endAt?new Lo(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Lo(n.startAt.position,n.startAt.inclusive):null;return fv(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function mv(n,e){const t=n.filters.concat([e]);return new Cr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function sp(n,e,t){return new Cr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function wh(n,e){return Ah(Wn(n),Wn(e))&&n.limitType===e.limitType}function kR(n){return`${$a(Wn(n))}|lt:${n.limitType}`}function ic(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((i=>RR(i))).join(", ")}]`),Ih(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((i=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(i))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((i=>Rc(i))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((i=>Rc(i))).join(",")),`Target(${s})`})(Wn(n))}; limitType=${n.limitType})`}function Nh(n,e){return e.isFoundDocument()&&(function(s,i){const a=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(a):Te.isDocumentKey(s.path)?s.path.isEqual(a):s.path.isImmediateParentOf(a)})(n,e)&&(function(s,i){for(const a of mc(s))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(s,i){for(const a of s.filters)if(!a.matches(i))return!1;return!0})(n,e)&&(function(s,i){return!(s.startAt&&!(function(l,u,f){const m=DA(l,u,f);return l.inclusive?m<=0:m<0})(s.startAt,mc(s),i)||s.endAt&&!(function(l,u,f){const m=DA(l,u,f);return l.inclusive?m>=0:m>0})(s.endAt,mc(s),i))})(n,e)}function VR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function LR(n){return(e,t)=>{let s=!1;for(const i of mc(n)){const a=wF(i,e,t);if(a!==0)return a;s=s||i.field.isKeyField()}return 0}}function wF(n,e,t){const s=n.field.isKeyField()?Te.comparator(e.key,t.key):(function(a,l,u){const f=l.data.field(a),m=u.data.field(a);return f!==null&&m!==null?Vo(f,m):we(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return we(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[i,a]of s)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),i=this.inner[s];if(i===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return s.length===1?delete this.inner[t]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(e){zo(this.inner,((t,s)=>{for(const[i,a]of s)e(i,a)}))}isEmpty(){return gR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF=new St(Te.comparator);function us(){return NF}const UR=new St(Te.comparator);function Ed(...n){let e=UR;for(const t of n)e=e.insert(t.key,t);return e}function OR(n){let e=UR;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function Gi(){return Ld()}function FR(){return Ld()}function Ld(){return new Rr((n=>n.toString()),((n,e)=>n.isEqual(e)))}const SF=new St(Te.comparator),CF=new Tt(Te.comparator);function Je(...n){let e=CF;for(const t of n)e=e.add(t);return e}const RF=new Tt(ze);function U0(){return RF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wd(e)?"-0":e}}function BR(n){return{integerValue:""+n}}function jR(n,e){return rR(e)?BR(e):O0(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(){this._=void 0}}function PF(n,e,t){return n instanceof Dc?(function(i,a){const l={fields:{[vR]:{stringValue:_R},[TR]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Fp(a)&&(a=Bp(a)),a&&(l.fields[ER]=a),{mapValue:l}})(t,e):n instanceof Ya?qR(n,e):n instanceof Ka?HR(n,e):(function(i,a){const l=GR(i,a),u=UA(l)+UA(i.Ae);return uv(l)&&uv(i.Ae)?BR(u):O0(i.serializer,u)})(n,e)}function DF(n,e,t){return n instanceof Ya?qR(n,e):n instanceof Ka?HR(n,e):t}function GR(n,e){return n instanceof Mc?(function(s){return uv(s)||(function(a){return!!a&&"doubleValue"in a})(s)})(e)?e:{integerValue:0}:null}class Dc extends Gp{}class Ya extends Gp{constructor(e){super(),this.elements=e}}function qR(n,e){const t=zR(e);for(const s of n.elements)t.some((i=>Ki(i,s)))||t.push(s);return{arrayValue:{values:t}}}class Ka extends Gp{constructor(e){super(),this.elements=e}}function HR(n,e){let t=zR(e);for(const s of n.elements)t=t.filter((i=>!Ki(i,s)));return{arrayValue:{values:t}}}class Mc extends Gp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function UA(n){return Lt(n.integerValue||n.doubleValue)}function zR(n){return sh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e,t){this.field=e,this.transform=t}}function MF(n,e){return n.field.isEqual(e.field)&&(function(s,i){return s instanceof Ya&&i instanceof Ya||s instanceof Ka&&i instanceof Ka?Ic(s.elements,i.elements,Ki):s instanceof Mc&&i instanceof Mc?Ki(s.Ae,i.Ae):s instanceof Dc&&i instanceof Dc})(n.transform,e.transform)}class kF{constructor(e,t){this.version=e,this.transformResults=t}}class Ft{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ft}static exists(e){return new Ft(void 0,e)}static updateTime(e){return new Ft(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function km(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class qp{}function $R(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Qc(n.key,Ft.none()):new Jc(n.key,n.data,Ft.none());{const t=n.data,s=kn.empty();let i=new Tt(Ot.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?s.delete(a):s.set(a,l),i=i.add(a)}return new Pr(n.key,s,new cs(i.toArray()),Ft.none())}}function VF(n,e,t){n instanceof Jc?(function(i,a,l){const u=i.value.clone(),f=FA(i.fieldTransforms,a,l.transformResults);u.setAll(f),a.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(n,e,t):n instanceof Pr?(function(i,a,l){if(!km(i.precondition,a))return void a.convertToUnknownDocument(l.version);const u=FA(i.fieldTransforms,a,l.transformResults),f=a.data;f.setAll(YR(i)),f.setAll(u),a.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(n,e,t):(function(i,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function Ud(n,e,t,s){return n instanceof Jc?(function(a,l,u,f){if(!km(a.precondition,l))return u;const m=a.value.clone(),_=BA(a.fieldTransforms,f,l);return m.setAll(_),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null})(n,e,t,s):n instanceof Pr?(function(a,l,u,f){if(!km(a.precondition,l))return u;const m=BA(a.fieldTransforms,f,l),_=l.data;return _.setAll(YR(a)),_.setAll(m),l.convertToFoundDocument(l.version,_).setHasLocalMutations(),u===null?null:u.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((T=>T.field)))})(n,e,t,s):(function(a,l,u){return km(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(n,e,t)}function LF(n,e){let t=null;for(const s of n.fieldTransforms){const i=e.data.field(s.field),a=GR(s.transform,i||null);a!=null&&(t===null&&(t=kn.empty()),t.set(s.field,a))}return t||null}function OA(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&Ic(s,i,((a,l)=>MF(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Jc extends qp{constructor(e,t,s,i=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Pr extends qp{constructor(e,t,s,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function YR(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function FA(n,e,t){const s=new Map;Pe(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const a=n[i],l=a.transform,u=e.data.field(a.field);s.set(a.field,DF(l,u,t[i]))}return s}function BA(n,e,t){const s=new Map;for(const i of n){const a=i.transform,l=t.data.field(i.field);s.set(i.field,PF(a,l,e))}return s}class Qc extends qp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class F0 extends qp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(e,t,s,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&VF(a,e,s[i])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Ud(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Ud(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=FR();return this.mutations.forEach((i=>{const a=e.get(i.key),l=a.overlayedDocument;let u=this.applyToLocalView(l,a.mutatedFields);u=t.has(i.key)?null:u;const f=$R(l,u);f!==null&&s.set(i.key,f),l.isValidDocument()||l.convertToNoDocument(Me.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Je())}isEqual(e){return this.batchId===e.batchId&&Ic(this.mutations,e.mutations,((t,s)=>OA(t,s)))&&Ic(this.baseMutations,e.baseMutations,((t,s)=>OA(t,s)))}}class j0{constructor(e,t,s,i){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=i}static from(e,t,s){Pe(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let i=(function(){return SF})();const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,s[l].version);return new j0(e,t,s,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hn,ot;function KR(n){switch(n){case ie.OK:return we(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return we(15467,{code:n})}}function JR(n){if(n===void 0)return Wt("GRPC error has no .code"),ie.UNKNOWN;switch(n){case hn.OK:return ie.OK;case hn.CANCELLED:return ie.CANCELLED;case hn.UNKNOWN:return ie.UNKNOWN;case hn.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case hn.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case hn.INTERNAL:return ie.INTERNAL;case hn.UNAVAILABLE:return ie.UNAVAILABLE;case hn.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case hn.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case hn.NOT_FOUND:return ie.NOT_FOUND;case hn.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case hn.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case hn.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case hn.ABORTED:return ie.ABORTED;case hn.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case hn.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case hn.DATA_LOSS:return ie.DATA_LOSS;default:return we(39323,{code:n})}}(ot=hn||(hn={}))[ot.OK=0]="OK",ot[ot.CANCELLED=1]="CANCELLED",ot[ot.UNKNOWN=2]="UNKNOWN",ot[ot.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ot[ot.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ot[ot.NOT_FOUND=5]="NOT_FOUND",ot[ot.ALREADY_EXISTS=6]="ALREADY_EXISTS",ot[ot.PERMISSION_DENIED=7]="PERMISSION_DENIED",ot[ot.UNAUTHENTICATED=16]="UNAUTHENTICATED",ot[ot.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ot[ot.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ot[ot.ABORTED=10]="ABORTED",ot[ot.OUT_OF_RANGE=11]="OUT_OF_RANGE",ot[ot.UNIMPLEMENTED=12]="UNIMPLEMENTED",ot[ot.INTERNAL=13]="INTERNAL",ot[ot.UNAVAILABLE=14]="UNAVAILABLE",ot[ot.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OF=new wo([4294967295,4294967295],0);function jA(n){const e=QR().encode(n),t=new GC;return t.update(e),new Uint8Array(t.digest())}function GA(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new wo([t,s],0),new wo([i,a],0)]}class q0{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Td(`Invalid padding: ${t}`);if(s<0)throw new Td(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Td(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Td(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=wo.fromNumber(this.ge)}ye(e,t,s){let i=e.add(t.multiply(wo.fromNumber(s)));return i.compare(OF)===1&&(i=new wo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=jA(e),[s,i]=GA(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(s,i,a);if(!this.we(l))return!1}return!0}static create(e,t,s){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new q0(a,i,t);return s.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const t=jA(e),[s,i]=GA(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(s,i,a);this.Se(l)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Td extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,t,s,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const i=new Map;return i.set(e,Rh.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Ch(Me.min(),i,new St(ze),us(),Je())}}class Rh{constructor(e,t,s,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Rh(s,t,Je(),Je(),Je())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(e,t,s,i){this.be=e,this.removedTargetIds=t,this.key=s,this.De=i}}class WR{constructor(e,t){this.targetId=e,this.Ce=t}}class XR{constructor(e,t,s=Ht.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=i}}class qA{constructor(){this.ve=0,this.Fe=HA(),this.Me=Ht.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Je(),t=Je(),s=Je();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:s=s.add(i);break;default:we(38017,{changeType:a})}})),new Rh(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=HA()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Pe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class FF{constructor(e){this.Ge=e,this.ze=new Map,this.je=us(),this.Je=_m(),this.He=_m(),this.Ye=new St(ze)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:we(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,s=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(tp(a))if(s===0){const l=new Te(a.path);this.et(t,l,Mt.newNoDocument(l,Me.min()))}else Pe(s===1,20013,{expectedCount:s});else{const l=this._t(t);if(l!==s){const u=this.ut(e),f=u?this.ct(u,e,l):1;if(f!==0){this.it(t);const m=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:a=0}=t;let l,u;try{l=br(s).toUint8Array()}catch(f){if(f instanceof yR)return Yi("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new q0(l,i,a)}catch(f){return Yi(f instanceof Td?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.ge===0?null:u}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let i=0;return s.forEach((a=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(u)||(this.et(t,a,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((a,l)=>{const u=this.ot(l);if(u){if(a.current&&tp(u.target)){const f=new Te(u.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,Mt.newNoDocument(f,e))}a.Be&&(t.set(l,a.ke()),a.qe())}}));let s=Je();this.He.forEach(((a,l)=>{let u=!0;l.forEachWhile((f=>{const m=this.ot(f);return!m||m.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(s=s.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(e)));const i=new Ch(e,t,this.Ye,this.je,s);return this.je=us(),this.Je=_m(),this.He=_m(),this.Ye=new St(ze),i}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new qA,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Tt(ze),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Tt(ze),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||fe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new qA),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function _m(){return new St(Te.comparator)}function HA(){return new St(Te.comparator)}const BF={asc:"ASCENDING",desc:"DESCENDING"},jF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GF={and:"AND",or:"OR"};class qF{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function pv(n,e){return n.useProto3Json||Ih(e)?e:{value:e}}function kc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ZR(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function HF(n,e){return kc(n,e.toTimestamp())}function Xt(n){return Pe(!!n,49232),Me.fromTimestamp((function(t){const s=Ir(t);return new gt(s.seconds,s.nanos)})(n))}function H0(n,e){return gv(n,e).canonicalString()}function gv(n,e){const t=(function(i){return new tt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function e1(n){const e=tt.fromString(n);return Pe(u1(e),10190,{key:e.toString()}),e}function rh(n,e){return H0(n.databaseId,e.path)}function Hi(n,e){const t=e1(e);if(t.get(1)!==n.databaseId.projectId)throw new he(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new he(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Te(s1(t))}function t1(n,e){return H0(n.databaseId,e)}function n1(n){const e=e1(n);return e.length===4?tt.emptyPath():s1(e)}function yv(n){return new tt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function s1(n){return Pe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function zA(n,e,t){return{name:rh(n,e),fields:t.value.mapValue.fields}}function i1(n,e,t){const s=Hi(n,e.name),i=Xt(e.updateTime),a=e.createTime?Xt(e.createTime):Me.min(),l=new kn({mapValue:{fields:e.fields}}),u=Mt.newFoundDocument(s,i,a,l);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function zF(n,e){return"found"in e?(function(s,i){Pe(!!i.found,43571),i.found.name,i.found.updateTime;const a=Hi(s,i.found.name),l=Xt(i.found.updateTime),u=i.found.createTime?Xt(i.found.createTime):Me.min(),f=new kn({mapValue:{fields:i.found.fields}});return Mt.newFoundDocument(a,l,u,f)})(n,e):"missing"in e?(function(s,i){Pe(!!i.missing,3894),Pe(!!i.readTime,22933);const a=Hi(s,i.missing),l=Xt(i.readTime);return Mt.newNoDocument(a,l)})(n,e):we(7234,{result:e})}function $F(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:we(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(m,_){return m.useProto3Json?(Pe(_===void 0||typeof _=="string",58123),Ht.fromBase64String(_||"")):(Pe(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Ht.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(m){const _=m.code===void 0?ie.UNKNOWN:JR(m.code);return new he(_,m.message||"")})(l);t=new XR(s,i,a,u||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=Hi(n,s.document.name),a=Xt(s.document.updateTime),l=s.document.createTime?Xt(s.document.createTime):Me.min(),u=new kn({mapValue:{fields:s.document.fields}}),f=Mt.newFoundDocument(i,a,l,u),m=s.targetIds||[],_=s.removedTargetIds||[];t=new Vm(m,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=Hi(n,s.document),a=s.readTime?Xt(s.readTime):Me.min(),l=Mt.newNoDocument(i,a),u=s.removedTargetIds||[];t=new Vm([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=Hi(n,s.document),a=s.removedTargetIds||[];t=new Vm([],a,i,null)}else{if(!("filter"in e))return we(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:i=0,unchangedNames:a}=s,l=new UF(i,a),u=s.targetId;t=new WR(u,l)}}return t}function oh(n,e){let t;if(e instanceof Jc)t={update:zA(n,e.key,e.value)};else if(e instanceof Qc)t={delete:rh(n,e.key)};else if(e instanceof Pr)t={update:zA(n,e.key,e.data),updateMask:XF(e.fieldMask)};else{if(!(e instanceof F0))return we(16599,{Vt:e.type});t={verify:rh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(a,l){const u=l.transform;if(u instanceof Dc)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Ya)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Ka)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Mc)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw we(20930,{transform:l.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:HF(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:we(27497)})(n,e.precondition)),t}function _v(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?Ft.updateTime(Xt(a.updateTime)):a.exists!==void 0?Ft.exists(a.exists):Ft.none()})(e.currentDocument):Ft.none(),s=e.updateTransforms?e.updateTransforms.map((i=>(function(l,u){let f=null;if("setToServerValue"in u)Pe(u.setToServerValue==="REQUEST_TIME",16630,{proto:u}),f=new Dc;else if("appendMissingElements"in u){const _=u.appendMissingElements.values||[];f=new Ya(_)}else if("removeAllFromArray"in u){const _=u.removeAllFromArray.values||[];f=new Ka(_)}else"increment"in u?f=new Mc(l,u.increment):we(16584,{proto:u});const m=Ot.fromServerFormat(u.fieldPath);return new Sh(m,f)})(n,i))):[];if(e.update){e.update.name;const i=Hi(n,e.update.name),a=new kn({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const m=f.fieldPaths||[];return new cs(m.map((_=>Ot.fromServerFormat(_))))})(e.updateMask);return new Pr(i,a,l,t,s)}return new Jc(i,a,t,s)}if(e.delete){const i=Hi(n,e.delete);return new Qc(i,t)}if(e.verify){const i=Hi(n,e.verify);return new F0(i,t)}return we(1463,{proto:e})}function YF(n,e){return n&&n.length>0?(Pe(e!==void 0,14353),n.map((t=>(function(i,a){let l=i.updateTime?Xt(i.updateTime):Xt(a);return l.isEqual(Me.min())&&(l=Xt(a)),new kF(l,i.transformResults||[])})(t,e)))):[]}function r1(n,e){return{documents:[t1(n,e.path)]}}function o1(n,e){const t={structuredQuery:{}},s=e.path;let i;e.collectionGroup!==null?(i=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=t1(n,i);const a=(function(m){if(m.length!==0)return c1(Et.create(m,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(m){if(m.length!==0)return m.map((_=>(function(x){return{field:rc(x.field),direction:JF(x.dir)}})(_)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const u=pv(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:i}}function a1(n){let e=n1(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let i=null;if(s>0){Pe(s===1,65062);const _=t.from[0];_.allDescendants?i=_.collectionId:e=e.child(_.collectionId)}let a=[];t.where&&(a=(function(T){const x=l1(T);return x instanceof Et&&V0(x)?x.getFilters():[x]})(t.where));let l=[];t.orderBy&&(l=(function(T){return T.map((x=>(function(k){return new ih(oc(k.field),(function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(x)))})(t.orderBy));let u=null;t.limit&&(u=(function(T){let x;return x=typeof T=="object"?T.value:T,Ih(x)?null:x})(t.limit));let f=null;t.startAt&&(f=(function(T){const x=!!T.before,b=T.values||[];return new Lo(b,x)})(t.startAt));let m=null;return t.endAt&&(m=(function(T){const x=!T.before,b=T.values||[];return new Lo(b,x)})(t.endAt)),MR(e,i,l,a,u,"F",f,m)}function KF(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return we(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function l1(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=oc(t.unaryFilter.field);return it.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=oc(t.unaryFilter.field);return it.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=oc(t.unaryFilter.field);return it.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=oc(t.unaryFilter.field);return it.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return we(61313);default:return we(60726)}})(n):n.fieldFilter!==void 0?(function(t){return it.create(oc(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return we(58110);default:return we(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Et.create(t.compositeFilter.filters.map((s=>l1(s))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return we(1026)}})(t.compositeFilter.op))})(n):we(30097,{filter:n})}function JF(n){return BF[n]}function QF(n){return jF[n]}function WF(n){return GF[n]}function rc(n){return{fieldPath:n.canonicalString()}}function oc(n){return Ot.fromServerFormat(n.fieldPath)}function c1(n){return n instanceof it?(function(t){if(t.op==="=="){if(CA(t.value))return{unaryFilter:{field:rc(t.field),op:"IS_NAN"}};if(SA(t.value))return{unaryFilter:{field:rc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(CA(t.value))return{unaryFilter:{field:rc(t.field),op:"IS_NOT_NAN"}};if(SA(t.value))return{unaryFilter:{field:rc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rc(t.field),op:QF(t.op),value:t.value}}})(n):n instanceof Et?(function(t){const s=t.getFilters().map((i=>c1(i)));return s.length===1?s[0]:{compositeFilter:{op:WF(t.op),filters:s}}})(n):we(54877,{filter:n})}function XF(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function u1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,t,s,i,a=Me.min(),l=Me.min(),u=Ht.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new gr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e){this.yt=e}}function ZF(n,e){let t;if(e.document)t=i1(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=Te.fromSegments(e.noDocument.path),i=Qa(e.noDocument.readTime);t=Mt.newNoDocument(s,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return we(56709);{const s=Te.fromSegments(e.unknownDocument.path),i=Qa(e.unknownDocument.version);t=Mt.newUnknownDocument(s,i)}}return e.readTime&&t.setReadTime((function(i){const a=new gt(i[0],i[1]);return Me.fromTimestamp(a)})(e.readTime)),t}function $A(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ip(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=(function(a,l){return{name:rh(a,l.key),fields:l.data.value.mapValue.fields,updateTime:kc(a,l.version.toTimestamp()),createTime:kc(a,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:Ja(e.version)};else{if(!e.isUnknownDocument())return we(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:Ja(e.version)}}return s}function ip(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ja(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Qa(n){const e=new gt(n.seconds,n.nanoseconds);return Me.fromTimestamp(e)}function Sa(n,e){const t=(e.baseMutations||[]).map((a=>_v(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const u=e.mutations[a+1];l.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const s=e.mutations.map((a=>_v(n.yt,a))),i=gt.fromMillis(e.localWriteTimeMs);return new B0(e.batchId,i,t,s)}function xd(n){const e=Qa(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Qa(n.lastLimboFreeSnapshotVersion):Me.min();let s;return s=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return Pe(l===1,1966,{count:l}),Wn(Kc(n1(a.documents[0])))})(n.query):(function(a){return Wn(a1(a))})(n.query),new gr(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ht.fromBase64String(n.resumeToken))}function h1(n,e){const t=Ja(e.snapshotVersion),s=Ja(e.lastLimboFreeSnapshotVersion);let i;i=tp(e.target)?r1(n.yt,e.target):o1(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:$a(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:i}}function z0(n){const e=a1({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?sp(e,e.limit,"L"):e}function M_(n,e){return new G0(e.largestBatchId,_v(n.yt,e.overlayMutation))}function YA(n,e){const t=e.path.lastSegment();return[n,Hn(e.path.popLast()),t]}function KA(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ja(s.readTime),documentKey:Hn(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{getBundleMetadata(e,t){return JA(e).get(t).next((s=>{if(s)return(function(a){return{id:a.bundleId,createTime:Qa(a.createTime),version:a.version}})(s)}))}saveBundleMetadata(e,t){return JA(e).put((function(i){return{bundleId:i.id,createTime:Ja(Xt(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return QA(e).get(t).next((s=>{if(s)return(function(a){return{name:a.name,query:z0(a.bundledQuery),readTime:Qa(a.readTime)}})(s)}))}saveNamedQuery(e,t){return QA(e).put((function(i){return{name:i.name,readTime:Ja(Xt(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function JA(n){return yn(n,Lp)}function QA(n){return yn(n,Up)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new Hp(e,s)}getOverlay(e,t){return ud(e).get(YA(this.userId,t)).next((s=>s?M_(this.serializer,s):null))}getOverlays(e,t){const s=Gi();return X.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&s.set(i,a)})))).next((()=>s))}saveOverlays(e,t,s){const i=[];return s.forEach(((a,l)=>{const u=new G0(t,l);i.push(this.St(e,u))})),X.waitFor(i)}removeOverlaysForBatchId(e,t,s){const i=new Set;t.forEach((l=>i.add(Hn(l.getCollectionPath()))));const a=[];return i.forEach((l=>{const u=IDBKeyRange.bound([this.userId,l,s],[this.userId,l,s+1],!1,!0);a.push(ud(e).Z(ov,u))})),X.waitFor(a)}getOverlaysForCollection(e,t,s){const i=Gi(),a=Hn(t),l=IDBKeyRange.bound([this.userId,a,s],[this.userId,a,Number.POSITIVE_INFINITY],!0);return ud(e).J(ov,l).next((u=>{for(const f of u){const m=M_(this.serializer,f);i.set(m.getKey(),m)}return i}))}getOverlaysForCollectionGroup(e,t,s,i){const a=Gi();let l;const u=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ud(e).ee({index:dR,range:u},((f,m,_)=>{const T=M_(this.serializer,m);a.size()<i||T.largestBatchId===l?(a.set(T.getKey(),T),l=T.largestBatchId):_.done()})).next((()=>a))}St(e,t){return ud(e).put((function(i,a,l){const[u,f,m]=YA(a,l.mutation.key);return{userId:a,collectionPath:f,documentId:m,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:oh(i.yt,l.mutation)}})(this.serializer,this.userId,t))}}function ud(n){return yn(n,Op)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t5{bt(e){return yn(e,P0)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const s=t==null?void 0:t.value;return s?Ht.fromUint8Array(s):Ht.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Lt(e.integerValue));else if("doubleValue"in e){const s=Lt(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),Wd(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=Ir(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(br(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?IR(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):jp(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):we(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const s=e.fields||{};this.Ft(t,55);for(const i of Object.keys(s))this.Ot(i,t),this.Ct(s[i],t)}kt(e,t){var l,u;const s=e.fields||{};this.Ft(t,53);const i=Cc,a=((u=(l=s[i].arrayValue)==null?void 0:l.values)==null?void 0:u.length)||0;this.Ft(t,15),t.Mt(Lt(a)),this.Ot(i,t),this.Ct(s[i],t)}Qt(e,t){const s=e.values||[];this.Ft(t,50);for(const i of s)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),Te.fromName(e).path.forEach((s=>{this.Ft(t,60),this.Ut(s,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Ca.Kt=new Ca;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl=255;function n5(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function WA(n){const e=64-(function(s){let i=0;for(let a=0;a<8;++a){const l=n5(255&s[a]);if(i+=l,l!==8)break}return i})(n);return Math.ceil(e/8)}class s5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Jt(s.value),s=t.next();this.Ht()}Yt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Jt(s);else if(s<2048)this.Jt(960|s>>>6),this.Jt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),s=WA(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let i=t.length-s;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),s=WA(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let i=t.length-s;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Zl),this.sn(255)}_n(){this.an(Zl),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let i=1;i<t.length;++i)t[i]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Zl?(this.sn(Zl),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Zl?(this.an(Zl),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const i=new Uint8Array(s);i.set(this.buffer),this.buffer=i}}class i5{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class r5{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class dd{constructor(){this.cn=new s5,this.ln=new i5(this.cn),this.hn=new r5(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,t,s,i){this.Tn=e,this.In=t,this.En=s,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.dn,0),t!==e?s.set([0],this.dn.length):++s[s.length-1],new Ra(this.Tn,this.In,this.En,s)}Rn(e,t,s){return{indexId:this.Tn,uid:e,arrayValue:Lm(this.En),directionalValue:Lm(this.dn),orderedDocumentKey:Lm(t),documentKey:s.path.toArray()}}Vn(e,t,s){const i=this.Rn(e,t,s);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function po(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=XA(n.En,e.En),t!==0?t:(t=XA(n.dn,e.dn),t!==0?t:Te.comparator(n.In,e.In)))}function XA(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function Lm(n){return SS()?(function(t){let s="";for(let i=0;i<t.length;i++)s+=String.fromCharCode(t[i]);return s})(n):n}function ZA(n){return typeof n!="string"?n:(function(t){const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s})(n)}class ew{constructor(e){this.mn=new Tt(((t,s)=>Ot.comparator(t.field,s.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const s=t;s.isInequality()?this.mn=this.mn.add(s):this.gn.push(s)}}get pn(){return this.mn.size>1}yn(e){if(Pe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=sv(e);if(t!==void 0&&!this.wn(t))return!1;const s=Aa(e);let i=new Set,a=0,l=0;for(;a<s.length&&this.wn(s[a]);++a)i=i.add(s[a].fieldPath.canonicalString());if(a===s.length)return!0;if(this.mn.size>0){const u=this.mn.getIterator().getNext();if(!i.has(u.field.canonicalString())){const f=s[a];if(!this.Sn(u,f)||!this.bn(this.fn[l++],f))return!1}++a}for(;a<s.length;++a){const u=s[a];if(l>=this.fn.length||!this.bn(this.fn[l++],u))return!1}return!0}Dn(){if(this.pn)return null;let e=new Tt(Ot.comparator);const t=[];for(const s of this.gn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new Sm(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new Sm(s.field,0))}for(const s of this.fn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new Sm(s.field,s.dir==="asc"?0:1)));return new Wm(Wm.UNKNOWN_ID,this.collectionId,t,Qd.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f1(n){var t,s;if(Pe(n instanceof it||n instanceof Et,20012),n instanceof it){if(n instanceof DR){const i=((s=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:s.map((a=>it.create(n.field,"==",a))))||[];return Et.create(i,"or")}return n}const e=n.filters.map((i=>f1(i)));return Et.create(e,n.op)}function o5(n){if(n.getFilters().length===0)return[];const e=Tv(f1(n));return Pe(m1(e),7391),vv(e)||Ev(e)?[e]:e.getFilters()}function vv(n){return n instanceof it}function Ev(n){return n instanceof Et&&V0(n)}function m1(n){return vv(n)||Ev(n)||(function(t){if(t instanceof Et&&dv(t)){for(const s of t.getFilters())if(!vv(s)&&!Ev(s))return!1;return!0}return!1})(n)}function Tv(n){if(Pe(n instanceof it||n instanceof Et,34018),n instanceof it)return n;if(n.filters.length===1)return Tv(n.filters[0]);const e=n.filters.map((s=>Tv(s)));let t=Et.create(e,n.op);return t=rp(t),m1(t)?t:(Pe(t instanceof Et,64498),Pe(Pc(t),40251),Pe(t.filters.length>1,57927),t.filters.reduce(((s,i)=>$0(s,i))))}function $0(n,e){let t;return Pe(n instanceof it||n instanceof Et,38388),Pe(e instanceof it||e instanceof Et,25473),t=n instanceof it?e instanceof it?(function(i,a){return Et.create([i,a],"and")})(n,e):tw(n,e):e instanceof it?tw(e,n):(function(i,a){if(Pe(i.filters.length>0&&a.filters.length>0,48005),Pc(i)&&Pc(a))return CR(i,a.getFilters());const l=dv(i)?i:a,u=dv(i)?a:i,f=l.filters.map((m=>$0(m,u)));return Et.create(f,"or")})(n,e),rp(t)}function tw(n,e){if(Pc(e))return CR(e,n.getFilters());{const t=e.filters.map((s=>$0(n,s)));return Et.create(t,"or")}}function rp(n){if(Pe(n instanceof it||n instanceof Et,11850),n instanceof it)return n;const e=n.getFilters();if(e.length===1)return rp(e[0]);if(NR(n))return n;const t=e.map((i=>rp(i))),s=[];return t.forEach((i=>{i instanceof it?s.push(i):i instanceof Et&&(i.op===n.op?s.push(...i.filters):s.push(i))})),s.length===1?s[0]:Et.create(s,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a5{constructor(){this.Cn=new Y0}addToCollectionParentIndex(e,t){return this.Cn.add(t),X.resolve()}getCollectionParents(e,t){return X.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return X.resolve()}deleteFieldIndex(e,t){return X.resolve()}deleteAllFieldIndexes(e){return X.resolve()}createTargetIndexes(e,t){return X.resolve()}getDocumentsMatchingTarget(e,t){return X.resolve(null)}getIndexType(e,t){return X.resolve(0)}getFieldIndexes(e,t){return X.resolve([])}getNextCollectionGroupToUpdate(e){return X.resolve(null)}getMinOffset(e,t){return X.resolve(ws.min())}getMinOffsetFromCollectionGroup(e,t){return X.resolve(ws.min())}updateCollectionGroup(e,t,s){return X.resolve()}updateIndexEntries(e,t){return X.resolve()}}class Y0{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t]||new Tt(tt.comparator),a=!i.has(s);return this.index[t]=i.add(s),a}has(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t];return i&&i.has(s)}getEntries(e){return(this.index[e]||new Tt(tt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw="IndexedDbIndexManager",vm=new Uint8Array(0);class l5{constructor(e,t){this.databaseId=t,this.vn=new Y0,this.Fn=new Rr((s=>$a(s)),((s,i)=>Ah(s,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const s=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:s,parent:Hn(i)};return sw(e).put(a)}return X.resolve()}getCollectionParents(e,t){const s=[],i=IDBKeyRange.bound([t,""],[QC(t),""],!1,!0);return sw(e).J(i).next((a=>{for(const l of a){if(l.collectionId!==t)break;s.push(ji(l.parent))}return s}))}addFieldIndex(e,t){const s=hd(e),i=(function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete i.indexId;const a=s.add(i);if(t.indexState){const l=tc(e);return a.next((u=>{l.put(KA(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const s=hd(e),i=tc(e),a=ec(e);return s.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=hd(e),s=ec(e),i=tc(e);return t.Z().next((()=>s.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return X.forEach(this.Mn(t),(s=>this.getIndexType(e,s).next((i=>{if(i===0||i===1){const a=new ew(s).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const s=ec(e);let i=!0;const a=new Map;return X.forEach(this.Mn(t),(l=>this.xn(e,l).next((u=>{i&&(i=!!u),a.set(l,u)})))).next((()=>{if(i){let l=Je();const u=[];return X.forEach(a,((f,m)=>{fe(nw,`Using index ${(function(H){return`id=${H.indexId}|cg=${H.collectionGroup}|f=${H.fields.map((U=>`${U.fieldPath}:${U.kind}`)).join(",")}`})(f)} to execute ${$a(t)}`);const _=(function(H,U){const z=sv(U);if(z===void 0)return null;for(const J of np(H,z.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null})(m,f),T=(function(H,U){const z=new Map;for(const J of Aa(U))for(const P of np(H,J.fieldPath))switch(P.op){case"==":case"in":z.set(J.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return z.set(J.fieldPath.canonicalString(),P.value),Array.from(z.values())}return null})(m,f),x=(function(H,U){const z=[];let J=!0;for(const P of Aa(U)){const C=P.kind===0?kA(H,P.fieldPath,H.startAt):VA(H,P.fieldPath,H.startAt);z.push(C.value),J&&(J=C.inclusive)}return new Lo(z,J)})(m,f),b=(function(H,U){const z=[];let J=!0;for(const P of Aa(U)){const C=P.kind===0?VA(H,P.fieldPath,H.endAt):kA(H,P.fieldPath,H.endAt);z.push(C.value),J&&(J=C.inclusive)}return new Lo(z,J)})(m,f),k=this.On(f,m,x),G=this.On(f,m,b),F=this.Nn(f,m,T),Y=this.Bn(f.indexId,_,k,x.inclusive,G,b.inclusive,F);return X.forEach(Y,(K=>s.Y(K,t.limit).next((H=>{H.forEach((U=>{const z=Te.fromSegments(U.documentKey);l.has(z)||(l=l.add(z),u.push(z))}))}))))})).next((()=>u))}return X.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=o5(Et.create(e.filters,"and")).map((s=>fv(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,s,i,a,l,u){const f=(t!=null?t.length:1)*Math.max(s.length,a.length),m=f/(t!=null?t.length:1),_=[];for(let T=0;T<f;++T){const x=t?this.Ln(t[T/m]):vm,b=this.kn(e,x,s[T%m],i),k=this.qn(e,x,a[T%m],l),G=u.map((F=>this.kn(e,x,F,!0)));_.push(...this.createRange(b,k,G))}return _}kn(e,t,s,i){const a=new Ra(e,Te.empty(),t,s);return i?a:a.An()}qn(e,t,s,i){const a=new Ra(e,Te.empty(),t,s);return i?a.An():a}xn(e,t){const s=new ew(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let l=null;for(const u of a)s.yn(u)&&(!l||u.fields.length>l.fields.length)&&(l=u);return l}))}getIndexType(e,t){let s=2;const i=this.Mn(t);return X.forEach(i,(a=>this.xn(e,a).next((l=>{l?s!==0&&l.fields.length<(function(f){let m=new Tt(Ot.comparator),_=!1;for(const T of f.filters)for(const x of T.getFlattenedFilters())x.field.isKeyField()||(x.op==="array-contains"||x.op==="array-contains-any"?_=!0:m=m.add(x.field));for(const T of f.orderBy)T.field.isKeyField()||(m=m.add(T.field));return m.size+(_?1:0)})(a)&&(s=1):s=0})))).next((()=>(function(l){return l.limit!==null})(t)&&i.length>1&&s===2?1:s))}Qn(e,t){const s=new dd;for(const i of Aa(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const l=s.Pn(i.kind);Ca.Kt.Dt(a,l)}return s.un()}Ln(e){const t=new dd;return Ca.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const s=new dd;return Ca.Kt.Dt(za(this.databaseId,t),s.Pn((function(a){const l=Aa(a);return l.length===0?0:l[l.length-1].kind})(e))),s.un()}Nn(e,t,s){if(s===null)return[];let i=[];i.push(new dd);let a=0;for(const l of Aa(e)){const u=s[a++];for(const f of i)if(this.Un(t,l.fieldPath)&&sh(u))i=this.Kn(i,l,u);else{const m=f.Pn(l.kind);Ca.Kt.Dt(u,m)}}return this.Wn(i)}On(e,t,s){return this.Nn(e,t,s.position)}Wn(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Kn(e,t,s){const i=[...e],a=[];for(const l of s.arrayValue.values||[])for(const u of i){const f=new dd;f.seed(u.un()),Ca.Kt.Dt(l,f.Pn(t.kind)),a.push(f)}return a}Un(e,t){return!!e.filters.find((s=>s instanceof it&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in")))}getFieldIndexes(e,t){const s=hd(e),i=tc(e);return(t?s.J(rv,IDBKeyRange.bound(t,t)):s.J()).next((a=>{const l=[];return X.forEach(a,(u=>i.get([u.indexId,this.uid]).next((f=>{l.push((function(_,T){const x=T?new Qd(T.sequenceNumber,new ws(Qa(T.readTime),new Te(ji(T.documentKey)),T.largestBatchId)):Qd.empty(),b=_.fields.map((([k,G])=>new Sm(Ot.fromServerFormat(k),G)));return new Wm(_.indexId,_.collectionGroup,b,x)})(u,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((s,i)=>{const a=s.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:ze(s.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,s){const i=hd(e),a=tc(e);return this.Gn(e).next((l=>i.J(rv,IDBKeyRange.bound(t,t)).next((u=>X.forEach(u,(f=>a.put(KA(f.indexId,this.uid,l,s))))))))}updateIndexEntries(e,t){const s=new Map;return X.forEach(t,((i,a)=>{const l=s.get(i.collectionGroup);return(l?X.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next((u=>(s.set(i.collectionGroup,u),X.forEach(u,(f=>this.zn(e,i,f).next((m=>{const _=this.jn(a,f);return m.isEqual(_)?X.resolve():this.Jn(e,a,f,m,_)})))))))}))}Hn(e,t,s,i){return ec(e).put(i.Rn(this.uid,this.$n(s,t.key),t.key))}Yn(e,t,s,i){return ec(e).delete(i.Vn(this.uid,this.$n(s,t.key),t.key))}zn(e,t,s){const i=ec(e);let a=new Tt(po);return i.ee({index:uR,range:IDBKeyRange.only([s.indexId,this.uid,Lm(this.$n(s,t))])},((l,u)=>{a=a.add(new Ra(s.indexId,t,ZA(u.arrayValue),ZA(u.directionalValue)))})).next((()=>a))}jn(e,t){let s=new Tt(po);const i=this.Qn(t,e);if(i==null)return s;const a=sv(t);if(a!=null){const l=e.data.field(a.fieldPath);if(sh(l))for(const u of l.arrayValue.values||[])s=s.add(new Ra(t.indexId,e.key,this.Ln(u),i))}else s=s.add(new Ra(t.indexId,e.key,vm,i));return s}Jn(e,t,s,i,a){fe(nw,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,m,_,T,x){const b=f.getIterator(),k=m.getIterator();let G=Xl(b),F=Xl(k);for(;G||F;){let Y=!1,K=!1;if(G&&F){const H=_(G,F);H<0?K=!0:H>0&&(Y=!0)}else G!=null?K=!0:Y=!0;Y?(T(F),F=Xl(k)):K?(x(G),G=Xl(b)):(G=Xl(b),F=Xl(k))}})(i,a,po,(u=>{l.push(this.Hn(e,t,s,u))}),(u=>{l.push(this.Yn(e,t,s,u))})),X.waitFor(l)}Gn(e){let t=1;return tc(e).ee({index:cR,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((s,i,a)=>{a.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,s){s=s.sort(((l,u)=>po(l,u))).filter(((l,u,f)=>!u||po(l,f[u-1])!==0));const i=[];i.push(e);for(const l of s){const u=po(l,e),f=po(l,t);if(u===0)i[0]=e.An();else if(u>0&&f<0)i.push(l),i.push(l.An());else if(f>0)break}i.push(t);const a=[];for(let l=0;l<i.length;l+=2){if(this.Zn(i[l],i[l+1]))return[];const u=i[l].Vn(this.uid,vm,Te.empty()),f=i[l+1].Vn(this.uid,vm,Te.empty());a.push(IDBKeyRange.bound(u,f))}return a}Zn(e,t){return po(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(iw)}getMinOffset(e,t){return X.mapArray(this.Mn(t),(s=>this.xn(e,s).next((i=>i||we(44426))))).next(iw)}}function sw(n){return yn(n,eh)}function ec(n){return yn(n,kd)}function hd(n){return yn(n,R0)}function tc(n){return yn(n,Md)}function iw(n){Pe(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const i=n[s].indexState.offset;N0(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ws(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},p1=41943040;class jn{static withCacheSize(e){return new jn(e,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g1(n,e,t){const s=n.store(ii),i=n.store(Ac),a=[],l=IDBKeyRange.only(t.batchId);let u=0;const f=s.ee({range:l},((_,T,x)=>(u++,x.delete())));a.push(f.next((()=>{Pe(u===1,47070,{batchId:t.batchId})})));const m=[];for(const _ of t.mutations){const T=oR(e,_.key.path,t.batchId);a.push(i.delete(T)),m.push(_.key)}return X.waitFor(a).next((()=>m))}function op(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw we(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jn.DEFAULT_COLLECTION_PERCENTILE=10,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jn.DEFAULT=new jn(p1,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jn.DISABLED=new jn(-1,0,0);class zp{constructor(e,t,s,i){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=i,this.Xn={}}static wt(e,t,s,i){Pe(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new zp(a,t,s,i)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return go(e).ee({index:Ma,range:s},((i,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,s,i){const a=ac(e),l=go(e);return l.add({}).next((u=>{Pe(typeof u=="number",49019);const f=new B0(u,t,s,i),m=(function(b,k,G){const F=G.baseMutations.map((K=>oh(b.yt,K))),Y=G.mutations.map((K=>oh(b.yt,K)));return{userId:k,batchId:G.batchId,localWriteTimeMs:G.localWriteTime.toMillis(),baseMutations:F,mutations:Y}})(this.serializer,this.userId,f),_=[];let T=new Tt(((x,b)=>ze(x.canonicalString(),b.canonicalString())));for(const x of i){const b=oR(this.userId,x.key.path,u);T=T.add(x.key.path.popLast()),_.push(l.put(m)),_.push(a.put(b,GO))}return T.forEach((x=>{_.push(this.indexManager.addToCollectionParentIndex(e,x))})),e.addOnCommittedListener((()=>{this.Xn[u]=f.keys()})),X.waitFor(_).next((()=>f))}))}lookupMutationBatch(e,t){return go(e).get(t).next((s=>s?(Pe(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),Sa(this.serializer,s)):null))}er(e,t){return this.Xn[t]?X.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((s=>{if(s){const i=s.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,i=IDBKeyRange.lowerBound([this.userId,s]);let a=null;return go(e).ee({index:Ma,range:i},((l,u,f)=>{u.userId===this.userId&&(Pe(u.batchId>=s,47524,{tr:s}),a=Sa(this.serializer,u)),f.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=No;return go(e).ee({index:Ma,range:t,reverse:!0},((i,a,l)=>{s=a.batchId,l.done()})).next((()=>s))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,No],[this.userId,Number.POSITIVE_INFINITY]);return go(e).J(Ma,t).next((s=>s.map((i=>Sa(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=Cm(this.userId,t.path),i=IDBKeyRange.lowerBound(s),a=[];return ac(e).ee({range:i},((l,u,f)=>{const[m,_,T]=l,x=ji(_);if(m===this.userId&&t.path.isEqual(x))return go(e).get(T).next((b=>{if(!b)throw we(61480,{nr:l,batchId:T});Pe(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:T}),a.push(Sa(this.serializer,b))}));f.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Tt(ze);const i=[];return t.forEach((a=>{const l=Cm(this.userId,a.path),u=IDBKeyRange.lowerBound(l),f=ac(e).ee({range:u},((m,_,T)=>{const[x,b,k]=m,G=ji(b);x===this.userId&&a.path.isEqual(G)?s=s.add(k):T.done()}));i.push(f)})),X.waitFor(i).next((()=>this.rr(e,s)))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,i=s.length+1,a=Cm(this.userId,s),l=IDBKeyRange.lowerBound(a);let u=new Tt(ze);return ac(e).ee({range:l},((f,m,_)=>{const[T,x,b]=f,k=ji(x);T===this.userId&&s.isPrefixOf(k)?k.length===i&&(u=u.add(b)):_.done()})).next((()=>this.rr(e,u)))}rr(e,t){const s=[],i=[];return t.forEach((a=>{i.push(go(e).get(a).next((l=>{if(l===null)throw we(35274,{batchId:a});Pe(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),s.push(Sa(this.serializer,l))})))})),X.waitFor(i).next((()=>s))}removeMutationBatch(e,t){return g1(e.le,this.userId,t).next((s=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),X.forEach(s,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return X.resolve();const s=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),i=[];return ac(e).ee({range:s},((a,l,u)=>{if(a[0]===this.userId){const f=ji(a[1]);i.push(f)}else u.done()})).next((()=>{Pe(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return y1(e,this.userId,t)}_r(e){return _1(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:No,lastStreamToken:""}))}}function y1(n,e,t){const s=Cm(e,t.path),i=s[1],a=IDBKeyRange.lowerBound(s);let l=!1;return ac(n).ee({range:a,X:!0},((u,f,m)=>{const[_,T,x]=u;_===e&&T===i&&(l=!0),m.done()})).next((()=>l))}function go(n){return yn(n,ii)}function ac(n){return yn(n,Ac)}function _1(n){return yn(n,Xd)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Wa(0)}static cr(){return new Wa(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c5{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const s=new Wa(t.highestTargetId);return t.highestTargetId=s.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Me.fromTimestamp(new gt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,s){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,s&&(i.lastRemoteSnapshotVersion=s.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((s=>(s.targetCount+=1,this.Tr(t,s),this.hr(e,s))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>nc(e).delete(t.targetId))).next((()=>this.lr(e))).next((s=>(Pe(s.targetCount>0,8065),s.targetCount-=1,this.hr(e,s))))}removeTargets(e,t,s){let i=0;const a=[];return nc(e).ee(((l,u)=>{const f=xd(u);f.sequenceNumber<=t&&s.get(f.targetId)===null&&(i++,a.push(this.removeTargetData(e,f)))})).next((()=>X.waitFor(a))).next((()=>i))}forEachTarget(e,t){return nc(e).ee(((s,i)=>{const a=xd(i);t(a)}))}lr(e){return ow(e).get(ep).next((t=>(Pe(t!==null,2888),t)))}hr(e,t){return ow(e).put(ep,t)}Pr(e,t){return nc(e).put(h1(this.serializer,t))}Tr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const s=$a(t),i=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let a=null;return nc(e).ee({range:i,index:lR},((l,u,f)=>{const m=xd(u);Ah(t,m.target)&&(a=m,f.done())})).next((()=>a))}addMatchingKeys(e,t,s){const i=[],a=vo(e);return t.forEach((l=>{const u=Hn(l.path);i.push(a.put({targetId:s,path:u})),i.push(this.referenceDelegate.addReference(e,s,l))})),X.waitFor(i)}removeMatchingKeys(e,t,s){const i=vo(e);return X.forEach(t,(a=>{const l=Hn(a.path);return X.waitFor([i.delete([s,l]),this.referenceDelegate.removeReference(e,s,a)])}))}removeMatchingKeysForTargetId(e,t){const s=vo(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(i)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),i=vo(e);let a=Je();return i.ee({range:s,X:!0},((l,u,f)=>{const m=ji(l[1]),_=new Te(m);a=a.add(_)})).next((()=>a))}containsKey(e,t){const s=Hn(t.path),i=IDBKeyRange.bound([s],[QC(s)],!1,!0);let a=0;return vo(e).ee({index:C0,X:!0,range:i},(([l,u],f,m)=>{l!==0&&(a++,m.done())})).next((()=>a>0))}At(e,t){return nc(e).get(t).next((s=>s?xd(s):null))}}function nc(n){return yn(n,wc)}function ow(n){return yn(n,Ba)}function vo(n){return yn(n,Nc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aw="LruGarbageCollector",u5=1048576;function lw([n,e],[t,s]){const i=ze(n,t);return i===0?ze(e,s):i}class d5{constructor(e){this.Ir=e,this.buffer=new Tt(lw),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();lw(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class v1{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){fe(aw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ho(t)?fe(aw,"Ignoring IndexedDB error during garbage collection: ",t):await qo(t)}await this.Vr(3e5)}))}}class h5{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return X.resolve(ls.ce);const s=new d5(t);return this.mr.forEachTarget(e,(i=>s.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>s.Ar(i))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),X.resolve(rw)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rw):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,i,a,l,u,f,m;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((T=>(T>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),i=this.params.maximumSequenceNumbersToCollect):i=T,l=Date.now(),this.nthSequenceNumber(e,i)))).next((T=>(s=T,u=Date.now(),this.removeTargets(e,s,t)))).next((T=>(a=T,f=Date.now(),this.removeOrphanedDocuments(e,s)))).next((T=>(m=Date.now(),sc()<=et.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-_}ms
	Determined least recently used ${i} in `+(u-l)+`ms
	Removed ${a} targets in `+(f-u)+`ms
	Removed ${T} documents in `+(m-f)+`ms
Total Duration: ${m-_}ms`),X.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:T}))))}}function E1(n,e){return new h5(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(e,t){this.db=e,this.garbageCollector=E1(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((s=>t.next((i=>s+i))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((s,i)=>t(i)))}addReference(e,t,s){return Em(e,s)}removeReference(e,t,s){return Em(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return Em(e,t)}br(e,t){return(function(i,a){let l=!1;return _1(i).te((u=>y1(i,u,a).next((f=>(f&&(l=!0),X.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,((l,u)=>{if(u<=t){const f=this.br(e,l).next((m=>{if(!m)return a++,s.getEntry(e,l).next((()=>(s.removeEntry(l,Me.min()),vo(e).delete((function(T){return[0,Hn(T.path)]})(l)))))}));i.push(f)}})).next((()=>X.waitFor(i))).next((()=>s.apply(e))).next((()=>a))}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return Em(e,t)}Sr(e,t){const s=vo(e);let i,a=ls.ce;return s.ee({index:C0},(([l,u],{path:f,sequenceNumber:m})=>{l===0?(a!==ls.ce&&t(new Te(ji(i)),a),a=m,i=f):a=ls.ce})).next((()=>{a!==ls.ce&&t(new Te(ji(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Em(n,e){return vo(n).put((function(s,i){return{targetId:0,path:Hn(s.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(){this.changes=new Rr((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Mt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?X.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m5{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return Ia(e).put(s)}removeEntry(e,t,s){return Ia(e).delete((function(a,l){const u=a.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],ip(l),u[u.length-1]]})(t,s))}updateMetadata(e,t){return this.getMetadata(e).next((s=>(s.byteSize+=t,this.Dr(e,s))))}getEntry(e,t){let s=Mt.newInvalidDocument(t);return Ia(e).ee({index:Rm,range:IDBKeyRange.only(fd(t))},((i,a)=>{s=this.Cr(t,a)})).next((()=>s))}vr(e,t){let s={size:0,document:Mt.newInvalidDocument(t)};return Ia(e).ee({index:Rm,range:IDBKeyRange.only(fd(t))},((i,a)=>{s={document:this.Cr(t,a),size:op(a)}})).next((()=>s))}getEntries(e,t){let s=us();return this.Fr(e,t,((i,a)=>{const l=this.Cr(i,a);s=s.insert(i,l)})).next((()=>s))}Mr(e,t){let s=us(),i=new St(Te.comparator);return this.Fr(e,t,((a,l)=>{const u=this.Cr(a,l);s=s.insert(a,u),i=i.insert(a,op(l))})).next((()=>({documents:s,Or:i})))}Fr(e,t,s){if(t.isEmpty())return X.resolve();let i=new Tt(dw);t.forEach((f=>i=i.add(f)));const a=IDBKeyRange.bound(fd(i.first()),fd(i.last())),l=i.getIterator();let u=l.getNext();return Ia(e).ee({index:Rm,range:a},((f,m,_)=>{const T=Te.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;u&&dw(u,T)<0;)s(u,null),u=l.getNext();u&&u.isEqual(T)&&(s(u,m),u=l.hasNext()?l.getNext():null),u?_.j(fd(u)):_.done()})).next((()=>{for(;u;)s(u,null),u=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,s,i,a){const l=t.path,u=[l.popLast().toArray(),l.lastSegment(),ip(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ia(e).J(IDBKeyRange.bound(u,f,!0)).next((m=>{a==null||a.incrementDocumentReadCount(m.length);let _=us();for(const T of m){const x=this.Cr(Te.fromSegments(T.prefixPath.concat(T.collectionGroup,T.documentId)),T);x.isFoundDocument()&&(Nh(t,x)||i.has(x.key))&&(_=_.insert(x.key,x))}return _}))}getAllFromCollectionGroup(e,t,s,i){let a=us();const l=uw(t,s),u=uw(t,ws.max());return Ia(e).ee({index:aR,range:IDBKeyRange.bound(l,u,!0)},((f,m,_)=>{const T=this.Cr(Te.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);a=a.insert(T.key,T),a.size===i&&_.done()})).next((()=>a))}newChangeBuffer(e){return new p5(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return cw(e).get(iv).next((t=>(Pe(!!t,20021),t)))}Dr(e,t){return cw(e).put(iv,t)}Cr(e,t){if(t){const s=ZF(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(Me.min())))return s}return Mt.newInvalidDocument(e)}}function x1(n){return new m5(n)}class p5 extends T1{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Rr((s=>s.toString()),((s,i)=>s.isEqual(i)))}applyChanges(e){const t=[];let s=0,i=new Tt(((a,l)=>ze(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const u=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,u.readTime)),l.isValidDocument()){const f=$A(this.Nr.serializer,l);i=i.add(a.path.popLast());const m=op(f);s+=m-u.size,t.push(this.Nr.addEntry(e,a,f))}else if(s-=u.size,this.trackRemovals){const f=$A(this.Nr.serializer,l.convertToNoDocument(Me.min()));t.push(this.Nr.addEntry(e,a,f))}})),i.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,s)),X.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((s=>(this.Br.set(t,{size:s.size,readTime:s.document.readTime}),s.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:s,Or:i})=>(i.forEach(((a,l)=>{this.Br.set(a,{size:l,readTime:s.get(a).readTime})})),s)))}}function cw(n){return yn(n,Zd)}function Ia(n){return yn(n,Zm)}function fd(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function uw(n,e){const t=e.documentKey.path.toArray();return[n,ip(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function dw(n,e){const t=n.path.toArray(),s=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<s.length-2;++a)if(i=ze(t[a],s[a]),i)return i;return i=ze(t.length,s.length),i||(i=ze(t[t.length-2],s[s.length-2]),i||ze(t[t.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(e,t,s,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=i}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(s=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(s!==null&&Ud(s.mutation,i,cs.empty(),gt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,Je()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=Je()){const i=Gi();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,s).next((a=>{let l=Ed();return a.forEach(((u,f)=>{l=l.insert(u,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const s=Gi();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,Je())))}populateOverlays(e,t,s){const i=[];return s.forEach((a=>{t.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((l,u)=>{t.set(l,u)}))}))}computeViews(e,t,s,i){let a=us();const l=Ld(),u=(function(){return Ld()})();return t.forEach(((f,m)=>{const _=s.get(m.key);i.has(m.key)&&(_===void 0||_.mutation instanceof Pr)?a=a.insert(m.key,m):_!==void 0?(l.set(m.key,_.mutation.getFieldMask()),Ud(_.mutation,m,_.mutation.getFieldMask(),gt.now())):l.set(m.key,cs.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((m,_)=>l.set(m,_))),t.forEach(((m,_)=>u.set(m,new g5(_,l.get(m)??null)))),u)))}recalculateAndSaveOverlays(e,t){const s=Ld();let i=new St(((l,u)=>l-u)),a=Je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const u of l)u.keys().forEach((f=>{const m=t.get(f);if(m===null)return;let _=s.get(f)||cs.empty();_=u.applyToLocalView(m,_),s.set(f,_);const T=(i.get(u.batchId)||Je()).add(f);i=i.insert(u.batchId,T)}))})).next((()=>{const l=[],u=i.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),m=f.key,_=f.value,T=FR();_.forEach((x=>{if(!a.has(x)){const b=$R(t.get(x),s.get(x));b!==null&&T.set(x,b),a=a.add(x)}})),l.push(this.documentOverlayCache.saveOverlays(e,m,T))}return X.waitFor(l)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,i){return(function(l){return Te.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):L0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,i):this.getDocumentsMatchingCollectionQuery(e,t,s,i)}getNextDocuments(e,t,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,i).next((a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,i-a.size):X.resolve(Gi());let u=bc,f=a;return l.next((m=>X.forEach(m,((_,T)=>(u<T.largestBatchId&&(u=T.largestBatchId),a.get(_)?X.resolve():this.remoteDocumentCache.getEntry(e,_).next((x=>{f=f.insert(_,x)}))))).next((()=>this.populateOverlays(e,m,a))).next((()=>this.computeViews(e,f,m,Je()))).next((_=>({batchId:u,changes:OR(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Te(t)).next((s=>{let i=Ed();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,i){const a=t.collectionGroup;let l=Ed();return this.indexManager.getCollectionParents(e,a).next((u=>X.forEach(u,(f=>{const m=(function(T,x){return new Cr(x,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)})(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,m,s,i).next((_=>{_.forEach(((T,x)=>{l=l.insert(T,x)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,s,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,a,i)))).next((l=>{a.forEach(((f,m)=>{const _=m.getKey();l.get(_)===null&&(l=l.insert(_,Mt.newInvalidDocument(_)))}));let u=Ed();return l.forEach(((f,m)=>{const _=a.get(f);_!==void 0&&Ud(_.mutation,m,cs.empty(),gt.now()),Nh(t,m)&&(u=u.insert(f,m))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y5{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return X.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Xt(i.createTime)}})(t)),X.resolve()}getNamedQuery(e,t){return X.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:z0(i.bundledQuery),readTime:Xt(i.readTime)}})(t)),X.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _5{constructor(){this.overlays=new St(Te.comparator),this.qr=new Map}getOverlay(e,t){return X.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Gi();return X.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&s.set(i,a)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((i,a)=>{this.St(e,t,a)})),X.resolve()}removeOverlaysForBatchId(e,t,s){const i=this.qr.get(s);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(s)),X.resolve()}getOverlaysForCollection(e,t,s){const i=Gi(),a=t.length+1,l=new Te(t.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const f=u.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===a&&f.largestBatchId>s&&i.set(f.getKey(),f)}return X.resolve(i)}getOverlaysForCollectionGroup(e,t,s,i){let a=new St(((m,_)=>m-_));const l=this.overlays.getIterator();for(;l.hasNext();){const m=l.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>s){let _=a.get(m.largestBatchId);_===null&&(_=Gi(),a=a.insert(m.largestBatchId,_)),_.set(m.getKey(),m)}}const u=Gi(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((m,_)=>u.set(m,_))),!(u.size()>=i)););return X.resolve(u)}St(e,t,s){const i=this.overlays.get(s.key);if(i!==null){const l=this.qr.get(i.largestBatchId).delete(s.key);this.qr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(s.key,new G0(t,s));let a=this.qr.get(t);a===void 0&&(a=Je(),this.qr.set(t,a)),this.qr.set(t,a.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v5{constructor(){this.sessionToken=Ht.EMPTY_BYTE_STRING}getSessionToken(e){return X.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,X.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(){this.Qr=new Tt(xn.$r),this.Ur=new Tt(xn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new xn(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Gr(new xn(e,t))}zr(e,t){e.forEach((s=>this.removeReference(s,t)))}jr(e){const t=new Te(new tt([])),s=new xn(t,e),i=new xn(t,e+1),a=[];return this.Ur.forEachInRange([s,i],(l=>{this.Gr(l),a.push(l.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Te(new tt([])),s=new xn(t,e),i=new xn(t,e+1);let a=Je();return this.Ur.forEachInRange([s,i],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new xn(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class xn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Te.comparator(e.key,t.key)||ze(e.Yr,t.Yr)}static Kr(e,t){return ze(e.Yr,t.Yr)||Te.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Tt(xn.$r)}checkEmpty(e){return X.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new B0(a,t,s,i);this.mutationQueue.push(l);for(const u of i)this.Zr=this.Zr.add(new xn(u.key,a)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return X.resolve(l)}lookupMutationBatch(e,t){return X.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,i=this.ei(s),a=i<0?0:i;return X.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return X.resolve(this.mutationQueue.length===0?No:this.tr-1)}getAllMutationBatches(e){return X.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new xn(t,0),i=new xn(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([s,i],(l=>{const u=this.Xr(l.Yr);a.push(u)})),X.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Tt(ze);return t.forEach((i=>{const a=new xn(i,0),l=new xn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],(u=>{s=s.add(u.Yr)}))})),X.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,i=s.length+1;let a=s;Te.isDocumentKey(a)||(a=a.child(""));const l=new xn(new Te(a),0);let u=new Tt(ze);return this.Zr.forEachWhile((f=>{const m=f.key.path;return!!s.isPrefixOf(m)&&(m.length===i&&(u=u.add(f.Yr)),!0)}),l),X.resolve(this.ti(u))}ti(e){const t=[];return e.forEach((s=>{const i=this.Xr(s);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Pe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return X.forEach(t.mutations,(i=>{const a=new xn(i.key,t.batchId);return s=s.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,t){const s=new xn(t,0),i=this.Zr.firstAfterOrEqual(s);return X.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,X.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T5{constructor(e){this.ri=e,this.docs=(function(){return new St(Te.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,i=this.docs.get(s),a=i?i.size:0,l=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return X.resolve(s?s.document.mutableCopy():Mt.newInvalidDocument(t))}getEntries(e,t){let s=us();return t.forEach((i=>{const a=this.docs.get(i);s=s.insert(i,a?a.document.mutableCopy():Mt.newInvalidDocument(i))})),X.resolve(s)}getDocumentsMatchingQuery(e,t,s,i){let a=us();const l=t.path,u=new Te(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:m,value:{document:_}}=f.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||N0(tR(_),s)<=0||(i.has(_.key)||Nh(t,_))&&(a=a.insert(_.key,_.mutableCopy()))}return X.resolve(a)}getAllFromCollectionGroup(e,t,s,i){we(9500)}ii(e,t){return X.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new x5(this)}getSize(e){return X.resolve(this.size)}}class x5 extends T1{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(s)})),X.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I5{constructor(e){this.persistence=e,this.si=new Rr((t=>$a(t)),Ah),this.lastRemoteSnapshotVersion=Me.min(),this.highestTargetId=0,this.oi=0,this._i=new K0,this.targetCount=0,this.ai=Wa.ur()}forEachTarget(e,t){return this.si.forEach(((s,i)=>t(i))),X.resolve()}getLastRemoteSnapshotVersion(e){return X.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return X.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),X.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),X.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Wa(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,X.resolve()}updateTargetData(e,t){return this.Pr(t),X.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,X.resolve()}removeTargets(e,t,s){let i=0;const a=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=t&&s.get(u.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),X.waitFor(a).next((()=>i))}getTargetCount(e){return X.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return X.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),X.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((l=>{a.push(i.markPotentiallyOrphaned(e,l))})),X.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),X.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return X.resolve(s)}containsKey(e,t){return X.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e,t){this.ui={},this.overlays={},this.ci=new ls(0),this.li=!1,this.li=!0,this.hi=new v5,this.referenceDelegate=e(this),this.Pi=new I5(this),this.indexManager=new a5,this.remoteDocumentCache=(function(i){return new T5(i)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new d1(t),this.Ii=new y5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new _5,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new E5(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){fe("MemoryPersistence","Starting transaction:",e);const i=new b5(this.ci.next());return this.referenceDelegate.Ei(),s(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,t){return X.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,t))))}}class b5 extends sR{constructor(e){super(),this.currentSequenceNumber=e}}class $p{constructor(e){this.persistence=e,this.Ri=new K0,this.Vi=null}static mi(e){return new $p(e)}get fi(){if(this.Vi)return this.Vi;throw we(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),X.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),X.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),X.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>s.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return X.forEach(this.fi,(s=>{const i=Te.fromPath(s);return this.gi(e,i).next((a=>{a||t.removeEntry(i,Me.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return X.or([()=>X.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class ap{constructor(e,t){this.persistence=e,this.pi=new Rr((s=>Hn(s.path)),((s,i)=>s.isEqual(i))),this.garbageCollector=E1(this,t)}static mi(e,t){return new ap(e,t)}Ei(){}di(e){return X.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((i=>s+i))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}pr(e,t){return X.forEach(this.pi,((s,i)=>this.br(e,s,i).next((a=>a?X.resolve():t(i)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(l=>this.br(e,l,t).next((u=>{u||(s++,a.removeEntry(l,Me.min()))})))).next((()=>a.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),X.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),X.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),X.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),X.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Dm(e.data.value)),t}br(e,t,s){return X.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return X.resolve(i!==void 0&&i>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A5{constructor(e){this.serializer=e}k(e,t,s,i){const a=new Vp("createOrUpgrade",t);s<1&&i>=1&&((function(f){f.createObjectStore(bh)})(e),(function(f){f.createObjectStore(Xd,{keyPath:jO}),f.createObjectStore(ii,{keyPath:xA,autoIncrement:!0}).createIndex(Ma,IA,{unique:!0}),f.createObjectStore(Ac)})(e),hw(e),(function(f){f.createObjectStore(wa)})(e));let l=X.resolve();return s<3&&i>=3&&(s!==0&&((function(f){f.deleteObjectStore(Nc),f.deleteObjectStore(wc),f.deleteObjectStore(Ba)})(e),hw(e)),l=l.next((()=>(function(f){const m=f.store(Ba),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Me.min().toTimestamp(),targetCount:0};return m.put(ep,_)})(a)))),s<4&&i>=4&&(s!==0&&(l=l.next((()=>(function(f,m){return m.store(ii).J().next((T=>{f.deleteObjectStore(ii),f.createObjectStore(ii,{keyPath:xA,autoIncrement:!0}).createIndex(Ma,IA,{unique:!0});const x=m.store(ii),b=T.map((k=>x.put(k)));return X.waitFor(b)}))})(e,a)))),l=l.next((()=>{(function(f){f.createObjectStore(Sc,{keyPath:QO})})(e)}))),s<5&&i>=5&&(l=l.next((()=>this.yi(a)))),s<6&&i>=6&&(l=l.next((()=>((function(f){f.createObjectStore(Zd)})(e),this.wi(a))))),s<7&&i>=7&&(l=l.next((()=>this.Si(a)))),s<8&&i>=8&&(l=l.next((()=>this.bi(e,a)))),s<9&&i>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),s<10&&i>=10&&(l=l.next((()=>this.Di(a)))),s<11&&i>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(Lp,{keyPath:WO})})(e),(function(f){f.createObjectStore(Up,{keyPath:XO})})(e)}))),s<12&&i>=12&&(l=l.next((()=>{(function(f){const m=f.createObjectStore(Op,{keyPath:rF});m.createIndex(ov,oF,{unique:!1}),m.createIndex(dR,aF,{unique:!1})})(e)}))),s<13&&i>=13&&(l=l.next((()=>(function(f){const m=f.createObjectStore(Zm,{keyPath:qO});m.createIndex(Rm,HO),m.createIndex(aR,zO)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(wa)))),s<14&&i>=14&&(l=l.next((()=>this.Fi(e,a)))),s<15&&i>=15&&(l=l.next((()=>(function(f){f.createObjectStore(R0,{keyPath:ZO,autoIncrement:!0}).createIndex(rv,eF,{unique:!1}),f.createObjectStore(Md,{keyPath:tF}).createIndex(cR,nF,{unique:!1}),f.createObjectStore(kd,{keyPath:sF}).createIndex(uR,iF,{unique:!1})})(e)))),s<16&&i>=16&&(l=l.next((()=>{t.objectStore(Md).clear()})).next((()=>{t.objectStore(kd).clear()}))),s<17&&i>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(P0,{keyPath:lF})})(e)}))),s<18&&i>=18&&SS()&&(l=l.next((()=>{t.objectStore(Md).clear()})).next((()=>{t.objectStore(kd).clear()}))),l}wi(e){let t=0;return e.store(wa).ee(((s,i)=>{t+=op(i)})).next((()=>{const s={byteSize:t};return e.store(Zd).put(iv,s)}))}yi(e){const t=e.store(Xd),s=e.store(ii);return t.J().next((i=>X.forEach(i,(a=>{const l=IDBKeyRange.bound([a.userId,No],[a.userId,a.lastAcknowledgedBatchId]);return s.J(Ma,l).next((u=>X.forEach(u,(f=>{Pe(f.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const m=Sa(this.serializer,f);return g1(e,a.userId,m).next((()=>{}))}))))}))))}Si(e){const t=e.store(Nc),s=e.store(wa);return e.store(Ba).get(ep).next((i=>{const a=[];return s.ee(((l,u)=>{const f=new tt(l),m=(function(T){return[0,Hn(T)]})(f);a.push(t.get(m).next((_=>_?X.resolve():(T=>t.put({targetId:0,path:Hn(T),sequenceNumber:i.highestListenSequenceNumber}))(f))))})).next((()=>X.waitFor(a)))}))}bi(e,t){e.createObjectStore(eh,{keyPath:JO});const s=t.store(eh),i=new Y0,a=l=>{if(i.add(l)){const u=l.lastSegment(),f=l.popLast();return s.put({collectionId:u,parent:Hn(f)})}};return t.store(wa).ee({X:!0},((l,u)=>{const f=new tt(l);return a(f.popLast())})).next((()=>t.store(Ac).ee({X:!0},(([l,u,f],m)=>{const _=ji(u);return a(_.popLast())}))))}Di(e){const t=e.store(wc);return t.ee(((s,i)=>{const a=xd(i),l=h1(this.serializer,a);return t.put(l)}))}Ci(e,t){const s=t.store(wa),i=[];return s.ee(((a,l)=>{const u=t.store(Zm),f=(function(T){return T.document?new Te(tt.fromString(T.document.name).popFirst(5)):T.noDocument?Te.fromSegments(T.noDocument.path):T.unknownDocument?Te.fromSegments(T.unknownDocument.path):we(36783)})(l).path.toArray(),m={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(u.put(m))})).next((()=>X.waitFor(i)))}Fi(e,t){const s=t.store(ii),i=x1(this.serializer),a=new J0($p.mi,this.serializer.yt);return s.J().next((l=>{const u=new Map;return l.forEach((f=>{let m=u.get(f.userId)??Je();Sa(this.serializer,f).keys().forEach((_=>m=m.add(_))),u.set(f.userId,m)})),X.forEach(u,((f,m)=>{const _=new In(m),T=Hp.wt(this.serializer,_),x=a.getIndexManager(_),b=zp.wt(_,this.serializer,x,a.referenceDelegate);return new I1(i,b,T,x).recalculateAndSaveOverlaysForDocumentKeys(new av(t,ls.ce),f).next()}))}))}}function hw(n){n.createObjectStore(Nc,{keyPath:YO}).createIndex(C0,KO,{unique:!0}),n.createObjectStore(wc,{keyPath:"targetId"}).createIndex(lR,$O,{unique:!0}),n.createObjectStore(Ba)}const yo="IndexedDbPersistence",k_=18e5,V_=5e3,L_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",b1="main";class Q0{constructor(e,t,s,i,a,l,u,f,m,_,T=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Mi=a,this.window=l,this.document=u,this.xi=m,this.Oi=_,this.Ni=T,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=x=>Promise.resolve(),!Q0.v())throw new he(ie.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new f5(this,i),this.$i=t+b1,this.serializer=new d1(f),this.Ui=new qi(this.$i,this.Ni,new A5(this.serializer)),this.hi=new t5,this.Pi=new c5(this.referenceDelegate,this.serializer),this.remoteDocumentCache=x1(this.serializer),this.Ii=new e5,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,_===!1&&Wt(yo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new he(ie.FAILED_PRECONDITION,L_);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new ls(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Tm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ho(e))return fe(yo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe(yo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return md(e).get(Wl).next((t=>X.resolve(this.es(t))))}ts(e){return Tm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,k_)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const s=yn(t,Sc);return s.J().next((i=>{const a=this.ss(i,k_),l=i.filter((u=>a.indexOf(u)===-1));return X.forEach(l,(u=>s.delete(u.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?X.resolve(!0):md(e).get(Wl).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,V_)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new he(ie.FAILED_PRECONDITION,L_);return!1}}return!(!this.networkEnabled||!this.inForeground)||Tm(e).J().next((s=>this.ss(s,V_).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,l=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(a||l&&u)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&fe(yo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[bh,Sc],(e=>{const t=new av(e,ls.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((s=>this.rs(s.updateTimeMs,t)&&!this.us(s.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Tm(e).J().next((t=>this.ss(t,k_).map((s=>s.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return zp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new l5(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Hp.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,s){fe(yo,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=(function(f){return f===18?dF:f===17?pR:f===16?uF:f===15?D0:f===14?mR:f===13?fR:f===12?cF:f===11?hR:void we(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,i,a,(u=>(l=new av(u,this.ci?this.ci.next():ls.ce),t==="readwrite-primary"?this.Hi(l).next((f=>!!f||this.Yi(l))).next((f=>{if(!f)throw Wt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new he(ie.FAILED_PRECONDITION,nR);return s(l)})).next((f=>this.Xi(l).next((()=>f)))):this.Is(l).next((()=>s(l)))))).then((u=>(l.raiseOnCommittedEvent(),u)))}Is(e){return md(e).get(Wl).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,V_)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new he(ie.FAILED_PRECONDITION,L_)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return md(e).put(Wl,t)}static v(){return qi.v()}Zi(e){const t=md(e);return t.get(Wl).next((s=>this.es(s)?(fe(yo,"Releasing primary lease."),t.delete(Wl)):X.resolve()))}rs(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(Wt(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;NS()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const s=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return fe(yo,`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return Wt(yo,"Failed to get zombied client id.",s),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Wt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function md(n){return yn(n,bh)}function Tm(n){return yn(n,Sc)}function W0(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e,t,s,i){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=i}static As(e,t){let s=Je(),i=Je();for(const a of t.docChanges)switch(a.type){case 0:s=s.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new X0(e,t.fromCache,s,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return NS()?8:iR(Bt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,i){const a={result:null};return this.ys(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ws(e,t,i,s).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new w5;return this.Ss(e,t,l).next((u=>{if(a.result=u,this.Vs)return this.bs(e,t,l,u.size)}))})).next((()=>a.result))}bs(e,t,s,i){return s.documentReadCount<this.fs?(sc()<=et.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",ic(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),X.resolve()):(sc()<=et.DEBUG&&fe("QueryEngine","Query:",ic(t),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.gs*i?(sc()<=et.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",ic(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wn(t))):X.resolve())}ys(e,t){if(LA(t))return X.resolve(null);let s=Wn(t);return this.indexManager.getIndexType(e,s).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=sp(t,null,"F"),s=Wn(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((a=>{const l=Je(...a);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,s).next((f=>{const m=this.Ds(t,u);return this.Cs(t,m,l,f.readTime)?this.ys(e,sp(t,null,"F")):this.vs(e,m,t,f)}))))})))))}ws(e,t,s,i){return LA(t)||i.isEqual(Me.min())?X.resolve(null):this.ps.getDocuments(e,s).next((a=>{const l=this.Ds(t,a);return this.Cs(t,l,s,i)?X.resolve(null):(sc()<=et.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ic(t)),this.vs(e,l,t,eR(i,bc)).next((u=>u)))}))}Ds(e,t){let s=new Tt(LR(e));return t.forEach(((i,a)=>{Nh(e,a)&&(s=s.add(a))})),s}Cs(e,t,s,i){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,s){return sc()<=et.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",ic(t)),this.ps.getDocumentsMatchingQuery(e,t,ws.min(),s)}vs(e,t,s,i){return this.ps.getDocumentsMatchingQuery(e,s,i).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0="LocalStore",N5=3e8;class S5{constructor(e,t,s,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new St(ze),this.xs=new Rr((a=>$a(a)),Ah),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new I1(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function w1(n,e,t,s){return new S5(n,e,t,s)}async function N1(n,e){const t=be(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let i;return t.mutationQueue.getAllMutationBatches(s).next((a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(s)))).next((a=>{const l=[],u=[];let f=Je();for(const m of i){l.push(m.batchId);for(const _ of m.mutations)f=f.add(_.key)}for(const m of a){u.push(m.batchId);for(const _ of m.mutations)f=f.add(_.key)}return t.localDocuments.getDocuments(s,f).next((m=>({Ls:m,removedBatchIds:l,addedBatchIds:u})))}))}))}function C5(n,e){const t=be(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,f,m,_){const T=m.batch,x=T.keys();let b=X.resolve();return x.forEach((k=>{b=b.next((()=>_.getEntry(f,k))).next((G=>{const F=m.docVersions.get(k);Pe(F!==null,48541),G.version.compareTo(F)<0&&(T.applyToRemoteDocument(G,m),G.isValidDocument()&&(G.setReadTime(m.commitVersion),_.addEntry(G)))}))})),b.next((()=>u.mutationQueue.removeMutationBatch(f,T)))})(t,s,e,a).next((()=>a.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(u){let f=Je();for(let m=0;m<u.mutationResults.length;++m)u.mutationResults[m].transformResults.length>0&&(f=f.add(u.batch.mutations[m].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(s,i)))}))}function S1(n){const e=be(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function R5(n,e){const t=be(n),s=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const u=[];e.targetChanges.forEach(((_,T)=>{const x=i.get(T);if(!x)return;u.push(t.Pi.removeMatchingKeys(a,_.removedDocuments,T).next((()=>t.Pi.addMatchingKeys(a,_.addedDocuments,T))));let b=x.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(T)!==null?b=b.withResumeToken(Ht.EMPTY_BYTE_STRING,Me.min()).withLastLimboFreeSnapshotVersion(Me.min()):_.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(_.resumeToken,s)),i=i.insert(T,b),(function(G,F,Y){return G.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-G.snapshotVersion.toMicroseconds()>=N5?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0})(x,b,_)&&u.push(t.Pi.updateTargetData(a,b))}));let f=us(),m=Je();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(a,_))})),u.push(C1(a,l,e.documentUpdates).next((_=>{f=_.ks,m=_.qs}))),!s.isEqual(Me.min())){const _=t.Pi.getLastRemoteSnapshotVersion(a).next((T=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,s)));u.push(_)}return X.waitFor(u).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,f,m))).next((()=>f))})).then((a=>(t.Ms=i,a)))}function C1(n,e,t){let s=Je(),i=Je();return t.forEach((a=>s=s.add(a))),e.getEntries(n,s).next((a=>{let l=us();return t.forEach(((u,f)=>{const m=a.get(u);f.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(u)),f.isNoDocument()&&f.version.isEqual(Me.min())?(e.removeEntry(u,f.readTime),l=l.insert(u,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||f.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(f),l=l.insert(u,f)):fe(Z0,"Ignoring outdated watch update for ",u,". Current version:",m.version," Watch version:",f.version)})),{ks:l,qs:i}}))}function P5(n,e){const t=be(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=No),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function Vc(n,e){const t=be(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let i;return t.Pi.getTargetData(s,e).next((a=>a?(i=a,X.resolve(i)):t.Pi.allocateTargetId(s).next((l=>(i=new gr(e,l,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,i).next((()=>i)))))))})).then((s=>{const i=t.Ms.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s}))}async function Lc(n,e,t){const s=be(n),i=s.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",a,(l=>s.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Ho(l))throw l;fe(Z0,`Failed to update sequence numbers for target ${e}: ${l}`)}s.Ms=s.Ms.remove(e),s.xs.delete(i.target)}function lp(n,e,t){const s=be(n);let i=Me.min(),a=Je();return s.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,m,_){const T=be(f),x=T.xs.get(_);return x!==void 0?X.resolve(T.Ms.get(x)):T.Pi.getTargetData(m,_)})(s,l,Wn(e)).next((u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(l,u.targetId).next((f=>{a=f}))})).next((()=>s.Fs.getDocumentsMatchingQuery(l,e,t?i:Me.min(),t?a:Je()))).next((u=>(D1(s,VR(e),u),{documents:u,Qs:a})))))}function R1(n,e){const t=be(n),s=be(t.Pi),i=t.Ms.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(a=>s.At(a,e).next((l=>l?l.target:null))))}function P1(n,e){const t=be(n),s=t.Os.get(e)||Me.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.Ns.getAllFromCollectionGroup(i,e,eR(s,bc),Number.MAX_SAFE_INTEGER))).then((i=>(D1(t,e,i),i)))}function D1(n,e,t){let s=n.Os.get(e)||Me.min();t.forEach(((i,a)=>{a.readTime.compareTo(s)>0&&(s=a.readTime)})),n.Os.set(e,s)}async function D5(n,e,t,s){const i=be(n);let a=Je(),l=us();for(const m of t){const _=e.$s(m.metadata.name);m.document&&(a=a.add(_));const T=e.Us(m);T.setReadTime(e.Ks(m.metadata.readTime)),l=l.insert(_,T)}const u=i.Ns.newChangeBuffer({trackRemovals:!0}),f=await Vc(i,(function(_){return Wn(Kc(tt.fromString(`__bundle__/docs/${_}`)))})(s));return i.persistence.runTransaction("Apply bundle documents","readwrite",(m=>C1(m,u,l).next((_=>(u.apply(m),_))).next((_=>i.Pi.removeMatchingKeysForTargetId(m,f.targetId).next((()=>i.Pi.addMatchingKeys(m,a,f.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(m,_.ks,_.qs))).next((()=>_.ks))))))}async function M5(n,e,t=Je()){const s=await Vc(n,Wn(z0(e.bundledQuery))),i=be(n);return i.persistence.runTransaction("Save named query","readwrite",(a=>{const l=Xt(e.readTime);if(s.snapshotVersion.compareTo(l)>=0)return i.Ii.saveNamedQuery(a,e);const u=s.withResumeToken(Ht.EMPTY_BYTE_STRING,l);return i.Ms=i.Ms.insert(u.targetId,u),i.Pi.updateTargetData(a,u).next((()=>i.Pi.removeMatchingKeysForTargetId(a,s.targetId))).next((()=>i.Pi.addMatchingKeys(a,t,s.targetId))).next((()=>i.Ii.saveNamedQuery(a,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1="firestore_clients";function fw(n,e){return`${M1}_${n}_${e}`}const k1="firestore_mutations";function mw(n,e,t){let s=`${k1}_${n}_${t}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}const V1="firestore_targets";function U_(n,e){return`${V1}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi="SharedClientState";class cp{constructor(e,t,s,i){this.user=e,this.batchId=t,this.state=s,this.error=i}static Ws(e,t,s){const i=JSON.parse(s);let a,l=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return l&&i.error&&(l=typeof i.error.message=="string"&&typeof i.error.code=="string",l&&(a=new he(i.error.code,i.error.message))),l?new cp(e,t,i.state,a):(Wt(Vi,`Failed to parse mutation state for ID '${t}': ${s}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Od{constructor(e,t,s){this.targetId=e,this.state=t,this.error=s}static Ws(e,t){const s=JSON.parse(t);let i,a=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return a&&s.error&&(a=typeof s.error.message=="string"&&typeof s.error.code=="string",a&&(i=new he(s.error.code,s.error.message))),a?new Od(e,s.state,i):(Wt(Vi,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class up{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const s=JSON.parse(t);let i=typeof s=="object"&&s.activeTargetIds instanceof Array,a=U0();for(let l=0;i&&l<s.activeTargetIds.length;++l)i=rR(s.activeTargetIds[l]),a=a.add(s.activeTargetIds[l]);return i?new up(e,a):(Wt(Vi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class eE{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new eE(t.clientId,t.onlineState):(Wt(Vi,`Failed to parse online state: ${e}`),null)}}class xv{constructor(){this.activeTargetIds=U0()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class O_{constructor(e,t,s,i,a){this.window=e,this.Mi=t,this.persistenceKey=s,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new St(ze),this.started=!1,this.Xs=[];const l=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.eo=fw(this.persistenceKey,this.Js),this.no=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new xv),this.ro=new RegExp(`^${M1}_${l}_([^_]*)$`),this.io=new RegExp(`^${k1}_${l}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${V1}_${l}_(\\d+)$`),this.oo=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this._o=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const s of e){if(s===this.Js)continue;const i=this.getItem(fw(this.persistenceKey,s));if(i){const a=up.Ws(s,i);a&&(this.Zs=this.Zs.insert(a.clientId,a))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const s=this.uo(t);s&&this.co(s)}for(const s of this.Xs)this.Ys(s);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((s,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,s){this.ho(e,t,s),this.Po(e)}addLocalQueryTarget(e,t=!0){let s="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(U_(this.persistenceKey,e));if(i){const a=Od.Ws(e,i);a&&(s=a.state)}}return t&&this.To.zs(e),this.ao(),s}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(U_(this.persistenceKey,e))}updateQueryState(e,t,s){this.Io(e,t,s)}handleUserChange(e,t,s){t.forEach((i=>{this.Po(i)})),this.currentUser=e,s.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return fe(Vi,"READ",e,t),t}setItem(e,t){fe(Vi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){fe(Vi,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(fe(Vi,"EVENT",t.key,t.newValue),t.key===this.eo)return void Wt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const s=this.Ro(t.key);return this.Vo(s,null)}{const s=this.mo(t.key,t.newValue);if(s)return this.Vo(s.clientId,s)}}else if(this.io.test(t.key)){if(t.newValue!==null){const s=this.fo(t.key,t.newValue);if(s)return this.po(s)}}else if(this.so.test(t.key)){if(t.newValue!==null){const s=this.yo(t.key,t.newValue);if(s)return this.wo(s)}}else if(t.key===this.oo){if(t.newValue!==null){const s=this.uo(t.newValue);if(s)return this.co(s)}}else if(t.key===this.no){const s=(function(a){let l=ls.ce;if(a!=null)try{const u=JSON.parse(a);Pe(typeof u=="number",30636,{So:a}),l=u}catch(u){Wt(Vi,"Failed to read sequence number from WebStorage",u)}return l})(t.newValue);s!==ls.ce&&this.sequenceNumberHandler(s)}else if(t.key===this._o){const s=this.bo(t.newValue);await Promise.all(s.map((i=>this.syncEngine.Do(i))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,s){const i=new cp(this.currentUser,e,t,s),a=mw(this.persistenceKey,this.currentUser,e);this.setItem(a,i.Gs())}Po(e){const t=mw(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,s){const i=U_(this.persistenceKey,e),a=new Od(e,t,s);this.setItem(i,a.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const s=this.Ro(e);return up.Ws(s,t)}fo(e,t){const s=this.io.exec(e),i=Number(s[1]),a=s[2]!==void 0?s[2]:null;return cp.Ws(new In(a),i,t)}yo(e,t){const s=this.so.exec(e),i=Number(s[1]);return Od.Ws(i,t)}uo(e){return eE.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);fe(Vi,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const s=t?this.Zs.insert(e,t):this.Zs.remove(e),i=this.lo(this.Zs),a=this.lo(s),l=[],u=[];return a.forEach((f=>{i.has(f)||l.push(f)})),i.forEach((f=>{a.has(f)||u.push(f)})),this.syncEngine.Fo(l,u).then((()=>{this.Zs=s}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=U0();return e.forEach(((s,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class L1{constructor(){this.Mo=new xv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new xv,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pw="ConnectivityMonitor";class gw{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){fe(pw,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){fe(pw,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xm=null;function Iv(){return xm===null?xm=(function(){return 268435456+Math.round(2147483648*Math.random())})():xm++,"0x"+xm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_="RestConnection",V5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class L5{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${i}`,this.Wo=this.databaseId.database===lv?`project_id=${s}`:`project_id=${s}&database_id=${i}`}Go(e,t,s,i,a){const l=Iv(),u=this.zo(e,t.toUriEncodedString());fe(F_,`Sending RPC '${e}' ${l}:`,u,s);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,i,a);const{host:m}=new URL(u),_=Gc(m);return this.Jo(e,u,f,s,_).then((T=>(fe(F_,`Received RPC '${e}' ${l}: `,T),T)),(T=>{throw Yi(F_,`RPC '${e}' ${l} failed with error: `,T,"url: ",u,"request:",s),T}))}Ho(e,t,s,i,a,l){return this.Go(e,t,s,i,a)}jo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Yc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,a)=>e[a]=i)),s&&s.headers.forEach(((i,a)=>e[a]=i))}zo(e,t){const s=V5[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U5{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn="WebChannelConnection";class O5 extends L5{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,i,a){const l=Iv();return new Promise(((u,f)=>{const m=new qC;m.setWithCredentials(!0),m.listenOnce(HC.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Nm.NO_ERROR:const T=m.getResponseJson();fe(Bn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(T)),u(T);break;case Nm.TIMEOUT:fe(Bn,`RPC '${e}' ${l} timed out`),f(new he(ie.DEADLINE_EXCEEDED,"Request time out"));break;case Nm.HTTP_ERROR:const x=m.getStatus();if(fe(Bn,`RPC '${e}' ${l} failed with status:`,x,"response text:",m.getResponseText()),x>0){let b=m.getResponseJson();Array.isArray(b)&&(b=b[0]);const k=b==null?void 0:b.error;if(k&&k.status&&k.message){const G=(function(Y){const K=Y.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(K)>=0?K:ie.UNKNOWN})(k.status);f(new he(G,k.message))}else f(new he(ie.UNKNOWN,"Server responded with status "+m.getStatus()))}else f(new he(ie.UNAVAILABLE,"Connection failed."));break;default:we(9055,{l_:e,streamId:l,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{fe(Bn,`RPC '${e}' ${l} completed.`)}}));const _=JSON.stringify(i);fe(Bn,`RPC '${e}' ${l} sending request:`,i),m.send(t,"POST",_,s,15)}))}T_(e,t,s){const i=Iv(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=YC(),u=$C(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(f.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,s),f.encodeInitMessageHeaders=!0;const _=a.join("");fe(Bn,`Creating RPC '${e}' stream ${i}: ${_}`,f);const T=l.createWebChannel(_,f);this.I_(T);let x=!1,b=!1;const k=new U5({Yo:F=>{b?fe(Bn,`Not sending because RPC '${e}' stream ${i} is closed:`,F):(x||(fe(Bn,`Opening RPC '${e}' stream ${i} transport.`),T.open(),x=!0),fe(Bn,`RPC '${e}' stream ${i} sending:`,F),T.send(F))},Zo:()=>T.close()}),G=(F,Y,K)=>{F.listen(Y,(H=>{try{K(H)}catch(U){setTimeout((()=>{throw U}),0)}}))};return G(T,vd.EventType.OPEN,(()=>{b||(fe(Bn,`RPC '${e}' stream ${i} transport opened.`),k.o_())})),G(T,vd.EventType.CLOSE,(()=>{b||(b=!0,fe(Bn,`RPC '${e}' stream ${i} transport closed`),k.a_(),this.E_(T))})),G(T,vd.EventType.ERROR,(F=>{b||(b=!0,Yi(Bn,`RPC '${e}' stream ${i} transport errored. Name:`,F.name,"Message:",F.message),k.a_(new he(ie.UNAVAILABLE,"The operation could not be completed")))})),G(T,vd.EventType.MESSAGE,(F=>{var Y;if(!b){const K=F.data[0];Pe(!!K,16349);const H=K,U=(H==null?void 0:H.error)||((Y=H[0])==null?void 0:Y.error);if(U){fe(Bn,`RPC '${e}' stream ${i} received error:`,U);const z=U.status;let J=(function(S){const L=hn[S];if(L!==void 0)return JR(L)})(z),P=U.message;J===void 0&&(J=ie.INTERNAL,P="Unknown error status: "+z+" with message "+U.message),b=!0,k.a_(new he(J,P)),T.close()}else fe(Bn,`RPC '${e}' stream ${i} received:`,K),k.u_(K)}})),G(u,zC.STAT_EVENT,(F=>{F.stat===tv.PROXY?fe(Bn,`RPC '${e}' stream ${i} detected buffering proxy`):F.stat===tv.NOPROXY&&fe(Bn,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{k.__()}),0),k}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U1(){return typeof window<"u"?window:null}function Um(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ph(n){return new qF(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,t,s=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-s);i>0&&fe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw="PersistentStream";class O1{constructor(e,t,s,i,a,l,u,f){this.Mi=e,this.S_=s,this.b_=i,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new tE(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(Wt(t.toString()),Wt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,i])=>{this.D_===t&&this.G_(s,i)}),(s=>{e((()=>{const i=new he(ie.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(i)}))}))}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{s((()=>this.z_(i)))})),this.stream.onMessage((i=>{s((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return fe(yw,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(fe(yw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class F5 extends O1{constructor(e,t,s,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,i,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=$F(this.serializer,e),s=(function(a){if(!("targetChange"in a))return Me.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Me.min():l.readTime?Xt(l.readTime):Me.min()})(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=yv(this.serializer),t.addTarget=(function(a,l){let u;const f=l.target;if(u=tp(f)?{documents:r1(a,f)}:{query:o1(a,f).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=ZR(a,l.resumeToken);const m=pv(a,l.expectedCount);m!==null&&(u.expectedCount=m)}else if(l.snapshotVersion.compareTo(Me.min())>0){u.readTime=kc(a,l.snapshotVersion.toTimestamp());const m=pv(a,l.expectedCount);m!==null&&(u.expectedCount=m)}return u})(this.serializer,e);const s=KF(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=yv(this.serializer),t.removeTarget=e,this.q_(t)}}class B5 extends O1{constructor(e,t,s,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,i,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=YF(e.writeResults,e.commitTime),s=Xt(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=yv(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>oh(this.serializer,s)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j5{}class G5 extends j5{constructor(e,t,s,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new he(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Go(e,gv(t,s),i,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new he(ie.UNKNOWN,a.toString())}))}Ho(e,t,s,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,gv(t,s),i,l,u,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new he(ie.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class q5{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Wt(t),this.aa=!1):fe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa="RemoteStore";class H5{constructor(e,t,s,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((l=>{s.enqueueAndForget((async()=>{$o(this)&&(fe(Xa,"Restarting streams for network reachability change."),await(async function(f){const m=be(f);m.Ea.add(4),await Wc(m),m.Ra.set("Unknown"),m.Ea.delete(4),await Dh(m)})(this))}))})),this.Ra=new q5(s,i)}}async function Dh(n){if($o(n))for(const e of n.da)await e(!0)}async function Wc(n){for(const e of n.da)await e(!1)}function Yp(n,e){const t=be(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),iE(t)?sE(t):Zc(t).O_()&&nE(t,e))}function Uc(n,e){const t=be(n),s=Zc(t);t.Ia.delete(e),s.O_()&&F1(t,e),t.Ia.size===0&&(s.O_()?s.L_():$o(t)&&t.Ra.set("Unknown"))}function nE(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Me.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Zc(n).Y_(e)}function F1(n,e){n.Va.Ue(e),Zc(n).Z_(e)}function sE(n){n.Va=new FF({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Zc(n).start(),n.Ra.ua()}function iE(n){return $o(n)&&!Zc(n).x_()&&n.Ia.size>0}function $o(n){return be(n).Ea.size===0}function B1(n){n.Va=void 0}async function z5(n){n.Ra.set("Online")}async function $5(n){n.Ia.forEach(((e,t)=>{nE(n,e)}))}async function Y5(n,e){B1(n),iE(n)?(n.Ra.ha(e),sE(n)):n.Ra.set("Unknown")}async function K5(n,e,t){if(n.Ra.set("Online"),e instanceof XR&&e.state===2&&e.cause)try{await(async function(i,a){const l=a.cause;for(const u of a.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,l),i.Ia.delete(u),i.Va.removeTarget(u))})(n,e)}catch(s){fe(Xa,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await dp(n,s)}else if(e instanceof Vm?n.Va.Ze(e):e instanceof WR?n.Va.st(e):n.Va.tt(e),!t.isEqual(Me.min()))try{const s=await S1(n.localStore);t.compareTo(s)>=0&&await(function(a,l){const u=a.Va.Tt(l);return u.targetChanges.forEach(((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const _=a.Ia.get(m);_&&a.Ia.set(m,_.withResumeToken(f.resumeToken,l))}})),u.targetMismatches.forEach(((f,m)=>{const _=a.Ia.get(f);if(!_)return;a.Ia.set(f,_.withResumeToken(Ht.EMPTY_BYTE_STRING,_.snapshotVersion)),F1(a,f);const T=new gr(_.target,f,m,_.sequenceNumber);nE(a,T)})),a.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(s){fe(Xa,"Failed to raise snapshot:",s),await dp(n,s)}}async function dp(n,e,t){if(!Ho(e))throw e;n.Ea.add(1),await Wc(n),n.Ra.set("Offline"),t||(t=()=>S1(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{fe(Xa,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Dh(n)}))}function j1(n,e){return e().catch((t=>dp(n,t,e)))}async function Xc(n){const e=be(n),t=Uo(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:No;for(;J5(e);)try{const i=await P5(e.localStore,s);if(i===null){e.Ta.length===0&&t.L_();break}s=i.batchId,Q5(e,i)}catch(i){await dp(e,i)}G1(e)&&q1(e)}function J5(n){return $o(n)&&n.Ta.length<10}function Q5(n,e){n.Ta.push(e);const t=Uo(n);t.O_()&&t.X_&&t.ea(e.mutations)}function G1(n){return $o(n)&&!Uo(n).x_()&&n.Ta.length>0}function q1(n){Uo(n).start()}async function W5(n){Uo(n).ra()}async function X5(n){const e=Uo(n);for(const t of n.Ta)e.ea(t.mutations)}async function Z5(n,e,t){const s=n.Ta.shift(),i=j0.from(s,e,t);await j1(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Xc(n)}async function e6(n,e){e&&Uo(n).X_&&await(async function(s,i){if((function(l){return KR(l)&&l!==ie.ABORTED})(i.code)){const a=s.Ta.shift();Uo(s).B_(),await j1(s,(()=>s.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Xc(s)}})(n,e),G1(n)&&q1(n)}async function _w(n,e){const t=be(n);t.asyncQueue.verifyOperationInProgress(),fe(Xa,"RemoteStore received new credentials");const s=$o(t);t.Ea.add(3),await Wc(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Dh(t)}async function bv(n,e){const t=be(n);e?(t.Ea.delete(2),await Dh(t)):e||(t.Ea.add(2),await Wc(t),t.Ra.set("Unknown"))}function Zc(n){return n.ma||(n.ma=(function(t,s,i){const a=be(t);return a.sa(),new F5(s,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:z5.bind(null,n),t_:$5.bind(null,n),r_:Y5.bind(null,n),H_:K5.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),iE(n)?sE(n):n.Ra.set("Unknown")):(await n.ma.stop(),B1(n))}))),n.ma}function Uo(n){return n.fa||(n.fa=(function(t,s,i){const a=be(t);return a.sa(),new B5(s,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:W5.bind(null,n),r_:e6.bind(null,n),ta:X5.bind(null,n),na:Z5.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Xc(n)):(await n.fa.stop(),n.Ta.length>0&&(fe(Xa,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(e,t,s,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=i,this.removalCallback=a,this.deferred=new Ln,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,i,a){const l=Date.now()+s,u=new rE(e,t,l,i,a);return u.start(s),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function eu(n,e){if(Wt("AsyncQueue",`${e}: ${n}`),Ho(n))return new he(ie.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{static emptySet(e){return new pc(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Te.comparator(t.key,s.key):(t,s)=>Te.comparator(t.key,s.key),this.keyedMap=Ed(),this.sortedSet=new St(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof pc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=s.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new pc;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(){this.ga=new St(Te.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):we(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Oc{constructor(e,t,s,i,a,l,u,f,m){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,t,s,i,a){const l=[];return t.forEach((u=>{l.push({type:0,doc:u})})),new Oc(e,t,pc.emptySet(t),l,s,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==s[i].type||!t[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class n6{constructor(){this.queries=Ew(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const i=be(t),a=i.queries;i.queries=Ew(),a.forEach(((l,u)=>{for(const f of u.Sa)f.onError(s)}))})(this,new he(ie.ABORTED,"Firestore shutting down"))}}function Ew(){return new Rr((n=>kR(n)),wh)}async function oE(n,e){const t=be(n);let s=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(s=2):(a=new t6,s=e.Da()?0:1);try{switch(s){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(l){const u=eu(l,`Initialization of query '${ic(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&lE(t)}async function aE(n,e){const t=be(n),s=e.query;let i=3;const a=t.queries.get(s);if(a){const l=a.Sa.indexOf(e);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function s6(n,e){const t=be(n);let s=!1;for(const i of e){const a=i.query,l=t.queries.get(a);if(l){for(const u of l.Sa)u.Fa(i)&&(s=!0);l.wa=i}}s&&lE(t)}function i6(n,e,t){const s=be(n),i=s.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);s.queries.delete(e)}function lE(n){n.Ca.forEach((e=>{e.next()}))}var Av,Tw;(Tw=Av||(Av={})).Ma="default",Tw.Cache="cache";class cE{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const i of e.docChanges)i.type!==3&&s.push(i);e=new Oc(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Oc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Av.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e){this.serializer=e}$s(e){return Hi(this.serializer,e)}Us(e){return e.metadata.exists?i1(this.serializer,e.document,!1):Mt.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Xt(e)}}class o6{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=H1(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const s=tt.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,s=new xw(this.serializer);for(const i of e)if(i.metadata.queries){const a=s.$s(i.metadata.name);for(const l of i.metadata.queries){const u=(t.get(l)||Je()).add(a);t.set(l,u)}}return t}async ja(e){const t=await D5(e,new xw(this.serializer),this.Wa,this.Ua.id),s=this.za(this.documents);for(const i of this.Ka)await M5(e,i,s.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function H1(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e){this.key=e}}class $1{constructor(e){this.key=e}}class Y1{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Je(),this.mutatedKeys=Je(),this.eu=LR(e),this.tu=new pc(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new vw,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,u=!1;const f=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,m=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((_,T)=>{const x=i.get(_),b=Nh(this.query,T)?T:null,k=!!x&&this.mutatedKeys.has(x.key),G=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let F=!1;x&&b?x.data.isEqual(b.data)?k!==G&&(s.track({type:3,doc:b}),F=!0):this.su(x,b)||(s.track({type:2,doc:b}),F=!0,(f&&this.eu(b,f)>0||m&&this.eu(b,m)<0)&&(u=!0)):!x&&b?(s.track({type:0,doc:b}),F=!0):x&&!b&&(s.track({type:1,doc:x}),F=!0,(f||m)&&(u=!0)),F&&(b?(l=l.add(b),a=G?a.add(_):a.delete(_)):(l=l.delete(_),a=a.delete(_)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const _=this.query.limitType==="F"?l.last():l.first();l=l.delete(_.key),a=a.delete(_.key),s.track({type:1,doc:_})}return{tu:l,iu:s,Cs:u,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((_,T)=>(function(b,k){const G=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return we(20277,{Rt:F})}};return G(b)-G(k)})(_.type,T.type)||this.eu(_.doc,T.doc))),this.ou(s),i=i??!1;const u=t&&!i?this._u():[],f=this.Xa.size===0&&this.current&&!i?1:0,m=f!==this.Za;return this.Za=f,l.length!==0||m?{snapshot:new Oc(this.query,e.tu,a,l,e.mutatedKeys,f===0,m,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new vw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Je(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const t=[];return e.forEach((s=>{this.Xa.has(s)||t.push(new $1(s))})),this.Xa.forEach((s=>{e.has(s)||t.push(new z1(s))})),t}cu(e){this.Ya=e.Qs,this.Xa=Je();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Oc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Yo="SyncEngine";class a6{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class l6{constructor(e){this.key=e,this.hu=!1}}class c6{constructor(e,t,s,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Rr((u=>kR(u)),wh),this.Iu=new Map,this.Eu=new Set,this.du=new St(Te.comparator),this.Au=new Map,this.Ru=new K0,this.Vu={},this.mu=new Map,this.fu=Wa.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function u6(n,e,t=!0){const s=Kp(n);let i;const a=s.Tu.get(e);return a?(s.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await K1(s,e,t,!0),i}async function d6(n,e){const t=Kp(n);await K1(t,e,!0,!1)}async function K1(n,e,t,s){const i=await Vc(n.localStore,Wn(e)),a=i.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let u;return s&&(u=await uE(n,e,a,l==="current",i.resumeToken)),n.isPrimaryClient&&t&&Yp(n.remoteStore,i),u}async function uE(n,e,t,s,i){n.pu=(T,x,b)=>(async function(G,F,Y,K){let H=F.view.ru(Y);H.Cs&&(H=await lp(G.localStore,F.query,!1).then((({documents:P})=>F.view.ru(P,H))));const U=K&&K.targetChanges.get(F.targetId),z=K&&K.targetMismatches.get(F.targetId)!=null,J=F.view.applyChanges(H,G.isPrimaryClient,U,z);return wv(G,F.targetId,J.au),J.snapshot})(n,T,x,b);const a=await lp(n.localStore,e,!0),l=new Y1(e,a.Qs),u=l.ru(a.documents),f=Rh.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",i),m=l.applyChanges(u,n.isPrimaryClient,f);wv(n,t,m.au);const _=new a6(e,t,l);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function h6(n,e,t){const s=be(n),i=s.Tu.get(e),a=s.Iu.get(i.targetId);if(a.length>1)return s.Iu.set(i.targetId,a.filter((l=>!wh(l,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await Lc(s.localStore,i.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(i.targetId),t&&Uc(s.remoteStore,i.targetId),Fc(s,i.targetId)})).catch(qo)):(Fc(s,i.targetId),await Lc(s.localStore,i.targetId,!0))}async function f6(n,e){const t=be(n),s=t.Tu.get(e),i=t.Iu.get(s.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Uc(t.remoteStore,s.targetId))}async function m6(n,e,t){const s=mE(n);try{const i=await(function(l,u){const f=be(l),m=gt.now(),_=u.reduce(((b,k)=>b.add(k.key)),Je());let T,x;return f.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let k=us(),G=Je();return f.Ns.getEntries(b,_).next((F=>{k=F,k.forEach(((Y,K)=>{K.isValidDocument()||(G=G.add(Y))}))})).next((()=>f.localDocuments.getOverlayedDocuments(b,k))).next((F=>{T=F;const Y=[];for(const K of u){const H=LF(K,T.get(K.key).overlayedDocument);H!=null&&Y.push(new Pr(K.key,H,AR(H.value.mapValue),Ft.exists(!0)))}return f.mutationQueue.addMutationBatch(b,m,Y,u)})).next((F=>{x=F;const Y=F.applyToLocalDocumentSet(T,G);return f.documentOverlayCache.saveOverlays(b,F.batchId,Y)}))})).then((()=>({batchId:x.batchId,changes:OR(T)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(i.batchId),(function(l,u,f){let m=l.Vu[l.currentUser.toKey()];m||(m=new St(ze)),m=m.insert(u,f),l.Vu[l.currentUser.toKey()]=m})(s,i.batchId,t),await Dr(s,i.changes),await Xc(s.remoteStore)}catch(i){const a=eu(i,"Failed to persist write");t.reject(a)}}async function J1(n,e){const t=be(n);try{const s=await R5(t.localStore,e);e.targetChanges.forEach(((i,a)=>{const l=t.Au.get(a);l&&(Pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?Pe(l.hu,14607):i.removedDocuments.size>0&&(Pe(l.hu,42227),l.hu=!1))})),await Dr(t,s,e)}catch(s){await qo(s)}}function Iw(n,e,t){const s=be(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const i=[];s.Tu.forEach(((a,l)=>{const u=l.view.va(e);u.snapshot&&i.push(u.snapshot)})),(function(l,u){const f=be(l);f.onlineState=u;let m=!1;f.queries.forEach(((_,T)=>{for(const x of T.Sa)x.va(u)&&(m=!0)})),m&&lE(f)})(s.eventManager,e),i.length&&s.Pu.H_(i),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function p6(n,e,t){const s=be(n);s.sharedClientState.updateQueryState(e,"rejected",t);const i=s.Au.get(e),a=i&&i.key;if(a){let l=new St(Te.comparator);l=l.insert(a,Mt.newNoDocument(a,Me.min()));const u=Je().add(a),f=new Ch(Me.min(),new Map,new St(ze),l,u);await J1(s,f),s.du=s.du.remove(a),s.Au.delete(e),fE(s)}else await Lc(s.localStore,e,!1).then((()=>Fc(s,e,t))).catch(qo)}async function g6(n,e){const t=be(n),s=e.batch.batchId;try{const i=await C5(t.localStore,e);hE(t,s,null),dE(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Dr(t,i)}catch(i){await qo(i)}}async function y6(n,e,t){const s=be(n);try{const i=await(function(l,u){const f=be(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let _;return f.mutationQueue.lookupMutationBatch(m,u).next((T=>(Pe(T!==null,37113),_=T.keys(),f.mutationQueue.removeMutationBatch(m,T)))).next((()=>f.mutationQueue.performConsistencyCheck(m))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(m,_,u))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,_))).next((()=>f.localDocuments.getDocuments(m,_)))}))})(s.localStore,e);hE(s,e,t),dE(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Dr(s,i)}catch(i){await qo(i)}}async function _6(n,e){const t=be(n);$o(t.remoteStore)||fe(Yo,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await(function(l){const u=be(l);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(f=>u.mutationQueue.getHighestUnacknowledgedBatchId(f)))})(t.localStore);if(s===No)return void e.resolve();const i=t.mu.get(s)||[];i.push(e),t.mu.set(s,i)}catch(s){const i=eu(s,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function dE(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function hE(n,e,t){const s=be(n);let i=s.Vu[s.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),s.Vu[s.currentUser.toKey()]=i}}function Fc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((s=>{n.Ru.containsKey(s)||Q1(n,s)}))}function Q1(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Uc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),fE(n))}function wv(n,e,t){for(const s of t)s instanceof z1?(n.Ru.addReference(s.key,e),v6(n,s)):s instanceof $1?(fe(Yo,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||Q1(n,s.key)):we(19791,{wu:s})}function v6(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(fe(Yo,"New document in limbo: "+t),n.Eu.add(s),fE(n))}function fE(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Te(tt.fromString(e)),s=n.fu.next();n.Au.set(s,new l6(t)),n.du=n.du.insert(t,s),Yp(n.remoteStore,new gr(Wn(Kc(t.path)),s,"TargetPurposeLimboResolution",ls.ce))}}async function Dr(n,e,t){const s=be(n),i=[],a=[],l=[];s.Tu.isEmpty()||(s.Tu.forEach(((u,f)=>{l.push(s.pu(f,e,t).then((m=>{var _;if((m||t)&&s.isPrimaryClient){const T=m?!m.fromCache:(_=t==null?void 0:t.targetChanges.get(f.targetId))==null?void 0:_.current;s.sharedClientState.updateQueryState(f.targetId,T?"current":"not-current")}if(m){i.push(m);const T=X0.As(f.targetId,m);a.push(T)}})))})),await Promise.all(l),s.Pu.H_(i),await(async function(f,m){const _=be(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(T=>X.forEach(m,(x=>X.forEach(x.Es,(b=>_.persistence.referenceDelegate.addReference(T,x.targetId,b))).next((()=>X.forEach(x.ds,(b=>_.persistence.referenceDelegate.removeReference(T,x.targetId,b)))))))))}catch(T){if(!Ho(T))throw T;fe(Z0,"Failed to update sequence numbers: "+T)}for(const T of m){const x=T.targetId;if(!T.fromCache){const b=_.Ms.get(x),k=b.snapshotVersion,G=b.withLastLimboFreeSnapshotVersion(k);_.Ms=_.Ms.insert(x,G)}}})(s.localStore,a))}async function E6(n,e){const t=be(n);if(!t.currentUser.isEqual(e)){fe(Yo,"User change. New user:",e.toKey());const s=await N1(t.localStore,e);t.currentUser=e,(function(a,l){a.mu.forEach((u=>{u.forEach((f=>{f.reject(new he(ie.CANCELLED,l))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Dr(t,s.Ls)}}function T6(n,e){const t=be(n),s=t.Au.get(e);if(s&&s.hu)return Je().add(s.key);{let i=Je();const a=t.Iu.get(e);if(!a)return i;for(const l of a){const u=t.Tu.get(l);i=i.unionWith(u.view.nu)}return i}}async function x6(n,e){const t=be(n),s=await lp(t.localStore,e.query,!0),i=e.view.cu(s);return t.isPrimaryClient&&wv(t,e.targetId,i.au),i}async function I6(n,e){const t=be(n);return P1(t.localStore,e).then((s=>Dr(t,s)))}async function b6(n,e,t,s){const i=be(n),a=await(function(u,f){const m=be(u),_=be(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",(T=>_.er(T,f).next((x=>x?m.localDocuments.getDocuments(T,x):X.resolve(null)))))})(i.localStore,e);a!==null?(t==="pending"?await Xc(i.remoteStore):t==="acknowledged"||t==="rejected"?(hE(i,e,s||null),dE(i,e),(function(u,f){be(be(u).mutationQueue).ir(f)})(i.localStore,e)):we(6720,"Unknown batchState",{Su:t}),await Dr(i,a)):fe(Yo,"Cannot apply mutation batch with id: "+e)}async function A6(n,e){const t=be(n);if(Kp(t),mE(t),e===!0&&t.gu!==!0){const s=t.sharedClientState.getAllActiveQueryTargets(),i=await bw(t,s.toArray());t.gu=!0,await bv(t.remoteStore,!0);for(const a of i)Yp(t.remoteStore,a)}else if(e===!1&&t.gu!==!1){const s=[];let i=Promise.resolve();t.Iu.forEach(((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?s.push(l):i=i.then((()=>(Fc(t,l),Lc(t.localStore,l,!0)))),Uc(t.remoteStore,l)})),await i,await bw(t,s),(function(l){const u=be(l);u.Au.forEach(((f,m)=>{Uc(u.remoteStore,m)})),u.Ru.Jr(),u.Au=new Map,u.du=new St(Te.comparator)})(t),t.gu=!1,await bv(t.remoteStore,!1)}}async function bw(n,e,t){const s=be(n),i=[],a=[];for(const l of e){let u;const f=s.Iu.get(l);if(f&&f.length!==0){u=await Vc(s.localStore,Wn(f[0]));for(const m of f){const _=s.Tu.get(m),T=await x6(s,_);T.snapshot&&a.push(T.snapshot)}}else{const m=await R1(s.localStore,l);u=await Vc(s.localStore,m),await uE(s,W1(m),l,!1,u.resumeToken)}i.push(u)}return s.Pu.H_(a),i}function W1(n){return MR(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function w6(n){return(function(t){return be(be(t).persistence).Ts()})(be(n).localStore)}async function N6(n,e,t,s){const i=be(n);if(i.gu)return void fe(Yo,"Ignoring unexpected query state notification.");const a=i.Iu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=await P1(i.localStore,VR(a[0])),u=Ch.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ht.EMPTY_BYTE_STRING);await Dr(i,l,u);break}case"rejected":await Lc(i.localStore,e,!0),Fc(i,e,s);break;default:we(64155,t)}}async function S6(n,e,t){const s=Kp(n);if(s.gu){for(const i of e){if(s.Iu.has(i)&&s.sharedClientState.isActiveQueryTarget(i)){fe(Yo,"Adding an already active target "+i);continue}const a=await R1(s.localStore,i),l=await Vc(s.localStore,a);await uE(s,W1(a),l.targetId,!1,l.resumeToken),Yp(s.remoteStore,l)}for(const i of t)s.Iu.has(i)&&await Lc(s.localStore,i,!1).then((()=>{Uc(s.remoteStore,i),Fc(s,i)})).catch(qo)}}function Kp(n){const e=be(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=J1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=T6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=p6.bind(null,e),e.Pu.H_=s6.bind(null,e.eventManager),e.Pu.yu=i6.bind(null,e.eventManager),e}function mE(n){const e=be(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=g6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=y6.bind(null,e),e}function C6(n,e,t){const s=be(n);(async function(a,l,u){try{const f=await l.getMetadata();if(await(function(b,k){const G=be(b),F=Xt(k.createTime);return G.persistence.runTransaction("hasNewerBundle","readonly",(Y=>G.Ii.getBundleMetadata(Y,k.id))).then((Y=>!!Y&&Y.createTime.compareTo(F)>=0))})(a.localStore,f))return await l.close(),u._completeWith((function(b){return{taskState:"Success",documentsLoaded:b.totalDocuments,bytesLoaded:b.totalBytes,totalDocuments:b.totalDocuments,totalBytes:b.totalBytes}})(f)),Promise.resolve(new Set);u._updateProgress(H1(f));const m=new o6(f,l.serializer);let _=await l.bu();for(;_;){const x=await m.Ga(_);x&&u._updateProgress(x),_=await l.bu()}const T=await m.ja(a.localStore);return await Dr(a,T.Ha,void 0),await(function(b,k){const G=be(b);return G.persistence.runTransaction("Save bundle","readwrite",(F=>G.Ii.saveBundleMetadata(F,k)))})(a.localStore,f),u._completeWith(T.progress),Promise.resolve(T.Ja)}catch(f){return Yi(Yo,`Loading bundle failed with ${f}`),u._failWith(f),Promise.resolve(new Set)}})(s,e,t).then((i=>{s.sharedClientState.notifyBundleLoaded(i)}))}class ah{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ph(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return w1(this.persistence,new A1,e.initialUser,this.serializer)}Cu(e){return new J0($p.mi,this.serializer)}Du(e){return new L1}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ah.provider={build:()=>new ah};class R6 extends ah{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Pe(this.persistence.referenceDelegate instanceof ap,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new v1(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new J0((s=>ap.mi(s,t)),this.serializer)}}class X1 extends ah{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await mE(this.xu.syncEngine),await Xc(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return w1(this.persistence,new A1,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new v1(s,e.asyncQueue,t)}Mu(e,t){const s=new FO(t,this.persistence);return new OO(e.asyncQueue,s)}Cu(e){const t=W0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new Q0(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,U1(),Um(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new L1}}class P6 extends X1{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof O_&&(this.sharedClientState.syncEngine={Co:b6.bind(null,t),vo:N6.bind(null,t),Fo:S6.bind(null,t),Ts:w6.bind(null,t),Do:I6.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async s=>{await A6(this.xu.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())}))}Du(e){const t=U1();if(!O_.v(t))throw new he(ie.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=W0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new O_(t,e.asyncQueue,s,e.clientId,e.initialUser)}}class lh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Iw(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=E6.bind(null,this.syncEngine),await bv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new n6})()}createDatastore(e){const t=Ph(e.databaseInfo.databaseId),s=(function(a){return new O5(a)})(e.databaseInfo);return(function(a,l,u,f){return new G5(a,l,u,f)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,i,a,l,u){return new H5(s,i,a,l,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>Iw(this.syncEngine,t,0)),(function(){return gw.v()?new gw:new k5})())}createSyncEngine(e,t){return(function(i,a,l,u,f,m,_){const T=new c6(i,a,l,u,f,m);return _&&(T.gu=!0),T})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const a=be(i);fe(Xa,"RemoteStore shutting down."),a.Ea.add(5),await Wc(a),a.Aa.shutdown(),a.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}lh.provider={build:()=>new lh};function Aw(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const s={value:n.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Wt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D6{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Ln,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((s=>{s&&s.$a()?this.metadata.resolve(s.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s==null?void 0:s.Qa)}`))}),(s=>this.metadata.reject(s)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),s=Number(t);isNaN(s)&&this.Qu(`length string (${t}) is not valid number`);const i=await this.$u(s);return new r6(JSON.parse(i),e.length+s)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new he(ie.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(i,a){const l=be(i),u={documents:a.map((T=>rh(l.serializer,T)))},f=await l.Ho("BatchGetDocuments",l.serializer.databaseId,tt.emptyPath(),u,a.length),m=new Map;f.forEach((T=>{const x=zF(l.serializer,T);m.set(x.key.toString(),x)}));const _=[];return a.forEach((T=>{const x=m.get(T.toString());Pe(!!x,55234,{key:T}),_.push(x)})),_})(this.datastore,e);return t.forEach((s=>this.recordVersion(s))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastTransactionError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new Qc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,s)=>{const i=Te.fromPath(s);this.mutations.push(new F0(i,this.precondition(i)))})),await(async function(s,i){const a=be(s),l={writes:i.map((u=>oh(a.serializer,u)))};await a.Go("Commit",a.serializer.databaseId,tt.emptyPath(),l)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw we(50498,{Gu:e.constructor.name});t=Me.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!t.isEqual(s))throw new he(ie.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Me.min())?Ft.exists(!1):Ft.updateTime(t):Ft.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Me.min()))throw new he(ie.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ft.updateTime(t)}return Ft.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e,t,s,i,a){this.asyncQueue=e,this.datastore=t,this.options=s,this.updateFunction=i,this.deferred=a,this.zu=s.maxAttempts,this.M_=new tE(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new M6(this.datastore),t=this.Hu(e);t&&t.then((s=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(s)})).catch((i=>{this.Yu(i)}))))})).catch((s=>{this.Yu(s)}))}))}Hu(e){try{const t=this.updateFunction(e);return!Ih(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!KR(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo="FirestoreClient";class V6{constructor(e,t,s,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=i,this.user=In.UNAUTHENTICATED,this.clientId=A0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(s,(async l=>{fe(Oo,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(s,(l=>(fe(Oo,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ln;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=eu(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function B_(n,e){n.asyncQueue.verifyOperationInProgress(),fe(Oo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async i=>{s.isEqual(i)||(await N1(e.localStore,i),s=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function ww(n,e){n.asyncQueue.verifyOperationInProgress();const t=await pE(n);fe(Oo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>_w(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,i)=>_w(e.remoteStore,i))),n._onlineComponents=e}async function pE(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){fe(Oo,"Using user provided OfflineComponentProvider");try{await B_(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===ie.FAILED_PRECONDITION||i.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Yi("Error using user provided cache. Falling back to memory cache: "+t),await B_(n,new ah)}}else fe(Oo,"Using default OfflineComponentProvider"),await B_(n,new R6(void 0));return n._offlineComponents}async function Qp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(fe(Oo,"Using user provided OnlineComponentProvider"),await ww(n,n._uninitializedComponentsProvider._online)):(fe(Oo,"Using default OnlineComponentProvider"),await ww(n,new lh))),n._onlineComponents}function Z1(n){return pE(n).then((e=>e.persistence))}function gE(n){return pE(n).then((e=>e.localStore))}function eP(n){return Qp(n).then((e=>e.remoteStore))}function yE(n){return Qp(n).then((e=>e.syncEngine))}function L6(n){return Qp(n).then((e=>e.datastore))}async function Bc(n){const e=await Qp(n),t=e.eventManager;return t.onListen=u6.bind(null,e.syncEngine),t.onUnlisten=h6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=d6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=f6.bind(null,e.syncEngine),t}function U6(n){return n.asyncQueue.enqueue((async()=>{const e=await Z1(n),t=await eP(n);return e.setNetworkEnabled(!0),(function(i){const a=be(i);return a.Ea.delete(0),Dh(a)})(t)}))}function O6(n){return n.asyncQueue.enqueue((async()=>{const e=await Z1(n),t=await eP(n);return e.setNetworkEnabled(!1),(async function(i){const a=be(i);a.Ea.add(0),await Wc(a),a.Ra.set("Offline")})(t)}))}function F6(n,e){const t=new Ln;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,a,l){try{const u=await(function(m,_){const T=be(m);return T.persistence.runTransaction("read document","readonly",(x=>T.localDocuments.getDocument(x,_)))})(i,a);u.isFoundDocument()?l.resolve(u):u.isNoDocument()?l.resolve(null):l.reject(new he(ie.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const f=eu(u,`Failed to get document '${a} from cache`);l.reject(f)}})(await gE(n),e,t))),t.promise}function tP(n,e,t={}){const s=new Ln;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,u,f,m){const _=new Jp({next:x=>{_.Nu(),l.enqueueAndForget((()=>aE(a,T)));const b=x.docs.has(u);!b&&x.fromCache?m.reject(new he(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&x.fromCache&&f&&f.source==="server"?m.reject(new he(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(x)},error:x=>m.reject(x)}),T=new cE(Kc(u.path),_,{includeMetadataChanges:!0,qa:!0});return oE(a,T)})(await Bc(n),n.asyncQueue,e,t,s))),s.promise}function B6(n,e){const t=new Ln;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,a,l){try{const u=await lp(i,a,!0),f=new Y1(a,u.Qs),m=f.ru(u.documents),_=f.applyChanges(m,!1);l.resolve(_.snapshot)}catch(u){const f=eu(u,`Failed to execute query '${a} against cache`);l.reject(f)}})(await gE(n),e,t))),t.promise}function nP(n,e,t={}){const s=new Ln;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,u,f,m){const _=new Jp({next:x=>{_.Nu(),l.enqueueAndForget((()=>aE(a,T))),x.fromCache&&f.source==="server"?m.reject(new he(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(x)},error:x=>m.reject(x)}),T=new cE(u,_,{includeMetadataChanges:!0,qa:!0});return oE(a,T)})(await Bc(n),n.asyncQueue,e,t,s))),s.promise}function j6(n,e){const t=new Jp(e);return n.asyncQueue.enqueueAndForget((async()=>(function(i,a){be(i).Ca.add(a),a.next()})(await Bc(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(i,a){be(i).Ca.delete(a)})(await Bc(n),t)))}}function G6(n,e,t,s){const i=(function(l,u){let f;return f=typeof l=="string"?QR().encode(l):l,(function(_,T){return new D6(_,T)})((function(_,T){if(_ instanceof Uint8Array)return Aw(_,T);if(_ instanceof ArrayBuffer)return Aw(new Uint8Array(_),T);if(_ instanceof ReadableStream)return _.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(f),u)})(t,Ph(e));n.asyncQueue.enqueueAndForget((async()=>{C6(await yE(n),i,s)}))}function q6(n,e){return n.asyncQueue.enqueue((async()=>(function(s,i){const a=be(s);return a.persistence.runTransaction("Get named query","readonly",(l=>a.Ii.getNamedQuery(l,i)))})(await gE(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP="firestore.googleapis.com",Sw=!0;class Cw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new he(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=iP,this.ssl=Sw}else this.host=e.host,this.ssl=e.ssl??Sw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=p1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<u5)throw new he(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}WC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sP(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new he(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new he(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new he(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,i){return s.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Mh{constructor(e,t,s,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Cw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new he(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Cw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new wO;switch(s.type){case"firstParty":return new RO(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new he(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=Nw.get(t);s&&(fe("ComponentProvider","Removing Datastore"),Nw.delete(t),s.terminate())})(this),Promise.resolve()}}function H6(n,e,t,s={}){var m;n=ut(n,Mh);const i=Gc(e),a=n._getSettings(),l={...a,emulatorOptions:n._getEmulatorOptions()},u=`${e}:${t}`;i&&(IS(`https://${u}`),bS("Firestore",!0)),a.host!==iP&&a.host!==u&&Yi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...a,host:u,ssl:i,emulatorOptions:s};if(!Co(f,l)&&(n._setSettings(f),s.mockUserToken)){let _,T;if(typeof s.mockUserToken=="string")_=s.mockUserToken,T=In.MOCK_USER;else{_=j2(s.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const x=s.mockUserToken.sub||s.mockUserToken.user_id;if(!x)throw new he(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");T=new In(x)}n._authCredentials=new NO(new JC(_,T))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zn=class rP{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new rP(this.firestore,e,this._query)}},Nt=class Id{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new So(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Id(this.firestore,e,this._key)}toJSON(){return{type:Id._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(xh(t,Id._jsonSchema))return new Id(e,s||null,new Te(tt.fromString(t.referencePath)))}};Nt._jsonSchemaVersion="firestore/documentReference/1.0",Nt._jsonSchema={type:mn("string",Nt._jsonSchemaVersion),referencePath:mn("string")};let So=class oP extends Zn{constructor(e,t,s){super(e,t,Kc(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nt(this.firestore,null,new Te(e))}withConverter(e){return new oP(this.firestore,e,this._path)}};function aP(n,e,...t){if(n=Le(n),w0("collection","path",e),n instanceof Mh){const s=tt.fromString(e,...t);return yA(s),new So(n,null,s)}{if(!(n instanceof Nt||n instanceof So))throw new he(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(tt.fromString(e,...t));return yA(s),new So(n.firestore,null,s)}}function z6(n,e){if(n=ut(n,Mh),w0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new he(ie.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Zn(n,null,(function(s){return new Cr(tt.emptyPath(),s)})(e))}function hp(n,e,...t){if(n=Le(n),arguments.length===1&&(e=A0.newId()),w0("doc","path",e),n instanceof Mh){const s=tt.fromString(e,...t);return gA(s),new Nt(n,null,new Te(s))}{if(!(n instanceof Nt||n instanceof So))throw new he(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(tt.fromString(e,...t));return gA(s),new Nt(n.firestore,n instanceof So?n.converter:null,new Te(s))}}function lP(n,e){return n=Le(n),e=Le(e),(n instanceof Nt||n instanceof So)&&(e instanceof Nt||e instanceof So)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function cP(n,e){return n=Le(n),e=Le(e),n instanceof Zn&&e instanceof Zn&&n.firestore===e.firestore&&wh(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw="AsyncQueue";class Pw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new tE(this,"async_queue_retry"),this._c=()=>{const s=Um();s&&fe(Rw,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=Um();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Um();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ln;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ho(e))throw e;fe(Rw,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,Wt("INTERNAL UNHANDLED ERROR: ",Dw(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=rE.createAndSchedule(this,e,t,s,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&we(47125,{Pc:Dw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Dw(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const i=t;for(const a of s)if(a in i&&typeof i[a]=="function")return!0;return!1})(n,["next","error","complete"])}class $6{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ln,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,s){this._progressObserver={next:e,error:t,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y6=-1;let Zt=class extends Mh{constructor(e,t,s,i){super(e,t,s,i),this.type="firestore",this._queue=new Pw,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Pw(e),this._firestoreClient=void 0,await e}}};function zn(n){if(n._terminated)throw new he(ie.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||uP(n),n._firestoreClient}function uP(n){var s,i,a;const e=n._freezeSettings(),t=(function(u,f,m,_){return new mF(u,f,m,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,sP(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)})(n._databaseId,((s=n._app)==null?void 0:s.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((a=e.localCache)!=null&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new V6(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(u){const f=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(f),_online:f}})(n._componentsProvider))}function K6(n,e){Yi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return dP(n,lh.provider,{build:s=>new X1(s,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function J6(n){Yi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();dP(n,lh.provider,{build:t=>new P6(t,e.cacheSizeBytes)})}function dP(n,e,t){if((n=ut(n,Zt))._firestoreClient||n._terminated)throw new he(ie.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new he(ie.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},uP(n)}function Q6(n){if(n._initialized&&!n._terminated)throw new he(ie.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Ln;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(s){if(!qi.v())return Promise.resolve();const i=s+b1;await qi.delete(i)})(W0(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function W6(n){return(function(t){const s=new Ln;return t.asyncQueue.enqueueAndForget((async()=>_6(await yE(t),s))),s.promise})(zn(n=ut(n,Zt)))}function X6(n){return U6(zn(n=ut(n,Zt)))}function Z6(n){return O6(zn(n=ut(n,Zt)))}function eB(n,e){const t=zn(n=ut(n,Zt)),s=new $6;return G6(t,n._databaseId,e,s),s}function tB(n,e){return q6(zn(n=ut(n,Zt)),e).then((t=>t?new Zn(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gn(Ht.fromBase64String(e))}catch(t){throw new he(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Gn(Ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xh(e,Gn._jsonSchema))return Gn.fromBase64String(e.bytes)}}Gn._jsonSchemaVersion="firestore/bytes/1.0",Gn._jsonSchema={type:mn("string",Gn._jsonSchemaVersion),bytes:mn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fo=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new he(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ot(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let il=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new he(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new he(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ze(this._lat,e._lat)||ze(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ai._jsonSchemaVersion}}static fromJSON(e){if(xh(e,ai._jsonSchema))return new ai(e.latitude,e.longitude)}}ai._jsonSchemaVersion="firestore/geoPoint/1.0",ai._jsonSchema={type:mn("string",ai._jsonSchemaVersion),latitude:mn("number"),longitude:mn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,i){if(s.length!==i.length)return!1;for(let a=0;a<s.length;++a)if(s[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:zi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xh(e,zi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new zi(e.vectorValues);throw new he(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}zi._jsonSchemaVersion="firestore/vectorValue/1.0",zi._jsonSchema={type:mn("string",zi._jsonSchemaVersion),vectorValues:mn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nB=/^__.*__$/;class sB{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Pr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Jc(e,this.data,t,this.fieldTransforms)}}class hP{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new Pr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function fP(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw we(40011,{Ac:n})}}class Wp{constructor(e,t,s,i,a,l){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Wp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return fp(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fP(this.Ac)&&nB.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class iB{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Ph(e)}Cc(e,t,s,i=!1){return new Wp({Ac:e,methodName:t,Dc:s,path:Ot.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rl(n){const e=n._freezeSettings(),t=Ph(n._databaseId);return new iB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Xp(n,e,t,s,i,a={}){const l=n.Cc(a.merge||a.mergeFields?2:0,e,t,i);bE("Data must be an object, but it was:",l,s);const u=gP(s,l);let f,m;if(a.merge)f=new cs(l.fieldMask),m=l.fieldTransforms;else if(a.mergeFields){const _=[];for(const T of a.mergeFields){const x=Sv(e,T,t);if(!l.contains(x))throw new he(ie.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);_P(_,x)||_.push(x)}f=new cs(_),m=l.fieldTransforms.filter((T=>f.covers(T.field)))}else f=null,m=l.fieldTransforms;return new sB(new kn(u),f,m)}class kh extends il{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof kh}}function mP(n,e,t){return new Wp({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class _E extends il{_toFieldTransform(e){return new Sh(e.path,new Dc)}isEqual(e){return e instanceof _E}}class vE extends il{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=mP(this,e,!0),s=this.vc.map((a=>ol(a,t))),i=new Ya(s);return new Sh(e.path,i)}isEqual(e){return e instanceof vE&&Co(this.vc,e.vc)}}class EE extends il{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=mP(this,e,!0),s=this.vc.map((a=>ol(a,t))),i=new Ka(s);return new Sh(e.path,i)}isEqual(e){return e instanceof EE&&Co(this.vc,e.vc)}}class TE extends il{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Mc(e.serializer,jR(e.serializer,this.Fc));return new Sh(e.path,t)}isEqual(e){return e instanceof TE&&this.Fc===e.Fc}}function xE(n,e,t,s){const i=n.Cc(1,e,t);bE("Data must be an object, but it was:",i,s);const a=[],l=kn.empty();zo(s,((f,m)=>{const _=AE(e,f,t);m=Le(m);const T=i.yc(_);if(m instanceof kh)a.push(_);else{const x=ol(m,T);x!=null&&(a.push(_),l.set(_,x))}}));const u=new cs(a);return new hP(l,u,i.fieldTransforms)}function IE(n,e,t,s,i,a){const l=n.Cc(1,e,t),u=[Sv(e,s,t)],f=[i];if(a.length%2!=0)throw new he(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)u.push(Sv(e,a[x])),f.push(a[x+1]);const m=[],_=kn.empty();for(let x=u.length-1;x>=0;--x)if(!_P(m,u[x])){const b=u[x];let k=f[x];k=Le(k);const G=l.yc(b);if(k instanceof kh)m.push(b);else{const F=ol(k,G);F!=null&&(m.push(b),_.set(b,F))}}const T=new cs(m);return new hP(_,T,l.fieldTransforms)}function pP(n,e,t,s=!1){return ol(t,n.Cc(s?4:3,e))}function ol(n,e){if(yP(n=Le(n)))return bE("Unsupported field value:",e,n),gP(n,e);if(n instanceof il)return(function(s,i){if(!fP(i.Ac))throw i.Sc(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${s._methodName}() is not currently supported inside arrays`);const a=s._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,i){const a=[];let l=0;for(const u of s){let f=ol(u,i.wc(l));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),l++}return{arrayValue:{values:a}}})(n,e)}return(function(s,i){if((s=Le(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return jR(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const a=gt.fromDate(s);return{timestampValue:kc(i.serializer,a)}}if(s instanceof gt){const a=new gt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:kc(i.serializer,a)}}if(s instanceof ai)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Gn)return{bytesValue:ZR(i.serializer,s._byteString)};if(s instanceof Nt){const a=i.databaseId,l=s.firestore._databaseId;if(!l.isEqual(a))throw i.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:H0(s.firestore._databaseId||i.databaseId,s._key.path)}}if(s instanceof zi)return(function(l,u){return{mapValue:{fields:{[M0]:{stringValue:k0},[Cc]:{arrayValue:{values:l.toArray().map((m=>{if(typeof m!="number")throw u.Sc("VectorValues must only contain numeric values.");return O0(u.serializer,m)}))}}}}}})(s,i);throw i.Sc(`Unsupported field value: ${kp(s)}`)})(n,e)}function gP(n,e){const t={};return gR(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zo(n,((s,i)=>{const a=ol(i,e.mc(s));a!=null&&(t[s]=a)})),{mapValue:{fields:t}}}function yP(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof gt||n instanceof ai||n instanceof Gn||n instanceof Nt||n instanceof il||n instanceof zi)}function bE(n,e,t){if(!yP(t)||!XC(t)){const s=kp(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function Sv(n,e,t){if((e=Le(e))instanceof Fo)return e._internalPath;if(typeof e=="string")return AE(n,e);throw fp("Field path arguments must be of type string or ",n,!1,void 0,t)}const rB=new RegExp("[~\\*/\\[\\]]");function AE(n,e,t){if(e.search(rB)>=0)throw fp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Fo(...e.split("."))._internalPath}catch{throw fp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fp(n,e,t,s,i){const a=s&&!s.isEmpty(),l=i!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(a||l)&&(f+=" (found",a&&(f+=` in field ${s}`),l&&(f+=` in document ${i}`),f+=")"),new he(ie.INVALID_ARGUMENT,u+n+f)}function _P(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e,t,s,i,a){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Nt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Zp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class oB extends ch{data(){return super.data()}}function Zp(n,e){return typeof e=="string"?AE(n,e):e instanceof Fo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vP(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new he(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wE{}class Vh extends wE{}function _o(n,e,...t){let s=[];e instanceof wE&&s.push(e),s=s.concat(t),(function(a){const l=a.filter((f=>f instanceof NE)).length,u=a.filter((f=>f instanceof eg)).length;if(l>1||l>0&&u>0)throw new he(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const i of s)n=i._apply(n);return n}class eg extends Vh{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new eg(e,t,s)}_apply(e){const t=this._parse(e);return TP(e._query,t),new Zn(e.firestore,e.converter,mv(e._query,t))}_parse(e){const t=rl(e.firestore);return(function(a,l,u,f,m,_,T){let x;if(m.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new he(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){kw(T,_);const k=[];for(const G of T)k.push(Mw(f,a,G));x={arrayValue:{values:k}}}else x=Mw(f,a,T)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||kw(T,_),x=pP(u,l,T,_==="in"||_==="not-in");return it.create(m,_,x)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function aB(n,e,t){const s=e,i=Zp("where",n);return eg._create(i,s,t)}class NE extends wE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new NE(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:Et.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,a){let l=i;const u=a.getFlattenedFilters();for(const f of u)TP(l,f),l=mv(l,f)})(e._query,t),new Zn(e.firestore,e.converter,mv(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class SE extends Vh{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new SE(e,t)}_apply(e){const t=(function(i,a,l){if(i.startAt!==null)throw new he(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new he(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ih(a,l)})(e._query,this._field,this._direction);return new Zn(e.firestore,e.converter,(function(i,a){const l=i.explicitOrderBy.concat([a]);return new Cr(i.path,i.collectionGroup,l,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function lB(n,e="asc"){const t=e,s=Zp("orderBy",n);return SE._create(s,t)}class tg extends Vh{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new tg(e,t,s)}_apply(e){return new Zn(e.firestore,e.converter,sp(e._query,this._limit,this._limitType))}}function cB(n){return ZC("limit",n),tg._create("limit",n,"F")}function uB(n){return ZC("limitToLast",n),tg._create("limitToLast",n,"L")}class ng extends Vh{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new ng(e,t,s)}_apply(e){const t=EP(e,this.type,this._docOrFields,this._inclusive);return new Zn(e.firestore,e.converter,(function(i,a){return new Cr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,a,i.endAt)})(e._query,t))}}function dB(...n){return ng._create("startAt",n,!0)}function hB(...n){return ng._create("startAfter",n,!1)}class sg extends Vh{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new sg(e,t,s)}_apply(e){const t=EP(e,this.type,this._docOrFields,this._inclusive);return new Zn(e.firestore,e.converter,(function(i,a){return new Cr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,a)})(e._query,t))}}function fB(...n){return sg._create("endBefore",n,!1)}function mB(...n){return sg._create("endAt",n,!0)}function EP(n,e,t,s){if(t[0]=Le(t[0]),t[0]instanceof ch)return(function(a,l,u,f,m){if(!f)throw new he(ie.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const _=[];for(const T of mc(a))if(T.field.isKeyField())_.push(za(l,f.key));else{const x=f.data.field(T.field);if(Fp(x))throw new he(ie.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+T.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(x===null){const b=T.field.canonicalString();throw new he(ie.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${b}' (used as the orderBy) does not exist.`)}_.push(x)}return new Lo(_,m)})(n._query,n.firestore._databaseId,e,t[0]._document,s);{const i=rl(n.firestore);return(function(l,u,f,m,_,T){const x=l.explicitOrderBy;if(_.length>x.length)throw new he(ie.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const b=[];for(let k=0;k<_.length;k++){const G=_[k];if(x[k].field.isKeyField()){if(typeof G!="string")throw new he(ie.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof G}`);if(!L0(l)&&G.indexOf("/")!==-1)throw new he(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${G}' contains a slash.`);const F=l.path.child(tt.fromString(G));if(!Te.isDocumentKey(F))throw new he(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${F}' is not because it contains an odd number of segments.`);const Y=new Te(F);b.push(za(u,Y))}else{const F=pP(f,m,G);b.push(F)}}return new Lo(b,T)})(n._query,n.firestore._databaseId,i,e,t,s)}}function Mw(n,e,t){if(typeof(t=Le(t))=="string"){if(t==="")throw new he(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!L0(e)&&t.indexOf("/")!==-1)throw new he(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(tt.fromString(t));if(!Te.isDocumentKey(s))throw new he(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return za(n,new Te(s))}if(t instanceof Nt)return za(n,t._key);throw new he(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${kp(t)}.`)}function kw(n,e){if(!Array.isArray(n)||n.length===0)throw new he(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function TP(n,e){const t=(function(i,a){for(const l of i)for(const u of l.getFlattenedFilters())if(a.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new he(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new he(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class CE{convertValue(e,t="none"){switch(ko(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(br(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw we(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return zo(e,((i,a)=>{s[i]=this.convertValue(a,t)})),s}convertVectorValue(e){var s,i,a;const t=(a=(i=(s=e.fields)==null?void 0:s[Cc].arrayValue)==null?void 0:i.values)==null?void 0:a.map((l=>Lt(l.doubleValue)));return new zi(t)}convertGeoPoint(e){return new ai(Lt(e.latitude),Lt(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Bp(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(th(e));default:return null}}convertTimestamp(e){const t=Ir(e);return new gt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=tt.fromString(e);Pe(u1(s),9688,{name:e});const i=new Mo(s.get(1),s.get(3)),a=new Te(s.popFirst(5));return i.isEqual(t)||Wt(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ig(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class pB extends CE{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Nt(this.firestore,null,t)}}class ka{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let js=class xP extends ch{constructor(e,t,s,i,a,l){super(e,t,s,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Fd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Zp("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new he(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=xP._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};js._jsonSchemaVersion="firestore/documentSnapshot/1.0",js._jsonSchema={type:mn("string",js._jsonSchemaVersion),bundleSource:mn("string","DocumentSnapshot"),bundleName:mn("string"),bundle:mn("string")};let Fd=class extends js{data(e={}){return super.data(e)}},li=class IP{constructor(e,t,s,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ka(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new Fd(this._firestore,this._userDataWriter,s.key,s,new ka(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new he(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map((u=>{const f=new Fd(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ka(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((u=>a||u.type!==3)).map((u=>{const f=new Fd(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ka(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,_=-1;return u.type!==0&&(m=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),_=l.indexOf(u.doc.key)),{type:gB(u.type),doc:f,oldIndex:m,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new he(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=IP._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=A0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),s.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function gB(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return we(61501,{type:n})}}function bP(n,e){return n instanceof js&&e instanceof js?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof li&&e instanceof li&&n._firestore===e._firestore&&cP(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yB(n){n=ut(n,Nt);const e=ut(n.firestore,Zt);return tP(zn(e),n._key).then((t=>RE(e,n,t)))}li._jsonSchemaVersion="firestore/querySnapshot/1.0",li._jsonSchema={type:mn("string",li._jsonSchemaVersion),bundleSource:mn("string","QuerySnapshot"),bundleName:mn("string"),bundle:mn("string")};class al extends CE{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Nt(this.firestore,null,t)}}function _B(n){n=ut(n,Nt);const e=ut(n.firestore,Zt),t=zn(e),s=new al(e);return F6(t,n._key).then((i=>new js(e,s,n._key,i,new ka(i!==null&&i.hasLocalMutations,!0),n.converter)))}function vB(n){n=ut(n,Nt);const e=ut(n.firestore,Zt);return tP(zn(e),n._key,{source:"server"}).then((t=>RE(e,n,t)))}function EB(n){n=ut(n,Zn);const e=ut(n.firestore,Zt),t=zn(e),s=new al(e);return vP(n._query),nP(t,n._query).then((i=>new li(e,s,n,i)))}function TB(n){n=ut(n,Zn);const e=ut(n.firestore,Zt),t=zn(e),s=new al(e);return B6(t,n._query).then((i=>new li(e,s,n,i)))}function xB(n){n=ut(n,Zn);const e=ut(n.firestore,Zt),t=zn(e),s=new al(e);return nP(t,n._query,{source:"server"}).then((i=>new li(e,s,n,i)))}function Vw(n,e,t){n=ut(n,Nt);const s=ut(n.firestore,Zt),i=ig(n.converter,e,t);return Lh(s,[Xp(rl(s),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Ft.none())])}function Lw(n,e,t,...s){n=ut(n,Nt);const i=ut(n.firestore,Zt),a=rl(i);let l;return l=typeof(e=Le(e))=="string"||e instanceof Fo?IE(a,"updateDoc",n._key,e,t,s):xE(a,"updateDoc",n._key,e),Lh(i,[l.toMutation(n._key,Ft.exists(!0))])}function IB(n){return Lh(ut(n.firestore,Zt),[new Qc(n._key,Ft.none())])}function bB(n,e){const t=ut(n.firestore,Zt),s=hp(n),i=ig(n.converter,e);return Lh(t,[Xp(rl(n.firestore),"addDoc",s._key,i,n.converter!==null,{}).toMutation(s._key,Ft.exists(!1))]).then((()=>s))}function AP(n,...e){var f,m,_;n=Le(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Nv(e[s])||(t=e[s++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Nv(e[s])){const T=e[s];e[s]=(f=T.next)==null?void 0:f.bind(T),e[s+1]=(m=T.error)==null?void 0:m.bind(T),e[s+2]=(_=T.complete)==null?void 0:_.bind(T)}let a,l,u;if(n instanceof Nt)l=ut(n.firestore,Zt),u=Kc(n._key.path),a={next:T=>{e[s]&&e[s](RE(l,n,T))},error:e[s+1],complete:e[s+2]};else{const T=ut(n,Zn);l=ut(T.firestore,Zt),u=T._query;const x=new al(l);a={next:b=>{e[s]&&e[s](new li(l,x,T,b))},error:e[s+1],complete:e[s+2]},vP(n._query)}return(function(x,b,k,G){const F=new Jp(G),Y=new cE(b,F,k);return x.asyncQueue.enqueueAndForget((async()=>oE(await Bc(x),Y))),()=>{F.Nu(),x.asyncQueue.enqueueAndForget((async()=>aE(await Bc(x),Y)))}})(zn(l),u,i,a)}function AB(n,e){return j6(zn(n=ut(n,Zt)),Nv(e)?e:{next:e})}function Lh(n,e){return(function(s,i){const a=new Ln;return s.asyncQueue.enqueueAndForget((async()=>m6(await yE(s),i,a))),a.promise})(zn(n),e)}function RE(n,e,t){const s=t.docs.get(e._key),i=new al(n);return new js(n,i,e._key,s,new ka(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wB={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let NB=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=rl(e)}set(e,t,s){this._verifyNotCommitted();const i=xo(e,this._firestore),a=ig(i.converter,t,s),l=Xp(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,s);return this._mutations.push(l.toMutation(i._key,Ft.none())),this}update(e,t,s,...i){this._verifyNotCommitted();const a=xo(e,this._firestore);let l;return l=typeof(t=Le(t))=="string"||t instanceof Fo?IE(this._dataReader,"WriteBatch.update",a._key,t,s,i):xE(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,Ft.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=xo(e,this._firestore);return this._mutations=this._mutations.concat(new Qc(t._key,Ft.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new he(ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function xo(n,e){if((n=Le(n)).firestore!==e)throw new he(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SB{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=rl(e)}get(e){const t=xo(e,this._firestore),s=new pB(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return we(24041);const a=i[0];if(a.isFoundDocument())return new ch(this._firestore,s,a.key,a,t.converter);if(a.isNoDocument())return new ch(this._firestore,s,t._key,null,t.converter);throw we(18433,{doc:a})}))}set(e,t,s){const i=xo(e,this._firestore),a=ig(i.converter,t,s),l=Xp(this._dataReader,"Transaction.set",i._key,a,i.converter!==null,s);return this._transaction.set(i._key,l),this}update(e,t,s,...i){const a=xo(e,this._firestore);let l;return l=typeof(t=Le(t))=="string"||t instanceof Fo?IE(this._dataReader,"Transaction.update",a._key,t,s,i):xE(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=xo(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CB=class extends SB{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=xo(e,this._firestore),s=new al(this._firestore);return super.get(e).then((i=>new js(this._firestore,s,t._key,i._document,new ka(!1,!1),t.converter)))}};function RB(n,e,t){n=ut(n,Zt);const s={...wB,...t};return(function(a){if(a.maxAttempts<1)throw new he(ie.INVALID_ARGUMENT,"Max attempts must be at least 1")})(s),(function(a,l,u){const f=new Ln;return a.asyncQueue.enqueueAndForget((async()=>{const m=await L6(a);new k6(a.asyncQueue,m,u,l,f).ju()})),f.promise})(zn(n),(i=>e(new CB(n,i))),s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PB(){return new kh("deleteField")}function DB(){return new _E("serverTimestamp")}function MB(...n){return new vE("arrayUnion",n)}function kB(...n){return new EE("arrayRemove",n)}function VB(n){return new TE("increment",n)}(function(e,t=!0){(function(i){Yc=i})(jo),qs(new Xn("firestore",((s,{instanceIdentifier:i,options:a})=>{const l=s.getProvider("app").getImmediate(),u=new Zt(new SO(s.getProvider("auth-internal")),new PO(l,s.getProvider("app-check-internal")),(function(m,_){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new he(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Mo(m.options.projectId,_)})(l,i),l);return a={useFetchStreams:t,...a},u._setSettings(a),u}),"PUBLIC").setMultipleInstances(!0)),Qn(hA,fA,e),Qn(hA,fA,"esm2020")})();const LB="@firebase/firestore-compat",UB="0.4.2";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new he("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(){if(typeof Uint8Array>"u")throw new he("unimplemented","Uint8Arrays are not available in this environment.")}function Ow(){if(!hF())throw new he("unimplemented","Blobs are unavailable in Firestore in this environment.")}let wP=class Cv{constructor(e){this._delegate=e}static fromBase64String(e){return Ow(),new Cv(Gn.fromBase64String(e))}static fromUint8Array(e){return Uw(),new Cv(Gn.fromUint8Array(e))}toBase64(){return Ow(),this._delegate.toBase64()}toUint8Array(){return Uw(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(n){return OB(n,["next","error","complete"])}function OB(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const s of e)if(s in t&&typeof t[s]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FB{enableIndexedDbPersistence(e,t){return K6(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return J6(e._delegate)}clearIndexedDbPersistence(e){return Q6(e._delegate)}}class NP{constructor(e,t,s){this._delegate=t,this._persistenceProvider=s,this.INTERNAL={delete:()=>this.terminate()},e instanceof Mo||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Yi("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,s={}){H6(this._delegate,e,t,s)}enableNetwork(){return X6(this._delegate)}disableNetwork(){return Z6(this._delegate)}enablePersistence(e){let t=!1,s=!1;return e&&(t=!!e.synchronizeTabs,s=!!e.experimentalForceOwningTab,WC("synchronizeTabs",t,"experimentalForceOwningTab",s)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,s)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return W6(this._delegate)}onSnapshotsInSync(e){return AB(this._delegate,e)}get app(){if(!this._appCompat)throw new he("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new jc(this,aP(this._delegate,e))}catch(t){throw Jn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Bs(this,hp(this._delegate,e))}catch(t){throw Jn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Kn(this,z6(this._delegate,e))}catch(t){throw Jn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return RB(this._delegate,t=>e(new SP(this,t)))}batch(){return zn(this._delegate),new CP(new NB(this._delegate,e=>Lh(this._delegate,e)))}loadBundle(e){return eB(this._delegate,e)}namedQuery(e){return tB(this._delegate,e).then(t=>t?new Kn(this,t):null)}}class rg extends CE{constructor(e){super(),this.firestore=e}convertBytes(e){return new wP(new Gn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Bs.forKey(t,this.firestore,null)}}function BB(n){bO(n)}class SP{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new rg(e)}get(e){const t=Va(e);return this._delegate.get(t).then(s=>new uh(this._firestore,new js(this._firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,t.converter)))}set(e,t,s){const i=Va(e);return s?(PE("Transaction.set",s),this._delegate.set(i,t,s)):this._delegate.set(i,t),this}update(e,t,s,...i){const a=Va(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,s,...i),this}delete(e){const t=Va(e);return this._delegate.delete(t),this}}class CP{constructor(e){this._delegate=e}set(e,t,s){const i=Va(e);return s?(PE("WriteBatch.set",s),this._delegate.set(i,t,s)):this._delegate.set(i,t),this}update(e,t,s,...i){const a=Va(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,s,...i),this}delete(e){const t=Va(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Za{constructor(e,t,s){this._firestore=e,this._userDataWriter=t,this._delegate=s}fromFirestore(e,t){const s=new Fd(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new dh(this._firestore,s),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const s=Za.INSTANCES;let i=s.get(e);i||(i=new WeakMap,s.set(e,i));let a=i.get(t);return a||(a=new Za(e,new rg(e),t),i.set(t,a)),a}}Za.INSTANCES=new WeakMap;class Bs{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new rg(e)}static forPath(e,t,s){if(e.length%2!==0)throw new he("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Bs(t,new Nt(t._delegate,s,new Te(e)))}static forKey(e,t,s){return new Bs(t,new Nt(t._delegate,s,e))}get id(){return this._delegate.id}get parent(){return new jc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new jc(this.firestore,aP(this._delegate,e))}catch(t){throw Jn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Le(e),e instanceof Nt?lP(this._delegate,e):!1}set(e,t){t=PE("DocumentReference.set",t);try{return t?Vw(this._delegate,e,t):Vw(this._delegate,e)}catch(s){throw Jn(s,"setDoc()","DocumentReference.set()")}}update(e,t,...s){try{return arguments.length===1?Lw(this._delegate,e):Lw(this._delegate,e,t,...s)}catch(i){throw Jn(i,"updateDoc()","DocumentReference.update()")}}delete(){return IB(this._delegate)}onSnapshot(...e){const t=RP(e),s=PP(e,i=>new uh(this.firestore,new js(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return AP(this._delegate,t,s)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=_B(this._delegate):(e==null?void 0:e.source)==="server"?t=vB(this._delegate):t=yB(this._delegate),t.then(s=>new uh(this.firestore,new js(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)))}withConverter(e){return new Bs(this.firestore,e?this._delegate.withConverter(Za.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Jn(n,e,t){return n.message=n.message.replace(e,t),n}function RP(n){for(const e of n)if(typeof e=="object"&&!Rv(e))return e;return{}}function PP(n,e){var s,i;let t;return Rv(n[0])?t=n[0]:Rv(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:a=>{t.next&&t.next(e(a))},error:(s=t.error)==null?void 0:s.bind(t),complete:(i=t.complete)==null?void 0:i.bind(t)}}class uh{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Bs(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return bP(this._delegate,e._delegate)}}class dh extends uh{data(e){const t=this._delegate.data(e);return this._delegate._converter||AO(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class Kn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new rg(e)}where(e,t,s){try{return new Kn(this.firestore,_o(this._delegate,aB(e,t,s)))}catch(i){throw Jn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Kn(this.firestore,_o(this._delegate,lB(e,t)))}catch(s){throw Jn(s,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Kn(this.firestore,_o(this._delegate,cB(e)))}catch(t){throw Jn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Kn(this.firestore,_o(this._delegate,uB(e)))}catch(t){throw Jn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Kn(this.firestore,_o(this._delegate,dB(...e)))}catch(t){throw Jn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Kn(this.firestore,_o(this._delegate,hB(...e)))}catch(t){throw Jn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Kn(this.firestore,_o(this._delegate,fB(...e)))}catch(t){throw Jn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Kn(this.firestore,_o(this._delegate,mB(...e)))}catch(t){throw Jn(t,"endAt()","Query.endAt()")}}isEqual(e){return cP(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=TB(this._delegate):(e==null?void 0:e.source)==="server"?t=xB(this._delegate):t=EB(this._delegate),t.then(s=>new Pv(this.firestore,new li(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)))}onSnapshot(...e){const t=RP(e),s=PP(e,i=>new Pv(this.firestore,new li(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return AP(this._delegate,t,s)}withConverter(e){return new Kn(this.firestore,e?this._delegate.withConverter(Za.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class jB{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new dh(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Pv{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Kn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new dh(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new jB(this._firestore,t))}forEach(e,t){this._delegate.forEach(s=>{e.call(t,new dh(this._firestore,s))})}isEqual(e){return bP(this._delegate,e._delegate)}}class jc extends Kn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Bs(this.firestore,e):null}doc(e){try{return e===void 0?new Bs(this.firestore,hp(this._delegate)):new Bs(this.firestore,hp(this._delegate,e))}catch(t){throw Jn(t,"doc()","CollectionReference.doc()")}}add(e){return bB(this._delegate,e).then(t=>new Bs(this.firestore,t))}isEqual(e){return lP(this._delegate,e._delegate)}withConverter(e){return new jc(this.firestore,e?this._delegate.withConverter(Za.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Va(n){return ut(n,Nt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(...e){this._delegate=new Fo(...e)}static documentId(){return new DE(Ot.keyField().canonicalString())}isEqual(e){return e=Le(e),e instanceof Fo?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{static serverTimestamp(){const e=DB();return e._methodName="FieldValue.serverTimestamp",new Pa(e)}static delete(){const e=PB();return e._methodName="FieldValue.delete",new Pa(e)}static arrayUnion(...e){const t=MB(...e);return t._methodName="FieldValue.arrayUnion",new Pa(t)}static arrayRemove(...e){const t=kB(...e);return t._methodName="FieldValue.arrayRemove",new Pa(t)}static increment(e){const t=VB(e);return t._methodName="FieldValue.increment",new Pa(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GB={Firestore:NP,GeoPoint:ai,Timestamp:gt,Blob:wP,Transaction:SP,WriteBatch:CP,DocumentReference:Bs,DocumentSnapshot:uh,Query:Kn,QueryDocumentSnapshot:dh,QuerySnapshot:Pv,CollectionReference:jc,FieldPath:DE,FieldValue:Pa,setLogLevel:BB,CACHE_SIZE_UNLIMITED:Y6};function qB(n,e){n.INTERNAL.registerComponent(new Xn("firestore-compat",t=>{const s=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(s,i)},"PUBLIC").setServiceProps({...GB}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HB(n){qB(n,(e,t)=>new NP(e,t,new FB)),n.registerVersion(LB,UB)}HB(je);const DP="@firebase/installations",ME="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP=1e4,kP=`w:${ME}`,VP="FIS_v2",zB="https://firebaseinstallations.googleapis.com/v1",$B=3600*1e3,YB="installations",KB="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JB={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},el=new wr(YB,KB,JB);function LP(n){return n instanceof Vn&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UP({projectId:n}){return`${zB}/projects/${n}/installations`}function OP(n){return{token:n.token,requestStatus:2,expiresIn:WB(n.expiresIn),creationTime:Date.now()}}async function FP(n,e){const s=(await e.json()).error;return el.create("request-failed",{requestName:n,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function BP({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function QB(n,{refreshToken:e}){const t=BP(n);return t.append("Authorization",XB(e)),t}async function jP(n){const e=await n();return e.status>=500&&e.status<600?n():e}function WB(n){return Number(n.replace("s","000"))}function XB(n){return`${VP} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZB({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const s=UP(n),i=BP(n),a=e.getImmediate({optional:!0});if(a){const m=await a.getHeartbeatsHeader();m&&i.append("x-firebase-client",m)}const l={fid:t,authVersion:VP,appId:n.appId,sdkVersion:kP},u={method:"POST",headers:i,body:JSON.stringify(l)},f=await jP(()=>fetch(s,u));if(f.ok){const m=await f.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:OP(m.authToken)}}else throw await FP("Create Installation",f)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GP(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e3(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3=/^[cdef][\w-]{21}$/,Dv="";function n3(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=s3(n);return t3.test(t)?t:Dv}catch{return Dv}}function s3(n){return e3(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function og(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qP=new Map;function HP(n,e){const t=og(n);zP(t,e),i3(t,e)}function zP(n,e){const t=qP.get(n);if(t)for(const s of t)s(e)}function i3(n,e){const t=r3();t&&t.postMessage({key:n,fid:e}),o3()}let La=null;function r3(){return!La&&"BroadcastChannel"in self&&(La=new BroadcastChannel("[Firebase] FID Change"),La.onmessage=n=>{zP(n.data.key,n.data.fid)}),La}function o3(){qP.size===0&&La&&(La.close(),La=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a3="firebase-installations-database",l3=1,tl="firebase-installations-store";let j_=null;function kE(){return j_||(j_=VS(a3,l3,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(tl)}}})),j_}async function mp(n,e){const t=og(n),i=(await kE()).transaction(tl,"readwrite"),a=i.objectStore(tl),l=await a.get(t);return await a.put(e,t),await i.done,(!l||l.fid!==e.fid)&&HP(n,e.fid),e}async function $P(n){const e=og(n),s=(await kE()).transaction(tl,"readwrite");await s.objectStore(tl).delete(e),await s.done}async function ag(n,e){const t=og(n),i=(await kE()).transaction(tl,"readwrite"),a=i.objectStore(tl),l=await a.get(t),u=e(l);return u===void 0?await a.delete(t):await a.put(u,t),await i.done,u&&(!l||l.fid!==u.fid)&&HP(n,u.fid),u}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VE(n){let e;const t=await ag(n.appConfig,s=>{const i=c3(s),a=u3(n,i);return e=a.registrationPromise,a.installationEntry});return t.fid===Dv?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function c3(n){const e=n||{fid:n3(),registrationStatus:0};return YP(e)}function u3(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(el.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=d3(n,t);return{installationEntry:t,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:h3(n)}:{installationEntry:e}}async function d3(n,e){try{const t=await ZB(n,e);return mp(n.appConfig,t)}catch(t){throw LP(t)&&t.customData.serverCode===409?await $P(n.appConfig):await mp(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function h3(n){let e=await Fw(n.appConfig);for(;e.registrationStatus===1;)await GP(100),e=await Fw(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:s}=await VE(n);return s||t}return e}function Fw(n){return ag(n,e=>{if(!e)throw el.create("installation-not-found");return YP(e)})}function YP(n){return f3(n)?{fid:n.fid,registrationStatus:0}:n}function f3(n){return n.registrationStatus===1&&n.registrationTime+MP<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m3({appConfig:n,heartbeatServiceProvider:e},t){const s=p3(n,t),i=QB(n,t),a=e.getImmediate({optional:!0});if(a){const m=await a.getHeartbeatsHeader();m&&i.append("x-firebase-client",m)}const l={installation:{sdkVersion:kP,appId:n.appId}},u={method:"POST",headers:i,body:JSON.stringify(l)},f=await jP(()=>fetch(s,u));if(f.ok){const m=await f.json();return OP(m)}else throw await FP("Generate Auth Token",f)}function p3(n,{fid:e}){return`${UP(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LE(n,e=!1){let t;const s=await ag(n.appConfig,a=>{if(!KP(a))throw el.create("not-registered");const l=a.authToken;if(!e&&_3(l))return a;if(l.requestStatus===1)return t=g3(n,e),a;{if(!navigator.onLine)throw el.create("app-offline");const u=E3(a);return t=y3(n,u),u}});return t?await t:s.authToken}async function g3(n,e){let t=await Bw(n.appConfig);for(;t.authToken.requestStatus===1;)await GP(100),t=await Bw(n.appConfig);const s=t.authToken;return s.requestStatus===0?LE(n,e):s}function Bw(n){return ag(n,e=>{if(!KP(e))throw el.create("not-registered");const t=e.authToken;return T3(t)?{...e,authToken:{requestStatus:0}}:e})}async function y3(n,e){try{const t=await m3(n,e),s={...e,authToken:t};return await mp(n.appConfig,s),t}catch(t){if(LP(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await $P(n.appConfig);else{const s={...e,authToken:{requestStatus:0}};await mp(n.appConfig,s)}throw t}}function KP(n){return n!==void 0&&n.registrationStatus===2}function _3(n){return n.requestStatus===2&&!v3(n)}function v3(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+$B}function E3(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function T3(n){return n.requestStatus===1&&n.requestTime+MP<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x3(n){const e=n,{installationEntry:t,registrationPromise:s}=await VE(e);return s?s.catch(console.error):LE(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I3(n,e=!1){const t=n;return await b3(t),(await LE(t,e)).token}async function b3(n){const{registrationPromise:e}=await VE(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A3(n){if(!n||!n.options)throw G_("App Configuration");if(!n.name)throw G_("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw G_(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function G_(n){return el.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP="installations",w3="installations-internal",N3=n=>{const e=n.getProvider("app").getImmediate(),t=A3(e),s=xp(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},S3=n=>{const e=n.getProvider("app").getImmediate(),t=xp(e,JP).getImmediate();return{getId:()=>x3(t),getToken:i=>I3(t,i)}};function C3(){qs(new Xn(JP,N3,"PUBLIC")),qs(new Xn(w3,S3,"PRIVATE"))}C3();Qn(DP,ME);Qn(DP,ME,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw="analytics",R3="firebase_id",P3="origin",D3=60*1e3,M3="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",UE="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An=new mh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},As=new wr("analytics","Analytics",k3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V3(n){if(!n.startsWith(UE)){const e=As.create("invalid-gtag-resource",{gtagURL:n});return An.warn(e.message),""}return n}function QP(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function L3(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function U3(n,e){const t=L3("firebase-js-sdk-policy",{createScriptURL:V3}),s=document.createElement("script"),i=`${UE}?l=${n}&id=${e}`;s.src=t?t==null?void 0:t.createScriptURL(i):i,s.async=!0,document.head.appendChild(s)}function O3(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function F3(n,e,t,s,i,a){const l=s[i];try{if(l)await e[l];else{const f=(await QP(t)).find(m=>m.measurementId===i);f&&await e[f.appId]}}catch(u){An.error(u)}n("config",i,a)}async function B3(n,e,t,s,i){try{let a=[];if(i&&i.send_to){let l=i.send_to;Array.isArray(l)||(l=[l]);const u=await QP(t);for(const f of l){const m=u.find(T=>T.measurementId===f),_=m&&e[m.appId];if(_)a.push(_);else{a=[];break}}}a.length===0&&(a=Object.values(e)),await Promise.all(a),n("event",s,i||{})}catch(a){An.error(a)}}function j3(n,e,t,s){async function i(a,...l){try{if(a==="event"){const[u,f]=l;await B3(n,e,t,u,f)}else if(a==="config"){const[u,f]=l;await F3(n,e,t,s,u,f)}else if(a==="consent"){const[u,f]=l;n("consent",u,f)}else if(a==="get"){const[u,f,m]=l;n("get",u,f,m)}else if(a==="set"){const[u]=l;n("set",u)}else n(a,...l)}catch(u){An.error(u)}}return i}function G3(n,e,t,s,i){let a=function(...l){window[s].push(arguments)};return window[i]&&typeof window[i]=="function"&&(a=window[i]),window[i]=j3(a,n,e,t),{gtagCore:a,wrappedGtag:window[i]}}function q3(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(UE)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H3=30,z3=1e3;class $3{constructor(e={},t=z3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const WP=new $3;function Y3(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function K3(n){var l;const{appId:e,apiKey:t}=n,s={method:"GET",headers:Y3(t)},i=M3.replace("{app-id}",e),a=await fetch(i,s);if(a.status!==200&&a.status!==304){let u="";try{const f=await a.json();(l=f.error)!=null&&l.message&&(u=f.error.message)}catch{}throw As.create("config-fetch-failed",{httpStatus:a.status,responseMessage:u})}return a.json()}async function J3(n,e=WP,t){const{appId:s,apiKey:i,measurementId:a}=n.options;if(!s)throw As.create("no-app-id");if(!i){if(a)return{measurementId:a,appId:s};throw As.create("no-api-key")}const l=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new X3;return setTimeout(async()=>{u.abort()},D3),XP({appId:s,apiKey:i,measurementId:a},l,u,e)}async function XP(n,{throttleEndTimeMillis:e,backoffCount:t},s,i=WP){var u;const{appId:a,measurementId:l}=n;try{await Q3(s,e)}catch(f){if(l)return An.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${f==null?void 0:f.message}]`),{appId:a,measurementId:l};throw f}try{const f=await K3(n);return i.deleteThrottleMetadata(a),f}catch(f){const m=f;if(!W3(m)){if(i.deleteThrottleMetadata(a),l)return An.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${m==null?void 0:m.message}]`),{appId:a,measurementId:l};throw f}const _=Number((u=m==null?void 0:m.customData)==null?void 0:u.httpStatus)===503?Mb(t,i.intervalMillis,H3):Mb(t,i.intervalMillis),T={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return i.setThrottleMetadata(a,T),An.debug(`Calling attemptFetch again in ${_} millis`),XP(n,T,s,i)}}function Q3(n,e){return new Promise((t,s)=>{const i=Math.max(e-Date.now(),0),a=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(a),s(As.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function W3(n){if(!(n instanceof Vn)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class X3{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Z3(n,e,t,s,i){if(i&&i.global){n("event",t,s);return}else{const a=await e,l={...s,send_to:a};n("event",t,l)}}async function ej(n,e,t,s){if(s&&s.global)return n("set",{screen_name:t}),Promise.resolve();{const i=await e;n("config",i,{update:!0,screen_name:t})}}async function tj(n,e,t,s){if(s&&s.global)return n("set",{user_id:t}),Promise.resolve();{const i=await e;n("config",i,{update:!0,user_id:t})}}async function nj(n,e,t,s){if(s&&s.global){const i={};for(const a of Object.keys(t))i[`user_properties.${a}`]=t[a];return n("set",i),Promise.resolve()}else{const i=await e;n("config",i,{update:!0,user_properties:t})}}async function sj(n,e){const t=await n;window[`ga-disable-${t}`]=!e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ij(){if(ja())try{await Xv()}catch(n){return An.warn(As.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return An.warn(As.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function rj(n,e,t,s,i,a,l){const u=J3(n);u.then(x=>{t[x.measurementId]=x.appId,n.options.measurementId&&x.measurementId!==n.options.measurementId&&An.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${x.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(x=>An.error(x)),e.push(u);const f=ij().then(x=>{if(x)return s.getId()}),[m,_]=await Promise.all([u,f]);q3(a)||U3(a,m.measurementId),i("js",new Date);const T=(l==null?void 0:l.config)??{};return T[P3]="firebase",T.update=!0,_!=null&&(T[R3]=_),i("config",m.measurementId,T),m.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oj=class{constructor(e){this.app=e}_delete(){return delete vr[this.app.options.appId],Promise.resolve()}},vr={},Gw=[];const qw={};let Om="dataLayer",ZP="gtag",Hw,Uh,Mv=!1;function aj(n){if(Mv)throw As.create("already-initialized");n.dataLayerName&&(Om=n.dataLayerName),n.gtagName&&(ZP=n.gtagName)}function lj(){const n=[];if(Tp()&&n.push("This is a browser extension environment."),CS()||n.push("Cookies are not available."),n.length>0){const e=n.map((s,i)=>`(${i+1}) ${s}`).join(" "),t=As.create("invalid-analytics-context",{errorInfo:e});An.warn(t.message)}}function cj(n,e,t){lj();const s=n.options.appId;if(!s)throw As.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)An.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw As.create("no-api-key");if(vr[s]!=null)throw As.create("already-exists",{id:s});if(!Mv){O3(Om);const{wrappedGtag:a,gtagCore:l}=G3(vr,Gw,qw,Om,ZP);Uh=a,Hw=l,Mv=!0}return vr[s]=rj(n,Gw,qw,e,Hw,Om,t),new oj(n)}async function uj(){if(Tp()||!CS()||!ja())return!1;try{return await Xv()}catch{return!1}}function dj(n,e,t){n=Le(n),ej(Uh,vr[n.app.options.appId],e,t).catch(s=>An.error(s))}function hj(n,e,t){n=Le(n),tj(Uh,vr[n.app.options.appId],e,t).catch(s=>An.error(s))}function eD(n,e,t){n=Le(n),nj(Uh,vr[n.app.options.appId],e,t).catch(s=>An.error(s))}function fj(n,e){n=Le(n),sj(vr[n.app.options.appId],e).catch(t=>An.error(t))}function tD(n,e,t,s){n=Le(n),Z3(Uh,vr[n.app.options.appId],e,t,s).catch(i=>An.error(i))}const zw="@firebase/analytics",$w="0.10.19";function mj(){qs(new Xn(jw,(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return cj(s,i,t)},"PUBLIC")),qs(new Xn("analytics-internal",n,"PRIVATE")),Qn(zw,$w),Qn(zw,$w,"esm2020");function n(e){try{const t=e.getProvider(jw).getImmediate();return{logEvent:(s,i,a)=>tD(t,s,i,a),setUserProperties:(s,i)=>eD(t,s,i)}}catch(t){throw As.create("interop-component-reg-failed",{reason:t})}}}mj();const pj="@firebase/analytics-compat",gj="0.2.25";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e,t){this.app=e,this._delegate=t}logEvent(e,t,s){tD(this._delegate,e,t,s)}setCurrentScreen(e,t){dj(this._delegate,e,t)}setUserId(e,t){hj(this._delegate,e,t)}setUserProperties(e,t){eD(this._delegate,e,t)}setAnalyticsCollectionEnabled(e){fj(this._delegate,e)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kv;(function(n){n.ADD_SHIPPING_INFO="add_shipping_info",n.ADD_PAYMENT_INFO="add_payment_info",n.ADD_TO_CART="add_to_cart",n.ADD_TO_WISHLIST="add_to_wishlist",n.BEGIN_CHECKOUT="begin_checkout",n.CHECKOUT_PROGRESS="checkout_progress",n.EXCEPTION="exception",n.GENERATE_LEAD="generate_lead",n.LOGIN="login",n.PAGE_VIEW="page_view",n.PURCHASE="purchase",n.REFUND="refund",n.REMOVE_FROM_CART="remove_from_cart",n.SCREEN_VIEW="screen_view",n.SEARCH="search",n.SELECT_CONTENT="select_content",n.SELECT_ITEM="select_item",n.SELECT_PROMOTION="select_promotion",n.SET_CHECKOUT_OPTION="set_checkout_option",n.SHARE="share",n.SIGN_UP="sign_up",n.TIMING_COMPLETE="timing_complete",n.VIEW_CART="view_cart",n.VIEW_ITEM="view_item",n.VIEW_ITEM_LIST="view_item_list",n.VIEW_PROMOTION="view_promotion",n.VIEW_SEARCH_RESULTS="view_search_results"})(kv||(kv={}));/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yj=n=>{const e=n.getProvider("app-compat").getImmediate(),t=n.getProvider("analytics").getImmediate();return new nD(e,t)};function _j(){const n={Analytics:nD,settings:aj,isSupported:uj,EventName:kv};je.INTERNAL.registerComponent(new Xn("analytics-compat",yj,"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}_j();je.registerVersion(pj,gj);const vj={apiKey:"AIzaSyCPOpbMFudxzh39jrwJ5ATtYNpGiH5Oqkk",authDomain:"labman-e07d2.firebaseapp.com",projectId:"labman-e07d2",storageBucket:"labman-e07d2.firebasestorage.app",messagingSenderId:"843086697564",appId:"1:843086697564:web:c4549ab625e350d6538299",measurementId:"G-86EX8W8S4M"};je.apps.length||je.initializeApp(vj);je.app();if(typeof window<"u")try{je.analytics()}catch{console.warn("Firebase Analytics not supported in this environment")}const xe=je.firestore(),Dt=je.auth();try{xe.settings({cacheSizeBytes:je.firestore.CACHE_SIZE_UNLIMITED,ignoreUndefinedProperties:!0})}catch{console.log("Firestore settings already applied")}xe.disableNetwork().then(()=>xe.enableNetwork()).catch(n=>{console.warn("Firestore network toggle failed:",n)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Ej,Tj;function xj(){return{geminiUrl:Ej,vertexUrl:Tj}}function Ij(n,e,t,s){var i,a;if(!(n!=null&&n.baseUrl)){const l=xj();return e?(i=l.vertexUrl)!==null&&i!==void 0?i:t:(a=l.geminiUrl)!==null&&a!==void 0?a:s}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Mr{}function Ae(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(s,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const a=e[i];return a!=null?String(a):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function g(n,e,t){for(let a=0;a<e.length-1;a++){const l=e[a];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in n))if(Array.isArray(t))n[u]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(n[u])){const f=n[u];if(Array.isArray(t))for(let m=0;m<f.length;m++){const _=f[m];g(_,e.slice(a+1),t[m])}else for(const m of f)g(m,e.slice(a+1),t)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in n||(n[u]=[{}]);const f=n[u];g(f[0],e.slice(a+1),t);return}(!n[l]||typeof n[l]!="object")&&(n[l]={}),n=n[l]}const s=e[e.length-1],i=n[s];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else s==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[s]=t}function p(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let s=0;s<e.length;s++){if(typeof n!="object"||n===null)return t;const i=e[s];if(i.endsWith("[]")){const a=i.slice(0,-2);if(a in n){const l=n[a];return Array.isArray(l)?l.map(u=>p(u,e.slice(s+1),t)):t}else return t}else n=n[i]}return n}catch(s){if(s instanceof TypeError)return t;throw s}}function bj(n,e){for(const[t,s]of Object.entries(e)){const i=t.split("."),a=s.split("."),l=new Set;let u=-1;for(let f=0;f<i.length;f++)if(i[f]==="*"){u=f;break}if(u!==-1&&a.length>u)for(let f=u;f<a.length;f++){const m=a[f];m!=="*"&&!m.endsWith("[]")&&!m.endsWith("[0]")&&l.add(m)}Vv(n,i,a,0,l)}}function Vv(n,e,t,s,i){if(s>=e.length||typeof n!="object"||n===null)return;const a=e[s];if(a.endsWith("[]")){const l=a.slice(0,-2),u=n;if(l in u&&Array.isArray(u[l]))for(const f of u[l])Vv(f,e,t,s+1,i)}else if(a==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const l=n,u=Object.keys(l).filter(m=>!m.startsWith("_")&&!i.has(m)),f={};for(const m of u)f[m]=l[m];for(const[m,_]of Object.entries(f)){const T=[];for(const x of t.slice(s))x==="*"?T.push(m):T.push(x);g(l,T,_)}for(const m of u)delete l[m]}}else{const l=n;a in l&&Vv(l[a],e,t,s+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OE(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Aj(n){const e={},t=p(n,["operationName"]);t!=null&&g(e,["operationName"],t);const s=p(n,["resourceName"]);return s!=null&&g(e,["_url","resourceName"],s),e}function wj(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const s=p(n,["metadata"]);s!=null&&g(e,["metadata"],s);const i=p(n,["done"]);i!=null&&g(e,["done"],i);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response","generateVideoResponse"]);return l!=null&&g(e,["response"],Sj(l)),e}function Nj(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const s=p(n,["metadata"]);s!=null&&g(e,["metadata"],s);const i=p(n,["done"]);i!=null&&g(e,["done"],i);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response"]);return l!=null&&g(e,["response"],Cj(l)),e}function Sj(n){const e={},t=p(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>Rj(l))),g(e,["generatedVideos"],a)}const s=p(n,["raiMediaFilteredCount"]);s!=null&&g(e,["raiMediaFilteredCount"],s);const i=p(n,["raiMediaFilteredReasons"]);return i!=null&&g(e,["raiMediaFilteredReasons"],i),e}function Cj(n){const e={},t=p(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>Pj(l))),g(e,["generatedVideos"],a)}const s=p(n,["raiMediaFilteredCount"]);s!=null&&g(e,["raiMediaFilteredCount"],s);const i=p(n,["raiMediaFilteredReasons"]);return i!=null&&g(e,["raiMediaFilteredReasons"],i),e}function Rj(n){const e={},t=p(n,["video"]);return t!=null&&g(e,["video"],Uj(t)),e}function Pj(n){const e={},t=p(n,["_self"]);return t!=null&&g(e,["video"],Oj(t)),e}function Dj(n){const e={},t=p(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function Mj(n){const e={},t=p(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function kj(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const s=p(n,["metadata"]);s!=null&&g(e,["metadata"],s);const i=p(n,["done"]);i!=null&&g(e,["done"],i);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response"]);return l!=null&&g(e,["response"],Vj(l)),e}function Vj(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["parent"]);s!=null&&g(e,["parent"],s);const i=p(n,["documentName"]);return i!=null&&g(e,["documentName"],i),e}function sD(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const s=p(n,["metadata"]);s!=null&&g(e,["metadata"],s);const i=p(n,["done"]);i!=null&&g(e,["done"],i);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response"]);return l!=null&&g(e,["response"],Lj(l)),e}function Lj(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["parent"]);s!=null&&g(e,["parent"],s);const i=p(n,["documentName"]);return i!=null&&g(e,["documentName"],i),e}function Uj(n){const e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);const s=p(n,["encodedVideo"]);s!=null&&g(e,["videoBytes"],OE(s));const i=p(n,["encoding"]);return i!=null&&g(e,["mimeType"],i),e}function Oj(n){const e={},t=p(n,["gcsUri"]);t!=null&&g(e,["uri"],t);const s=p(n,["bytesBase64Encoded"]);s!=null&&g(e,["videoBytes"],OE(s));const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Yw;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Yw||(Yw={}));var Kw;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Kw||(Kw={}));var Jw;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(Jw||(Jw={}));var Io;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Io||(Io={}));var Qw;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Qw||(Qw={}));var Ww;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Ww||(Ww={}));var Xw;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Xw||(Xw={}));var Zw;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Zw||(Zw={}));var eN;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(eN||(eN={}));var tN;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(tN||(tN={}));var nN;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(nN||(nN={}));var sN;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(sN||(sN={}));var iN;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(iN||(iN={}));var rN;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(rN||(rN={}));var oN;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(oN||(oN={}));var aN;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(aN||(aN={}));var lN;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(lN||(lN={}));var cN;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(cN||(cN={}));var uN;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(uN||(uN={}));var pp;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(pp||(pp={}));var dN;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(dN||(dN={}));var hN;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(hN||(hN={}));var fN;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(fN||(fN={}));var Lv;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Lv||(Lv={}));var mN;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(mN||(mN={}));var pN;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(pN||(pN={}));var gN;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(gN||(gN={}));var yN;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(yN||(yN={}));var _N;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(_N||(_N={}));var vN;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(vN||(vN={}));var EN;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(EN||(EN={}));var TN;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(TN||(TN={}));var xN;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(xN||(xN={}));var IN;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(IN||(IN={}));var bN;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(bN||(bN={}));var AN;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(AN||(AN={}));var wN;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(wN||(wN={}));var NN;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(NN||(NN={}));var SN;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(SN||(SN={}));var CN;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(CN||(CN={}));var RN;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(RN||(RN={}));var PN;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(PN||(PN={}));var DN;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(DN||(DN={}));var MN;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(MN||(MN={}));var kN;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(kN||(kN={}));var VN;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(VN||(VN={}));var LN;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(LN||(LN={}));var UN;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(UN||(UN={}));var ON;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(ON||(ON={}));var FN;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(FN||(FN={}));var BN;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(BN||(BN={}));var jN;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(jN||(jN={}));var GN;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(GN||(GN={}));var qN;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(qN||(qN={}));var cc;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(cc||(cc={}));class Uv{constructor(e){const t={};for(const s of e.headers.entries())t[s[0]]=s[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class pd{get text(){var e,t,s,i,a,l,u,f;if(((i=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",_=!1;const T=[];for(const x of(f=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&f!==void 0?f:[]){for(const[b,k]of Object.entries(x))b!=="text"&&b!=="thought"&&b!=="thoughtSignature"&&(k!==null||k!==void 0)&&T.push(b);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;_=!0,m+=x.text}}return T.length>0&&console.warn(`there are non-text parts ${T} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),_?m:void 0}get data(){var e,t,s,i,a,l,u,f;if(((i=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="";const _=[];for(const T of(f=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&f!==void 0?f:[]){for(const[x,b]of Object.entries(T))x!=="inlineData"&&(b!==null||b!==void 0)&&_.push(x);T.inlineData&&typeof T.inlineData.data=="string"&&(m+=atob(T.inlineData.data))}return _.length>0&&console.warn(`there are non-data parts ${_} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var e,t,s,i,a,l,u,f;if(((i=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const m=(f=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(_=>_.functionCall).map(_=>_.functionCall).filter(_=>_!==void 0);if((m==null?void 0:m.length)!==0)return m}get executableCode(){var e,t,s,i,a,l,u,f,m;if(((i=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const _=(f=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(T=>T.executableCode).map(T=>T.executableCode).filter(T=>T!==void 0);if((_==null?void 0:_.length)!==0)return(m=_==null?void 0:_[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var e,t,s,i,a,l,u,f,m;if(((i=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const _=(f=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||f===void 0?void 0:f.filter(T=>T.codeExecutionResult).map(T=>T.codeExecutionResult).filter(T=>T!==void 0);if((_==null?void 0:_.length)!==0)return(m=_==null?void 0:_[0])===null||m===void 0?void 0:m.output}}class HN{}class zN{}class Fj{}class Bj{}class jj{}class Gj{}class $N{}class YN{}class KN{}class qj{}class gp{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const s=new gp;let i;const a=e;return t?i=Nj(a):i=wj(a),Object.assign(s,i),s}}class JN{}class QN{}class WN{}class XN{}class Hj{}class zj{}class $j{}class FE{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const s=new FE,a=kj(e);return Object.assign(s,a),s}}class Yj{}class Kj{}class Jj{}class ZN{}class Qj{get text(){var e,t,s;let i="",a=!1;const l=[];for(const u of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[f,m]of Object.entries(u))f!=="text"&&f!=="thought"&&m!==null&&l.push(f);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;a=!0,i+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?i:void 0}get data(){var e,t,s;let i="";const a=[];for(const l of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[u,f]of Object.entries(l))u!=="inlineData"&&f!==null&&a.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(i+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class Wj{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class BE{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const s=new BE,a=sD(e);return Object.assign(s,a),s}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function iD(n,e){const t=dt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function rD(n){return Array.isArray(n)?n.map(e=>yp(e)):[yp(n)]}function yp(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function oD(n){const e=yp(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function aD(n){const e=yp(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function eS(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function lD(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>eS(e)):[eS(n)]}function Ov(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function tS(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function nS(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function qn(n){if(n==null)throw new Error("ContentUnion is required");return Ov(n)?n:{role:"user",parts:lD(n)}}function jE(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const s=qn(t);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(n.isVertexAI()){const t=qn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>qn(t)):[qn(e)]}function Gs(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(tS(n)||nS(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[qn(n)]}const e=[],t=[],s=Ov(n[0]);for(const i of n){const a=Ov(i);if(a!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(i);else{if(tS(i)||nS(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(i)}}return s||e.push({role:"user",parts:lD(t)}),e}function Xj(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(s=>s!=="null");if(t.length===1)e.type=Object.values(Io).includes(t[0].toUpperCase())?t[0].toUpperCase():Io.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const s of t)e.anyOf.push({type:Object.values(Io).includes(s.toUpperCase())?s.toUpperCase():Io.TYPE_UNSPECIFIED})}}function gc(n){const e={},t=["items"],s=["anyOf"],i=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&Xj(n.type,e);for(const[l,u]of Object.entries(n))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(Io).includes(u.toUpperCase())?u.toUpperCase():Io.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=gc(u);else if(s.includes(l)){const f=[];for(const m of u){if(m.type=="null"){e.nullable=!0;continue}f.push(gc(m))}e[l]=f}else if(i.includes(l)){const f={};for(const[m,_]of Object.entries(u))f[m]=gc(_);e[l]=f}else{if(l==="additionalProperties")continue;e[l]=u}return e}function GE(n){return gc(n)}function qE(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function HE(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function tu(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=gc(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=gc(e.response));return n}function nu(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function Zj(n,e,t,s=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===s;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:i?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function kr(n,e){if(typeof e!="string")throw new Error("name must be a string");return Zj(n,e,"cachedContents")}function cD(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Ko(n){return OE(n)}function eG(n){return n!=null&&typeof n=="object"&&"name"in n}function tG(n){return n!=null&&typeof n=="object"&&"video"in n}function nG(n){return n!=null&&typeof n=="object"&&"uri"in n}function uD(n){var e;let t;if(eG(n)&&(t=n.name),!(nG(n)&&(t=n.uri,t===void 0))&&!(tG(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const i=t.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${t}`);t=i[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function dD(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function hD(n){for(const e of["models","tunedModels","publisherModels"])if(sG(n,e))return n[e];return[]}function sG(n,e){return n!==null&&typeof n=="object"&&e in n}function iG(n,e={}){const t=n,s={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(s.responseJsonSchema=t.outputSchema),e.behavior&&(s.behavior=e.behavior),{functionDeclarations:[s]}}function rG(n,e={}){const t=[],s=new Set;for(const i of n){const a=i.name;if(s.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);s.add(a);const l=iG(i,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function fD(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const s=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,i=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(i>0||s!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(s>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function oG(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function mD(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const i=t.inlinedResponses;if(!Array.isArray(i)||i.length===0)return n;let a=!1;for(const l of i){if(typeof l!="object"||l===null)continue;const f=l.response;if(typeof f!="object"||f===null)continue;if(f.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function su(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function pD(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aG(n){const e={},t=p(n,["responsesFile"]);t!=null&&g(e,["fileName"],t);const s=p(n,["inlinedResponses","inlinedResponses"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>jG(l))),g(e,["inlinedResponses"],a)}const i=p(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["inlinedEmbedContentResponses"],a)}return e}function lG(n){const e={},t=p(n,["predictionsFormat"]);t!=null&&g(e,["format"],t);const s=p(n,["gcsDestination","outputUriPrefix"]);s!=null&&g(e,["gcsUri"],s);const i=p(n,["bigqueryDestination","outputUri"]);return i!=null&&g(e,["bigqueryUri"],i),e}function cG(n){const e={},t=p(n,["format"]);t!=null&&g(e,["predictionsFormat"],t);const s=p(n,["gcsUri"]);s!=null&&g(e,["gcsDestination","outputUriPrefix"],s);const i=p(n,["bigqueryUri"]);if(i!=null&&g(e,["bigqueryDestination","outputUri"],i),p(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(p(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Fm(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const s=p(n,["metadata","displayName"]);s!=null&&g(e,["displayName"],s);const i=p(n,["metadata","state"]);i!=null&&g(e,["state"],pD(i));const a=p(n,["metadata","createTime"]);a!=null&&g(e,["createTime"],a);const l=p(n,["metadata","endTime"]);l!=null&&g(e,["endTime"],l);const u=p(n,["metadata","updateTime"]);u!=null&&g(e,["updateTime"],u);const f=p(n,["metadata","model"]);f!=null&&g(e,["model"],f);const m=p(n,["metadata","output"]);return m!=null&&g(e,["dest"],aG(mD(m))),e}function Fv(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const s=p(n,["displayName"]);s!=null&&g(e,["displayName"],s);const i=p(n,["state"]);i!=null&&g(e,["state"],pD(i));const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["createTime"]);l!=null&&g(e,["createTime"],l);const u=p(n,["startTime"]);u!=null&&g(e,["startTime"],u);const f=p(n,["endTime"]);f!=null&&g(e,["endTime"],f);const m=p(n,["updateTime"]);m!=null&&g(e,["updateTime"],m);const _=p(n,["model"]);_!=null&&g(e,["model"],_);const T=p(n,["inputConfig"]);T!=null&&g(e,["src"],uG(T));const x=p(n,["outputConfig"]);x!=null&&g(e,["dest"],lG(mD(x)));const b=p(n,["completionStats"]);return b!=null&&g(e,["completionStats"],b),e}function uG(n){const e={},t=p(n,["instancesFormat"]);t!=null&&g(e,["format"],t);const s=p(n,["gcsSource","uris"]);s!=null&&g(e,["gcsUri"],s);const i=p(n,["bigquerySource","inputUri"]);return i!=null&&g(e,["bigqueryUri"],i),e}function dG(n,e){const t={};if(p(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=p(e,["fileName"]);s!=null&&g(t,["fileName"],s);const i=p(e,["inlinedRequests"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>BG(n,l))),g(t,["requests","requests"],a)}return t}function hG(n){const e={},t=p(n,["format"]);t!=null&&g(e,["instancesFormat"],t);const s=p(n,["gcsUri"]);s!=null&&g(e,["gcsSource","uris"],s);const i=p(n,["bigqueryUri"]);if(i!=null&&g(e,["bigquerySource","inputUri"],i),p(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function fG(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function mG(n,e){const t={},s=p(e,["name"]);return s!=null&&g(t,["_url","name"],su(n,s)),t}function pG(n,e){const t={},s=p(e,["name"]);return s!=null&&g(t,["_url","name"],su(n,s)),t}function gG(n){const e={},t=p(n,["content"]);t!=null&&g(e,["content"],t);const s=p(n,["citationMetadata"]);s!=null&&g(e,["citationMetadata"],yG(s));const i=p(n,["tokenCount"]);i!=null&&g(e,["tokenCount"],i);const a=p(n,["finishReason"]);a!=null&&g(e,["finishReason"],a);const l=p(n,["avgLogprobs"]);l!=null&&g(e,["avgLogprobs"],l);const u=p(n,["groundingMetadata"]);u!=null&&g(e,["groundingMetadata"],u);const f=p(n,["index"]);f!=null&&g(e,["index"],f);const m=p(n,["logprobsResult"]);m!=null&&g(e,["logprobsResult"],m);const _=p(n,["safetyRatings"]);if(_!=null){let x=_;Array.isArray(x)&&(x=x.map(b=>b)),g(e,["safetyRatings"],x)}const T=p(n,["urlContextMetadata"]);return T!=null&&g(e,["urlContextMetadata"],T),e}function yG(n){const e={},t=p(n,["citationSources"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(i=>i)),g(e,["citations"],s)}return e}function gD(n){const e={},t=p(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>KG(a))),g(e,["parts"],i)}const s=p(n,["role"]);return s!=null&&g(e,["role"],s),e}function _G(n,e){const t={},s=p(n,["displayName"]);if(e!==void 0&&s!=null&&g(e,["batch","displayName"],s),p(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function vG(n,e){const t={},s=p(n,["displayName"]);e!==void 0&&s!=null&&g(e,["displayName"],s);const i=p(n,["dest"]);return e!==void 0&&i!=null&&g(e,["outputConfig"],cG(oG(i))),t}function sS(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["src"]);i!=null&&g(t,["batch","inputConfig"],dG(n,fD(n,i)));const a=p(e,["config"]);return a!=null&&_G(a,t),t}function EG(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["model"],dt(n,s));const i=p(e,["src"]);i!=null&&g(t,["inputConfig"],hG(fD(n,i)));const a=p(e,["config"]);return a!=null&&vG(a,t),t}function TG(n,e){const t={},s=p(n,["displayName"]);return e!==void 0&&s!=null&&g(e,["batch","displayName"],s),t}function xG(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["src"]);i!=null&&g(t,["batch","inputConfig"],CG(n,i));const a=p(e,["config"]);return a!=null&&TG(a,t),t}function IG(n,e){const t={},s=p(e,["name"]);return s!=null&&g(t,["_url","name"],su(n,s)),t}function bG(n,e){const t={},s=p(e,["name"]);return s!=null&&g(t,["_url","name"],su(n,s)),t}function AG(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["name"]);s!=null&&g(e,["name"],s);const i=p(n,["done"]);i!=null&&g(e,["done"],i);const a=p(n,["error"]);return a!=null&&g(e,["error"],a),e}function wG(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["name"]);s!=null&&g(e,["name"],s);const i=p(n,["done"]);i!=null&&g(e,["done"],i);const a=p(n,["error"]);return a!=null&&g(e,["error"],a),e}function NG(n,e){const t={},s=p(e,["contents"]);if(s!=null){let a=jE(n,s);Array.isArray(a)&&(a=a.map(l=>l)),g(t,["requests[]","request","content"],a)}const i=p(e,["config"]);return i!=null&&(g(t,["_self"],SG(i,t)),bj(t,{"requests[].*":"requests[].request.*"})),t}function SG(n,e){const t={},s=p(n,["taskType"]);e!==void 0&&s!=null&&g(e,["requests[]","taskType"],s);const i=p(n,["title"]);e!==void 0&&i!=null&&g(e,["requests[]","title"],i);const a=p(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&g(e,["requests[]","outputDimensionality"],a),p(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function CG(n,e){const t={},s=p(e,["fileName"]);s!=null&&g(t,["file_name"],s);const i=p(e,["inlinedRequests"]);return i!=null&&g(t,["requests"],NG(n,i)),t}function RG(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function PG(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const s=p(n,["args"]);s!=null&&g(e,["args"],s);const i=p(n,["name"]);if(i!=null&&g(e,["name"],i),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function DG(n){const e={},t=p(n,["mode"]);t!=null&&g(e,["mode"],t);const s=p(n,["allowedFunctionNames"]);if(s!=null&&g(e,["allowedFunctionNames"],s),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function MG(n,e,t){const s={},i=p(e,["systemInstruction"]);t!==void 0&&i!=null&&g(t,["systemInstruction"],gD(qn(i)));const a=p(e,["temperature"]);a!=null&&g(s,["temperature"],a);const l=p(e,["topP"]);l!=null&&g(s,["topP"],l);const u=p(e,["topK"]);u!=null&&g(s,["topK"],u);const f=p(e,["candidateCount"]);f!=null&&g(s,["candidateCount"],f);const m=p(e,["maxOutputTokens"]);m!=null&&g(s,["maxOutputTokens"],m);const _=p(e,["stopSequences"]);_!=null&&g(s,["stopSequences"],_);const T=p(e,["responseLogprobs"]);T!=null&&g(s,["responseLogprobs"],T);const x=p(e,["logprobs"]);x!=null&&g(s,["logprobs"],x);const b=p(e,["presencePenalty"]);b!=null&&g(s,["presencePenalty"],b);const k=p(e,["frequencyPenalty"]);k!=null&&g(s,["frequencyPenalty"],k);const G=p(e,["seed"]);G!=null&&g(s,["seed"],G);const F=p(e,["responseMimeType"]);F!=null&&g(s,["responseMimeType"],F);const Y=p(e,["responseSchema"]);Y!=null&&g(s,["responseSchema"],GE(Y));const K=p(e,["responseJsonSchema"]);if(K!=null&&g(s,["responseJsonSchema"],K),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const H=p(e,["safetySettings"]);if(t!==void 0&&H!=null){let M=H;Array.isArray(M)&&(M=M.map(ae=>JG(ae))),g(t,["safetySettings"],M)}const U=p(e,["tools"]);if(t!==void 0&&U!=null){let M=nu(U);Array.isArray(M)&&(M=M.map(ae=>WG(tu(ae)))),g(t,["tools"],M)}const z=p(e,["toolConfig"]);if(t!==void 0&&z!=null&&g(t,["toolConfig"],QG(z)),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=p(e,["cachedContent"]);t!==void 0&&J!=null&&g(t,["cachedContent"],kr(n,J));const P=p(e,["responseModalities"]);P!=null&&g(s,["responseModalities"],P);const C=p(e,["mediaResolution"]);C!=null&&g(s,["mediaResolution"],C);const S=p(e,["speechConfig"]);if(S!=null&&g(s,["speechConfig"],qE(S)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=p(e,["thinkingConfig"]);L!=null&&g(s,["thinkingConfig"],L);const V=p(e,["imageConfig"]);V!=null&&g(s,["imageConfig"],FG(V));const O=p(e,["enableEnhancedCivicAnswers"]);return O!=null&&g(s,["enableEnhancedCivicAnswers"],O),s}function kG(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["candidates"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(m=>gG(m))),g(e,["candidates"],f)}const i=p(n,["modelVersion"]);i!=null&&g(e,["modelVersion"],i);const a=p(n,["promptFeedback"]);a!=null&&g(e,["promptFeedback"],a);const l=p(n,["responseId"]);l!=null&&g(e,["responseId"],l);const u=p(n,["usageMetadata"]);return u!=null&&g(e,["usageMetadata"],u),e}function VG(n,e){const t={},s=p(e,["name"]);return s!=null&&g(t,["_url","name"],su(n,s)),t}function LG(n,e){const t={},s=p(e,["name"]);return s!=null&&g(t,["_url","name"],su(n,s)),t}function UG(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function OG(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function FG(n){const e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);const s=p(n,["imageSize"]);if(s!=null&&g(e,["imageSize"],s),p(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function BG(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["request","model"],dt(n,s));const i=p(e,["contents"]);if(i!=null){let u=Gs(i);Array.isArray(u)&&(u=u.map(f=>gD(f))),g(t,["request","contents"],u)}const a=p(e,["metadata"]);a!=null&&g(t,["metadata"],a);const l=p(e,["config"]);return l!=null&&g(t,["request","generationConfig"],MG(n,l,p(t,["request"],{}))),t}function jG(n){const e={},t=p(n,["response"]);t!=null&&g(e,["response"],kG(t));const s=p(n,["error"]);return s!=null&&g(e,["error"],s),e}function GG(n,e){const t={},s=p(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const i=p(n,["pageToken"]);if(e!==void 0&&i!=null&&g(e,["_query","pageToken"],i),p(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function qG(n,e){const t={},s=p(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const i=p(n,["pageToken"]);e!==void 0&&i!=null&&g(e,["_query","pageToken"],i);const a=p(n,["filter"]);return e!==void 0&&a!=null&&g(e,["_query","filter"],a),t}function HG(n){const e={},t=p(n,["config"]);return t!=null&&GG(t,e),e}function zG(n){const e={},t=p(n,["config"]);return t!=null&&qG(t,e),e}function $G(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const i=p(n,["operations"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>Fm(l))),g(e,["batchJobs"],a)}return e}function YG(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const i=p(n,["batchPredictionJobs"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>Fv(l))),g(e,["batchJobs"],a)}return e}function KG(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const s=p(n,["codeExecutionResult"]);s!=null&&g(e,["codeExecutionResult"],s);const i=p(n,["executableCode"]);i!=null&&g(e,["executableCode"],i);const a=p(n,["fileData"]);a!=null&&g(e,["fileData"],RG(a));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],PG(l));const u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);const f=p(n,["inlineData"]);f!=null&&g(e,["inlineData"],fG(f));const m=p(n,["text"]);m!=null&&g(e,["text"],m);const _=p(n,["thought"]);_!=null&&g(e,["thought"],_);const T=p(n,["thoughtSignature"]);T!=null&&g(e,["thoughtSignature"],T);const x=p(n,["videoMetadata"]);return x!=null&&g(e,["videoMetadata"],x),e}function JG(n){const e={},t=p(n,["category"]);if(t!=null&&g(e,["category"],t),p(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=p(n,["threshold"]);return s!=null&&g(e,["threshold"],s),e}function QG(n){const e={},t=p(n,["functionCallingConfig"]);t!=null&&g(e,["functionCallingConfig"],DG(t));const s=p(n,["retrievalConfig"]);return s!=null&&g(e,["retrievalConfig"],s),e}function WG(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(T=>T)),g(e,["functionDeclarations"],_)}if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=p(n,["googleSearchRetrieval"]);s!=null&&g(e,["googleSearchRetrieval"],s);const i=p(n,["computerUse"]);i!=null&&g(e,["computerUse"],i);const a=p(n,["fileSearch"]);a!=null&&g(e,["fileSearch"],a);const l=p(n,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],UG(u));const f=p(n,["googleSearch"]);f!=null&&g(e,["googleSearch"],OG(f));const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ar;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(Ar||(Ar={}));class ll{constructor(e,t,s,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,s,i)}init(e,t,s){var i,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!s||Object.keys(s).length===0?l={config:{}}:typeof s=="object"?l=Object.assign({},s):l=s,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(i=l.config)===null||i===void 0?void 0:i.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XG extends Mr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ll(Ar.PAGED_ITEM_BATCH_JOBS,s=>this.listInternal(s),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=sS(this.apiClient,e),s=t._url,i=Ae("{model}:batchGenerateContent",s),u=t.batch.inputConfig.requests,f=u.requests,m=[];for(const _ of f){const T=Object.assign({},_);if(T.systemInstruction){const x=T.systemInstruction;delete T.systemInstruction;const b=T.request;b.systemInstruction=x,T.request=b}m.push(T)}return u.requests=m,delete t.config,delete t._url,delete t._query,{path:i,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const s=t?Object.assign({},t):{},i=Date.now().toString();if(s.displayName||(s.displayName=`genaiBatchJob_${i}`),s.dest===void 0){const a=this.getGcsUri(e),l=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?s.dest=`${a.slice(0,-6)}/dest`:s.dest=`${a}_dest_${i}`;else if(l)s.dest=`${l}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return s}async createInternal(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=EG(this.apiClient,e);return u=Ae("batchPredictionJobs",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),l.then(_=>Fv(_))}else{const m=sS(this.apiClient,e);return u=Ae("{model}:batchGenerateContent",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Fm(_))}}async createEmbeddingsInternal(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=xG(this.apiClient,e);return a=Ae("{model}:asyncBatchEmbedContent",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>Fm(f))}}async get(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=LG(this.apiClient,e);return u=Ae("batchPredictionJobs/{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),l.then(_=>Fv(_))}else{const m=VG(this.apiClient,e);return u=Ae("batches/{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Fm(_))}}async cancel(e){var t,s,i,a;let l="",u={};if(this.apiClient.isVertexAI()){const f=pG(this.apiClient,e);l=Ae("batchPredictionJobs/{name}:cancel",f._url),u=f._query,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const f=mG(this.apiClient,e);l=Ae("batches/{name}:cancel",f._url),u=f._query,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=zG(e);return u=Ae("batchPredictionJobs",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=YG(_),x=new ZN;return Object.assign(x,T),x})}else{const m=HG(e);return u=Ae("batches",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=$G(_),x=new ZN;return Object.assign(x,T),x})}}async delete(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=bG(this.apiClient,e);return u=Ae("batchPredictionJobs/{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>wG(_))}else{const m=IG(this.apiClient,e);return u=Ae("batches/{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>AG(_))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZG(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function iS(n){const e={},t=p(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>xq(a))),g(e,["parts"],i)}const s=p(n,["role"]);return s!=null&&g(e,["role"],s),e}function eq(n,e){const t={},s=p(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const i=p(n,["expireTime"]);e!==void 0&&i!=null&&g(e,["expireTime"],i);const a=p(n,["displayName"]);e!==void 0&&a!=null&&g(e,["displayName"],a);const l=p(n,["contents"]);if(e!==void 0&&l!=null){let _=Gs(l);Array.isArray(_)&&(_=_.map(T=>iS(T))),g(e,["contents"],_)}const u=p(n,["systemInstruction"]);e!==void 0&&u!=null&&g(e,["systemInstruction"],iS(qn(u)));const f=p(n,["tools"]);if(e!==void 0&&f!=null){let _=f;Array.isArray(_)&&(_=_.map(T=>bq(T))),g(e,["tools"],_)}const m=p(n,["toolConfig"]);if(e!==void 0&&m!=null&&g(e,["toolConfig"],Iq(m)),p(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function tq(n,e){const t={},s=p(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const i=p(n,["expireTime"]);e!==void 0&&i!=null&&g(e,["expireTime"],i);const a=p(n,["displayName"]);e!==void 0&&a!=null&&g(e,["displayName"],a);const l=p(n,["contents"]);if(e!==void 0&&l!=null){let T=Gs(l);Array.isArray(T)&&(T=T.map(x=>x)),g(e,["contents"],T)}const u=p(n,["systemInstruction"]);e!==void 0&&u!=null&&g(e,["systemInstruction"],qn(u));const f=p(n,["tools"]);if(e!==void 0&&f!=null){let T=f;Array.isArray(T)&&(T=T.map(x=>Aq(x))),g(e,["tools"],T)}const m=p(n,["toolConfig"]);e!==void 0&&m!=null&&g(e,["toolConfig"],m);const _=p(n,["kmsKeyName"]);return e!==void 0&&_!=null&&g(e,["encryption_spec","kmsKeyName"],_),t}function nq(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["model"],iD(n,s));const i=p(e,["config"]);return i!=null&&eq(i,t),t}function sq(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["model"],iD(n,s));const i=p(e,["config"]);return i!=null&&tq(i,t),t}function iq(n,e){const t={},s=p(e,["name"]);return s!=null&&g(t,["_url","name"],kr(n,s)),t}function rq(n,e){const t={},s=p(e,["name"]);return s!=null&&g(t,["_url","name"],kr(n,s)),t}function oq(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function aq(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function lq(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function cq(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const s=p(n,["args"]);s!=null&&g(e,["args"],s);const i=p(n,["name"]);if(i!=null&&g(e,["name"],i),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function uq(n){const e={},t=p(n,["mode"]);t!=null&&g(e,["mode"],t);const s=p(n,["allowedFunctionNames"]);if(s!=null&&g(e,["allowedFunctionNames"],s),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function dq(n){const e={};if(p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=p(n,["description"]);t!=null&&g(e,["description"],t);const s=p(n,["name"]);s!=null&&g(e,["name"],s);const i=p(n,["parameters"]);i!=null&&g(e,["parameters"],i);const a=p(n,["parametersJsonSchema"]);a!=null&&g(e,["parametersJsonSchema"],a);const l=p(n,["response"]);l!=null&&g(e,["response"],l);const u=p(n,["responseJsonSchema"]);return u!=null&&g(e,["responseJsonSchema"],u),e}function hq(n,e){const t={},s=p(e,["name"]);return s!=null&&g(t,["_url","name"],kr(n,s)),t}function fq(n,e){const t={},s=p(e,["name"]);return s!=null&&g(t,["_url","name"],kr(n,s)),t}function mq(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function pq(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function gq(n,e){const t={},s=p(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const i=p(n,["pageToken"]);return e!==void 0&&i!=null&&g(e,["_query","pageToken"],i),t}function yq(n,e){const t={},s=p(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const i=p(n,["pageToken"]);return e!==void 0&&i!=null&&g(e,["_query","pageToken"],i),t}function _q(n){const e={},t=p(n,["config"]);return t!=null&&gq(t,e),e}function vq(n){const e={},t=p(n,["config"]);return t!=null&&yq(t,e),e}function Eq(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const i=p(n,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["cachedContents"],a)}return e}function Tq(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const i=p(n,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["cachedContents"],a)}return e}function xq(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const s=p(n,["codeExecutionResult"]);s!=null&&g(e,["codeExecutionResult"],s);const i=p(n,["executableCode"]);i!=null&&g(e,["executableCode"],i);const a=p(n,["fileData"]);a!=null&&g(e,["fileData"],lq(a));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],cq(l));const u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);const f=p(n,["inlineData"]);f!=null&&g(e,["inlineData"],ZG(f));const m=p(n,["text"]);m!=null&&g(e,["text"],m);const _=p(n,["thought"]);_!=null&&g(e,["thought"],_);const T=p(n,["thoughtSignature"]);T!=null&&g(e,["thoughtSignature"],T);const x=p(n,["videoMetadata"]);return x!=null&&g(e,["videoMetadata"],x),e}function Iq(n){const e={},t=p(n,["functionCallingConfig"]);t!=null&&g(e,["functionCallingConfig"],uq(t));const s=p(n,["retrievalConfig"]);return s!=null&&g(e,["retrievalConfig"],s),e}function bq(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(T=>T)),g(e,["functionDeclarations"],_)}if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=p(n,["googleSearchRetrieval"]);s!=null&&g(e,["googleSearchRetrieval"],s);const i=p(n,["computerUse"]);i!=null&&g(e,["computerUse"],i);const a=p(n,["fileSearch"]);a!=null&&g(e,["fileSearch"],a);const l=p(n,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],mq(u));const f=p(n,["googleSearch"]);f!=null&&g(e,["googleSearch"],pq(f));const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function Aq(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(x=>dq(x))),g(e,["functionDeclarations"],T)}const s=p(n,["retrieval"]);s!=null&&g(e,["retrieval"],s);const i=p(n,["googleSearchRetrieval"]);i!=null&&g(e,["googleSearchRetrieval"],i);const a=p(n,["computerUse"]);if(a!=null&&g(e,["computerUse"],a),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=p(n,["codeExecution"]);l!=null&&g(e,["codeExecution"],l);const u=p(n,["enterpriseWebSearch"]);u!=null&&g(e,["enterpriseWebSearch"],u);const f=p(n,["googleMaps"]);f!=null&&g(e,["googleMaps"],f);const m=p(n,["googleSearch"]);m!=null&&g(e,["googleSearch"],m);const _=p(n,["urlContext"]);return _!=null&&g(e,["urlContext"],_),e}function wq(n,e){const t={},s=p(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const i=p(n,["expireTime"]);return e!==void 0&&i!=null&&g(e,["expireTime"],i),t}function Nq(n,e){const t={},s=p(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const i=p(n,["expireTime"]);return e!==void 0&&i!=null&&g(e,["expireTime"],i),t}function Sq(n,e){const t={},s=p(e,["name"]);s!=null&&g(t,["_url","name"],kr(n,s));const i=p(e,["config"]);return i!=null&&wq(i,t),t}function Cq(n,e){const t={},s=p(e,["name"]);s!=null&&g(t,["_url","name"],kr(n,s));const i=p(e,["config"]);return i!=null&&Nq(i,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rq extends Mr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ll(Ar.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(t),t)}async create(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=sq(this.apiClient,e);return u=Ae("cachedContents",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const m=nq(this.apiClient,e);return u=Ae("cachedContents",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async get(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=fq(this.apiClient,e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const m=hq(this.apiClient,e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async delete(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=rq(this.apiClient,e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=aq(_),x=new WN;return Object.assign(x,T),x})}else{const m=iq(this.apiClient,e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=oq(_),x=new WN;return Object.assign(x,T),x})}}async update(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=Cq(this.apiClient,e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const m=Sq(this.apiClient,e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async listInternal(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=vq(e);return u=Ae("cachedContents",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=Tq(_),x=new XN;return Object.assign(x,T),x})}else{const m=_q(e);return u=Ae("cachedContents",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=Eq(_),x=new XN;return Object.assign(x,T),x})}}}function rS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pt(n){return this instanceof Pt?(this.v=n,this):new Pt(n)}function yc(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(b){return function(k){return Promise.resolve(k).then(b,T)}}function u(b,k){s[b]&&(i[b]=function(G){return new Promise(function(F,Y){a.push([b,G,F,Y])>1||f(b,G)})},k&&(i[b]=k(i[b])))}function f(b,k){try{m(s[b](k))}catch(G){x(a[0][3],G)}}function m(b){b.value instanceof Pt?Promise.resolve(b.value.v).then(_,T):x(a[0][2],b)}function _(b){f("next",b)}function T(b){f("throw",b)}function x(b,k){b(k),a.shift(),a.length&&f(a[0][0],a[0][1])}}function Bd(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof rS=="function"?rS(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(a){t[a]=n[a]&&function(l){return new Promise(function(u,f){l=n[a](l),i(u,f,l.done,l.value)})}}function i(a,l,u,f){Promise.resolve(f).then(function(m){a({value:m,done:u})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pq(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:yD(t)}function yD(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function Dq(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function oS(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let s=0;for(;s<t;)if(n[s].role==="user")e.push(n[s]),s++;else{const i=[];let a=!0;for(;s<t&&n[s].role==="model";)i.push(n[s]),a&&!yD(n[s])&&(a=!1),s++;a?e.push(...i):e.pop()}return e}class Mq{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new kq(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class kq{constructor(e,t,s,i={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=s,this.config=i,this.history=a,this.sendPromise=Promise.resolve(),Dq(a)}async sendMessage(e){var t;await this.sendPromise;const s=qn(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,l,u;const f=await i,m=(l=(a=f.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,_=f.automaticFunctionCallingHistory,T=this.getHistory(!0).length;let x=[];_!=null&&(x=(u=_.slice(T))!==null&&u!==void 0?u:[]);const b=m?[m]:[];this.recordHistory(s,b,x)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;const s=qn(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const a=await i;return this.processStreamResponse(a,s)}getHistory(e=!1){const t=e?oS(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return yc(this,arguments,function*(){var i,a,l,u,f,m;const _=[];try{for(var T=!0,x=Bd(e),b;b=yield Pt(x.next()),i=b.done,!i;T=!0){u=b.value,T=!1;const k=u;if(Pq(k)){const G=(m=(f=k.candidates)===null||f===void 0?void 0:f[0])===null||m===void 0?void 0:m.content;G!==void 0&&_.push(G)}yield yield Pt(k)}}catch(k){a={error:k}}finally{try{!T&&!i&&(l=x.return)&&(yield Pt(l.call(x)))}finally{if(a)throw a.error}}this.recordHistory(t,_)})}recordHistory(e,t,s){let i=[];t.length>0&&t.every(a=>a.role!==void 0)?i=t:i.push({role:"model",parts:[]}),s&&s.length>0?this.history.push(...oS(s)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lg extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,lg.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vq(n){const e={},t=p(n,["file"]);return t!=null&&g(e,["file"],t),e}function Lq(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function Uq(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","file"],uD(t)),e}function Oq(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function Fq(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","file"],uD(t)),e}function Bq(n,e){const t={},s=p(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const i=p(n,["pageToken"]);return e!==void 0&&i!=null&&g(e,["_query","pageToken"],i),t}function jq(n){const e={},t=p(n,["config"]);return t!=null&&Bq(t,e),e}function Gq(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const i=p(n,["files"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qq extends Mr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ll(Ar.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=jq(e);return a=Ae("files",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),i.then(f=>{const m=Gq(f),_=new Yj;return Object.assign(_,m),_})}}async createInternal(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Vq(e);return a=Ae("upload/v1beta/files",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>{const m=Lq(f),_=new Kj;return Object.assign(_,m),_})}}async get(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Fq(e);return a=Ae("files/{file}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>f)}}async delete(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Uq(e);return a=Ae("files/{file}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),i.then(f=>{const m=Oq(f),_=new Jj;return Object.assign(_,m),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bm(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function Hq(n){const e={},t=p(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>oH(a))),g(e,["parts"],i)}const s=p(n,["role"]);return s!=null&&g(e,["role"],s),e}function zq(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function $q(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const s=p(n,["args"]);s!=null&&g(e,["args"],s);const i=p(n,["name"]);if(i!=null&&g(e,["name"],i),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Yq(n){const e={};if(p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=p(n,["description"]);t!=null&&g(e,["description"],t);const s=p(n,["name"]);s!=null&&g(e,["name"],s);const i=p(n,["parameters"]);i!=null&&g(e,["parameters"],i);const a=p(n,["parametersJsonSchema"]);a!=null&&g(e,["parametersJsonSchema"],a);const l=p(n,["response"]);l!=null&&g(e,["response"],l);const u=p(n,["responseJsonSchema"]);return u!=null&&g(e,["responseJsonSchema"],u),e}function Kq(n){const e={},t=p(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);const s=p(n,["responseJsonSchema"]);s!=null&&g(e,["responseJsonSchema"],s);const i=p(n,["audioTimestamp"]);i!=null&&g(e,["audioTimestamp"],i);const a=p(n,["candidateCount"]);a!=null&&g(e,["candidateCount"],a);const l=p(n,["enableAffectiveDialog"]);l!=null&&g(e,["enableAffectiveDialog"],l);const u=p(n,["frequencyPenalty"]);u!=null&&g(e,["frequencyPenalty"],u);const f=p(n,["logprobs"]);f!=null&&g(e,["logprobs"],f);const m=p(n,["maxOutputTokens"]);m!=null&&g(e,["maxOutputTokens"],m);const _=p(n,["mediaResolution"]);_!=null&&g(e,["mediaResolution"],_);const T=p(n,["presencePenalty"]);T!=null&&g(e,["presencePenalty"],T);const x=p(n,["responseLogprobs"]);x!=null&&g(e,["responseLogprobs"],x);const b=p(n,["responseMimeType"]);b!=null&&g(e,["responseMimeType"],b);const k=p(n,["responseModalities"]);k!=null&&g(e,["responseModalities"],k);const G=p(n,["responseSchema"]);G!=null&&g(e,["responseSchema"],G);const F=p(n,["routingConfig"]);F!=null&&g(e,["routingConfig"],F);const Y=p(n,["seed"]);Y!=null&&g(e,["seed"],Y);const K=p(n,["speechConfig"]);K!=null&&g(e,["speechConfig"],_D(K));const H=p(n,["stopSequences"]);H!=null&&g(e,["stopSequences"],H);const U=p(n,["temperature"]);U!=null&&g(e,["temperature"],U);const z=p(n,["thinkingConfig"]);z!=null&&g(e,["thinkingConfig"],z);const J=p(n,["topK"]);J!=null&&g(e,["topK"],J);const P=p(n,["topP"]);if(P!=null&&g(e,["topP"],P),p(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Jq(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function Qq(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function Wq(n,e){const t={},s=p(n,["generationConfig"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig"],s);const i=p(n,["responseModalities"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig","responseModalities"],i);const a=p(n,["temperature"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","temperature"],a);const l=p(n,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);const f=p(n,["maxOutputTokens"]);e!==void 0&&f!=null&&g(e,["setup","generationConfig","maxOutputTokens"],f);const m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);const _=p(n,["seed"]);e!==void 0&&_!=null&&g(e,["setup","generationConfig","seed"],_);const T=p(n,["speechConfig"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","speechConfig"],HE(T));const x=p(n,["thinkingConfig"]);e!==void 0&&x!=null&&g(e,["setup","generationConfig","thinkingConfig"],x);const b=p(n,["enableAffectiveDialog"]);e!==void 0&&b!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],b);const k=p(n,["systemInstruction"]);e!==void 0&&k!=null&&g(e,["setup","systemInstruction"],Hq(qn(k)));const G=p(n,["tools"]);if(e!==void 0&&G!=null){let J=nu(G);Array.isArray(J)&&(J=J.map(P=>lH(tu(P)))),g(e,["setup","tools"],J)}const F=p(n,["sessionResumption"]);e!==void 0&&F!=null&&g(e,["setup","sessionResumption"],aH(F));const Y=p(n,["inputAudioTranscription"]);e!==void 0&&Y!=null&&g(e,["setup","inputAudioTranscription"],Y);const K=p(n,["outputAudioTranscription"]);e!==void 0&&K!=null&&g(e,["setup","outputAudioTranscription"],K);const H=p(n,["realtimeInputConfig"]);e!==void 0&&H!=null&&g(e,["setup","realtimeInputConfig"],H);const U=p(n,["contextWindowCompression"]);e!==void 0&&U!=null&&g(e,["setup","contextWindowCompression"],U);const z=p(n,["proactivity"]);return e!==void 0&&z!=null&&g(e,["setup","proactivity"],z),t}function Xq(n,e){const t={},s=p(n,["generationConfig"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig"],Kq(s));const i=p(n,["responseModalities"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig","responseModalities"],i);const a=p(n,["temperature"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","temperature"],a);const l=p(n,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);const f=p(n,["maxOutputTokens"]);e!==void 0&&f!=null&&g(e,["setup","generationConfig","maxOutputTokens"],f);const m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);const _=p(n,["seed"]);e!==void 0&&_!=null&&g(e,["setup","generationConfig","seed"],_);const T=p(n,["speechConfig"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","speechConfig"],_D(HE(T)));const x=p(n,["thinkingConfig"]);e!==void 0&&x!=null&&g(e,["setup","generationConfig","thinkingConfig"],x);const b=p(n,["enableAffectiveDialog"]);e!==void 0&&b!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],b);const k=p(n,["systemInstruction"]);e!==void 0&&k!=null&&g(e,["setup","systemInstruction"],qn(k));const G=p(n,["tools"]);if(e!==void 0&&G!=null){let J=nu(G);Array.isArray(J)&&(J=J.map(P=>cH(tu(P)))),g(e,["setup","tools"],J)}const F=p(n,["sessionResumption"]);e!==void 0&&F!=null&&g(e,["setup","sessionResumption"],F);const Y=p(n,["inputAudioTranscription"]);e!==void 0&&Y!=null&&g(e,["setup","inputAudioTranscription"],Y);const K=p(n,["outputAudioTranscription"]);e!==void 0&&K!=null&&g(e,["setup","outputAudioTranscription"],K);const H=p(n,["realtimeInputConfig"]);e!==void 0&&H!=null&&g(e,["setup","realtimeInputConfig"],H);const U=p(n,["contextWindowCompression"]);e!==void 0&&U!=null&&g(e,["setup","contextWindowCompression"],U);const z=p(n,["proactivity"]);return e!==void 0&&z!=null&&g(e,["setup","proactivity"],z),t}function Zq(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["setup","model"],dt(n,s));const i=p(e,["config"]);return i!=null&&g(t,["config"],Wq(i,t)),t}function eH(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["setup","model"],dt(n,s));const i=p(e,["config"]);return i!=null&&g(t,["config"],Xq(i,t)),t}function tH(n){const e={},t=p(n,["musicGenerationConfig"]);return t!=null&&g(e,["musicGenerationConfig"],t),e}function nH(n){const e={},t=p(n,["weightedPrompts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(i=>i)),g(e,["weightedPrompts"],s)}return e}function sH(n){const e={},t=p(n,["media"]);if(t!=null){let m=rD(t);Array.isArray(m)&&(m=m.map(_=>Bm(_))),g(e,["mediaChunks"],m)}const s=p(n,["audio"]);s!=null&&g(e,["audio"],Bm(aD(s)));const i=p(n,["audioStreamEnd"]);i!=null&&g(e,["audioStreamEnd"],i);const a=p(n,["video"]);a!=null&&g(e,["video"],Bm(oD(a)));const l=p(n,["text"]);l!=null&&g(e,["text"],l);const u=p(n,["activityStart"]);u!=null&&g(e,["activityStart"],u);const f=p(n,["activityEnd"]);return f!=null&&g(e,["activityEnd"],f),e}function iH(n){const e={},t=p(n,["media"]);if(t!=null){let m=rD(t);Array.isArray(m)&&(m=m.map(_=>_)),g(e,["mediaChunks"],m)}const s=p(n,["audio"]);s!=null&&g(e,["audio"],aD(s));const i=p(n,["audioStreamEnd"]);i!=null&&g(e,["audioStreamEnd"],i);const a=p(n,["video"]);a!=null&&g(e,["video"],oD(a));const l=p(n,["text"]);l!=null&&g(e,["text"],l);const u=p(n,["activityStart"]);u!=null&&g(e,["activityStart"],u);const f=p(n,["activityEnd"]);return f!=null&&g(e,["activityEnd"],f),e}function rH(n){const e={},t=p(n,["setupComplete"]);t!=null&&g(e,["setupComplete"],t);const s=p(n,["serverContent"]);s!=null&&g(e,["serverContent"],s);const i=p(n,["toolCall"]);i!=null&&g(e,["toolCall"],i);const a=p(n,["toolCallCancellation"]);a!=null&&g(e,["toolCallCancellation"],a);const l=p(n,["usageMetadata"]);l!=null&&g(e,["usageMetadata"],uH(l));const u=p(n,["goAway"]);u!=null&&g(e,["goAway"],u);const f=p(n,["sessionResumptionUpdate"]);return f!=null&&g(e,["sessionResumptionUpdate"],f),e}function oH(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const s=p(n,["codeExecutionResult"]);s!=null&&g(e,["codeExecutionResult"],s);const i=p(n,["executableCode"]);i!=null&&g(e,["executableCode"],i);const a=p(n,["fileData"]);a!=null&&g(e,["fileData"],zq(a));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],$q(l));const u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);const f=p(n,["inlineData"]);f!=null&&g(e,["inlineData"],Bm(f));const m=p(n,["text"]);m!=null&&g(e,["text"],m);const _=p(n,["thought"]);_!=null&&g(e,["thought"],_);const T=p(n,["thoughtSignature"]);T!=null&&g(e,["thoughtSignature"],T);const x=p(n,["videoMetadata"]);return x!=null&&g(e,["videoMetadata"],x),e}function aH(n){const e={},t=p(n,["handle"]);if(t!=null&&g(e,["handle"],t),p(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function _D(n){const e={},t=p(n,["voiceConfig"]);t!=null&&g(e,["voiceConfig"],t);const s=p(n,["languageCode"]);if(s!=null&&g(e,["languageCode"],s),p(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function lH(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(T=>T)),g(e,["functionDeclarations"],_)}if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=p(n,["googleSearchRetrieval"]);s!=null&&g(e,["googleSearchRetrieval"],s);const i=p(n,["computerUse"]);i!=null&&g(e,["computerUse"],i);const a=p(n,["fileSearch"]);a!=null&&g(e,["fileSearch"],a);const l=p(n,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],Jq(u));const f=p(n,["googleSearch"]);f!=null&&g(e,["googleSearch"],Qq(f));const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function cH(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(x=>Yq(x))),g(e,["functionDeclarations"],T)}const s=p(n,["retrieval"]);s!=null&&g(e,["retrieval"],s);const i=p(n,["googleSearchRetrieval"]);i!=null&&g(e,["googleSearchRetrieval"],i);const a=p(n,["computerUse"]);if(a!=null&&g(e,["computerUse"],a),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=p(n,["codeExecution"]);l!=null&&g(e,["codeExecution"],l);const u=p(n,["enterpriseWebSearch"]);u!=null&&g(e,["enterpriseWebSearch"],u);const f=p(n,["googleMaps"]);f!=null&&g(e,["googleMaps"],f);const m=p(n,["googleSearch"]);m!=null&&g(e,["googleSearch"],m);const _=p(n,["urlContext"]);return _!=null&&g(e,["urlContext"],_),e}function uH(n){const e={},t=p(n,["promptTokenCount"]);t!=null&&g(e,["promptTokenCount"],t);const s=p(n,["cachedContentTokenCount"]);s!=null&&g(e,["cachedContentTokenCount"],s);const i=p(n,["candidatesTokenCount"]);i!=null&&g(e,["responseTokenCount"],i);const a=p(n,["toolUsePromptTokenCount"]);a!=null&&g(e,["toolUsePromptTokenCount"],a);const l=p(n,["thoughtsTokenCount"]);l!=null&&g(e,["thoughtsTokenCount"],l);const u=p(n,["totalTokenCount"]);u!=null&&g(e,["totalTokenCount"],u);const f=p(n,["promptTokensDetails"]);if(f!=null){let b=f;Array.isArray(b)&&(b=b.map(k=>k)),g(e,["promptTokensDetails"],b)}const m=p(n,["cacheTokensDetails"]);if(m!=null){let b=m;Array.isArray(b)&&(b=b.map(k=>k)),g(e,["cacheTokensDetails"],b)}const _=p(n,["candidatesTokensDetails"]);if(_!=null){let b=_;Array.isArray(b)&&(b=b.map(k=>k)),g(e,["responseTokensDetails"],b)}const T=p(n,["toolUsePromptTokensDetails"]);if(T!=null){let b=T;Array.isArray(b)&&(b=b.map(k=>k)),g(e,["toolUsePromptTokensDetails"],b)}const x=p(n,["trafficType"]);return x!=null&&g(e,["trafficType"],x),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dH(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function hH(n){const e={},t=p(n,["content"]);t!=null&&g(e,["content"],t);const s=p(n,["citationMetadata"]);s!=null&&g(e,["citationMetadata"],fH(s));const i=p(n,["tokenCount"]);i!=null&&g(e,["tokenCount"],i);const a=p(n,["finishReason"]);a!=null&&g(e,["finishReason"],a);const l=p(n,["avgLogprobs"]);l!=null&&g(e,["avgLogprobs"],l);const u=p(n,["groundingMetadata"]);u!=null&&g(e,["groundingMetadata"],u);const f=p(n,["index"]);f!=null&&g(e,["index"],f);const m=p(n,["logprobsResult"]);m!=null&&g(e,["logprobsResult"],m);const _=p(n,["safetyRatings"]);if(_!=null){let x=_;Array.isArray(x)&&(x=x.map(b=>b)),g(e,["safetyRatings"],x)}const T=p(n,["urlContextMetadata"]);return T!=null&&g(e,["urlContextMetadata"],T),e}function fH(n){const e={},t=p(n,["citationSources"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(i=>i)),g(e,["citations"],s)}return e}function mH(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["contents"]);if(i!=null){let a=Gs(i);Array.isArray(a)&&(a=a.map(l=>l)),g(t,["contents"],a)}return t}function pH(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["tokensInfo"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>a)),g(e,["tokensInfo"],i)}return e}function gH(n){const e={},t=p(n,["values"]);t!=null&&g(e,["values"],t);const s=p(n,["statistics"]);return s!=null&&g(e,["statistics"],yH(s)),e}function yH(n){const e={},t=p(n,["truncated"]);t!=null&&g(e,["truncated"],t);const s=p(n,["token_count"]);return s!=null&&g(e,["tokenCount"],s),e}function cg(n){const e={},t=p(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>w9(a))),g(e,["parts"],i)}const s=p(n,["role"]);return s!=null&&g(e,["role"],s),e}function _H(n){const e={},t=p(n,["controlType"]);t!=null&&g(e,["controlType"],t);const s=p(n,["enableControlImageComputation"]);return s!=null&&g(e,["computeControl"],s),e}function vH(n){const e={};if(p(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(p(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(p(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function EH(n,e){const t={},s=p(n,["systemInstruction"]);e!==void 0&&s!=null&&g(e,["systemInstruction"],qn(s));const i=p(n,["tools"]);if(e!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>ID(u))),g(e,["tools"],l)}const a=p(n,["generationConfig"]);return e!==void 0&&a!=null&&g(e,["generationConfig"],d9(a)),t}function TH(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["contents"]);if(i!=null){let l=Gs(i);Array.isArray(l)&&(l=l.map(u=>cg(u))),g(t,["contents"],l)}const a=p(e,["config"]);return a!=null&&vH(a),t}function xH(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["contents"]);if(i!=null){let l=Gs(i);Array.isArray(l)&&(l=l.map(u=>u)),g(t,["contents"],l)}const a=p(e,["config"]);return a!=null&&EH(a,t),t}function IH(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["totalTokens"]);s!=null&&g(e,["totalTokens"],s);const i=p(n,["cachedContentTokenCount"]);return i!=null&&g(e,["cachedContentTokenCount"],i),e}function bH(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["totalTokens"]);return s!=null&&g(e,["totalTokens"],s),e}function AH(n,e){const t={},s=p(e,["model"]);return s!=null&&g(t,["_url","name"],dt(n,s)),t}function wH(n,e){const t={},s=p(e,["model"]);return s!=null&&g(t,["_url","name"],dt(n,s)),t}function NH(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function SH(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function CH(n,e){const t={},s=p(n,["outputGcsUri"]);e!==void 0&&s!=null&&g(e,["parameters","storageUri"],s);const i=p(n,["negativePrompt"]);e!==void 0&&i!=null&&g(e,["parameters","negativePrompt"],i);const a=p(n,["numberOfImages"]);e!==void 0&&a!=null&&g(e,["parameters","sampleCount"],a);const l=p(n,["aspectRatio"]);e!==void 0&&l!=null&&g(e,["parameters","aspectRatio"],l);const u=p(n,["guidanceScale"]);e!==void 0&&u!=null&&g(e,["parameters","guidanceScale"],u);const f=p(n,["seed"]);e!==void 0&&f!=null&&g(e,["parameters","seed"],f);const m=p(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&g(e,["parameters","safetySetting"],m);const _=p(n,["personGeneration"]);e!==void 0&&_!=null&&g(e,["parameters","personGeneration"],_);const T=p(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&g(e,["parameters","includeSafetyAttributes"],T);const x=p(n,["includeRaiReason"]);e!==void 0&&x!=null&&g(e,["parameters","includeRaiReason"],x);const b=p(n,["language"]);e!==void 0&&b!=null&&g(e,["parameters","language"],b);const k=p(n,["outputMimeType"]);e!==void 0&&k!=null&&g(e,["parameters","outputOptions","mimeType"],k);const G=p(n,["outputCompressionQuality"]);e!==void 0&&G!=null&&g(e,["parameters","outputOptions","compressionQuality"],G);const F=p(n,["addWatermark"]);e!==void 0&&F!=null&&g(e,["parameters","addWatermark"],F);const Y=p(n,["labels"]);e!==void 0&&Y!=null&&g(e,["labels"],Y);const K=p(n,["editMode"]);e!==void 0&&K!=null&&g(e,["parameters","editMode"],K);const H=p(n,["baseSteps"]);return e!==void 0&&H!=null&&g(e,["parameters","editConfig","baseSteps"],H),t}function RH(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["prompt"]);i!=null&&g(t,["instances[0]","prompt"],i);const a=p(e,["referenceImages"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(f=>D9(f))),g(t,["instances[0]","referenceImages"],u)}const l=p(e,["config"]);return l!=null&&CH(l,t),t}function PH(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>ug(a))),g(e,["generatedImages"],i)}return e}function DH(n,e){const t={},s=p(n,["taskType"]);e!==void 0&&s!=null&&g(e,["requests[]","taskType"],s);const i=p(n,["title"]);e!==void 0&&i!=null&&g(e,["requests[]","title"],i);const a=p(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&g(e,["requests[]","outputDimensionality"],a),p(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function MH(n,e){const t={},s=p(n,["taskType"]);e!==void 0&&s!=null&&g(e,["instances[]","task_type"],s);const i=p(n,["title"]);e!==void 0&&i!=null&&g(e,["instances[]","title"],i);const a=p(n,["outputDimensionality"]);e!==void 0&&a!=null&&g(e,["parameters","outputDimensionality"],a);const l=p(n,["mimeType"]);e!==void 0&&l!=null&&g(e,["instances[]","mimeType"],l);const u=p(n,["autoTruncate"]);return e!==void 0&&u!=null&&g(e,["parameters","autoTruncate"],u),t}function kH(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["contents"]);if(i!=null){let u=jE(n,i);Array.isArray(u)&&(u=u.map(f=>f)),g(t,["requests[]","content"],u)}const a=p(e,["config"]);a!=null&&DH(a,t);const l=p(e,["model"]);return l!==void 0&&g(t,["requests[]","model"],dt(n,l)),t}function VH(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["contents"]);if(i!=null){let l=jE(n,i);Array.isArray(l)&&(l=l.map(u=>u)),g(t,["instances[]","content"],l)}const a=p(e,["config"]);return a!=null&&MH(a,t),t}function LH(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["embeddings"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["embeddings"],a)}const i=p(n,["metadata"]);return i!=null&&g(e,["metadata"],i),e}function UH(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["predictions[]","embeddings"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>gH(l))),g(e,["embeddings"],a)}const i=p(n,["metadata"]);return i!=null&&g(e,["metadata"],i),e}function OH(n){const e={},t=p(n,["endpoint"]);t!=null&&g(e,["name"],t);const s=p(n,["deployedModelId"]);return s!=null&&g(e,["deployedModelId"],s),e}function FH(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function BH(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const s=p(n,["args"]);s!=null&&g(e,["args"],s);const i=p(n,["name"]);if(i!=null&&g(e,["name"],i),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function jH(n){const e={},t=p(n,["mode"]);t!=null&&g(e,["mode"],t);const s=p(n,["allowedFunctionNames"]);if(s!=null&&g(e,["allowedFunctionNames"],s),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function GH(n){const e={};if(p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=p(n,["description"]);t!=null&&g(e,["description"],t);const s=p(n,["name"]);s!=null&&g(e,["name"],s);const i=p(n,["parameters"]);i!=null&&g(e,["parameters"],i);const a=p(n,["parametersJsonSchema"]);a!=null&&g(e,["parametersJsonSchema"],a);const l=p(n,["response"]);l!=null&&g(e,["response"],l);const u=p(n,["responseJsonSchema"]);return u!=null&&g(e,["responseJsonSchema"],u),e}function qH(n,e,t){const s={},i=p(e,["systemInstruction"]);t!==void 0&&i!=null&&g(t,["systemInstruction"],cg(qn(i)));const a=p(e,["temperature"]);a!=null&&g(s,["temperature"],a);const l=p(e,["topP"]);l!=null&&g(s,["topP"],l);const u=p(e,["topK"]);u!=null&&g(s,["topK"],u);const f=p(e,["candidateCount"]);f!=null&&g(s,["candidateCount"],f);const m=p(e,["maxOutputTokens"]);m!=null&&g(s,["maxOutputTokens"],m);const _=p(e,["stopSequences"]);_!=null&&g(s,["stopSequences"],_);const T=p(e,["responseLogprobs"]);T!=null&&g(s,["responseLogprobs"],T);const x=p(e,["logprobs"]);x!=null&&g(s,["logprobs"],x);const b=p(e,["presencePenalty"]);b!=null&&g(s,["presencePenalty"],b);const k=p(e,["frequencyPenalty"]);k!=null&&g(s,["frequencyPenalty"],k);const G=p(e,["seed"]);G!=null&&g(s,["seed"],G);const F=p(e,["responseMimeType"]);F!=null&&g(s,["responseMimeType"],F);const Y=p(e,["responseSchema"]);Y!=null&&g(s,["responseSchema"],GE(Y));const K=p(e,["responseJsonSchema"]);if(K!=null&&g(s,["responseJsonSchema"],K),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const H=p(e,["safetySettings"]);if(t!==void 0&&H!=null){let M=H;Array.isArray(M)&&(M=M.map(ae=>M9(ae))),g(t,["safetySettings"],M)}const U=p(e,["tools"]);if(t!==void 0&&U!=null){let M=nu(U);Array.isArray(M)&&(M=M.map(ae=>B9(tu(ae)))),g(t,["tools"],M)}const z=p(e,["toolConfig"]);if(t!==void 0&&z!=null&&g(t,["toolConfig"],F9(z)),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=p(e,["cachedContent"]);t!==void 0&&J!=null&&g(t,["cachedContent"],kr(n,J));const P=p(e,["responseModalities"]);P!=null&&g(s,["responseModalities"],P);const C=p(e,["mediaResolution"]);C!=null&&g(s,["mediaResolution"],C);const S=p(e,["speechConfig"]);if(S!=null&&g(s,["speechConfig"],qE(S)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=p(e,["thinkingConfig"]);L!=null&&g(s,["thinkingConfig"],L);const V=p(e,["imageConfig"]);V!=null&&g(s,["imageConfig"],g9(V));const O=p(e,["enableEnhancedCivicAnswers"]);return O!=null&&g(s,["enableEnhancedCivicAnswers"],O),s}function HH(n,e,t){const s={},i=p(e,["systemInstruction"]);t!==void 0&&i!=null&&g(t,["systemInstruction"],qn(i));const a=p(e,["temperature"]);a!=null&&g(s,["temperature"],a);const l=p(e,["topP"]);l!=null&&g(s,["topP"],l);const u=p(e,["topK"]);u!=null&&g(s,["topK"],u);const f=p(e,["candidateCount"]);f!=null&&g(s,["candidateCount"],f);const m=p(e,["maxOutputTokens"]);m!=null&&g(s,["maxOutputTokens"],m);const _=p(e,["stopSequences"]);_!=null&&g(s,["stopSequences"],_);const T=p(e,["responseLogprobs"]);T!=null&&g(s,["responseLogprobs"],T);const x=p(e,["logprobs"]);x!=null&&g(s,["logprobs"],x);const b=p(e,["presencePenalty"]);b!=null&&g(s,["presencePenalty"],b);const k=p(e,["frequencyPenalty"]);k!=null&&g(s,["frequencyPenalty"],k);const G=p(e,["seed"]);G!=null&&g(s,["seed"],G);const F=p(e,["responseMimeType"]);F!=null&&g(s,["responseMimeType"],F);const Y=p(e,["responseSchema"]);Y!=null&&g(s,["responseSchema"],GE(Y));const K=p(e,["responseJsonSchema"]);K!=null&&g(s,["responseJsonSchema"],K);const H=p(e,["routingConfig"]);H!=null&&g(s,["routingConfig"],H);const U=p(e,["modelSelectionConfig"]);U!=null&&g(s,["modelConfig"],U);const z=p(e,["safetySettings"]);if(t!==void 0&&z!=null){let Q=z;Array.isArray(Q)&&(Q=Q.map(ge=>ge)),g(t,["safetySettings"],Q)}const J=p(e,["tools"]);if(t!==void 0&&J!=null){let Q=nu(J);Array.isArray(Q)&&(Q=Q.map(ge=>ID(tu(ge)))),g(t,["tools"],Q)}const P=p(e,["toolConfig"]);t!==void 0&&P!=null&&g(t,["toolConfig"],P);const C=p(e,["labels"]);t!==void 0&&C!=null&&g(t,["labels"],C);const S=p(e,["cachedContent"]);t!==void 0&&S!=null&&g(t,["cachedContent"],kr(n,S));const L=p(e,["responseModalities"]);L!=null&&g(s,["responseModalities"],L);const V=p(e,["mediaResolution"]);V!=null&&g(s,["mediaResolution"],V);const O=p(e,["speechConfig"]);O!=null&&g(s,["speechConfig"],xD(qE(O)));const M=p(e,["audioTimestamp"]);M!=null&&g(s,["audioTimestamp"],M);const ae=p(e,["thinkingConfig"]);ae!=null&&g(s,["thinkingConfig"],ae);const Ie=p(e,["imageConfig"]);if(Ie!=null&&g(s,["imageConfig"],y9(Ie)),p(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return s}function aS(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["contents"]);if(i!=null){let l=Gs(i);Array.isArray(l)&&(l=l.map(u=>cg(u))),g(t,["contents"],l)}const a=p(e,["config"]);return a!=null&&g(t,["generationConfig"],qH(n,a,t)),t}function lS(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["contents"]);if(i!=null){let l=Gs(i);Array.isArray(l)&&(l=l.map(u=>u)),g(t,["contents"],l)}const a=p(e,["config"]);return a!=null&&g(t,["generationConfig"],HH(n,a,t)),t}function cS(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["candidates"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(m=>hH(m))),g(e,["candidates"],f)}const i=p(n,["modelVersion"]);i!=null&&g(e,["modelVersion"],i);const a=p(n,["promptFeedback"]);a!=null&&g(e,["promptFeedback"],a);const l=p(n,["responseId"]);l!=null&&g(e,["responseId"],l);const u=p(n,["usageMetadata"]);return u!=null&&g(e,["usageMetadata"],u),e}function uS(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["candidates"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(_=>_)),g(e,["candidates"],m)}const i=p(n,["createTime"]);i!=null&&g(e,["createTime"],i);const a=p(n,["modelVersion"]);a!=null&&g(e,["modelVersion"],a);const l=p(n,["promptFeedback"]);l!=null&&g(e,["promptFeedback"],l);const u=p(n,["responseId"]);u!=null&&g(e,["responseId"],u);const f=p(n,["usageMetadata"]);return f!=null&&g(e,["usageMetadata"],f),e}function zH(n,e){const t={};if(p(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=p(n,["numberOfImages"]);e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s);const i=p(n,["aspectRatio"]);e!==void 0&&i!=null&&g(e,["parameters","aspectRatio"],i);const a=p(n,["guidanceScale"]);if(e!==void 0&&a!=null&&g(e,["parameters","guidanceScale"],a),p(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=p(n,["safetyFilterLevel"]);e!==void 0&&l!=null&&g(e,["parameters","safetySetting"],l);const u=p(n,["personGeneration"]);e!==void 0&&u!=null&&g(e,["parameters","personGeneration"],u);const f=p(n,["includeSafetyAttributes"]);e!==void 0&&f!=null&&g(e,["parameters","includeSafetyAttributes"],f);const m=p(n,["includeRaiReason"]);e!==void 0&&m!=null&&g(e,["parameters","includeRaiReason"],m);const _=p(n,["language"]);e!==void 0&&_!=null&&g(e,["parameters","language"],_);const T=p(n,["outputMimeType"]);e!==void 0&&T!=null&&g(e,["parameters","outputOptions","mimeType"],T);const x=p(n,["outputCompressionQuality"]);if(e!==void 0&&x!=null&&g(e,["parameters","outputOptions","compressionQuality"],x),p(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(p(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const b=p(n,["imageSize"]);if(e!==void 0&&b!=null&&g(e,["parameters","sampleImageSize"],b),p(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function $H(n,e){const t={},s=p(n,["outputGcsUri"]);e!==void 0&&s!=null&&g(e,["parameters","storageUri"],s);const i=p(n,["negativePrompt"]);e!==void 0&&i!=null&&g(e,["parameters","negativePrompt"],i);const a=p(n,["numberOfImages"]);e!==void 0&&a!=null&&g(e,["parameters","sampleCount"],a);const l=p(n,["aspectRatio"]);e!==void 0&&l!=null&&g(e,["parameters","aspectRatio"],l);const u=p(n,["guidanceScale"]);e!==void 0&&u!=null&&g(e,["parameters","guidanceScale"],u);const f=p(n,["seed"]);e!==void 0&&f!=null&&g(e,["parameters","seed"],f);const m=p(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&g(e,["parameters","safetySetting"],m);const _=p(n,["personGeneration"]);e!==void 0&&_!=null&&g(e,["parameters","personGeneration"],_);const T=p(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&g(e,["parameters","includeSafetyAttributes"],T);const x=p(n,["includeRaiReason"]);e!==void 0&&x!=null&&g(e,["parameters","includeRaiReason"],x);const b=p(n,["language"]);e!==void 0&&b!=null&&g(e,["parameters","language"],b);const k=p(n,["outputMimeType"]);e!==void 0&&k!=null&&g(e,["parameters","outputOptions","mimeType"],k);const G=p(n,["outputCompressionQuality"]);e!==void 0&&G!=null&&g(e,["parameters","outputOptions","compressionQuality"],G);const F=p(n,["addWatermark"]);e!==void 0&&F!=null&&g(e,["parameters","addWatermark"],F);const Y=p(n,["labels"]);e!==void 0&&Y!=null&&g(e,["labels"],Y);const K=p(n,["imageSize"]);e!==void 0&&K!=null&&g(e,["parameters","sampleImageSize"],K);const H=p(n,["enhancePrompt"]);return e!==void 0&&H!=null&&g(e,["parameters","enhancePrompt"],H),t}function YH(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["prompt"]);i!=null&&g(t,["instances[0]","prompt"],i);const a=p(e,["config"]);return a!=null&&zH(a,t),t}function KH(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["prompt"]);i!=null&&g(t,["instances[0]","prompt"],i);const a=p(e,["config"]);return a!=null&&$H(a,t),t}function JH(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["predictions"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>a9(l))),g(e,["generatedImages"],a)}const i=p(n,["positivePromptSafetyAttributes"]);return i!=null&&g(e,["positivePromptSafetyAttributes"],ED(i)),e}function QH(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["predictions"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>ug(l))),g(e,["generatedImages"],a)}const i=p(n,["positivePromptSafetyAttributes"]);return i!=null&&g(e,["positivePromptSafetyAttributes"],TD(i)),e}function WH(n,e){const t={},s=p(n,["numberOfVideos"]);if(e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s),p(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=p(n,["durationSeconds"]);if(e!==void 0&&i!=null&&g(e,["parameters","durationSeconds"],i),p(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=p(n,["aspectRatio"]);e!==void 0&&a!=null&&g(e,["parameters","aspectRatio"],a);const l=p(n,["resolution"]);e!==void 0&&l!=null&&g(e,["parameters","resolution"],l);const u=p(n,["personGeneration"]);if(e!==void 0&&u!=null&&g(e,["parameters","personGeneration"],u),p(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=p(n,["negativePrompt"]);e!==void 0&&f!=null&&g(e,["parameters","negativePrompt"],f);const m=p(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&g(e,["parameters","enhancePrompt"],m),p(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const _=p(n,["lastFrame"]);e!==void 0&&_!=null&&g(e,["instances[0]","lastFrame"],dg(_));const T=p(n,["referenceImages"]);if(e!==void 0&&T!=null){let x=T;Array.isArray(x)&&(x=x.map(b=>Z9(b))),g(e,["instances[0]","referenceImages"],x)}if(p(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(p(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function XH(n,e){const t={},s=p(n,["numberOfVideos"]);e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s);const i=p(n,["outputGcsUri"]);e!==void 0&&i!=null&&g(e,["parameters","storageUri"],i);const a=p(n,["fps"]);e!==void 0&&a!=null&&g(e,["parameters","fps"],a);const l=p(n,["durationSeconds"]);e!==void 0&&l!=null&&g(e,["parameters","durationSeconds"],l);const u=p(n,["seed"]);e!==void 0&&u!=null&&g(e,["parameters","seed"],u);const f=p(n,["aspectRatio"]);e!==void 0&&f!=null&&g(e,["parameters","aspectRatio"],f);const m=p(n,["resolution"]);e!==void 0&&m!=null&&g(e,["parameters","resolution"],m);const _=p(n,["personGeneration"]);e!==void 0&&_!=null&&g(e,["parameters","personGeneration"],_);const T=p(n,["pubsubTopic"]);e!==void 0&&T!=null&&g(e,["parameters","pubsubTopic"],T);const x=p(n,["negativePrompt"]);e!==void 0&&x!=null&&g(e,["parameters","negativePrompt"],x);const b=p(n,["enhancePrompt"]);e!==void 0&&b!=null&&g(e,["parameters","enhancePrompt"],b);const k=p(n,["generateAudio"]);e!==void 0&&k!=null&&g(e,["parameters","generateAudio"],k);const G=p(n,["lastFrame"]);e!==void 0&&G!=null&&g(e,["instances[0]","lastFrame"],ui(G));const F=p(n,["referenceImages"]);if(e!==void 0&&F!=null){let H=F;Array.isArray(H)&&(H=H.map(U=>ez(U))),g(e,["instances[0]","referenceImages"],H)}const Y=p(n,["mask"]);e!==void 0&&Y!=null&&g(e,["instances[0]","mask"],X9(Y));const K=p(n,["compressionQuality"]);return e!==void 0&&K!=null&&g(e,["parameters","compressionQuality"],K),t}function ZH(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const s=p(n,["metadata"]);s!=null&&g(e,["metadata"],s);const i=p(n,["done"]);i!=null&&g(e,["done"],i);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response","generateVideoResponse"]);return l!=null&&g(e,["response"],s9(l)),e}function e9(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const s=p(n,["metadata"]);s!=null&&g(e,["metadata"],s);const i=p(n,["done"]);i!=null&&g(e,["done"],i);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response"]);return l!=null&&g(e,["response"],i9(l)),e}function t9(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["prompt"]);i!=null&&g(t,["instances[0]","prompt"],i);const a=p(e,["image"]);a!=null&&g(t,["instances[0]","image"],dg(a));const l=p(e,["video"]);l!=null&&g(t,["instances[0]","video"],bD(l));const u=p(e,["source"]);u!=null&&r9(u,t);const f=p(e,["config"]);return f!=null&&WH(f,t),t}function n9(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["prompt"]);i!=null&&g(t,["instances[0]","prompt"],i);const a=p(e,["image"]);a!=null&&g(t,["instances[0]","image"],ui(a));const l=p(e,["video"]);l!=null&&g(t,["instances[0]","video"],AD(l));const u=p(e,["source"]);u!=null&&o9(u,t);const f=p(e,["config"]);return f!=null&&XH(f,t),t}function s9(n){const e={},t=p(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>c9(l))),g(e,["generatedVideos"],a)}const s=p(n,["raiMediaFilteredCount"]);s!=null&&g(e,["raiMediaFilteredCount"],s);const i=p(n,["raiMediaFilteredReasons"]);return i!=null&&g(e,["raiMediaFilteredReasons"],i),e}function i9(n){const e={},t=p(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>u9(l))),g(e,["generatedVideos"],a)}const s=p(n,["raiMediaFilteredCount"]);s!=null&&g(e,["raiMediaFilteredCount"],s);const i=p(n,["raiMediaFilteredReasons"]);return i!=null&&g(e,["raiMediaFilteredReasons"],i),e}function r9(n,e){const t={},s=p(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const i=p(n,["image"]);e!==void 0&&i!=null&&g(e,["instances[0]","image"],dg(i));const a=p(n,["video"]);return e!==void 0&&a!=null&&g(e,["instances[0]","video"],bD(a)),t}function o9(n,e){const t={},s=p(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const i=p(n,["image"]);e!==void 0&&i!=null&&g(e,["instances[0]","image"],ui(i));const a=p(n,["video"]);return e!==void 0&&a!=null&&g(e,["instances[0]","video"],AD(a)),t}function a9(n){const e={},t=p(n,["_self"]);t!=null&&g(e,["image"],_9(t));const s=p(n,["raiFilteredReason"]);s!=null&&g(e,["raiFilteredReason"],s);const i=p(n,["_self"]);return i!=null&&g(e,["safetyAttributes"],ED(i)),e}function ug(n){const e={},t=p(n,["_self"]);t!=null&&g(e,["image"],vD(t));const s=p(n,["raiFilteredReason"]);s!=null&&g(e,["raiFilteredReason"],s);const i=p(n,["_self"]);i!=null&&g(e,["safetyAttributes"],TD(i));const a=p(n,["prompt"]);return a!=null&&g(e,["enhancedPrompt"],a),e}function l9(n){const e={},t=p(n,["_self"]);t!=null&&g(e,["mask"],vD(t));const s=p(n,["labels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>a)),g(e,["labels"],i)}return e}function c9(n){const e={},t=p(n,["video"]);return t!=null&&g(e,["video"],Q9(t)),e}function u9(n){const e={},t=p(n,["_self"]);return t!=null&&g(e,["video"],W9(t)),e}function d9(n){const e={},t=p(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);const s=p(n,["responseJsonSchema"]);s!=null&&g(e,["responseJsonSchema"],s);const i=p(n,["audioTimestamp"]);i!=null&&g(e,["audioTimestamp"],i);const a=p(n,["candidateCount"]);a!=null&&g(e,["candidateCount"],a);const l=p(n,["enableAffectiveDialog"]);l!=null&&g(e,["enableAffectiveDialog"],l);const u=p(n,["frequencyPenalty"]);u!=null&&g(e,["frequencyPenalty"],u);const f=p(n,["logprobs"]);f!=null&&g(e,["logprobs"],f);const m=p(n,["maxOutputTokens"]);m!=null&&g(e,["maxOutputTokens"],m);const _=p(n,["mediaResolution"]);_!=null&&g(e,["mediaResolution"],_);const T=p(n,["presencePenalty"]);T!=null&&g(e,["presencePenalty"],T);const x=p(n,["responseLogprobs"]);x!=null&&g(e,["responseLogprobs"],x);const b=p(n,["responseMimeType"]);b!=null&&g(e,["responseMimeType"],b);const k=p(n,["responseModalities"]);k!=null&&g(e,["responseModalities"],k);const G=p(n,["responseSchema"]);G!=null&&g(e,["responseSchema"],G);const F=p(n,["routingConfig"]);F!=null&&g(e,["routingConfig"],F);const Y=p(n,["seed"]);Y!=null&&g(e,["seed"],Y);const K=p(n,["speechConfig"]);K!=null&&g(e,["speechConfig"],xD(K));const H=p(n,["stopSequences"]);H!=null&&g(e,["stopSequences"],H);const U=p(n,["temperature"]);U!=null&&g(e,["temperature"],U);const z=p(n,["thinkingConfig"]);z!=null&&g(e,["thinkingConfig"],z);const J=p(n,["topK"]);J!=null&&g(e,["topK"],J);const P=p(n,["topP"]);if(P!=null&&g(e,["topP"],P),p(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function h9(n,e){const t={},s=p(e,["model"]);return s!=null&&g(t,["_url","name"],dt(n,s)),t}function f9(n,e){const t={},s=p(e,["model"]);return s!=null&&g(t,["_url","name"],dt(n,s)),t}function m9(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function p9(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function g9(n){const e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);const s=p(n,["imageSize"]);if(s!=null&&g(e,["imageSize"],s),p(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function y9(n){const e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);const s=p(n,["imageSize"]);s!=null&&g(e,["imageSize"],s);const i=p(n,["outputMimeType"]);i!=null&&g(e,["imageOutputOptions","mimeType"],i);const a=p(n,["outputCompressionQuality"]);return a!=null&&g(e,["imageOutputOptions","compressionQuality"],a),e}function _9(n){const e={},t=p(n,["bytesBase64Encoded"]);t!=null&&g(e,["imageBytes"],Ko(t));const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function vD(n){const e={},t=p(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);const s=p(n,["bytesBase64Encoded"]);s!=null&&g(e,["imageBytes"],Ko(s));const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function dg(n){const e={};if(p(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=p(n,["imageBytes"]);t!=null&&g(e,["bytesBase64Encoded"],Ko(t));const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function ui(n){const e={},t=p(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);const s=p(n,["imageBytes"]);s!=null&&g(e,["bytesBase64Encoded"],Ko(s));const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function v9(n,e,t){const s={},i=p(e,["pageSize"]);t!==void 0&&i!=null&&g(t,["_query","pageSize"],i);const a=p(e,["pageToken"]);t!==void 0&&a!=null&&g(t,["_query","pageToken"],a);const l=p(e,["filter"]);t!==void 0&&l!=null&&g(t,["_query","filter"],l);const u=p(e,["queryBase"]);return t!==void 0&&u!=null&&g(t,["_url","models_url"],dD(n,u)),s}function E9(n,e,t){const s={},i=p(e,["pageSize"]);t!==void 0&&i!=null&&g(t,["_query","pageSize"],i);const a=p(e,["pageToken"]);t!==void 0&&a!=null&&g(t,["_query","pageToken"],a);const l=p(e,["filter"]);t!==void 0&&l!=null&&g(t,["_query","filter"],l);const u=p(e,["queryBase"]);return t!==void 0&&u!=null&&g(t,["_url","models_url"],dD(n,u)),s}function T9(n,e){const t={},s=p(e,["config"]);return s!=null&&v9(n,s,t),t}function x9(n,e){const t={},s=p(e,["config"]);return s!=null&&E9(n,s,t),t}function I9(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const i=p(n,["_self"]);if(i!=null){let a=hD(i);Array.isArray(a)&&(a=a.map(l=>Bv(l))),g(e,["models"],a)}return e}function b9(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const i=p(n,["_self"]);if(i!=null){let a=hD(i);Array.isArray(a)&&(a=a.map(l=>jv(l))),g(e,["models"],a)}return e}function A9(n){const e={},t=p(n,["maskMode"]);t!=null&&g(e,["maskMode"],t);const s=p(n,["segmentationClasses"]);s!=null&&g(e,["maskClasses"],s);const i=p(n,["maskDilation"]);return i!=null&&g(e,["dilation"],i),e}function Bv(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const s=p(n,["displayName"]);s!=null&&g(e,["displayName"],s);const i=p(n,["description"]);i!=null&&g(e,["description"],i);const a=p(n,["version"]);a!=null&&g(e,["version"],a);const l=p(n,["_self"]);l!=null&&g(e,["tunedModelInfo"],j9(l));const u=p(n,["inputTokenLimit"]);u!=null&&g(e,["inputTokenLimit"],u);const f=p(n,["outputTokenLimit"]);f!=null&&g(e,["outputTokenLimit"],f);const m=p(n,["supportedGenerationMethods"]);m!=null&&g(e,["supportedActions"],m);const _=p(n,["temperature"]);_!=null&&g(e,["temperature"],_);const T=p(n,["maxTemperature"]);T!=null&&g(e,["maxTemperature"],T);const x=p(n,["topP"]);x!=null&&g(e,["topP"],x);const b=p(n,["topK"]);b!=null&&g(e,["topK"],b);const k=p(n,["thinking"]);return k!=null&&g(e,["thinking"],k),e}function jv(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const s=p(n,["displayName"]);s!=null&&g(e,["displayName"],s);const i=p(n,["description"]);i!=null&&g(e,["description"],i);const a=p(n,["versionId"]);a!=null&&g(e,["version"],a);const l=p(n,["deployedModels"]);if(l!=null){let T=l;Array.isArray(T)&&(T=T.map(x=>OH(x))),g(e,["endpoints"],T)}const u=p(n,["labels"]);u!=null&&g(e,["labels"],u);const f=p(n,["_self"]);f!=null&&g(e,["tunedModelInfo"],G9(f));const m=p(n,["defaultCheckpointId"]);m!=null&&g(e,["defaultCheckpointId"],m);const _=p(n,["checkpoints"]);if(_!=null){let T=_;Array.isArray(T)&&(T=T.map(x=>x)),g(e,["checkpoints"],T)}return e}function w9(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const s=p(n,["codeExecutionResult"]);s!=null&&g(e,["codeExecutionResult"],s);const i=p(n,["executableCode"]);i!=null&&g(e,["executableCode"],i);const a=p(n,["fileData"]);a!=null&&g(e,["fileData"],FH(a));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],BH(l));const u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);const f=p(n,["inlineData"]);f!=null&&g(e,["inlineData"],dH(f));const m=p(n,["text"]);m!=null&&g(e,["text"],m);const _=p(n,["thought"]);_!=null&&g(e,["thought"],_);const T=p(n,["thoughtSignature"]);T!=null&&g(e,["thoughtSignature"],T);const x=p(n,["videoMetadata"]);return x!=null&&g(e,["videoMetadata"],x),e}function N9(n){const e={},t=p(n,["productImage"]);return t!=null&&g(e,["image"],ui(t)),e}function S9(n,e){const t={},s=p(n,["numberOfImages"]);e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s);const i=p(n,["baseSteps"]);e!==void 0&&i!=null&&g(e,["parameters","baseSteps"],i);const a=p(n,["outputGcsUri"]);e!==void 0&&a!=null&&g(e,["parameters","storageUri"],a);const l=p(n,["seed"]);e!==void 0&&l!=null&&g(e,["parameters","seed"],l);const u=p(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&g(e,["parameters","safetySetting"],u);const f=p(n,["personGeneration"]);e!==void 0&&f!=null&&g(e,["parameters","personGeneration"],f);const m=p(n,["addWatermark"]);e!==void 0&&m!=null&&g(e,["parameters","addWatermark"],m);const _=p(n,["outputMimeType"]);e!==void 0&&_!=null&&g(e,["parameters","outputOptions","mimeType"],_);const T=p(n,["outputCompressionQuality"]);e!==void 0&&T!=null&&g(e,["parameters","outputOptions","compressionQuality"],T);const x=p(n,["enhancePrompt"]);e!==void 0&&x!=null&&g(e,["parameters","enhancePrompt"],x);const b=p(n,["labels"]);return e!==void 0&&b!=null&&g(e,["labels"],b),t}function C9(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["source"]);i!=null&&P9(i,t);const a=p(e,["config"]);return a!=null&&S9(a,t),t}function R9(n){const e={},t=p(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(i=>ug(i))),g(e,["generatedImages"],s)}return e}function P9(n,e){const t={},s=p(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const i=p(n,["personImage"]);e!==void 0&&i!=null&&g(e,["instances[0]","personImage","image"],ui(i));const a=p(n,["productImages"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>N9(u))),g(e,["instances[0]","productImages"],l)}return t}function D9(n){const e={},t=p(n,["referenceImage"]);t!=null&&g(e,["referenceImage"],ui(t));const s=p(n,["referenceId"]);s!=null&&g(e,["referenceId"],s);const i=p(n,["referenceType"]);i!=null&&g(e,["referenceType"],i);const a=p(n,["maskImageConfig"]);a!=null&&g(e,["maskImageConfig"],A9(a));const l=p(n,["controlImageConfig"]);l!=null&&g(e,["controlImageConfig"],_H(l));const u=p(n,["styleImageConfig"]);u!=null&&g(e,["styleImageConfig"],u);const f=p(n,["subjectImageConfig"]);return f!=null&&g(e,["subjectImageConfig"],f),e}function ED(n){const e={},t=p(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);const s=p(n,["safetyAttributes","scores"]);s!=null&&g(e,["scores"],s);const i=p(n,["contentType"]);return i!=null&&g(e,["contentType"],i),e}function TD(n){const e={},t=p(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);const s=p(n,["safetyAttributes","scores"]);s!=null&&g(e,["scores"],s);const i=p(n,["contentType"]);return i!=null&&g(e,["contentType"],i),e}function M9(n){const e={},t=p(n,["category"]);if(t!=null&&g(e,["category"],t),p(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=p(n,["threshold"]);return s!=null&&g(e,["threshold"],s),e}function k9(n){const e={},t=p(n,["image"]);return t!=null&&g(e,["image"],ui(t)),e}function V9(n,e){const t={},s=p(n,["mode"]);e!==void 0&&s!=null&&g(e,["parameters","mode"],s);const i=p(n,["maxPredictions"]);e!==void 0&&i!=null&&g(e,["parameters","maxPredictions"],i);const a=p(n,["confidenceThreshold"]);e!==void 0&&a!=null&&g(e,["parameters","confidenceThreshold"],a);const l=p(n,["maskDilation"]);e!==void 0&&l!=null&&g(e,["parameters","maskDilation"],l);const u=p(n,["binaryColorThreshold"]);e!==void 0&&u!=null&&g(e,["parameters","binaryColorThreshold"],u);const f=p(n,["labels"]);return e!==void 0&&f!=null&&g(e,["labels"],f),t}function L9(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["source"]);i!=null&&O9(i,t);const a=p(e,["config"]);return a!=null&&V9(a,t),t}function U9(n){const e={},t=p(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(i=>l9(i))),g(e,["generatedMasks"],s)}return e}function O9(n,e){const t={},s=p(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const i=p(n,["image"]);e!==void 0&&i!=null&&g(e,["instances[0]","image"],ui(i));const a=p(n,["scribbleImage"]);return e!==void 0&&a!=null&&g(e,["instances[0]","scribble"],k9(a)),t}function xD(n){const e={},t=p(n,["voiceConfig"]);t!=null&&g(e,["voiceConfig"],t);const s=p(n,["languageCode"]);if(s!=null&&g(e,["languageCode"],s),p(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function F9(n){const e={},t=p(n,["functionCallingConfig"]);t!=null&&g(e,["functionCallingConfig"],jH(t));const s=p(n,["retrievalConfig"]);return s!=null&&g(e,["retrievalConfig"],s),e}function B9(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(T=>T)),g(e,["functionDeclarations"],_)}if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=p(n,["googleSearchRetrieval"]);s!=null&&g(e,["googleSearchRetrieval"],s);const i=p(n,["computerUse"]);i!=null&&g(e,["computerUse"],i);const a=p(n,["fileSearch"]);a!=null&&g(e,["fileSearch"],a);const l=p(n,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],m9(u));const f=p(n,["googleSearch"]);f!=null&&g(e,["googleSearch"],p9(f));const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function ID(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(x=>GH(x))),g(e,["functionDeclarations"],T)}const s=p(n,["retrieval"]);s!=null&&g(e,["retrieval"],s);const i=p(n,["googleSearchRetrieval"]);i!=null&&g(e,["googleSearchRetrieval"],i);const a=p(n,["computerUse"]);if(a!=null&&g(e,["computerUse"],a),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=p(n,["codeExecution"]);l!=null&&g(e,["codeExecution"],l);const u=p(n,["enterpriseWebSearch"]);u!=null&&g(e,["enterpriseWebSearch"],u);const f=p(n,["googleMaps"]);f!=null&&g(e,["googleMaps"],f);const m=p(n,["googleSearch"]);m!=null&&g(e,["googleSearch"],m);const _=p(n,["urlContext"]);return _!=null&&g(e,["urlContext"],_),e}function j9(n){const e={},t=p(n,["baseModel"]);t!=null&&g(e,["baseModel"],t);const s=p(n,["createTime"]);s!=null&&g(e,["createTime"],s);const i=p(n,["updateTime"]);return i!=null&&g(e,["updateTime"],i),e}function G9(n){const e={},t=p(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&g(e,["baseModel"],t);const s=p(n,["createTime"]);s!=null&&g(e,["createTime"],s);const i=p(n,["updateTime"]);return i!=null&&g(e,["updateTime"],i),e}function q9(n,e){const t={},s=p(n,["displayName"]);e!==void 0&&s!=null&&g(e,["displayName"],s);const i=p(n,["description"]);e!==void 0&&i!=null&&g(e,["description"],i);const a=p(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&g(e,["defaultCheckpointId"],a),t}function H9(n,e){const t={},s=p(n,["displayName"]);e!==void 0&&s!=null&&g(e,["displayName"],s);const i=p(n,["description"]);e!==void 0&&i!=null&&g(e,["description"],i);const a=p(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&g(e,["defaultCheckpointId"],a),t}function z9(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","name"],dt(n,s));const i=p(e,["config"]);return i!=null&&q9(i,t),t}function $9(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["config"]);return i!=null&&H9(i,t),t}function Y9(n,e){const t={},s=p(n,["outputGcsUri"]);e!==void 0&&s!=null&&g(e,["parameters","storageUri"],s);const i=p(n,["safetyFilterLevel"]);e!==void 0&&i!=null&&g(e,["parameters","safetySetting"],i);const a=p(n,["personGeneration"]);e!==void 0&&a!=null&&g(e,["parameters","personGeneration"],a);const l=p(n,["includeRaiReason"]);e!==void 0&&l!=null&&g(e,["parameters","includeRaiReason"],l);const u=p(n,["outputMimeType"]);e!==void 0&&u!=null&&g(e,["parameters","outputOptions","mimeType"],u);const f=p(n,["outputCompressionQuality"]);e!==void 0&&f!=null&&g(e,["parameters","outputOptions","compressionQuality"],f);const m=p(n,["enhanceInputImage"]);e!==void 0&&m!=null&&g(e,["parameters","upscaleConfig","enhanceInputImage"],m);const _=p(n,["imagePreservationFactor"]);e!==void 0&&_!=null&&g(e,["parameters","upscaleConfig","imagePreservationFactor"],_);const T=p(n,["labels"]);e!==void 0&&T!=null&&g(e,["labels"],T);const x=p(n,["numberOfImages"]);e!==void 0&&x!=null&&g(e,["parameters","sampleCount"],x);const b=p(n,["mode"]);return e!==void 0&&b!=null&&g(e,["parameters","mode"],b),t}function K9(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["_url","model"],dt(n,s));const i=p(e,["image"]);i!=null&&g(t,["instances[0]","image"],ui(i));const a=p(e,["upscaleFactor"]);a!=null&&g(t,["parameters","upscaleConfig","upscaleFactor"],a);const l=p(e,["config"]);return l!=null&&Y9(l,t),t}function J9(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>ug(a))),g(e,["generatedImages"],i)}return e}function Q9(n){const e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);const s=p(n,["encodedVideo"]);s!=null&&g(e,["videoBytes"],Ko(s));const i=p(n,["encoding"]);return i!=null&&g(e,["mimeType"],i),e}function W9(n){const e={},t=p(n,["gcsUri"]);t!=null&&g(e,["uri"],t);const s=p(n,["bytesBase64Encoded"]);s!=null&&g(e,["videoBytes"],Ko(s));const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function X9(n){const e={},t=p(n,["image"]);t!=null&&g(e,["_self"],ui(t));const s=p(n,["maskMode"]);return s!=null&&g(e,["maskMode"],s),e}function Z9(n){const e={},t=p(n,["image"]);t!=null&&g(e,["image"],dg(t));const s=p(n,["referenceType"]);return s!=null&&g(e,["referenceType"],s),e}function ez(n){const e={},t=p(n,["image"]);t!=null&&g(e,["image"],ui(t));const s=p(n,["referenceType"]);return s!=null&&g(e,["referenceType"],s),e}function bD(n){const e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);const s=p(n,["videoBytes"]);s!=null&&g(e,["encodedVideo"],Ko(s));const i=p(n,["mimeType"]);return i!=null&&g(e,["encoding"],i),e}function AD(n){const e={},t=p(n,["uri"]);t!=null&&g(e,["gcsUri"],t);const s=p(n,["videoBytes"]);s!=null&&g(e,["bytesBase64Encoded"],Ko(s));const i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tz(n,e){const t={},s=p(n,["displayName"]);return e!==void 0&&s!=null&&g(e,["displayName"],s),t}function nz(n){const e={},t=p(n,["config"]);return t!=null&&tz(t,e),e}function sz(n,e){const t={},s=p(n,["force"]);return e!==void 0&&s!=null&&g(e,["_query","force"],s),t}function iz(n){const e={},t=p(n,["name"]);t!=null&&g(e,["_url","name"],t);const s=p(n,["config"]);return s!=null&&sz(s,e),e}function rz(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function oz(n,e){const t={},s=p(n,["customMetadata"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["customMetadata"],a)}const i=p(n,["chunkingConfig"]);return e!==void 0&&i!=null&&g(e,["chunkingConfig"],i),t}function az(n){const e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);const s=p(n,["metadata"]);s!=null&&g(e,["metadata"],s);const i=p(n,["done"]);i!=null&&g(e,["done"],i);const a=p(n,["error"]);a!=null&&g(e,["error"],a);const l=p(n,["response"]);return l!=null&&g(e,["response"],cz(l)),e}function lz(n){const e={},t=p(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);const s=p(n,["fileName"]);s!=null&&g(e,["fileName"],s);const i=p(n,["config"]);return i!=null&&oz(i,e),e}function cz(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["parent"]);s!=null&&g(e,["parent"],s);const i=p(n,["documentName"]);return i!=null&&g(e,["documentName"],i),e}function uz(n,e){const t={},s=p(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const i=p(n,["pageToken"]);return e!==void 0&&i!=null&&g(e,["_query","pageToken"],i),t}function dz(n){const e={},t=p(n,["config"]);return t!=null&&uz(t,e),e}function hz(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const i=p(n,["fileSearchStores"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["fileSearchStores"],a)}return e}function wD(n,e){const t={},s=p(n,["mimeType"]);e!==void 0&&s!=null&&g(e,["mimeType"],s);const i=p(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);const a=p(n,["customMetadata"]);if(e!==void 0&&a!=null){let u=a;Array.isArray(u)&&(u=u.map(f=>f)),g(e,["customMetadata"],u)}const l=p(n,["chunkingConfig"]);return e!==void 0&&l!=null&&g(e,["chunkingConfig"],l),t}function fz(n){const e={},t=p(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);const s=p(n,["config"]);return s!=null&&wD(s,e),e}function mz(n){const e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pz="Content-Type",gz="X-Server-Timeout",yz="User-Agent",Gv="x-goog-api-client",_z="1.32.0",vz=`google-genai-sdk/${_z}`,Ez="v1beta1",Tz="v1beta";class xz{constructor(e){var t,s;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:Ez,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:Tz,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&s.push(e.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,s){const i=[this.getRequestUrlInternal(t)];return s&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,s);if(e.queryParams)for(const[l,u]of Object.entries(e.queryParams))i.searchParams.append(l,String(u));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,i.toString(),e.abortSignal),this.unaryApiCall(i,a,e.httpMethod)}patchHttpOptions(e,t){const s=JSON.parse(JSON.stringify(e));for(const[i,a]of Object.entries(t))typeof a=="object"?s[i]=Object.assign(Object.assign({},s[i]),a):a!==void 0&&(s[i]=a);return s}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,s);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,i.toString(),e.abortSignal),this.streamApiCall(i,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,s,i){if(t&&t.timeout||i){const a=new AbortController,l=a.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const u=setTimeout(()=>a.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}i&&i.addEventListener("abort",()=>{a.abort()}),e.signal=l}return t&&t.extraBody!==null&&Iz(e,t.extraBody),e.headers=await this.getHeadersInternal(t,s),e}async unaryApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async i=>(await dS(i),new Uv(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async i=>(await dS(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return yc(this,arguments,function*(){var s;const i=(s=e==null?void 0:e.body)===null||s===void 0?void 0:s.getReader(),a=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let l="";const u="data:",f=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:m,value:_}=yield Pt(i.read());if(m){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const T=a.decode(_,{stream:!0});try{const k=JSON.parse(T);if("error"in k){const G=JSON.parse(JSON.stringify(k.error)),F=G.status,Y=G.code,K=`got status: ${F}. ${JSON.stringify(k)}`;if(Y>=400&&Y<600)throw new lg({message:K,status:Y})}}catch(k){if(k.name==="ApiError")throw k}l+=T;let x=-1,b=0;for(;;){x=-1,b=0;for(const F of f){const Y=l.indexOf(F);Y!==-1&&(x===-1||Y<x)&&(x=Y,b=F.length)}if(x===-1)break;const k=l.substring(0,x);l=l.substring(x+b);const G=k.trim();if(G.startsWith(u)){const F=G.substring(u.length).trim();try{const Y=new Response(F,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Pt(new Uv(Y))}catch(Y){throw new Error(`exception parsing stream chunk ${F}. ${Y}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const e={},t=vz+" "+this.clientOptions.userAgentExtra;return e[yz]=t,e[Gv]=t,e[pz]="application/json",e}async getHeadersInternal(e,t){const s=new Headers;if(e&&e.headers){for(const[i,a]of Object.entries(e.headers))s.append(i,a);e.timeout&&e.timeout>0&&s.append(gz,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(s,t),s}getFileName(e){var t;let s="";return typeof e=="string"&&(s=e.replace(/[/\\]+$/,""),s=(t=s.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),s}async uploadFile(e,t){var s;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const a=this.clientOptions.uploader,l=await a.stat(e);i.sizeBytes=String(l.size);const u=(s=t==null?void 0:t.mimeType)!==null&&s!==void 0?s:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const f={file:i},m=this.getFileName(e),_=Ae("upload/v1beta/files",f._url),T=await this.fetchUploadUrl(_,i.sizeBytes,i.mimeType,m,f,t==null?void 0:t.httpOptions);return a.upload(e,T,this)}async uploadFileToFileSearchStore(e,t,s){var i;const a=this.clientOptions.uploader,l=await a.stat(t),u=String(l.size),f=(i=s==null?void 0:s.mimeType)!==null&&i!==void 0?i:l.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const m=`upload/v1beta/${e}:uploadToFileSearchStore`,_=this.getFileName(t),T={};s!=null&&wD(s,T);const x=await this.fetchUploadUrl(m,u,f,_,T,s==null?void 0:s.httpOptions);return a.uploadToFileSearchStore(t,x,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,s,i,a,l){var u;let f={};l?f=l:f={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${s}`},i?{"X-Goog-Upload-File-Name":i}:{})};const m=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:f});if(!m||!(m!=null&&m.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const _=(u=m==null?void 0:m.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(_===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return _}}async function dS(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let s;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await n.json():s={error:{message:await n.text(),code:n.status,status:n.statusText}};const i=JSON.stringify(s);throw t>=400&&t<600?new lg({message:i,status:t}):new Error(i)}}function Iz(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const a=JSON.parse(n.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function s(a,l){const u=Object.assign({},a);for(const f in l)if(Object.prototype.hasOwnProperty.call(l,f)){const m=l[f],_=u[f];m&&typeof m=="object"&&!Array.isArray(m)&&_&&typeof _=="object"&&!Array.isArray(_)?u[f]=s(_,m):(_&&m&&typeof _!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof _}, New type: ${typeof m}. Overwriting.`),u[f]=m)}return u}const i=s(t,e);n.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bz="mcp_used/unknown";let Az=!1;function ND(n){for(const e of n)if(wz(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Az}function SD(n){var e;const t=(e=n[Gv])!==null&&e!==void 0?e:"";n[Gv]=(t+` ${bz}`).trimStart()}function wz(n){return n!==null&&typeof n=="object"&&n instanceof zE}function Nz(n){return yc(this,arguments,function*(t,s=100){let i,a=0;for(;a<s;){const l=yield Pt(t.listTools({cursor:i}));for(const u of l.tools)yield yield Pt(u),a++;if(!l.nextCursor)break;i=l.nextCursor}})}class zE{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new zE(e,t)}async initialize(){var e,t,s,i;if(this.mcpTools.length>0)return;const a={},l=[];for(const _ of this.mcpClients)try{for(var u=!0,f=(t=void 0,Bd(Nz(_))),m;m=await f.next(),e=m.done,!e;u=!0){i=m.value,u=!1;const T=i;l.push(T);const x=T.name;if(a[x])throw new Error(`Duplicate function name ${x} found in MCP tools. Please ensure function names are unique.`);a[x]=_}}catch(T){t={error:T}}finally{try{!u&&!e&&(s=f.return)&&await s.call(f)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),rG(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const s of e)if(s.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[s.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const l=await i.callTool({name:s.name,arguments:s.args},void 0,a);t.push({functionResponse:{name:s.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Sz(n,e,t){const s=new Wj;let i;t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),Object.assign(s,i),e(s)}class Cz{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s}async connect(e){var t,s;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=Dz(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),f=`${i}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${u}`;let m=()=>{};const _=new Promise(H=>{m=H}),T=e.callbacks,x=function(){m({})},b=this.apiClient,k={onopen:x,onmessage:H=>{Sz(b,T.onmessage,H)},onerror:(t=T==null?void 0:T.onerror)!==null&&t!==void 0?t:function(H){},onclose:(s=T==null?void 0:T.onclose)!==null&&s!==void 0?s:function(H){}},G=this.webSocketFactory.create(f,Pz(l),k);G.connect(),await _;const K={setup:{model:dt(this.apiClient,e.model)}};return G.send(JSON.stringify(K)),new Rz(G,this.apiClient)}}class Rz{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=nH(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=tH(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(cc.PLAY)}pause(){this.sendPlaybackControl(cc.PAUSE)}stop(){this.sendPlaybackControl(cc.STOP)}resetContext(){this.sendPlaybackControl(cc.RESET_CONTEXT)}close(){this.conn.close()}}function Pz(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function Dz(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Mz="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function kz(n,e,t){const s=new Qj;let i;t.data instanceof Blob?i=await t.data.text():t.data instanceof ArrayBuffer?i=new TextDecoder().decode(t.data):i=t.data;const a=JSON.parse(i);if(n.isVertexAI()){const l=rH(a);Object.assign(s,l)}else Object.assign(s,a);e(s)}class Vz{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s,this.music=new Cz(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,s,i,a,l,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const f=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion();let _;const T=this.apiClient.getHeaders();e.config&&e.config.tools&&ND(e.config.tools)&&SD(T);const x=Fz(T);if(this.apiClient.isVertexAI())_=`${f}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x,_);else{const S=this.apiClient.getApiKey();let L="BidiGenerateContent",V="key";S!=null&&S.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),m!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),L="BidiGenerateContentConstrained",V="access_token"),_=`${f}/ws/google.ai.generativelanguage.${m}.GenerativeService.${L}?${V}=${S}`}let b=()=>{};const k=new Promise(S=>{b=S}),G=e.callbacks,F=function(){var S;(S=G==null?void 0:G.onopen)===null||S===void 0||S.call(G),b({})},Y=this.apiClient,K={onopen:F,onmessage:S=>{kz(Y,G.onmessage,S)},onerror:(t=G==null?void 0:G.onerror)!==null&&t!==void 0?t:function(S){},onclose:(s=G==null?void 0:G.onclose)!==null&&s!==void 0?s:function(S){}},H=this.webSocketFactory.create(_,Oz(x),K);H.connect(),await k;let U=dt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&U.startsWith("publishers/")){const S=this.apiClient.getProject(),L=this.apiClient.getLocation();U=`projects/${S}/locations/${L}/`+U}let z={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[pp.AUDIO]}:e.config.responseModalities=[pp.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const J=(u=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],P=[];for(const S of J)if(this.isCallableTool(S)){const L=S;P.push(await L.tool())}else P.push(S);P.length>0&&(e.config.tools=P);const C={model:U,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?z=eH(this.apiClient,C):z=Zq(this.apiClient,C),delete z.config,H.send(JSON.stringify(z)),new Uz(H,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Lz={turnComplete:!0};class Uz{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let s=[];try{s=Gs(t.turns),e.isVertexAI()||(s=s.map(i=>cg(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:s,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let s=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?s=t.functionResponses:s=[t.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const a of s){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(Mz)}return{toolResponse:{functionResponses:s}}}sendClientContent(e){e=Object.assign(Object.assign({},Lz),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:iH(e)}:t={realtimeInput:sH(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Oz(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function Fz(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hS=10;function fS(n){var e,t,s;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const l of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(_c(l)){i=!0;break}if(!i)return!0;const a=(s=n==null?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function _c(n){return"callTool"in n&&typeof n.callTool=="function"}function Bz(n){var e,t,s;return(s=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>_c(i)))!==null&&s!==void 0?s:!1}function mS(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((s,i)=>{if(_c(s))return;const a=s;a.functionDeclarations&&a.functionDeclarations.length>0&&t.push(i)}),t}function pS(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jz extends Mr{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var s,i,a,l,u;const f=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!Bz(t)||fS(t.config))return await this.generateContentInternal(f);const m=mS(t);if(m.length>0){const G=m.map(F=>`tools[${F}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${G}.`)}let _,T;const x=Gs(f.contents),b=(a=(i=(s=f.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&a!==void 0?a:hS;let k=0;for(;k<b&&(_=await this.generateContentInternal(f),!(!_.functionCalls||_.functionCalls.length===0));){const G=_.candidates[0].content,F=[];for(const Y of(u=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(_c(Y)){const H=await Y.callTool(_.functionCalls);F.push(...H)}k++,T={role:"user",parts:F},f.contents=Gs(f.contents),f.contents.push(G),f.contents.push(T),pS(f.config)&&(x.push(G),x.push(T))}return pS(f.config)&&(_.automaticFunctionCallingHistory=x),_},this.generateContentStream=async t=>{var s,i,a,l,u;if(this.maybeMoveToResponseJsonSchem(t),fS(t.config)){const T=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(T)}const f=mS(t);if(f.length>0){const T=f.map(x=>`tools[${x}]`).join(", ");throw new Error(`Incompatible tools found at ${T}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const m=(a=(i=(s=t==null?void 0:t.config)===null||s===void 0?void 0:s.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,_=(u=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(m&&!_)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(s=>{var i;let a;const l=[];if(s!=null&&s.generatedImages)for(const f of s.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((i=f==null?void 0:f.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?a=f==null?void 0:f.safetyAttributes:l.push(f);let u;return a?u={generatedImages:l,positivePromptSafetyAttributes:a,sdkHttpResponse:s.sdkHttpResponse}:u={generatedImages:l,sdkHttpResponse:s.sdkHttpResponse},u}),this.list=async t=>{var s;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((s=l.config)===null||s===void 0)&&s.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new ll(Ar.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async t=>{const s={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(s.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(s)},this.upscaleImage=async t=>{let s={numberOfImages:1,mode:"upscale"};t.config&&(s=Object.assign(Object.assign({},s),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:s};return await this.upscaleImageInternal(i)},this.generateVideos=async t=>{var s,i,a,l,u,f;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((s=t.video)===null||s===void 0)&&s.uri&&(!((i=t.video)===null||i===void 0)&&i.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(a=t.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.uri&&(!((f=(u=t.source)===null||u===void 0?void 0:u.video)===null||f===void 0)&&f.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,s,i;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const l=await Promise.all(a.map(async f=>_c(f)?await f.tool():f)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(u.config.tools=l,e.config&&e.config.tools&&ND(e.config.tools)){const f=(i=(s=e.config.httpOptions)===null||s===void 0?void 0:s.headers)!==null&&i!==void 0?i:{};let m=Object.assign({},f);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),SD(m),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:m})}return u}async initAfcToolsMap(e){var t,s,i;const a=new Map;for(const l of(s=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&s!==void 0?s:[])if(_c(l)){const u=l,f=await u.tool();for(const m of(i=f.functionDeclarations)!==null&&i!==void 0?i:[]){if(!m.name)throw new Error("Function declaration name is required.");if(a.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);a.set(m.name,u)}}return a}async processAfcStream(e){var t,s,i;const a=(i=(s=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&i!==void 0?i:hS;let l=!1,u=0;const f=await this.initAfcToolsMap(e);return(function(m,_,T){return yc(this,arguments,function*(){for(var x,b,k,G,F,Y;u<a;){l&&(u++,l=!1);const z=yield Pt(m.processParamsMaybeAddMcpUsage(T)),J=yield Pt(m.generateContentStreamInternal(z)),P=[],C=[];try{for(var K=!0,H=(b=void 0,Bd(J)),U;U=yield Pt(H.next()),x=U.done,!x;K=!0){G=U.value,K=!1;const S=G;if(yield yield Pt(S),S.candidates&&(!((F=S.candidates[0])===null||F===void 0)&&F.content)){C.push(S.candidates[0].content);for(const L of(Y=S.candidates[0].content.parts)!==null&&Y!==void 0?Y:[])if(u<a&&L.functionCall){if(!L.functionCall.name)throw new Error("Function call name was not returned by the model.");if(_.has(L.functionCall.name)){const V=yield Pt(_.get(L.functionCall.name).callTool([L.functionCall]));P.push(...V)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${_.keys()}, mising tool: ${L.functionCall.name}`)}}}}catch(S){b={error:S}}finally{try{!K&&!x&&(k=H.return)&&(yield Pt(k.call(H)))}finally{if(b)throw b.error}}if(P.length>0){l=!0;const S=new pd;S.candidates=[{content:{role:"user",parts:P}}],yield yield Pt(S);const L=[];L.push(...C),L.push({role:"user",parts:P});const V=Gs(T.contents).concat(L);T.contents=V}else break}})})(this,f,e)}async generateContentInternal(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=lS(this.apiClient,e);return u=Ae("{model}:generateContent",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=uS(_),x=new pd;return Object.assign(x,T),x})}else{const m=aS(this.apiClient,e);return u=Ae("{model}:generateContent",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=cS(_),x=new pd;return Object.assign(x,T),x})}}async generateContentStreamInternal(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=lS(this.apiClient,e);return u=Ae("{model}:streamGenerateContent?alt=sse",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.requestStream({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),l.then(function(T){return yc(this,arguments,function*(){var x,b,k,G;try{for(var F=!0,Y=Bd(T),K;K=yield Pt(Y.next()),x=K.done,!x;F=!0){G=K.value,F=!1;const H=G,U=uS(yield Pt(H.json()));U.sdkHttpResponse={headers:H.headers};const z=new pd;Object.assign(z,U),yield yield Pt(z)}}catch(H){b={error:H}}finally{try{!F&&!x&&(k=Y.return)&&(yield Pt(k.call(Y)))}finally{if(b)throw b.error}}})})}else{const m=aS(this.apiClient,e);return u=Ae("{model}:streamGenerateContent?alt=sse",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.requestStream({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(T){return yc(this,arguments,function*(){var x,b,k,G;try{for(var F=!0,Y=Bd(T),K;K=yield Pt(Y.next()),x=K.done,!x;F=!0){G=K.value,F=!1;const H=G,U=cS(yield Pt(H.json()));U.sdkHttpResponse={headers:H.headers};const z=new pd;Object.assign(z,U),yield yield Pt(z)}}catch(H){b={error:H}}finally{try{!F&&!x&&(k=Y.return)&&(yield Pt(k.call(Y)))}finally{if(b)throw b.error}}})})}}async embedContent(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=VH(this.apiClient,e);return u=Ae("{model}:predict",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=UH(_),x=new HN;return Object.assign(x,T),x})}else{const m=kH(this.apiClient,e);return u=Ae("{model}:batchEmbedContents",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=LH(_),x=new HN;return Object.assign(x,T),x})}}async generateImagesInternal(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=KH(this.apiClient,e);return u=Ae("{model}:predict",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=QH(_),x=new zN;return Object.assign(x,T),x})}else{const m=YH(this.apiClient,e);return u=Ae("{model}:predict",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=JH(_),x=new zN;return Object.assign(x,T),x})}}async editImageInternal(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=RH(this.apiClient,e);return a=Ae("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),i.then(f=>{const m=PH(f),_=new Fj;return Object.assign(_,m),_})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=K9(this.apiClient,e);return a=Ae("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),i.then(f=>{const m=J9(f),_=new Bj;return Object.assign(_,m),_})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=C9(this.apiClient,e);return a=Ae("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>{const m=R9(f),_=new jj;return Object.assign(_,m),_})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=L9(this.apiClient,e);return a=Ae("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>{const m=U9(f),_=new Gj;return Object.assign(_,m),_})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=f9(this.apiClient,e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),l.then(_=>jv(_))}else{const m=h9(this.apiClient,e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Bv(_))}}async listInternal(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=x9(this.apiClient,e);return u=Ae("{models_url}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=b9(_),x=new $N;return Object.assign(x,T),x})}else{const m=T9(this.apiClient,e);return u=Ae("{models_url}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=I9(_),x=new $N;return Object.assign(x,T),x})}}async update(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=$9(this.apiClient,e);return u=Ae("{model}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),l.then(_=>jv(_))}else{const m=z9(this.apiClient,e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Bv(_))}}async delete(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=wH(this.apiClient,e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=SH(_),x=new YN;return Object.assign(x,T),x})}else{const m=AH(this.apiClient,e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=NH(_),x=new YN;return Object.assign(x,T),x})}}async countTokens(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=xH(this.apiClient,e);return u=Ae("{model}:countTokens",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=bH(_),x=new KN;return Object.assign(x,T),x})}else{const m=TH(this.apiClient,e);return u=Ae("{model}:countTokens",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=IH(_),x=new KN;return Object.assign(x,T),x})}}async computeTokens(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=mH(this.apiClient,e);return a=Ae("{model}:computeTokens",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),i.then(f=>{const m=pH(f),_=new qj;return Object.assign(_,m),_})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=n9(this.apiClient,e);return u=Ae("{model}:predictLongRunning",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),l.then(_=>{const T=e9(_),x=new gp;return Object.assign(x,T),x})}else{const m=t9(this.apiClient,e);return u=Ae("{model}:predictLongRunning",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>{const T=ZH(_),x=new gp;return Object.assign(x,T),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gz extends Mr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,s=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let a;s&&"httpOptions"in s&&(a=s.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:s});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const t=e.operation,s=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let a;s&&"httpOptions"in s&&(a=s.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:s});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=Mj(e);return u=Ae("{operationName}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),l}else{const m=Dj(e);return u=Ae("{operationName}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l}}async fetchPredictVideosOperationInternal(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=Aj(e);return a=Ae("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qz(n){const e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function Hz(n){const e={},t=p(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>Zz(a))),g(e,["parts"],i)}const s=p(n,["role"]);return s!=null&&g(e,["role"],s),e}function zz(n,e,t){const s={},i=p(e,["expireTime"]);t!==void 0&&i!=null&&g(t,["expireTime"],i);const a=p(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&g(t,["newSessionExpireTime"],a);const l=p(e,["uses"]);t!==void 0&&l!=null&&g(t,["uses"],l);const u=p(e,["liveConnectConstraints"]);t!==void 0&&u!=null&&g(t,["bidiGenerateContentSetup"],Xz(n,u));const f=p(e,["lockAdditionalFields"]);return t!==void 0&&f!=null&&g(t,["fieldMask"],f),s}function $z(n,e){const t={},s=p(e,["config"]);return s!=null&&g(t,["config"],zz(n,s,t)),t}function Yz(n){const e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=p(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function Kz(n){const e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);const s=p(n,["args"]);s!=null&&g(e,["args"],s);const i=p(n,["name"]);if(i!=null&&g(e,["name"],i),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Jz(n){const e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function Qz(n){const e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function Wz(n,e){const t={},s=p(n,["generationConfig"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig"],s);const i=p(n,["responseModalities"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig","responseModalities"],i);const a=p(n,["temperature"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","temperature"],a);const l=p(n,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);const f=p(n,["maxOutputTokens"]);e!==void 0&&f!=null&&g(e,["setup","generationConfig","maxOutputTokens"],f);const m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);const _=p(n,["seed"]);e!==void 0&&_!=null&&g(e,["setup","generationConfig","seed"],_);const T=p(n,["speechConfig"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","speechConfig"],HE(T));const x=p(n,["thinkingConfig"]);e!==void 0&&x!=null&&g(e,["setup","generationConfig","thinkingConfig"],x);const b=p(n,["enableAffectiveDialog"]);e!==void 0&&b!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],b);const k=p(n,["systemInstruction"]);e!==void 0&&k!=null&&g(e,["setup","systemInstruction"],Hz(qn(k)));const G=p(n,["tools"]);if(e!==void 0&&G!=null){let J=nu(G);Array.isArray(J)&&(J=J.map(P=>t8(tu(P)))),g(e,["setup","tools"],J)}const F=p(n,["sessionResumption"]);e!==void 0&&F!=null&&g(e,["setup","sessionResumption"],e8(F));const Y=p(n,["inputAudioTranscription"]);e!==void 0&&Y!=null&&g(e,["setup","inputAudioTranscription"],Y);const K=p(n,["outputAudioTranscription"]);e!==void 0&&K!=null&&g(e,["setup","outputAudioTranscription"],K);const H=p(n,["realtimeInputConfig"]);e!==void 0&&H!=null&&g(e,["setup","realtimeInputConfig"],H);const U=p(n,["contextWindowCompression"]);e!==void 0&&U!=null&&g(e,["setup","contextWindowCompression"],U);const z=p(n,["proactivity"]);return e!==void 0&&z!=null&&g(e,["setup","proactivity"],z),t}function Xz(n,e){const t={},s=p(e,["model"]);s!=null&&g(t,["setup","model"],dt(n,s));const i=p(e,["config"]);return i!=null&&g(t,["config"],Wz(i,t)),t}function Zz(n){const e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const s=p(n,["codeExecutionResult"]);s!=null&&g(e,["codeExecutionResult"],s);const i=p(n,["executableCode"]);i!=null&&g(e,["executableCode"],i);const a=p(n,["fileData"]);a!=null&&g(e,["fileData"],Yz(a));const l=p(n,["functionCall"]);l!=null&&g(e,["functionCall"],Kz(l));const u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);const f=p(n,["inlineData"]);f!=null&&g(e,["inlineData"],qz(f));const m=p(n,["text"]);m!=null&&g(e,["text"],m);const _=p(n,["thought"]);_!=null&&g(e,["thought"],_);const T=p(n,["thoughtSignature"]);T!=null&&g(e,["thoughtSignature"],T);const x=p(n,["videoMetadata"]);return x!=null&&g(e,["videoMetadata"],x),e}function e8(n){const e={},t=p(n,["handle"]);if(t!=null&&g(e,["handle"],t),p(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function t8(n){const e={},t=p(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(T=>T)),g(e,["functionDeclarations"],_)}if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=p(n,["googleSearchRetrieval"]);s!=null&&g(e,["googleSearchRetrieval"],s);const i=p(n,["computerUse"]);i!=null&&g(e,["computerUse"],i);const a=p(n,["fileSearch"]);a!=null&&g(e,["fileSearch"],a);const l=p(n,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],Jz(u));const f=p(n,["googleSearch"]);f!=null&&g(e,["googleSearch"],Qz(f));const m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n8(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const s=n[t];if(typeof s=="object"&&s!=null&&Object.keys(s).length>0){const i=Object.keys(s).map(a=>`${t}.${a}`);e.push(...i)}else e.push(t)}return e.join(",")}function s8(n,e){let t=null;const s=n.bidiGenerateContentSetup;if(typeof s=="object"&&s!==null&&"setup"in s){const a=s.setup;typeof a=="object"&&a!==null?(n.bidiGenerateContentSetup=a,t=a):delete n.bidiGenerateContentSetup}else s!==void 0&&delete n.bidiGenerateContentSetup;const i=n.fieldMask;if(t){const a=n8(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?n.fieldMask=a:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];i.length>0&&(u=i.map(m=>l.includes(m)?`generationConfig.${m}`:m));const f=[];a&&f.push(a),u.length>0&&f.push(...u),f.length>0?n.fieldMask=f.join(","):delete n.fieldMask}else delete n.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?n.fieldMask=i.join(","):delete n.fieldMask;return n}class i8 extends Mr{constructor(e){super(),this.apiClient=e}async create(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=$z(this.apiClient,e);a=Ae("auth_tokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query;const f=s8(u,e.config);return i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),i.then(m=>m)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function r8(n,e){const t={},s=p(n,["force"]);return e!==void 0&&s!=null&&g(e,["_query","force"],s),t}function o8(n){const e={},t=p(n,["name"]);t!=null&&g(e,["_url","name"],t);const s=p(n,["config"]);return s!=null&&r8(s,e),e}function a8(n){const e={},t=p(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function l8(n,e){const t={},s=p(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const i=p(n,["pageToken"]);return e!==void 0&&i!=null&&g(e,["_query","pageToken"],i),t}function c8(n){const e={},t=p(n,["parent"]);t!=null&&g(e,["_url","parent"],t);const s=p(n,["config"]);return s!=null&&l8(s,e),e}function u8(n){const e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=p(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const i=p(n,["documents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),g(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class d8 extends Mr{constructor(e){super(),this.apiClient=e,this.list=async t=>new ll(Ar.PAGED_ITEM_DOCUMENTS,s=>this.listInternal({parent:t.parent,config:s.config}),await this.listInternal(t),t)}async get(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=a8(e);return a=Ae("{name}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>f)}}async delete(e){var t,s;let i="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=o8(e);i=Ae("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=c8(e);return a=Ae("{parent}/documents",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>{const m=u8(f),_=new Hj;return Object.assign(_,m),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class h8 extends Mr{constructor(e,t=new d8(e)){super(),this.apiClient=e,this.documents=t,this.list=async(s={})=>new ll(Ar.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(s),s)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=nz(e);return a=Ae("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>f)}}async get(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=rz(e);return a=Ae("{name}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>f)}}async delete(e){var t,s;let i="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=iz(e);i=Ae("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=dz(e);return a=Ae("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>{const m=hz(f),_=new zj;return Object.assign(_,m),_})}}async uploadToFileSearchStoreInternal(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=fz(e);return a=Ae("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>{const m=mz(f),_=new $j;return Object.assign(_,m),_})}}async importFile(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=lz(e);return a=Ae("{file_search_store_name}:importFile",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>{const m=az(f),_=new FE;return Object.assign(_,m),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f8(n,e){const t={},s=p(n,["name"]);return s!=null&&g(t,["_url","name"],s),t}function m8(n,e){const t={},s=p(n,["name"]);return s!=null&&g(t,["_url","name"],s),t}function p8(n,e){const t={},s=p(n,["sdkHttpResponse"]);return s!=null&&g(t,["sdkHttpResponse"],s),t}function g8(n,e){const t={},s=p(n,["sdkHttpResponse"]);return s!=null&&g(t,["sdkHttpResponse"],s),t}function y8(n,e,t){const s={};if(p(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=p(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&g(e,["displayName"],i),p(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=p(n,["epochCount"]);e!==void 0&&a!=null&&g(e,["tuningTask","hyperparameters","epochCount"],a);const l=p(n,["learningRateMultiplier"]);if(l!=null&&g(s,["tuningTask","hyperparameters","learningRateMultiplier"],l),p(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(p(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(p(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=p(n,["batchSize"]);e!==void 0&&u!=null&&g(e,["tuningTask","hyperparameters","batchSize"],u);const f=p(n,["learningRate"]);if(e!==void 0&&f!=null&&g(e,["tuningTask","hyperparameters","learningRate"],f),p(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(p(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return s}function _8(n,e,t){const s={};let i=p(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const b=p(n,["validationDataset"]);e!==void 0&&b!=null&&g(e,["supervisedTuningSpec"],gS(b))}else if(i==="PREFERENCE_TUNING"){const b=p(n,["validationDataset"]);e!==void 0&&b!=null&&g(e,["preferenceOptimizationSpec"],gS(b))}const a=p(n,["tunedModelDisplayName"]);e!==void 0&&a!=null&&g(e,["tunedModelDisplayName"],a);const l=p(n,["description"]);e!==void 0&&l!=null&&g(e,["description"],l);let u=p(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const b=p(n,["epochCount"]);e!==void 0&&b!=null&&g(e,["supervisedTuningSpec","hyperParameters","epochCount"],b)}else if(u==="PREFERENCE_TUNING"){const b=p(n,["epochCount"]);e!==void 0&&b!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],b)}let f=p(t,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const b=p(n,["learningRateMultiplier"]);e!==void 0&&b!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],b)}else if(f==="PREFERENCE_TUNING"){const b=p(n,["learningRateMultiplier"]);e!==void 0&&b!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],b)}let m=p(t,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const b=p(n,["exportLastCheckpointOnly"]);e!==void 0&&b!=null&&g(e,["supervisedTuningSpec","exportLastCheckpointOnly"],b)}else if(m==="PREFERENCE_TUNING"){const b=p(n,["exportLastCheckpointOnly"]);e!==void 0&&b!=null&&g(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],b)}let _=p(t,["config","method"]);if(_===void 0&&(_="SUPERVISED_FINE_TUNING"),_==="SUPERVISED_FINE_TUNING"){const b=p(n,["adapterSize"]);e!==void 0&&b!=null&&g(e,["supervisedTuningSpec","hyperParameters","adapterSize"],b)}else if(_==="PREFERENCE_TUNING"){const b=p(n,["adapterSize"]);e!==void 0&&b!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],b)}if(p(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(p(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const T=p(n,["labels"]);e!==void 0&&T!=null&&g(e,["labels"],T);const x=p(n,["beta"]);return e!==void 0&&x!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","beta"],x),s}function v8(n,e){const t={},s=p(n,["baseModel"]);s!=null&&g(t,["baseModel"],s);const i=p(n,["preTunedModel"]);i!=null&&g(t,["preTunedModel"],i);const a=p(n,["trainingDataset"]);a!=null&&R8(a);const l=p(n,["config"]);return l!=null&&y8(l,t),t}function E8(n,e){const t={},s=p(n,["baseModel"]);s!=null&&g(t,["baseModel"],s);const i=p(n,["preTunedModel"]);i!=null&&g(t,["preTunedModel"],i);const a=p(n,["trainingDataset"]);a!=null&&P8(a,t,e);const l=p(n,["config"]);return l!=null&&_8(l,t,e),t}function T8(n,e){const t={},s=p(n,["name"]);return s!=null&&g(t,["_url","name"],s),t}function x8(n,e){const t={},s=p(n,["name"]);return s!=null&&g(t,["_url","name"],s),t}function I8(n,e,t){const s={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const a=p(n,["pageToken"]);e!==void 0&&a!=null&&g(e,["_query","pageToken"],a);const l=p(n,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),s}function b8(n,e,t){const s={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const a=p(n,["pageToken"]);e!==void 0&&a!=null&&g(e,["_query","pageToken"],a);const l=p(n,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),s}function A8(n,e){const t={},s=p(n,["config"]);return s!=null&&I8(s,t),t}function w8(n,e){const t={},s=p(n,["config"]);return s!=null&&b8(s,t),t}function N8(n,e){const t={},s=p(n,["sdkHttpResponse"]);s!=null&&g(t,["sdkHttpResponse"],s);const i=p(n,["nextPageToken"]);i!=null&&g(t,["nextPageToken"],i);const a=p(n,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>CD(u))),g(t,["tuningJobs"],l)}return t}function S8(n,e){const t={},s=p(n,["sdkHttpResponse"]);s!=null&&g(t,["sdkHttpResponse"],s);const i=p(n,["nextPageToken"]);i!=null&&g(t,["nextPageToken"],i);const a=p(n,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>qv(u))),g(t,["tuningJobs"],l)}return t}function C8(n,e){const t={},s=p(n,["name"]);s!=null&&g(t,["model"],s);const i=p(n,["name"]);return i!=null&&g(t,["endpoint"],i),t}function R8(n,e){const t={};if(p(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const s=p(n,["examples"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>a)),g(t,["examples","examples"],i)}return t}function P8(n,e,t){const s={};let i=p(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const l=p(n,["gcsUri"]);e!==void 0&&l!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(i==="PREFERENCE_TUNING"){const l=p(n,["gcsUri"]);e!==void 0&&l!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let a=p(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=p(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=p(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(p(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return s}function CD(n,e){const t={},s=p(n,["sdkHttpResponse"]);s!=null&&g(t,["sdkHttpResponse"],s);const i=p(n,["name"]);i!=null&&g(t,["name"],i);const a=p(n,["state"]);a!=null&&g(t,["state"],cD(a));const l=p(n,["createTime"]);l!=null&&g(t,["createTime"],l);const u=p(n,["tuningTask","startTime"]);u!=null&&g(t,["startTime"],u);const f=p(n,["tuningTask","completeTime"]);f!=null&&g(t,["endTime"],f);const m=p(n,["updateTime"]);m!=null&&g(t,["updateTime"],m);const _=p(n,["description"]);_!=null&&g(t,["description"],_);const T=p(n,["baseModel"]);T!=null&&g(t,["baseModel"],T);const x=p(n,["_self"]);return x!=null&&g(t,["tunedModel"],C8(x)),t}function qv(n,e){const t={},s=p(n,["sdkHttpResponse"]);s!=null&&g(t,["sdkHttpResponse"],s);const i=p(n,["name"]);i!=null&&g(t,["name"],i);const a=p(n,["state"]);a!=null&&g(t,["state"],cD(a));const l=p(n,["createTime"]);l!=null&&g(t,["createTime"],l);const u=p(n,["startTime"]);u!=null&&g(t,["startTime"],u);const f=p(n,["endTime"]);f!=null&&g(t,["endTime"],f);const m=p(n,["updateTime"]);m!=null&&g(t,["updateTime"],m);const _=p(n,["error"]);_!=null&&g(t,["error"],_);const T=p(n,["description"]);T!=null&&g(t,["description"],T);const x=p(n,["baseModel"]);x!=null&&g(t,["baseModel"],x);const b=p(n,["tunedModel"]);b!=null&&g(t,["tunedModel"],b);const k=p(n,["preTunedModel"]);k!=null&&g(t,["preTunedModel"],k);const G=p(n,["supervisedTuningSpec"]);G!=null&&g(t,["supervisedTuningSpec"],G);const F=p(n,["preferenceOptimizationSpec"]);F!=null&&g(t,["preferenceOptimizationSpec"],F);const Y=p(n,["tuningDataStats"]);Y!=null&&g(t,["tuningDataStats"],Y);const K=p(n,["encryptionSpec"]);K!=null&&g(t,["encryptionSpec"],K);const H=p(n,["partnerModelTuningSpec"]);H!=null&&g(t,["partnerModelTuningSpec"],H);const U=p(n,["customBaseModel"]);U!=null&&g(t,["customBaseModel"],U);const z=p(n,["experiment"]);z!=null&&g(t,["experiment"],z);const J=p(n,["labels"]);J!=null&&g(t,["labels"],J);const P=p(n,["outputUri"]);P!=null&&g(t,["outputUri"],P);const C=p(n,["pipelineJob"]);C!=null&&g(t,["pipelineJob"],C);const S=p(n,["serviceAccount"]);S!=null&&g(t,["serviceAccount"],S);const L=p(n,["tunedModelDisplayName"]);L!=null&&g(t,["tunedModelDisplayName"],L);const V=p(n,["veoTuningSpec"]);return V!=null&&g(t,["veoTuningSpec"],V),t}function D8(n,e){const t={},s=p(n,["sdkHttpResponse"]);s!=null&&g(t,["sdkHttpResponse"],s);const i=p(n,["name"]);i!=null&&g(t,["name"],i);const a=p(n,["metadata"]);a!=null&&g(t,["metadata"],a);const l=p(n,["done"]);l!=null&&g(t,["done"],l);const u=p(n,["error"]);return u!=null&&g(t,["error"],u),t}function gS(n,e){const t={},s=p(n,["gcsUri"]);s!=null&&g(t,["validationDatasetUri"],s);const i=p(n,["vertexDatasetResource"]);return i!=null&&g(t,["validationDatasetUri"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class M8 extends Mr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ll(Ar.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var s;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const i={tunedModelName:t.baseModel};!((s=t.config)===null||s===void 0)&&s.preTunedModelCheckpointId&&(i.checkpointId=t.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},t),{preTunedModel:i});return a.baseModel=void 0,await this.tuneInternal(a)}else{const i=Object.assign({},t);return await this.tuneInternal(i)}else{const i=Object.assign({},t),a=await this.tuneMldevInternal(i);let l="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?l=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(l=a.name.split("/operations/")[0]),{name:l,state:Lv.JOB_STATE_QUEUED}}}}async getInternal(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=x8(e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>qv(_))}else{const m=T8(e);return u=Ae("{name}",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>CD(_))}}async listInternal(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=w8(e);return u=Ae("tuningJobs",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=S8(_),x=new JN;return Object.assign(x,T),x})}else{const m=A8(e);return u=Ae("tunedModels",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=N8(_),x=new JN;return Object.assign(x,T),x})}}async cancel(e){var t,s,i,a;let l,u="",f={};if(this.apiClient.isVertexAI()){const m=m8(e);return u=Ae("{name}:cancel",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=g8(_),x=new QN;return Object.assign(x,T),x})}else{const m=f8(e);return u=Ae("{name}:cancel",m._url),f=m._query,delete m._url,delete m._query,l=this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:_.headers},x})),l.then(_=>{const T=p8(_),x=new QN;return Object.assign(x,T),x})}}async tuneInternal(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=E8(e,e);return a=Ae("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),i.then(f=>qv(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,s;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=v8(e);return a=Ae("tunedModels",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),i.then(f=>D8(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class k8{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const V8=1024*1024*8,L8=3,U8=1e3,O8=2,_p="x-goog-upload-status";async function F8(n,e,t){var s;const i=await RD(n,e,t),a=await(i==null?void 0:i.json());if(((s=i==null?void 0:i.headers)===null||s===void 0?void 0:s[_p])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function B8(n,e,t){var s;const i=await RD(n,e,t),a=await(i==null?void 0:i.json());if(((s=i==null?void 0:i.headers)===null||s===void 0?void 0:s[_p])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=sD(a),u=new BE;return Object.assign(u,l),u}async function RD(n,e,t){var s,i;let a=0,l=0,u=new Uv(new Response),f="upload";for(a=n.size;l<a;){const m=Math.min(V8,a-l),_=n.slice(l,l+m);l+m>=a&&(f+=", finalize");let T=0,x=U8;for(;T<L8&&(u=await t.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(l),"Content-Length":String(m)}}}),!(!((s=u==null?void 0:u.headers)===null||s===void 0)&&s[_p]));)T++,await G8(x),x=x*O8;if(l+=m,((i=u==null?void 0:u.headers)===null||i===void 0?void 0:i[_p])!=="active")break;if(a<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function j8(n){return{size:n.size,type:n.type}}function G8(n){return new Promise(e=>setTimeout(e,n))}class q8{async upload(e,t,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await F8(e,t,s)}async uploadToFileSearchStore(e,t,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await B8(e,t,s)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await j8(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class H8{create(e,t,s){return new z8(e,t,s)}}class z8{constructor(e,t,s){this.url=e,this.headers=t,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yS="x-goog-api-key";class $8{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(yS)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(yS,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Y8="gl-node/";class K8{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const s=Ij(e.httpOptions,e.vertexai,void 0,void 0);s&&(e.httpOptions?e.httpOptions.baseUrl=s:e.httpOptions={baseUrl:s}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new $8(this.apiKey);this.apiClient=new xz({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:Y8+"web",uploader:new q8,downloader:new k8}),this.models=new jz(this.apiClient),this.live=new Vz(this.apiClient,i,new H8),this.batches=new XG(this.apiClient),this.chats=new Mq(this.models,this.apiClient),this.caches=new Rq(this.apiClient),this.files=new qq(this.apiClient),this.operations=new Gz(this.apiClient),this.authTokens=new i8(this.apiClient),this.tunings=new M8(this.apiClient),this.fileSearchStores=new h8(this.apiClient)}}/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J8=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Q8=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),_S=n=>{const e=Q8(n);return e.charAt(0).toUpperCase()+e.slice(1)},PD=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim(),W8=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var X8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z8=le.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:i="",children:a,iconNode:l,...u},f)=>le.createElement("svg",{ref:f,...X8,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:PD("lucide",i),...!a&&!W8(u)&&{"aria-hidden":"true"},...u},[...l.map(([m,_])=>le.createElement(m,_)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=(n,e)=>{const t=le.forwardRef(({className:s,...i},a)=>le.createElement(Z8,{ref:a,iconNode:e,className:PD(`lucide-${J8(_S(n))}`,`lucide-${n}`,s),...i}));return t.displayName=_S(n),t};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e7=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],$E=Fe("activity",e7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t7=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],n7=Fe("arrow-down-right",t7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s7=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],DD=Fe("arrow-right",s7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i7=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],r7=Fe("arrow-up-right",i7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o7=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],MD=Fe("bell",o7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a7=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],l7=Fe("calendar-clock",a7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c7=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],u7=Fe("calendar",c7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d7=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],h7=Fe("chart-column",d7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f7=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],YE=Fe("check",f7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m7=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],p7=Fe("chevron-down",m7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],KE=Fe("circle-alert",g7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],oi=Fe("circle-check",y7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],hh=Fe("circle-x",_7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v7=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],JE=Fe("clipboard-list",v7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E7=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],T7=Fe("clock",E7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x7=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],I7=Fe("credit-card",x7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b7=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],A7=Fe("database",b7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w7=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Bo=Fe("dollar-sign",w7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N7=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],S7=Fe("download",N7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C7=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],R7=Fe("eye",C7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]],QE=Fe("file-chart-column-increasing",P7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],hg=Fe("file-check",D7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],kD=Fe("file-spreadsheet",M7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],fg=Fe("file-text",k7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V7=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],L7=Fe("flask-conical",V7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],VD=Fe("info",U7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O7=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],mg=Fe("layout-dashboard",O7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F7=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Hv=Fe("list",F7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B7=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],nl=Fe("loader-circle",B7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j7=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],G7=Fe("log-out",j7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q7=[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]],pg=Fe("microscope",q7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H7=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Er=Fe("package",H7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z7=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],$7=Fe("pen",z7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y7=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],vS=Fe("phone",Y7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K7=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],yr=Fe("plus",K7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J7=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Oh=Fe("printer",J7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q7=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],W7=Fe("qr-code",Q7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X7=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Z7=Fe("save",X7);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e$=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],jd=Fe("search",e$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t$=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],jm=Fe("settings",t$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n$=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],LD=Fe("shield",n$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s$=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],i$=Fe("sparkles",s$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r$=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],gg=Fe("syringe",r$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o$=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Gd=Fe("trash-2",o$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a$=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],l$=Fe("trending-up",a$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c$=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],fh=Fe("triangle-alert",c$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u$=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],qd=Fe("truck",u$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d$=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],yg=Fe("user-plus",d$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h$=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],f$=Fe("user",h$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m$=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],WE=Fe("users",m$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p$=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],UD=Fe("wallet",p$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g$=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Fh=Fe("x",g$);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y$=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],_$=Fe("zap",y$),Mn=n=>{if(!n)return"--";try{return n.toDate?n.toDate().toLocaleString():n instanceof Date?n.toLocaleString():new Date(n).toLocaleString()}catch{return"--"}},OD=n=>{if(!n)return"--:--";try{return(n.toDate?n.toDate():new Date(n)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"--:--"}},vp=n=>{if(!n)return 0;const e=new Date(n),t=Date.now()-e.getTime(),s=new Date(t);return Math.abs(s.getUTCFullYear()-1970)},w={RICH_BLACK:"#F0F9FF",MIDNIGHT_GREEN:"#FFFFFF",PERSIAN_GREEN:"#0EA5E9",GAMBOGE:"#0EA5E9",ALLOY_ORANGE:"#06B6D4",CITRON:"#0F172A",TIFFANY_BLUE:"#334155",RUST:"#EF4444"},v$=({activeTab:n,onNavigate:e,user:t,onLogout:s})=>{const i=[{id:"dashboard",label:"Dashboard",icon:mg},{id:"reception",label:"Reception",icon:JE},{id:"phlebotomy",label:"Phlebotomy",icon:gg},{id:"lab-tech",label:"Technician",icon:pg},{id:"pathologist",label:"Pathologist",icon:hg},{id:"admin",label:"Admin",icon:jm}];return d.jsxs("div",{className:"w-full h-16 flex items-center justify-between px-6 shadow-md z-50 shrink-0",style:{backgroundColor:w.RICH_BLACK,borderBottom:`1px solid ${w.MIDNIGHT_GREEN}`},children:[d.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>e("dashboard"),children:[d.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center shadow-lg transform transition-transform hover:scale-105",style:{backgroundColor:w.PERSIAN_GREEN},children:d.jsx($E,{className:"w-6 h-6 text-white"})}),d.jsxs("div",{children:[d.jsxs("h1",{className:"text-xl font-bold tracking-tight",style:{color:w.TIFFANY_BLUE},children:["LabPro ",d.jsx("span",{style:{color:w.GAMBOGE},children:"Plus"})]}),d.jsx("p",{className:"text-[10px] uppercase tracking-widest font-bold opacity-60",style:{color:w.CITRON},children:"Diagnostic OS"})]})]}),d.jsx("div",{className:"flex items-center gap-2 p-1.5 rounded-full border backdrop-blur-sm",style:{backgroundColor:`${w.MIDNIGHT_GREEN}`,borderColor:`${w.PERSIAN_GREEN}40`},children:i.map(a=>{const l=n===a.id;return d.jsxs("button",{onClick:()=>e(a.id),className:`px-4 py-2 rounded-full flex items-center gap-2 text-sm font-bold transition-all duration-300 ${l?"shadow-md transform scale-105":""}`,style:{backgroundColor:l?w.PERSIAN_GREEN:"transparent",color:l?"#fff":w.TIFFANY_BLUE},onMouseEnter:u=>{l||(u.currentTarget.style.backgroundColor=`${w.PERSIAN_GREEN}15`)},onMouseLeave:u=>{l||(u.currentTarget.style.backgroundColor="transparent")},children:[d.jsx(a.icon,{className:`w-4 h-4 ${l?"animate-pulse":""}`}),d.jsx("span",{className:"hidden xl:inline",children:a.label})]},a.id)})}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"text-right hidden sm:block",children:[d.jsx("p",{className:"text-sm font-bold truncate max-w-[150px]",style:{color:w.CITRON},children:t==null?void 0:t.email}),d.jsx("p",{className:"text-xs opacity-70",style:{color:w.TIFFANY_BLUE},children:(t==null?void 0:t.role)||"Staff"})]}),d.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-red-500/20 transition-colors group",title:"Logout",children:d.jsx(G7,{className:"w-5 h-5 group-hover:text-red-400",style:{color:w.RUST}})})]})]})},E$=({toasts:n,onClose:e})=>d.jsx("div",{className:"fixed top-4 right-4 z-[9999] space-y-2",children:n.map(t=>{const s={success:d.jsx(oi,{className:"w-5 h-5"}),error:d.jsx(hh,{className:"w-5 h-5"}),warning:d.jsx(fh,{className:"w-5 h-5"}),info:d.jsx(VD,{className:"w-5 h-5"})},i={success:"bg-emerald-50 border-emerald-200 text-emerald-800",error:"bg-red-50 border-red-200 text-red-800",warning:"bg-amber-50 border-amber-200 text-amber-800",info:"bg-sky-50 border-sky-200 text-sky-800"};return d.jsxs("div",{className:`${i[t.type]} border rounded-lg shadow-lg p-4 min-w-[300px] max-w-md animate-in slide-in-from-right-5 flex items-start gap-3`,children:[s[t.type],d.jsx("p",{className:"flex-1 text-sm font-medium",children:t.message}),d.jsx("button",{onClick:()=>e(t.id),className:"hover:opacity-70",children:d.jsx(Fh,{className:"w-4 h-4"})})]},t.id)})}),T$=({isOpen:n,type:e,title:t,message:s,onClose:i})=>{if(!n)return null;const a={success:{icon:oi,color:"text-emerald-600",bg:"bg-emerald-50",border:"border-emerald-200"},error:{icon:hh,color:"text-red-600",bg:"bg-red-50",border:"border-red-200"},warning:{icon:fh,color:"text-amber-600",bg:"bg-amber-50",border:"border-amber-200"},info:{icon:VD,color:"text-sky-600",bg:"bg-sky-50",border:"border-sky-200"}},l=a[e]||a.info,u=l.icon;return d.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9998] flex items-center justify-center p-4 animate-in fade-in",onClick:i,children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full animate-in zoom-in-95",onClick:f=>f.stopPropagation(),children:[d.jsxs("div",{className:`${l.bg} ${l.border} border-b p-4 rounded-t-xl flex items-center gap-3`,children:[d.jsx(u,{className:`w-6 h-6 ${l.color}`}),d.jsx("h3",{className:"font-bold text-lg text-slate-800",children:t||e.charAt(0).toUpperCase()+e.slice(1)})]}),d.jsx("div",{className:"p-6",children:d.jsx("p",{className:"text-slate-700 leading-relaxed",children:s})}),d.jsx("div",{className:"p-4 bg-slate-50 rounded-b-xl flex justify-end",children:d.jsx("button",{onClick:i,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 transition-colors",children:"OK"})})]})})},x$=({isOpen:n,title:e,message:t,confirmText:s="Confirm",cancelText:i="Cancel",type:a="primary",onConfirm:l,onCancel:u})=>{if(!n)return null;const f={danger:"bg-red-600 hover:bg-red-700",primary:"bg-indigo-600 hover:bg-indigo-700",warning:"bg-amber-600 hover:bg-amber-700"};return d.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9998] flex items-center justify-center p-4 animate-in fade-in",onClick:u,children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full animate-in zoom-in-95",onClick:m=>m.stopPropagation(),children:[d.jsxs("div",{className:"p-6",children:[e&&d.jsx("h3",{className:"font-bold text-xl text-slate-800 mb-4",children:e}),d.jsx("p",{className:"text-slate-700 leading-relaxed",children:t})]}),d.jsxs("div",{className:"p-4 bg-slate-50 rounded-b-xl flex justify-end gap-3",children:[d.jsx("button",{onClick:u,className:"px-6 py-2 text-slate-600 hover:bg-slate-200 rounded-lg font-bold transition-colors",children:i}),d.jsx("button",{onClick:l,className:`px-6 py-2 ${f[a]} text-white rounded-lg font-bold transition-colors`,children:s})]})]})})},I$=({isOpen:n,title:e,message:t,defaultValue:s="",placeholder:i,onConfirm:a,onCancel:l})=>{const[u,f]=le.useState(s);if(le.useEffect(()=>{n&&f(s)},[n,s]),!n)return null;const m=()=>{u.trim()&&(a(u),f(""))};return d.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9998] flex items-center justify-center p-4 animate-in fade-in",onClick:l,children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full animate-in zoom-in-95",onClick:_=>_.stopPropagation(),children:[d.jsxs("div",{className:"p-6",children:[e&&d.jsx("h3",{className:"font-bold text-xl text-slate-800 mb-4",children:e}),d.jsx("p",{className:"text-slate-700 leading-relaxed mb-4",children:t}),d.jsx("input",{type:"text",value:u,onChange:_=>f(_.target.value),onKeyDown:_=>_.key==="Enter"&&m(),placeholder:i,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none",autoFocus:!0})]}),d.jsxs("div",{className:"p-4 bg-slate-50 rounded-b-xl flex justify-end gap-3",children:[d.jsx("button",{onClick:l,className:"px-6 py-2 text-slate-600 hover:bg-slate-200 rounded-lg font-bold transition-colors",children:"Cancel"}),d.jsx("button",{onClick:m,disabled:!u.trim(),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"OK"})]})]})})},q_={admin:["dashboard","admin_users","admin_tests","finance","admin_reports","inventory","admin_logs","admin_settings","reception","collection","lab_tech","lab_path"],receptionist:["dashboard","patients","reception"],phlebotomist:["dashboard","patients","collection"],technician:["dashboard","lab_tech"],pathologist:["dashboard","lab_path","patients","admin_reports"],accountant:["dashboard","finance"],inventory_manager:["dashboard","inventory","admin_reports"]},b$=["Test Reagent","Consumable","Equipment","Packaging","PPE","General","Machinery","Electric","Stationary","Furniture","Other"],A$=n=>n==="admin"||n==="inventory_manager",XE=[{id:"admin",label:"System Administrator",icon:LD},{id:"receptionist",label:"Receptionist",icon:WE},{id:"phlebotomist",label:"Sample Collection",icon:gg},{id:"technician",label:"Lab Technologist",icon:pg},{id:"pathologist",label:"Pathologist",icon:hg},{id:"accountant",label:"Finance Manager",icon:Bo},{id:"inventory_manager",label:"Inventory Manager",icon:Er},{id:"doctor",label:"Referring Doctor",icon:yg,disabled:!0,disabledReason:"Portal coming soon"}],Ua=async(n,e,t,s)=>{try{await xe.collection("audit_logs").add({action:n,module:e,details:t,userId:s.uid||"unknown",userName:s.email||s.username||"System",timestamp:je.firestore.Timestamp.now()})}catch(i){console.error("Audit log failed",i)}},w$=(n,e)=>{const t=new Date,s=String(t.getDate()).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getFullYear()).slice(-2),l=n?n.slice(-4).toUpperCase():"XXXX";return`${s}${i}${a}-${l}-${e+1}`},bd=(n,e)=>{if(!n.length)return;const t=Object.keys(n[0]),s=[t.join(","),...n.map(l=>t.map(u=>JSON.stringify(l[u],(f,m)=>m===null?"":m)).join(","))].join(`
`),i=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(i),a.download=e,a.click()},N$=({data:n,color:e="bg-indigo-500"})=>{const t=Math.max(...n.map(i=>i.value))||1,s=160;return d.jsx("div",{className:"flex items-end gap-3 w-full",style:{height:`${s}px`},children:n.map((i,a)=>{const l=Math.max(i.value/t*s,4);return d.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2 group relative",children:[d.jsx("div",{className:"relative w-full flex justify-center items-end flex-1",style:{minHeight:`${s}px`},children:d.jsx("div",{style:{height:`${l}px`},className:`w-full max-w-[50px] ${e} opacity-80 group-hover:opacity-100 transition-all rounded-t relative`,children:d.jsxs("div",{className:"absolute bottom-full mb-2 left-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 bg-slate-800 text-white text-[10px] px-2 py-1 rounded pointer-events-none whitespace-nowrap z-10 transition-opacity",children:["$",i.value.toLocaleString()]})})}),d.jsxs("div",{className:"text-center",children:[d.jsx("span",{className:"text-[10px] text-slate-400 block",children:i.label}),d.jsxs("span",{className:"text-xs font-bold text-slate-700 block mt-0.5",children:["$",(i.value/1e3).toFixed(1),"k"]})]})]},a)})})},S$=({data:n})=>{const e=n.reduce((s,i)=>s+i.value,0)||1;let t=0;return d.jsxs("div",{className:"relative w-32 h-32 mx-auto",children:[d.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full rotate-[-90deg]",children:[n.map((s,i)=>{const a=s.value/e*360,l=50+40*Math.cos(Math.PI*t/180),u=50+40*Math.sin(Math.PI*t/180),f=50+40*Math.cos(Math.PI*(t+a)/180),m=50+40*Math.sin(Math.PI*(t+a)/180),_=a>180?1:0,T=`M 50 50 L ${l} ${u} A 40 40 0 ${_} 1 ${f} ${m} Z`;return t+=a,d.jsx("path",{d:T,fill:s.color,className:"hover:opacity-80 transition-opacity",title:`${s.label}: ${s.value}`},i)}),d.jsx("circle",{cx:"50",cy:"50",r:"25",fill:"white"})]}),d.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:d.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:"Total"})})]})},FD=({isOpen:n,onClose:e,userId:t,userName:s,userRole:i})=>{const{showAlert:a,showConfirm:l,showToast:u}=iu(),[f,m]=le.useState("new"),[_,T]=le.useState([]),[x,b]=le.useState([]),[k,G]=le.useState(""),[F,Y]=le.useState(1),[K,H]=le.useState(""),[U,z]=le.useState(!1);le.useEffect(()=>{if(!n)return;const C=xe.collection("inventory_items").where("status","!=","out_of_stock").orderBy("name").onSnapshot(L=>T(L.docs.map(V=>({id:V.id,...V.data()})))),S=xe.collection("inventory_requests").where("requesterId","==",t).orderBy("createdAt","desc").limit(20).onSnapshot(L=>b(L.docs.map(V=>({id:V.id,...V.data()}))));return()=>{C(),S()}},[n,t]);const J=async()=>{if(!k||F<=0||!K){a("warning","Please fill all required fields.","Incomplete Form");return}const C=_.find(S=>S.id===k);if(C){z(!0);try{await xe.collection("inventory_requests").add({requesterId:t,requesterName:s,requesterRole:i,itemId:C.id,itemName:C.name,quantity:F,purpose:K,status:"pending",createdAt:je.firestore.Timestamp.now()}),u("success","Request submitted successfully!"),m("history"),G(""),Y(1),H("")}catch(S){console.error(S),a("error","Failed to submit request. Please try again.")}finally{z(!1)}}},P=async C=>{if(!await l(`Confirm receipt of ${C.releasedQuantity} x ${C.itemName}? This will deduct items from stock.`,{title:"Confirm Receipt",confirmText:"Confirm Receipt",type:"primary"}))return;const L=xe.batch(),V=xe.collection("inventory_requests").doc(C.id);L.update(V,{status:"completed",completedAt:je.firestore.Timestamp.now()});const ae=((await xe.collection("inventory_items").doc(C.itemId).get()).data().purchasePrice||0)*(C.releasedQuantity||0),Ie=xe.collection("inventory_items").doc(C.itemId);L.update(Ie,{quantity:je.firestore.FieldValue.increment(-(C.releasedQuantity||0))});const Q=xe.collection("inventory_transactions").doc();L.set(Q,{itemId:C.itemId,itemName:C.itemName,type:"issue",quantity:-(C.releasedQuantity||0),cost:ae,performedBy:t,reason:`Staff Request: ${C.purpose}`,timestamp:je.firestore.Timestamp.now()});try{await L.commit(),u("success","Receipt confirmed & stock deducted")}catch(ge){console.error(ge),a("error","Failed to confirm receipt. Please try again.")}};return n?d.jsx("div",{className:"fixed inset-0 bg-black/70 z-[100] flex items-center justify-center p-4",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl h-[80vh] flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"p-4 border-b bg-slate-50 flex justify-between items-center",children:[d.jsxs("h3",{className:"font-bold text-lg text-slate-800 flex items-center gap-2",children:[d.jsx(qd,{className:"w-5 h-5 text-indigo-600"})," Request Inventory"]}),d.jsx("button",{onClick:e,children:d.jsx(Fh,{className:"w-5 h-5 text-slate-500 hover:text-red-500"})})]}),d.jsxs("div",{className:"flex border-b border-slate-200",children:[d.jsx("button",{onClick:()=>m("new"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${f==="new"?"border-indigo-600 text-indigo-600 bg-indigo-50/50":"border-transparent text-slate-500 hover:bg-slate-50"}`,children:"New Request"}),d.jsxs("button",{onClick:()=>m("history"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${f==="history"?"border-indigo-600 text-indigo-600 bg-indigo-50/50":"border-transparent text-slate-500 hover:bg-slate-50"}`,children:["My Requests ",x.filter(C=>C.status==="released").length>0&&d.jsx("span",{className:"ml-1 bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded-full",children:x.filter(C=>C.status==="released").length})]})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50/50",children:[f==="new"&&d.jsxs("div",{className:"space-y-4 max-w-lg mx-auto bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Select Item"}),d.jsxs("select",{className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",value:k,onChange:C=>G(C.target.value),children:[d.jsx("option",{value:"",children:"-- Choose Item --"}),_.map(C=>d.jsxs("option",{value:C.id,children:[C.name," (",C.quantity," ",C.unit," avail)"]},C.id))]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Quantity Needed"}),d.jsx("input",{type:"number",min:"1",className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",value:F,onChange:C=>Y(parseInt(C.target.value))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Purpose / Reason"}),d.jsx("textarea",{className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500 h-24 resize-none",placeholder:"e.g. Restocking Phlebotomy Room 2",value:K,onChange:C=>H(C.target.value)})]}),d.jsxs("button",{onClick:J,disabled:U,className:"w-full bg-indigo-600 text-white py-3 rounded-lg font-bold shadow-md hover:bg-indigo-700 disabled:opacity-50 flex justify-center items-center gap-2",children:[U?d.jsx(nl,{className:"w-5 h-5 animate-spin"}):d.jsx(oi,{className:"w-5 h-5"})," Submit Request"]})]}),f==="history"&&d.jsxs("div",{className:"space-y-3",children:[x.map(C=>d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200 shadow-sm flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("h4",{className:"font-bold text-slate-800",children:C.itemName}),d.jsxs("span",{className:"text-sm font-medium bg-slate-100 px-2 py-0.5 rounded",children:["x",C.quantity]})]}),d.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Requested: ",Mn(C.createdAt),"  Reason: ",C.purpose]}),C.status==="released"&&d.jsxs("div",{className:"mt-2 bg-green-50 p-2 rounded border border-green-100 text-xs",children:[d.jsx("p",{className:"font-bold text-green-800",children:"Ready for Pickup!"}),d.jsxs("p",{className:"text-green-700",children:["Manager released ",C.releasedQuantity," items."]})]}),C.status==="rejected"&&d.jsxs("div",{className:"mt-2 bg-red-50 p-2 rounded border border-red-100 text-xs",children:[d.jsx("p",{className:"font-bold text-red-800",children:"Request Rejected"}),d.jsxs("p",{className:"text-red-700",children:["Reason: ",C.rejectionReason||"No reason provided"]}),C.rejectedAt&&d.jsxs("p",{className:"text-red-600 mt-1",children:["Rejected on: ",Mn(C.rejectedAt)]})]})]}),d.jsxs("div",{className:"shrink-0 flex items-center gap-3",children:[d.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase ${C.status==="pending"?"bg-blue-100 text-blue-700":C.status==="released"?"bg-amber-100 text-amber-700 animate-pulse":C.status==="completed"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:C.status==="released"?"Ready to Pick":C.status}),C.status==="released"&&d.jsxs("button",{onClick:()=>P(C),className:"bg-green-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold shadow hover:bg-green-700 flex items-center gap-1",children:[d.jsx(YE,{className:"w-3 h-3"})," Confirm Received"]})]})]},C.id)),x.length===0&&d.jsx("p",{className:"text-center text-slate-400 py-8 italic",children:"No request history."})]})]})]})}):null},C$=({data:n,onClose:e})=>{le.useEffect(()=>{const s=setTimeout(()=>{window.print()},800);return()=>clearTimeout(s)},[]);const t=()=>{window.print()};return d.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4 print:p-0 print:bg-white print:fixed print:inset-0 print:z-[9999]",children:[d.jsx("style",{children:"@media print { body > *:not(.print-modal-root) { display: none !important; } .print-modal-root { display: flex !important; width: 100% !important; height: 100% !important; } }"}),d.jsxs("div",{className:"print-modal-root bg-white w-full max-w-2xl rounded-xl shadow-2xl overflow-hidden print:shadow-none print:w-full print:max-w-none print:rounded-none print:h-full print:absolute print:top-0 print:left-0",children:[d.jsxs("div",{className:"bg-slate-800 text-white p-4 flex justify-between items-center print:hidden",children:[d.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[d.jsx(Oh,{className:"w-5 h-5"})," Print Preview"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:t,className:"bg-indigo-500 hover:bg-indigo-600 px-4 py-2 rounded-lg font-bold text-sm shadow-sm transition-all",children:"Print Now"}),d.jsx("button",{onClick:e,className:"bg-slate-700 hover:bg-slate-600 px-4 py-2 rounded-lg font-bold text-sm shadow-sm transition-all",children:"Close"})]})]}),d.jsxs("div",{className:"p-10 print:p-8 text-slate-900 font-serif h-full flex flex-col overflow-y-auto",children:[d.jsxs("div",{className:"border-b-2 border-slate-800 pb-6 mb-6 flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"LabPro Diagnostics"}),d.jsxs("p",{className:"text-sm text-slate-600 mt-2 leading-relaxed",children:["123 Medical Plaza, Suite 400",d.jsx("br",{}),"New York, NY 10001",d.jsx("br",{}),"Phone: +1 (555) 123-4567"]})]}),d.jsxs("div",{className:"text-right",children:[d.jsx("h2",{className:"text-xl font-bold uppercase tracking-widest text-slate-400",children:"Invoice"}),d.jsxs("p",{className:"font-mono font-bold text-xl mt-1 text-slate-900",children:["#",n.invoiceId.slice(0,8).toUpperCase()]}),d.jsx("p",{className:"text-sm text-slate-500 mt-1",children:n.date})]})]}),d.jsxs("div",{className:"flex justify-between mb-8 bg-slate-50 p-5 rounded-lg border border-slate-100 print:bg-transparent print:p-0 print:border-0",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Patient Details"}),d.jsx("p",{className:"font-bold text-lg text-slate-800",children:n.patientName}),d.jsxs("p",{className:"text-sm text-slate-700",children:[n.age," / ",n.gender]}),d.jsx("p",{className:"text-sm text-slate-700",children:n.patientPhone})]}),d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Referred By"}),d.jsx("p",{className:"font-bold text-slate-800",children:n.doctor}),d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mt-4 mb-1",children:"Payment Mode"}),d.jsx("p",{className:"uppercase font-bold text-slate-800",children:n.paymentMethod})]})]}),d.jsx("div",{className:"flex-1",children:d.jsxs("table",{className:"w-full text-left mb-8",children:[d.jsx("thead",{className:"border-b-2 border-slate-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"py-2 text-sm font-bold uppercase text-slate-500",children:"Test Description"}),d.jsx("th",{className:"py-2 text-right text-sm font-bold uppercase text-slate-500",children:"Amount"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:n.items.map((s,i)=>d.jsxs("tr",{children:[d.jsxs("td",{className:"py-3",children:[d.jsx("p",{className:"font-bold text-slate-800",children:s.name}),d.jsx("p",{className:"text-xs text-slate-500",children:s.code})]}),d.jsxs("td",{className:"py-3 text-right font-mono font-medium text-slate-700",children:["$",s.price.toFixed(2)]})]},i))})]})}),d.jsx("div",{className:"flex justify-end border-t border-slate-200 pt-6",children:d.jsxs("div",{className:"w-56 space-y-2",children:[d.jsxs("div",{className:"flex justify-between text-sm",children:[d.jsx("span",{className:"text-slate-500 font-medium",children:"Subtotal:"}),d.jsxs("span",{className:"font-mono font-bold text-slate-700",children:["$",n.subtotal.toFixed(2)]})]}),n.discount>0&&d.jsxs("div",{className:"flex justify-between text-sm",children:[d.jsx("span",{className:"text-slate-500 font-medium",children:"Discount:"}),d.jsxs("span",{className:"font-mono font-bold text-red-500",children:["-$",n.discount.toFixed(2)]})]}),d.jsxs("div",{className:"flex justify-between text-xl font-bold border-t border-slate-800 pt-3 mt-2 text-slate-900",children:[d.jsx("span",{children:"Total:"}),d.jsxs("span",{children:["$",n.total.toFixed(2)]})]}),d.jsxs("div",{className:"flex justify-between text-sm mt-4 pt-4 border-t border-slate-200",children:[d.jsx("span",{className:"text-slate-500 font-medium",children:"Amount Paid:"}),d.jsxs("span",{className:"font-mono font-bold text-slate-700",children:["$",n.paid.toFixed(2)]})]}),n.due>0&&d.jsxs("div",{className:"flex justify-between text-sm text-red-600 bg-red-50 p-2 rounded mt-2 print:bg-transparent print:p-0 print:text-red-600",children:[d.jsx("span",{className:"font-bold",children:"Balance Due:"}),d.jsxs("span",{className:"font-mono font-bold",children:["$",n.due.toFixed(2)]})]})]})}),d.jsxs("div",{className:"mt-12 pt-8 border-t border-slate-200 text-center text-xs text-slate-400",children:[d.jsx("p",{children:"Thank you for choosing LabPro Diagnostics."}),d.jsx("p",{children:"This is a computer generated invoice and does not require a signature."}),d.jsx("p",{className:"mt-2 font-mono",children:n.invoiceId})]})]})]})]})},BD=({data:n,onClose:e})=>(le.useEffect(()=>{const t=setTimeout(()=>window.print(),800);return()=>clearTimeout(t)},[]),d.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4 print:p-0 print:bg-white print:fixed print:inset-0 print:z-[9999]",children:[d.jsx("style",{children:"@media print { body > *:not(.print-report-root) { display: none !important; } .print-report-root { display: flex !important; width: 100% !important; height: 100% !important; position: absolute; top: 0; left: 0; } @page { margin: 0; size: A4; } }"}),d.jsxs("div",{className:"print-report-root bg-white w-full max-w-3xl rounded-xl shadow-2xl overflow-hidden flex flex-col h-[90vh] print:h-full print:rounded-none print:shadow-none",children:[d.jsxs("div",{className:"bg-slate-800 text-white p-4 flex justify-between items-center print:hidden shrink-0",children:[d.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[d.jsx(fg,{className:"w-5 h-5"})," Report Preview"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>window.print(),className:"bg-indigo-500 hover:bg-indigo-600 px-4 py-2 rounded-lg font-bold text-sm",children:"Print"}),d.jsx("button",{onClick:e,className:"bg-slate-700 hover:bg-slate-600 px-4 py-2 rounded-lg font-bold text-sm",children:"Close"})]})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-10 print:p-8 font-serif bg-white text-slate-900",children:[d.jsxs("div",{className:"border-b-2 border-slate-900 pb-6 mb-8 flex justify-between items-end",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold tracking-tight text-slate-900",children:"LabPro Diagnostics"}),d.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"123 Medical Plaza, New York, NY 10001"}),d.jsx("p",{className:"text-sm text-slate-600",children:"ISO 15189 Certified Laboratory"})]}),d.jsxs("div",{className:"text-right",children:[d.jsx("h2",{className:"text-xl font-bold uppercase tracking-widest text-slate-400",children:"Lab Report"}),d.jsx("p",{className:"font-mono font-bold text-lg mt-1",children:n.sampleLabelId||n.id.slice(0,8).toUpperCase()}),d.jsx("p",{className:"text-sm text-slate-500",children:Mn(n.reportedAt||new Date)})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-8 mb-8 bg-slate-50 p-6 rounded-lg border border-slate-100 print:bg-transparent print:p-0 print:border-0",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Patient Name"}),d.jsx("p",{className:"font-bold text-lg",children:n.patientName})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Age / Gender"}),d.jsxs("p",{className:"font-bold text-lg",children:[n.patientAge||"--"," Yrs / ",n.patientGender||"--"]})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Referred By"}),d.jsx("p",{className:"font-bold text-lg",children:"Dr. Smith (General)"})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Sample Type"}),d.jsx("p",{className:"font-bold text-lg",children:n.sampleType})]})]}),d.jsx("div",{className:"mb-6 text-center",children:d.jsx("h2",{className:"text-xl font-bold underline decoration-2 underline-offset-4 text-slate-900",children:n.testName})}),d.jsxs("table",{className:"w-full text-left mb-8",children:[d.jsx("thead",{className:"border-b-2 border-slate-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"py-2 font-bold uppercase text-xs text-slate-500 w-1/2",children:"Investigation"}),d.jsx("th",{className:"py-2 font-bold uppercase text-xs text-slate-500 w-1/4",children:"Result"}),d.jsx("th",{className:"py-2 font-bold uppercase text-xs text-slate-500 w-1/4 text-right",children:"Reference Range"})]})}),d.jsxs("tbody",{className:"divide-y divide-slate-100",children:[n.results&&Object.entries(n.results).map(([t,s])=>{const i=typeof s=="object"?s.value:s,a=typeof s=="object"?s.unit:"",l=typeof s=="object"?s.flag:"N",u={N:"",L:"(Low)",H:"(High)",CL:"(CRITICAL LOW)",CH:"(CRITICAL HIGH)"}[l]||"",f=l==="CL"||l==="CH",m=l==="L"||l==="H";return d.jsxs("tr",{children:[d.jsx("td",{className:"py-3 font-medium text-slate-800",children:t}),d.jsxs("td",{className:"py-3",children:[d.jsx("span",{className:`font-bold ${f?"text-red-600":m?"text-amber-700":"text-slate-900"}`,children:i}),d.jsx("span",{className:"text-slate-500 text-xs ml-1",children:a}),u&&d.jsx("span",{className:`text-[10px] ml-2 font-bold ${f?"text-red-600":"text-amber-600"}`,children:u})]}),d.jsx("td",{className:"py-3 text-right text-slate-500 text-sm",children:"--"})]},t)}),(!n.results||Object.keys(n.results).length===0)&&d.jsx("tr",{children:d.jsx("td",{colSpan:3,className:"py-4 text-center text-slate-400 italic",children:"No quantitative results recorded."})})]})]}),(n.conclusion||n.pathologistRemarks)&&d.jsxs("div",{className:"mb-12 border rounded-lg p-4 bg-slate-50 print:bg-transparent print:border-slate-300",children:[n.conclusion&&d.jsxs("div",{className:"mb-4",children:[d.jsx("h4",{className:"font-bold text-sm uppercase text-slate-700 mb-1",children:"Pathologist's Conclusion"}),d.jsx("p",{className:"text-slate-900 text-sm leading-relaxed",children:n.conclusion})]}),n.pathologistRemarks&&d.jsxs("div",{children:[d.jsx("h4",{className:"font-bold text-sm uppercase text-slate-700 mb-1",children:"Remarks"}),d.jsx("p",{className:"text-slate-900 text-sm leading-relaxed",children:n.pathologistRemarks})]})]}),d.jsx("div",{className:"mt-auto pt-6 flex justify-end",children:d.jsxs("div",{className:"text-center w-48",children:[d.jsx("div",{className:"h-16 mb-2 border-b border-slate-900/20",children:d.jsx("div",{className:"h-full flex items-end justify-center pb-2 font-cursive text-2xl text-slate-600",children:"Dr. A. Pathologist"})}),d.jsx("p",{className:"font-bold text-sm text-slate-900",children:n.verifiedBy||"Dr. Alice Pathologist"}),d.jsx("p",{className:"text-xs text-slate-500",children:"MD, Pathology (Reg: 12345)"})]})}),d.jsx("div",{className:"mt-8 pt-4 border-t border-slate-200 text-center text-[10px] text-slate-400",children:d.jsx("p",{children:"End of Report. Electronically generated by LabPro System."})})]})]})]})),R$=({onLoginSuccess:n})=>{const[e,t]=le.useState(""),[s,i]=le.useState(""),[a,l]=le.useState(!1),[u,f]=le.useState(""),[m,_]=le.useState("receptionist");le.useEffect(()=>{Dt.setPersistence(je.auth.Auth.Persistence.LOCAL).catch(console.error)},[]);const T=async x=>{if(x.preventDefault(),!e||!s){f("Please enter username and password.");return}l(!0),f("");try{if(e==="admin"&&s==="admin"){try{await Dt.signInAnonymously()}catch(k){console.warn("Anonymous auth failed:",k)}n("admin",{uid:"sys-admin",email:"System Admin",username:"admin"}),await Ua("LOGIN","Auth","Admin logged in",{uid:"sys-admin",username:"admin"});return}const b=await xe.collection("users").where("username","==",e).where("password","==",s).where("status","==","active").limit(1).get();if(!b.empty){const k=b.docs[0].data();if(k.role!==m&&k.role!=="admin"){f(`Credentials valid, but this user is a ${k.role}, not a ${m}.`),l(!1);return}try{await Dt.signInAnonymously()}catch(G){console.warn("Anonymous auth failed:",G)}n(k.role,{uid:b.docs[0].id,email:k.username,...k}),await Ua("LOGIN","Auth",`User logged in as ${k.role}`,{uid:b.docs[0].id,username:k.username});return}f("Invalid credentials.")}catch(b){console.error(b),f("Login failed. Please try again.")}finally{l(!1)}};return d.jsxs("div",{className:"min-h-screen flex flex-col font-sans",style:{backgroundColor:w.RICH_BLACK},children:[d.jsx("header",{className:"shadow-sm sticky top-0 z-40",style:{backgroundColor:w.MIDNIGHT_GREEN,borderBottom:`1px solid ${w.PERSIAN_GREEN}20`},children:d.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-center",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center shadow-lg",style:{backgroundColor:w.PERSIAN_GREEN},children:d.jsx($E,{className:"w-6 h-6 text-white"})}),d.jsxs("div",{children:[d.jsxs("h1",{className:"text-2xl font-bold tracking-tight",style:{color:w.CITRON},children:["LabPro ",d.jsx("span",{style:{color:w.PERSIAN_GREEN},children:"Plus"})]}),d.jsx("p",{className:"text-[10px] uppercase tracking-widest font-bold",style:{color:w.TIFFANY_BLUE},children:"Diagnostic Management System"})]})]})})}),d.jsx("main",{className:"flex-1 flex items-center justify-center p-4",children:d.jsx("div",{className:"w-full max-w-md",children:d.jsxs("div",{className:"rounded-2xl shadow-2xl p-8",style:{backgroundColor:w.MIDNIGHT_GREEN},children:[d.jsxs("div",{className:"mb-8 text-center",children:[d.jsx("h3",{className:"text-2xl font-bold mb-2",style:{color:w.CITRON},children:"System Login"}),d.jsx("p",{className:"text-sm",style:{color:w.TIFFANY_BLUE},children:"Select role and enter credentials"})]}),d.jsxs("form",{onSubmit:T,className:"space-y-5",autoComplete:"on",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:w.TIFFANY_BLUE},children:"Select Role"}),d.jsxs("div",{className:"relative",children:[d.jsx("select",{value:m,onChange:x=>_(x.target.value),className:"w-full p-3.5 border-2 rounded-xl outline-none appearance-none font-medium transition-all",style:{backgroundColor:w.RICH_BLACK,borderColor:`${w.PERSIAN_GREEN}30`,color:w.CITRON},onFocus:x=>x.target.style.borderColor=w.PERSIAN_GREEN,onBlur:x=>x.target.style.borderColor=`${w.PERSIAN_GREEN}30`,name:"role",children:XE.filter(x=>!x.disabled).map(x=>d.jsx("option",{value:x.id,children:x.label},x.id))}),d.jsx(p7,{className:"absolute right-4 top-4 w-4 h-4 pointer-events-none",style:{color:w.TIFFANY_BLUE}})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:w.TIFFANY_BLUE},children:"Username"}),d.jsx("input",{type:"text",value:e,onChange:x=>t(x.target.value),className:"w-full p-3.5 border-2 rounded-xl outline-none transition-all",style:{backgroundColor:w.RICH_BLACK,borderColor:`${w.PERSIAN_GREEN}30`,color:w.CITRON},onFocus:x=>x.target.style.borderColor=w.PERSIAN_GREEN,onBlur:x=>x.target.style.borderColor=`${w.PERSIAN_GREEN}30`,placeholder:"Enter username",autoFocus:!0,name:"username",autoComplete:"username"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:w.TIFFANY_BLUE},children:"Password"}),d.jsx("input",{type:"password",value:s,onChange:x=>i(x.target.value),className:"w-full p-3.5 border-2 rounded-xl outline-none transition-all",style:{backgroundColor:w.RICH_BLACK,borderColor:`${w.PERSIAN_GREEN}30`,color:w.CITRON},onFocus:x=>x.target.style.borderColor=w.PERSIAN_GREEN,onBlur:x=>x.target.style.borderColor=`${w.PERSIAN_GREEN}30`,placeholder:"",name:"password",autoComplete:"current-password"})]}),u&&d.jsxs("div",{className:"border-2 p-3 rounded-xl text-sm flex items-start gap-2 animate-in fade-in slide-in-from-top-2",style:{backgroundColor:"#FEE2E2",borderColor:"#FCA5A5",color:"#991B1B"},children:[d.jsx(KE,{className:"w-4 h-4 mt-0.5 shrink-0"}),d.jsx("span",{className:"leading-snug",children:u})]}),d.jsx("button",{type:"submit",disabled:a||!e||!s,className:"w-full py-3.5 rounded-xl font-bold transition-all disabled:opacity-50 shadow-lg flex justify-center items-center gap-2 text-white",style:{backgroundColor:w.PERSIAN_GREEN,boxShadow:`0 4px 14px 0 ${w.PERSIAN_GREEN}40`},onMouseEnter:x=>x.currentTarget.style.transform="translateY(-1px)",onMouseLeave:x=>x.currentTarget.style.transform="translateY(0)",children:a?d.jsx(nl,{className:"w-5 h-5 animate-spin"}):"Secure Login"})]})]})})}),d.jsx("footer",{className:"py-6",style:{backgroundColor:w.MIDNIGHT_GREEN,borderTop:`1px solid ${w.PERSIAN_GREEN}20`},children:d.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center",children:[d.jsxs("p",{className:"text-sm font-medium mb-2",style:{color:w.CITRON},children:["Developed by ",d.jsx("span",{className:"font-bold",style:{color:w.PERSIAN_GREEN},children:"ABS TECH Bahawalpur"})]}),d.jsxs("p",{className:"text-sm mb-2",style:{color:w.TIFFANY_BLUE},children:["Contact Us at ",d.jsx("span",{className:"font-bold",style:{color:w.PERSIAN_GREEN},children:"03009686545"})]}),d.jsx("p",{className:"text-xs",style:{color:w.TIFFANY_BLUE},children:"All Rights Reserved  ABS BAHAWALPUR"})]})})]})},P$=({expenses:n})=>{const[e,t]=le.useState("due"),[s,i]=le.useState(!1),[a,l]=le.useState({category:"General",isRecurring:!1,status:"pending"}),[u,f]=le.useState("month"),m=async()=>{var x;if(!(!a.title||!a.amount||!a.dueDate))try{await xe.collection("expenses").add({...a,date:je.firestore.Timestamp.now(),createdBy:((x=Dt.currentUser)==null?void 0:x.email)||"admin"}),await Ua("ADD_EXPENSE","Finance",`Added expense: ${a.title} ($${a.amount})`,Dt.currentUser),i(!1),l({category:"General",isRecurring:!1,status:"pending"})}catch(b){console.error(b)}},_=async x=>{var b;try{await xe.collection("expenses").doc(x.id).update({status:"paid",paidAt:je.firestore.Timestamp.now(),paidBy:((b=Dt.currentUser)==null?void 0:b.email)||"admin"})}catch(k){console.error(k)}},T=le.useMemo(()=>{if(e==="due")return n.filter(b=>b.status!=="paid");const x=new Date;return n.filter(b=>{if(b.status!=="paid")return!1;const k=b.paidAt?b.paidAt.toDate?b.paidAt.toDate():new Date(b.paidAt):new Date(b.date);return u==="day"?k.toDateString()===x.toDateString():u==="week"?k>new Date(x.setDate(x.getDate()-7)):u==="month"?k.getMonth()===x.getMonth()&&k.getFullYear()===x.getFullYear():u==="year"?k.getFullYear()===x.getFullYear():!0})},[n,e,u]);return d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Expense Management"}),d.jsxs("div",{className:"flex gap-2 mt-2",children:[d.jsx("button",{onClick:()=>t("due"),className:`px-3 py-1 text-sm rounded-full font-bold ${e==="due"?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-500"}`,children:"Due Expenses"}),d.jsx("button",{onClick:()=>t("paid"),className:`px-3 py-1 text-sm rounded-full font-bold ${e==="paid"?"bg-green-100 text-green-700":"bg-slate-100 text-slate-500"}`,children:"Paid History"})]})]}),d.jsxs("div",{className:"flex gap-2",children:[e==="paid"&&d.jsxs(d.Fragment,{children:[d.jsxs("select",{value:u,onChange:x=>f(x.target.value),className:"p-2 border rounded text-sm font-bold bg-white",children:[d.jsx("option",{value:"day",children:"Today"}),d.jsx("option",{value:"week",children:"This Week"}),d.jsx("option",{value:"month",children:"This Month"}),d.jsx("option",{value:"year",children:"This Year"})]}),d.jsx("button",{onClick:()=>bd(T,"paid_expenses.csv"),className:"bg-slate-200 p-2 rounded hover:bg-slate-300",title:"Export Excel",children:d.jsx(kD,{className:"w-5 h-5"})}),d.jsx("button",{onClick:()=>window.print(),className:"bg-slate-200 p-2 rounded hover:bg-slate-300",title:"Print",children:d.jsx(Oh,{className:"w-5 h-5"})})]}),d.jsxs("button",{onClick:()=>i(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2",children:[d.jsx(yr,{className:"w-4 h-4"})," Add Expense"]})]})]}),s&&d.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 mb-6 animate-in slide-in-from-top-4",children:[d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[d.jsx("input",{className:"p-2 border rounded",placeholder:"Title / Description",value:a.title||"",onChange:x=>l({...a,title:x.target.value})}),d.jsx("input",{className:"p-2 border rounded",type:"number",placeholder:"Amount",value:a.amount||"",onChange:x=>l({...a,amount:parseFloat(x.target.value)})}),d.jsxs("select",{className:"p-2 border rounded",value:a.category,onChange:x=>l({...a,category:x.target.value}),children:[d.jsx("option",{children:"General"}),d.jsx("option",{children:"Rent"}),d.jsx("option",{children:"Utilities"}),d.jsx("option",{children:"Salaries"}),d.jsx("option",{children:"Inventory"}),d.jsx("option",{children:"Maintenance"})]}),d.jsx("input",{className:"p-2 border rounded",type:"date",placeholder:"Due Date",value:a.dueDate||"",onChange:x=>l({...a,dueDate:x.target.value})})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("input",{className:"p-2 border rounded w-64",placeholder:"Vendor (Optional)",value:a.vendor||"",onChange:x=>l({...a,vendor:x.target.value})}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2 text-slate-500",children:"Cancel"}),d.jsx("button",{onClick:m,className:"bg-green-600 text-white px-4 py-2 rounded font-bold",children:"Save Record"})]})]})]}),d.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm flex-1 overflow-hidden flex flex-col",children:d.jsx("div",{className:"overflow-y-auto",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",children:e==="due"?"Due Date":"Paid Date"}),d.jsx("th",{className:"p-4",children:"Description"}),d.jsx("th",{className:"p-4",children:"Category"}),d.jsx("th",{className:"p-4",children:"Vendor"}),d.jsx("th",{className:"p-4 text-right",children:"Amount"}),e==="due"&&d.jsx("th",{className:"p-4 text-center",children:"Action"})]})}),d.jsxs("tbody",{className:"divide-y divide-slate-100",children:[T.map(x=>d.jsxs("tr",{className:"hover:bg-slate-50",children:[d.jsx("td",{className:"p-4 text-slate-500 text-xs font-mono",children:e==="due"?x.dueDate:Mn(x.paidAt)}),d.jsx("td",{className:"p-4 font-bold text-slate-700",children:x.title}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"bg-slate-100 px-2 py-1 rounded text-xs",children:x.category})}),d.jsx("td",{className:"p-4 text-slate-500",children:x.vendor||"-"}),d.jsxs("td",{className:"p-4 text-right font-bold text-slate-800",children:["$",x.amount.toFixed(2)]}),e==="due"&&d.jsx("td",{className:"p-4 text-center",children:d.jsx("button",{onClick:()=>_(x),className:"bg-green-500 text-white px-3 py-1 rounded text-xs font-bold shadow hover:bg-green-600 transition-colors",children:"Mark Paid"})})]},x.id)),T.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"p-8 text-center text-slate-400",children:"No expenses found."})})]})]})})})]})},D$=({doctors:n,orders:e})=>{const{showAlert:t,showConfirm:s,showToast:i}=iu(),[a,l]=le.useState(!1),[u,f]=le.useState({status:"active",commissionRate:0}),m=async()=>{if(u.name)try{await xe.collection("doctors").add(u),l(!1),f({status:"active",commissionRate:0})}catch(T){console.error(T)}},_=async T=>{var x;try{console.log("Attempting to pay commission for:",T.name);const b=e.filter(K=>K.doctorId===T.id&&!K.commissionPaid);if(console.log("Unpaid orders count:",b.length),b.length===0){t("info","No unpaid orders found for this doctor in the current view.","No Pending Commissions");return}const k=b.reduce((K,H)=>K+(H.doctorCommission||0),0);if(!await s(`Mark $${k.toFixed(2)} as paid to Dr. ${T.name}? This will create a specific expense record.`,{title:"Confirm Commission Payment",confirmText:"Mark Paid",type:"primary"}))return;const F=xe.batch(),Y=xe.collection("expenses").doc();F.set(Y,{title:`Commission - ${T.name}`,category:"Commission",amount:k,status:"paid",date:je.firestore.Timestamp.now(),paidAt:je.firestore.Timestamp.now(),paidBy:((x=Dt.currentUser)==null?void 0:x.email)||"admin",createdBy:"system"}),b.forEach(K=>{const H=xe.collection("orders").doc(K.id);F.update(H,{commissionPaid:!0})}),await F.commit(),i("success",`Commission of $${k.toFixed(2)} paid & expense logged`)}catch(b){console.error("Payment failed",b),t("error","Failed to pay commission: "+(b instanceof Error?b.message:String(b)),"Payment Failed")}};return d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Doctor Referral Program"}),d.jsxs("button",{onClick:()=>l(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2",children:[d.jsx(yg,{className:"w-4 h-4"})," Add Doctor"]})]}),a&&d.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 mb-6",children:[d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[d.jsx("input",{className:"p-2 border rounded",placeholder:"Doctor Name",value:u.name||"",onChange:T=>f({...u,name:T.target.value})}),d.jsx("input",{className:"p-2 border rounded",placeholder:"Clinic / Hospital",value:u.clinic||"",onChange:T=>f({...u,clinic:T.target.value})}),d.jsx("input",{className:"p-2 border rounded",placeholder:"Phone",value:u.phone||"",onChange:T=>f({...u,phone:T.target.value})}),d.jsx("input",{className:"p-2 border rounded",type:"number",placeholder:"Commission %",value:u.commissionRate||"",onChange:T=>f({...u,commissionRate:parseFloat(T.target.value)})})]}),d.jsxs("div",{className:"flex justify-end gap-2",children:[d.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 text-slate-500",children:"Cancel"}),d.jsx("button",{onClick:m,className:"bg-green-600 text-white px-4 py-2 rounded font-bold",children:"Save Doctor"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full min-h-0",children:[d.jsx("div",{className:"lg:col-span-2 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden flex flex-col",children:d.jsx("div",{className:"overflow-y-auto",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",children:"Doctor"}),d.jsx("th",{className:"p-4",children:"Clinic"}),d.jsx("th",{className:"p-4",children:"Comm. Rate"}),d.jsx("th",{className:"p-4 text-right",children:"Revenue Generated"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:n.map(T=>{const x=e.filter(b=>b.doctorId===T.id).reduce((b,k)=>b+k.totalAmount,0);return d.jsxs("tr",{className:"hover:bg-slate-50",children:[d.jsx("td",{className:"p-4 font-bold text-slate-800",children:T.name}),d.jsx("td",{className:"p-4 text-slate-500",children:T.clinic}),d.jsxs("td",{className:"p-4 font-mono text-indigo-600 font-bold",children:[T.commissionRate,"%"]}),d.jsxs("td",{className:"p-4 text-right font-bold text-green-600",children:["$",x.toLocaleString()]})]},T.id)})})]})})}),d.jsxs("div",{className:"bg-indigo-50 p-6 rounded-xl border border-indigo-100 overflow-y-auto",children:[d.jsx("h4",{className:"font-bold text-indigo-900 mb-4",children:"Outstanding Commission Liabilities"}),d.jsxs("div",{className:"space-y-4",children:[n.map(T=>{const x=e.filter(b=>b.doctorId===T.id&&!b.commissionPaid).reduce((b,k)=>b+(k.doctorCommission||0),0);return x<=0?null:d.jsxs("div",{className:"bg-white p-3 rounded border border-indigo-100 flex justify-between items-center shadow-sm",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-bold text-slate-700 text-sm",children:T.name}),d.jsx("p",{className:"text-xs text-slate-400",children:T.clinic})]}),d.jsxs("div",{className:"text-right",children:[d.jsxs("p",{className:"font-bold text-indigo-600",children:["$",x.toFixed(2)]}),d.jsx("button",{onClick:()=>_(T),className:"text-[10px] bg-green-100 text-green-700 font-bold px-2 py-1 rounded hover:bg-green-200 mt-1 transition-colors",children:"Mark Paid"})]})]},T.id)}),n.every(T=>e.filter(x=>x.doctorId===T.id&&!x.commissionPaid).reduce((x,b)=>x+(b.doctorCommission||0),0)<=0)&&d.jsx("p",{className:"text-center text-indigo-400 text-sm py-4",children:"No pending commissions."})]})]})]})]})},jD=()=>{const{showToast:n}=iu(),[e,t]=le.useState("dashboard"),[s,i]=le.useState([]),[a,l]=le.useState([]),[u,f]=le.useState([]),[m,_]=le.useState(0),[T,x]=le.useState([]),[b,k]=le.useState("month");le.useEffect(()=>{const U=xe.collection("orders").orderBy("createdAt","desc").limit(200).onSnapshot(S=>i(S.docs.map(L=>({id:L.id,...L.data()})))),z=xe.collection("expenses").orderBy("date","desc").limit(200).onSnapshot(S=>l(S.docs.map(L=>({id:L.id,...L.data()})))),J=xe.collection("doctors").onSnapshot(S=>f(S.docs.map(L=>({id:L.id,...L.data()})))),P=xe.collection("inventory_items").onSnapshot(S=>{const L=S.docs.reduce((V,O)=>{const M=O.data();return V+M.quantity*(M.purchasePrice||0)},0);_(L)}),C=xe.collection("inventory_transactions").orderBy("timestamp","desc").limit(100).onSnapshot(S=>x(S.docs.map(L=>({id:L.id,...L.data()}))));return()=>{U(),z(),J(),P(),C()}},[]);const G=U=>{const z=U.toDate?U.toDate():new Date(U),J=new Date;return b==="today"?z.toDateString()===J.toDateString():b==="week"?z>new Date(J.setDate(J.getDate()-7)):b==="month"?z.getMonth()===J.getMonth()&&z.getFullYear()===J.getFullYear():b==="year"?z.getFullYear()===J.getFullYear():!0},F=le.useMemo(()=>s.filter(U=>G(U.createdAt)),[s,b]),Y=le.useMemo(()=>a.filter(U=>U.status==="paid"&&G(U.paidAt)),[a,b]),K=le.useMemo(()=>T.filter(U=>(U.type==="issue"||U.type==="deduction")&&G(U.timestamp)),[T,b]),H=le.useMemo(()=>{const U=F.reduce((S,L)=>S+L.totalAmount,0),z=Y.reduce((S,L)=>S+L.amount,0),J=K.reduce((S,L)=>S+(L.cost||0),0),P=s.filter(S=>!S.commissionPaid).reduce((S,L)=>S+(L.doctorCommission||0),0),C=U-z-J;return{revenue:U,paidExpenses:z,invUsageCost:J,pendingCommissions:P,profit:C}},[F,Y,K,s]);return d.jsxs("div",{className:"h-full flex flex-col bg-slate-50",children:[d.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-3 flex justify-between items-center shrink-0",children:[d.jsx("div",{className:"flex items-center gap-2",children:d.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[d.jsx(Bo,{className:"w-6 h-6 text-indigo-600"})," Financial Dashboard"]})}),d.jsx("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[{id:"dashboard",label:"Overview",icon:mg},{id:"sales",label:"Sales",icon:fg},{id:"expenses",label:"Expenses",icon:UD},{id:"doctors",label:"Referrals",icon:yg},{id:"inventory",label:"Inventory Finance",icon:Er}].map(U=>d.jsxs("button",{onClick:()=>t(U.id),className:`px-3 py-1.5 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${e===U.id?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-800"}`,children:[d.jsx(U.icon,{className:"w-4 h-4"})," ",d.jsx("span",{className:"hidden sm:inline",children:U.label})]},U.id))})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[d.jsx("div",{className:"flex justify-end mb-6",children:d.jsxs("select",{value:b,onChange:U=>k(U.target.value),className:"p-2 border rounded-lg text-sm bg-white font-bold text-slate-700",children:[d.jsx("option",{value:"today",children:"Today"}),d.jsx("option",{value:"week",children:"This Week"}),d.jsx("option",{value:"month",children:"This Month"}),d.jsx("option",{value:"year",children:"This Year"})]})}),e==="dashboard"&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[d.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Total Revenue"}),d.jsxs("p",{className:"text-3xl font-bold text-slate-800 mt-2",children:["$",H.revenue.toLocaleString()]}),d.jsxs("p",{className:"text-xs text-green-600 mt-1 font-bold flex items-center gap-1",children:[d.jsx(l$,{className:"w-3 h-3"})," Income"]})]}),d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[d.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Paid Expenses"}),d.jsxs("p",{className:"text-3xl font-bold text-slate-800 mt-2",children:["$",H.paidExpenses.toLocaleString()]}),d.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Operational & Paid Comms"})]}),d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[d.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase",children:"Inventory Usage Cost"}),d.jsxs("p",{className:"text-3xl font-bold text-slate-800 mt-2",children:["$",H.invUsageCost.toLocaleString()]}),d.jsx("p",{className:"text-xs text-amber-600 mt-1 font-bold",children:"Cost of Goods Sold"})]}),d.jsxs("div",{className:`p-6 rounded-xl border shadow-lg text-white ${H.profit>=0?"bg-indigo-600 border-indigo-700 shadow-indigo-200":"bg-red-600 border-red-700 shadow-red-200"}`,children:[d.jsx("p",{className:"text-white/80 text-xs font-bold uppercase",children:"Net Profit"}),d.jsxs("p",{className:"text-3xl font-bold mt-2",children:["$",H.profit.toLocaleString()]}),d.jsx("p",{className:"text-xs text-white/70 mt-1 opacity-80",children:"Rev - (Exp + Inv. Usage)"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[d.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Financial Overview"}),[H.revenue,H.paidExpenses,H.invUsageCost].some(U=>U>0)?d.jsxs(d.Fragment,{children:[d.jsx(N$,{data:[{label:"Revenue",value:H.revenue},{label:"Paid Exp",value:H.paidExpenses},{label:"Inv. Usage",value:H.invUsageCost},{label:"Profit",value:Math.max(0,H.profit)}]}),d.jsx("div",{className:"mt-4 grid grid-cols-2 gap-2 text-xs",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 bg-indigo-500 rounded"}),d.jsx("span",{className:"text-slate-600",children:"Data Values"})]})})]}):d.jsx("div",{className:"h-40 flex items-center justify-center text-slate-400 text-sm",children:"No financial data for selected period"})]}),d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[d.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Expense Breakdown (Paid)"}),Y.length>0||K.length>0?d.jsxs(d.Fragment,{children:[d.jsx(S$,{data:(()=>{const U=Y.reduce((J,P)=>({...J,[P.category]:(J[P.category]||0)+P.amount}),{}),z=K.reduce((J,P)=>J+(P.cost||0),0);return z>0&&(U.Inventory=z),Object.entries(U).map(([J,P],C)=>({label:J,value:P,color:["#6366f1","#ec4899","#f59e0b","#10b981","#8b5cf6"][C%5]}))})()}),d.jsx("div",{className:"mt-4 grid grid-cols-2 gap-2 text-xs",children:(()=>{const U=Y.reduce((J,P)=>({...J,[P.category]:(J[P.category]||0)+P.amount}),{}),z=K.reduce((J,P)=>J+(P.cost||0),0);return z>0&&(U.Inventory=z),Object.entries(U).map(([J,P],C)=>d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:["#6366f1","#ec4899","#f59e0b","#10b981","#8b5cf6"][C%5]}}),d.jsxs("span",{className:"text-slate-600",children:[J,": $",P.toFixed(0)]})]},J))})()})]}):d.jsx("div",{className:"h-40 flex items-center justify-center text-slate-400 text-sm",children:"No paid expenses for selected period"})]})]}),d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[d.jsx("div",{className:"flex justify-between items-center mb-4",children:d.jsxs("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[d.jsx(QE,{className:"w-5 h-5 text-indigo-600"})," Financial Reports"]})}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[d.jsxs("button",{onClick:()=>{const U=new Date,z=s.filter(C=>(C.createdAt.toDate?C.createdAt.toDate():new Date(C.createdAt)).toDateString()===U.toDateString()),J=a.filter(C=>C.status==="paid"&&C.paidAt&&(C.paidAt.toDate?C.paidAt.toDate():new Date(C.paidAt)).toDateString()===U.toDateString()),P=`DAILY FINANCIAL REPORT - ${U.toDateString()}

REVENUE
Total Sales: $${z.reduce((C,S)=>C+S.totalAmount,0).toFixed(2)}
Number of Orders: ${z.length}

EXPENSES
Total Paid: $${J.reduce((C,S)=>C+S.amount,0).toFixed(2)}
Number of Expenses: ${J.length}

NET: $${(z.reduce((C,S)=>C+S.totalAmount,0)-J.reduce((C,S)=>C+S.amount,0)).toFixed(2)}`;bd([{Report:P}],`daily_report_${U.toISOString().split("T")[0]}.csv`),n("success","Daily report exported!")},className:"p-4 border-2 border-slate-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-all text-left group",children:[d.jsx(u7,{className:"w-6 h-6 text-indigo-600 mb-2"}),d.jsx("p",{className:"font-bold text-slate-800 group-hover:text-indigo-600",children:"Daily Report"}),d.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Today's summary"})]}),d.jsxs("button",{onClick:()=>{const U=new Date,z=new Date(U.setDate(U.getDate()-7)),J=s.filter(P=>(P.createdAt.toDate?P.createdAt.toDate():new Date(P.createdAt))>z);a.filter(P=>P.status==="paid"&&P.paidAt&&(P.paidAt.toDate?P.paidAt.toDate():new Date(P.paidAt))>z),bd(J.map(P=>({Date:Mn(P.createdAt),Patient:P.patientName,Amount:P.totalAmount})),`weekly_sales_${new Date().toISOString().split("T")[0]}.csv`),n("success","Weekly report exported!")},className:"p-4 border-2 border-slate-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-all text-left group",children:[d.jsx(l7,{className:"w-6 h-6 text-indigo-600 mb-2"}),d.jsx("p",{className:"font-bold text-slate-800 group-hover:text-indigo-600",children:"Weekly Report"}),d.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Last 7 days"})]}),d.jsxs("button",{onClick:()=>{const U=new Date,z=s.filter(J=>{const P=J.createdAt.toDate?J.createdAt.toDate():new Date(J.createdAt);return P.getMonth()===U.getMonth()&&P.getFullYear()===U.getFullYear()});a.filter(J=>{if(J.status!=="paid"||!J.paidAt)return!1;const P=J.paidAt.toDate?J.paidAt.toDate():new Date(J.paidAt);return P.getMonth()===U.getMonth()&&P.getFullYear()===U.getFullYear()}),bd(z.map(J=>({Date:Mn(J.createdAt),Patient:J.patientName,Amount:J.totalAmount})),`monthly_sales_${U.getFullYear()}_${U.getMonth()+1}.csv`),n("success","Monthly report exported!")},className:"p-4 border-2 border-slate-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-all text-left group",children:[d.jsx(h7,{className:"w-6 h-6 text-indigo-600 mb-2"}),d.jsx("p",{className:"font-bold text-slate-800 group-hover:text-indigo-600",children:"Monthly Report"}),d.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Current month"})]}),d.jsxs("button",{onClick:()=>{const U={Generated:new Date().toLocaleString(),Period:b,"Total Revenue":H.revenue,"Total Expenses":H.paidExpenses,"Inventory Cost":H.invUsageCost,"Net Profit":H.profit,"Pending Commissions":H.pendingCommissions,"Total Orders":F.length,"Paid Expenses Count":Y.length},z=[...F.map(J=>({Type:"Revenue",Date:Mn(J.createdAt),Description:`Order - ${J.patientName}`,Amount:J.totalAmount})),...Y.map(J=>({Type:"Expense",Date:Mn(J.paidAt),Description:`${J.category} - ${J.title}`,Amount:-J.amount}))];bd([U,...z],`master_financial_report_${new Date().toISOString().split("T")[0]}.csv`),n("success","Master report with all financial data exported!")},className:"p-4 border-2 border-indigo-500 bg-indigo-50 rounded-lg hover:bg-indigo-100 transition-all text-left group",children:[d.jsx(kD,{className:"w-6 h-6 text-indigo-600 mb-2"}),d.jsx("p",{className:"font-bold text-indigo-800",children:"Master Report"}),d.jsx("p",{className:"text-xs text-indigo-600 mt-1 font-medium",children:"Complete financial data"})]})]}),d.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 flex items-center justify-between",children:[d.jsx("p",{className:"text-xs text-slate-500",children:"All reports are exported as CSV files for Excel/Sheets"}),d.jsxs("button",{onClick:()=>window.print(),className:"text-sm font-bold text-indigo-600 hover:text-indigo-800 flex items-center gap-1",children:[d.jsx(Oh,{className:"w-4 h-4"})," Print Dashboard"]})]})]}),d.jsxs("div",{className:"bg-amber-50 p-4 rounded-xl border border-amber-100 flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-bold text-amber-900",children:"Outstanding Liabilities"}),d.jsxs("p",{className:"text-sm text-amber-700",children:["Pending Commissions: ",d.jsxs("b",{children:["$",H.pendingCommissions.toLocaleString()]}),"  Due Expenses: ",d.jsxs("b",{children:["$",a.filter(U=>U.status!=="paid").reduce((U,z)=>U+z.amount,0).toLocaleString()]})]})]}),d.jsx("button",{onClick:()=>t("expenses"),className:"px-4 py-2 bg-white text-amber-700 text-sm font-bold rounded shadow-sm hover:bg-amber-100",children:"Manage Due Expenses"})]})]}),e==="expenses"&&d.jsx(P$,{expenses:a}),e==="doctors"&&d.jsx(D$,{doctors:u,orders:s}),e==="sales"&&d.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"bg-slate-50 border-b",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",children:"Date"}),d.jsx("th",{className:"p-4",children:"Bill #"}),d.jsx("th",{className:"p-4",children:"Patient"}),d.jsx("th",{className:"p-4",children:"Referred By"}),d.jsx("th",{className:"p-4 text-right",children:"Amount"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:F.map(U=>d.jsxs("tr",{className:"hover:bg-slate-50",children:[d.jsx("td",{className:"p-4 text-xs font-mono text-slate-500",children:Mn(U.createdAt)}),d.jsx("td",{className:"p-4 text-xs font-bold",children:U.id.slice(0,8).toUpperCase()}),d.jsx("td",{className:"p-4 font-bold text-slate-800",children:U.patientName}),d.jsx("td",{className:"p-4 text-slate-600",children:U.doctorName||"Self"}),d.jsxs("td",{className:"p-4 text-right font-bold text-slate-800",children:["$",U.totalAmount]})]},U.id))})]})}),e==="inventory"&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-indigo-50 p-6 rounded-xl border border-indigo-100",children:[d.jsx("h3",{className:"font-bold text-indigo-900 mb-2",children:"Total Current Inventory Value"}),d.jsxs("p",{className:"text-4xl font-bold text-indigo-600",children:["$",m.toLocaleString()]}),d.jsx("p",{className:"text-sm text-indigo-400 mt-2",children:"Valuation of current stock (Purchase Price  Quantity)."})]}),d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[d.jsxs("h3",{className:"font-bold text-slate-800 mb-4",children:["Inventory Usage Cost (",b,")"]}),d.jsxs("p",{className:"text-4xl font-bold text-slate-800 mb-4",children:["$",H.invUsageCost.toLocaleString()]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex justify-between text-sm",children:[d.jsx("span",{className:"text-slate-500",children:"Used in Tests"}),d.jsxs("span",{className:"font-bold",children:["$",K.filter(U=>U.type==="deduction").reduce((U,z)=>U+(z.cost||0),0).toFixed(2)]})]}),d.jsxs("div",{className:"flex justify-between text-sm",children:[d.jsx("span",{className:"text-slate-500",children:"Issued to Staff"}),d.jsxs("span",{className:"font-bold",children:["$",K.filter(U=>U.type==="issue").reduce((U,z)=>U+(z.cost||0),0).toFixed(2)]})]})]})]})]}),d.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[d.jsx("div",{className:"p-4 border-b bg-slate-50 font-bold text-slate-700",children:"Inventory Cost Ledger"}),d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"border-b",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",children:"Date"}),d.jsx("th",{className:"p-4",children:"Item"}),d.jsx("th",{className:"p-4",children:"Type"}),d.jsx("th",{className:"p-4",children:"Reason"}),d.jsx("th",{className:"p-4 text-right",children:"Cost"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:K.map(U=>d.jsxs("tr",{className:"hover:bg-slate-50",children:[d.jsx("td",{className:"p-4 text-xs font-mono text-slate-500",children:Mn(U.timestamp)}),d.jsx("td",{className:"p-4 font-bold text-slate-700",children:U.itemName}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"bg-slate-100 px-2 py-1 rounded text-xs uppercase",children:U.type})}),d.jsx("td",{className:"p-4 text-slate-600",children:U.reason}),d.jsxs("td",{className:"p-4 text-right font-bold text-slate-800",children:["$",(U.cost||0).toFixed(2)]})]},U.id))})]})]})]})]})]})},M$=()=>{const[n,e]=le.useState([]);return le.useEffect(()=>{const t=xe.collection("orders").orderBy("createdAt","desc").limit(50).onSnapshot(s=>e(s.docs.map(i=>({id:i.id,...i.data()}))));return()=>t()},[]),d.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"bg-slate-50 border-b",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",children:"Date"}),d.jsx("th",{className:"p-4",children:"Order ID"}),d.jsx("th",{className:"p-4",children:"Patient"}),d.jsx("th",{className:"p-4",children:"Amount"}),d.jsx("th",{className:"p-4",children:"Status"})]})}),d.jsxs("tbody",{className:"divide-y divide-slate-50",children:[n.map(t=>d.jsxs("tr",{className:"hover:bg-slate-50",children:[d.jsx("td",{className:"p-4 text-xs text-slate-500",children:Mn(t.createdAt)}),d.jsx("td",{className:"p-4 font-mono text-xs font-bold",children:t.id.slice(0,8).toUpperCase()}),d.jsx("td",{className:"p-4 font-bold text-slate-800",children:t.patientName}),d.jsxs("td",{className:"p-4 font-bold text-slate-800",children:["$",t.totalAmount]}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${t.status==="completed"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:t.status})})]},t.id)),n.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"p-8 text-center text-slate-400",children:"No recent orders found."})})]})]})})},k$=({onPrint:n})=>{const[e,t]=le.useState([]);return le.useEffect(()=>{const s=xe.collection("samples").where("status","==","reported").orderBy("reportedAt","desc").limit(50).onSnapshot(i=>t(i.docs.map(a=>({id:a.id,...a.data()}))));return()=>s()},[]),d.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"bg-slate-50 border-b",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",children:"Reported Date"}),d.jsx("th",{className:"p-4",children:"Patient"}),d.jsx("th",{className:"p-4",children:"Test"}),d.jsx("th",{className:"p-4 text-right",children:"Action"})]})}),d.jsxs("tbody",{className:"divide-y divide-slate-50",children:[e.map(s=>d.jsxs("tr",{className:"hover:bg-slate-50",children:[d.jsx("td",{className:"p-4 text-xs text-slate-500",children:Mn(s.reportedAt)}),d.jsx("td",{className:"p-4 font-bold text-slate-800",children:s.patientName}),d.jsx("td",{className:"p-4 text-slate-600",children:s.testName}),d.jsx("td",{className:"p-4 text-right",children:d.jsxs("button",{onClick:()=>n(s),className:"bg-indigo-50 text-indigo-600 px-3 py-1.5 rounded text-xs font-bold hover:bg-indigo-100 flex items-center gap-1 ml-auto transition-colors",children:[d.jsx(Oh,{className:"w-3 h-3"})," Print Report"]})})]},s.id)),e.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:4,className:"p-8 text-center text-slate-400",children:"No completed reports yet."})})]})]})})},V$=({onSelect:n})=>{const[e,t]=le.useState(""),[s,i]=le.useState([]),[a,l]=le.useState(!1),u=async()=>{if(e){l(!0);try{const f=await xe.collection("patients").where("fullName",">=",e).where("fullName","<=",e+"").limit(20).get();i(f.docs.map(m=>({id:m.id,...m.data()})))}catch(f){console.error(f)}l(!1)}};return d.jsxs("div",{className:"p-6 h-full flex flex-col bg-white rounded-xl border border-slate-200 shadow-sm",children:[d.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"Search Patient Database"}),d.jsxs("div",{className:"flex gap-2 mb-6",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(jd,{className:"absolute left-3 top-3 text-slate-400 w-4 h-4"}),d.jsx("input",{className:"w-full pl-9 p-3 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter Patient Name...",value:e,onChange:f=>t(f.target.value),onKeyDown:f=>f.key==="Enter"&&u()})]}),d.jsx("button",{onClick:u,disabled:a,className:"px-6 bg-indigo-600 text-white rounded-lg font-bold shadow hover:bg-indigo-700 disabled:opacity-50",children:a?d.jsx(nl,{className:"w-4 h-4 animate-spin"}):"Search"})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto",children:[s.map(f=>d.jsxs("div",{className:"p-4 border-b border-slate-100 last:border-0 hover:bg-slate-50 flex justify-between items-center transition-colors",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-bold text-slate-800",children:f.fullName}),d.jsxs("p",{className:"text-xs text-slate-500",children:[f.phone,"  ",f.gender,"  ",vp(f.dob)," yrs"]})]}),d.jsx("button",{onClick:()=>n(f),className:"px-3 py-1.5 bg-indigo-50 text-indigo-700 rounded text-xs font-bold hover:bg-indigo-100",children:"Select"})]},f.id)),s.length===0&&!a&&d.jsxs("div",{className:"p-12 text-center text-slate-400 flex flex-col items-center",children:[d.jsx(jd,{className:"w-8 h-8 mb-2 opacity-20"}),d.jsx("p",{children:"No patients found. Search by name."})]})]})]})},L$=()=>{const[n,e]=le.useState([]);return le.useEffect(()=>{const t=xe.collection("patients").orderBy("createdAt","desc").limit(50).onSnapshot(s=>e(s.docs.map(i=>({id:i.id,...i.data()}))));return()=>t()},[]),d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[d.jsx(WE,{className:"w-6 h-6 text-indigo-600"})," Patient Directory"]}),d.jsx("div",{className:"bg-white rounded-xl border border-slate-200 flex-1 overflow-hidden shadow-sm flex flex-col",children:d.jsx("div",{className:"overflow-y-auto flex-1",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",children:"Name"}),d.jsx("th",{className:"p-4",children:"Phone"}),d.jsx("th",{className:"p-4",children:"Gender"}),d.jsx("th",{className:"p-4",children:"Age"}),d.jsx("th",{className:"p-4",children:"Registered"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-50",children:n.map(t=>d.jsxs("tr",{className:"hover:bg-slate-50",children:[d.jsx("td",{className:"p-4 font-bold text-slate-800",children:t.fullName}),d.jsx("td",{className:"p-4 text-slate-600",children:t.phone}),d.jsx("td",{className:"p-4 capitalize text-slate-600",children:t.gender}),d.jsxs("td",{className:"p-4 text-slate-600",children:[vp(t.dob)," yrs"]}),d.jsx("td",{className:"p-4 text-slate-500 text-xs",children:Mn(t.createdAt)})]},t.id))})]})})})]})},U$=({role:n})=>{const{showAlert:e,showConfirm:t,showPrompt:s,showToast:i}=iu(),a=A$(n),[l,u]=le.useState(a?"dashboard":"requests"),[f,m]=le.useState([]),[_,T]=le.useState([]),[x,b]=le.useState([]),[k,G]=le.useState([]),[F,Y]=le.useState(!1),[K,H]=le.useState(null),[U,z]=le.useState({category:"General",unit:"pcs",status:"in_stock"}),[J,P]=le.useState(null),[C,S]=le.useState(!1),[L,V]=le.useState(null),[O,M]=le.useState({quantity:0,unitPrice:0,vendorName:"",vendorPhone:"",invoiceNumber:"",expiryDate:"",manufactureDate:"",remarks:""});le.useEffect(()=>{const q=xe.collection("inventory_items").onSnapshot(ye=>m(ye.docs.map(Ne=>({id:Ne.id,...Ne.data()})))),me=xe.collection("inventory_requests").orderBy("createdAt","desc").limit(50).onSnapshot(ye=>T(ye.docs.map(Ne=>({id:Ne.id,...Ne.data()})))),_e=xe.collection("vendors").onSnapshot(ye=>b(ye.docs.map(Ne=>({id:Ne.id,...Ne.data()})))),Ce=xe.collection("inventory_wastages").orderBy("reportedAt","desc").limit(50).onSnapshot(ye=>G(ye.docs.map(Ne=>({id:Ne.id,...Ne.data()}))));return()=>{q(),me(),_e(),Ce()}},[]);const ae=le.useMemo(()=>{const q=new Date,me=f.length,_e=f.filter(at=>at.quantity<at.minLevel).length,Ce=f.filter(at=>at.quantity===0).length,ye=f.filter(at=>at.expiryDate?(at.expiryDate.toDate?at.expiryDate.toDate():new Date(at.expiryDate))<q:!1).length,Ne=f.filter(at=>{if(!at.expiryDate)return!1;const On=((at.expiryDate.toDate?at.expiryDate.toDate():new Date(at.expiryDate)).getTime()-q.getTime())/(1e3*3600*24);return On>0&&On<=30}).length,ht=f.reduce((at,_n)=>at+(_n.purchasePrice||0)*_n.quantity,0),qe=_.filter(at=>at.status==="pending").length;return{totalItems:me,lowStock:_e,outOfStock:Ce,expired:ye,expiringSoon:Ne,totalValue:ht,pendingRequests:qe}},[f,_]),Ie=async()=>{var me,_e,Ce,ye,Ne,ht,qe,at,_n,On,ds,ee;const q=[];if((me=U.name)!=null&&me.trim()||q.push("Item Name"),U.category||q.push("Category"),(_e=U.unit)!=null&&_e.trim()||q.push("Unit"),(U.quantity===void 0||U.quantity===null)&&q.push("Quantity"),(U.minLevel===void 0||U.minLevel===null)&&q.push("Min Level"),(!U.purchasePrice||U.purchasePrice<=0)&&q.push("Purchase Price"),(Ce=U.vendorName)!=null&&Ce.trim()||q.push("Vendor Name"),(ye=U.batchNumber)!=null&&ye.trim()||q.push("Batch Number"),!((Ne=U.barcode)!=null&&Ne.trim())&&!((ht=U.sku)!=null&&ht.trim())&&q.push("Barcode or SKU (at least one is required)"),q.length>0){e("error",`Please fill in the following required fields:

${q.map(Re=>` ${Re}`).join(`
`)}`,"Missing Required Fields");return}if(U.quantity<0){e("error","Quantity cannot be negative","Invalid Quantity");return}if(U.minLevel<0){e("error","Min Level cannot be negative","Invalid Min Level");return}try{const Re=je.firestore.Timestamp.now(),Ge={...U,name:(qe=U.name)==null?void 0:qe.trim(),vendorName:(at=U.vendorName)==null?void 0:at.trim(),batchNumber:(_n=U.batchNumber)==null?void 0:_n.trim(),barcode:((On=U.barcode)==null?void 0:On.trim())||void 0,sku:((ds=U.sku)==null?void 0:ds.trim())||void 0,updatedAt:Re,status:(U.quantity||0)===0?"out_of_stock":(U.quantity||0)<(U.minLevel||0)?"low_stock":"in_stock",createdBy:((ee=Dt.currentUser)==null?void 0:ee.email)||"admin"};K?(await xe.collection("inventory_items").doc(K.id).update(Ge),await Ua("UPDATE_INVENTORY","Inventory",`Updated item: ${U.name}`,Dt.currentUser),i("success","Inventory item updated successfully")):(await xe.collection("inventory_items").add({...Ge,createdAt:Re}),await Ua("ADD_INVENTORY","Inventory",`Added new item: ${U.name}`,Dt.currentUser),i("success","Inventory item added successfully")),Y(!1),H(null),z({category:"General",unit:"pcs",status:"in_stock"})}catch(Re){console.error(Re),e("error","Failed to save item: "+(Re instanceof Error?Re.message:String(Re)),"Save Failed")}},Q=q=>{V(q),M({quantity:0,unitPrice:q.purchasePrice||0,vendorName:q.vendorName||"",vendorPhone:q.vendorPhone||"",invoiceNumber:"",expiryDate:"",manufactureDate:"",remarks:""}),S(!0)},ge=async q=>{var Ne,ht;const me=f.find(qe=>qe.id===q.itemId);if(!me){e("error","Item not found","Error");return}if(me.quantity<q.quantity){e("warning",`Insufficient stock. Available: ${me.quantity} ${me.unit}`,"Low Stock");return}const _e=Math.min(q.quantity,me.quantity),Ce=await s(`Approve and release quantity (max ${_e}):`,{title:"Approve Request",defaultValue:_e.toString(),placeholder:"Enter quantity"});if(!Ce)return;const ye=parseInt(Ce);if(isNaN(ye)||ye<=0||ye>_e){e("error",`Invalid quantity. Must be between 1 and ${_e}`,"Invalid Input");return}try{const qe=xe.batch(),at=xe.collection("inventory_requests").doc(q.id);qe.update(at,{status:"released",releasedQuantity:ye,releasedAt:je.firestore.Timestamp.now(),respondedBy:((Ne=Dt.currentUser)==null?void 0:Ne.email)||"manager"});const _n=xe.collection("inventory_items").doc(q.itemId);qe.update(_n,{quantity:je.firestore.FieldValue.increment(-ye)});const On=xe.collection("inventory_transactions").doc(),ds=(me.purchasePrice||0)*ye;qe.set(On,{itemId:q.itemId,itemName:q.itemName,type:"issue",quantity:-ye,cost:ds,performedBy:((ht=Dt.currentUser)==null?void 0:ht.uid)||"manager",reason:`Approved request from ${q.requesterName}: ${q.purpose}`,timestamp:je.firestore.Timestamp.now()}),await qe.commit(),await Ua("APPROVE_REQUEST","Inventory",`Approved & released ${ye} x ${q.itemName} to ${q.requesterName}`,Dt.currentUser),i("success",`Request approved! ${ye} items released from stock`)}catch(qe){console.error(qe),e("error","Failed to approve request: "+(qe instanceof Error?qe.message:String(qe)),"Approval Failed")}},Ee=async q=>{var Ce;if(!await t(`Reject inventory request from ${q.requesterName} for ${q.quantity} ${q.itemName}?`,{title:"Confirm Rejection",confirmText:"Reject",cancelText:"Cancel",type:"danger"}))return;const _e=await s("Enter reason for rejection:",{title:"Rejection Reason",placeholder:"Why is this request being rejected?",defaultValue:""});if(!(_e!=null&&_e.trim())){e("warning","Rejection cancelled - reason is required","No Reason Provided");return}try{await xe.collection("inventory_requests").doc(q.id).update({status:"rejected",rejectionReason:_e.trim(),rejectedAt:je.firestore.Timestamp.now(),respondedBy:((Ce=Dt.currentUser)==null?void 0:Ce.email)||"manager"}),await Ua("REJECT_REQUEST","Inventory",`Rejected request from ${q.requesterName}: ${_e}`,Dt.currentUser),i("success",`Request rejected. ${q.requesterName} will be notified.`)}catch(ye){console.error(ye),e("error","Failed to reject request: "+(ye instanceof Error?ye.message:String(ye)),"Rejection Failed")}},ke=()=>d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[d.jsxs("div",{className:"p-6 rounded-xl border shadow-sm",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsxs("div",{className:"flex justify-between items-start mb-2",children:[d.jsx("p",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Total Items"}),d.jsx(Er,{className:"w-5 h-5",style:{color:w.PERSIAN_GREEN}})]}),d.jsx("p",{className:"text-3xl font-bold",style:{color:w.CITRON},children:ae.totalItems})]}),d.jsxs("div",{className:"p-6 rounded-xl border shadow-sm",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsxs("div",{className:"flex justify-between items-start mb-2",children:[d.jsx("p",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Low Stock"}),d.jsx(fh,{className:"w-5 h-5 text-amber-500"})]}),d.jsx("p",{className:"text-3xl font-bold text-amber-500",children:ae.lowStock})]}),d.jsxs("div",{className:"p-6 rounded-xl border shadow-sm",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsxs("div",{className:"flex justify-between items-start mb-2",children:[d.jsx("p",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Expired Items"}),d.jsx(hh,{className:"w-5 h-5 text-red-500"})]}),d.jsx("p",{className:"text-3xl font-bold text-red-500",children:ae.expired})]}),d.jsxs("div",{className:"p-6 rounded-xl border shadow-sm",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsxs("div",{className:"flex justify-between items-start mb-2",children:[d.jsx("p",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Total Value"}),d.jsx(Bo,{className:"w-5 h-5 text-green-500"})]}),d.jsxs("p",{className:"text-3xl font-bold text-green-500",children:["$",ae.totalValue.toLocaleString()]})]})]}),(ae.lowStock>0||ae.expired>0||ae.expiringSoon>0)&&d.jsxs("div",{className:"p-4 rounded-xl border",style:{backgroundColor:"#78350f30",borderColor:"#f59e0b40"},children:[d.jsxs("h3",{className:"font-bold mb-3 flex items-center gap-2",style:{color:"#fbbf24"},children:[d.jsx(MD,{className:"w-4 h-4"})," Inventory Alerts"]}),d.jsxs("div",{className:"space-y-2",children:[ae.lowStock>0&&d.jsxs("p",{className:"text-sm",style:{color:"#fcd34d"},children:[" ",ae.lowStock," items below minimum stock level"]}),ae.expired>0&&d.jsxs("p",{className:"text-sm",style:{color:"#fca5a5"},children:[" ",ae.expired," items have expired"]}),ae.expiringSoon>0&&d.jsxs("p",{className:"text-sm",style:{color:"#fcd34d"},children:[" ",ae.expiringSoon," items expiring within 30 days"]})]}),d.jsx("button",{onClick:()=>u("items"),className:"mt-3 text-sm font-bold hover:underline",style:{color:"#fbbf24"},children:"View Items "})]}),ae.pendingRequests>0&&d.jsxs("div",{className:"p-4 rounded-xl border",style:{backgroundColor:"#312e8130",borderColor:"#6366f140"},children:[d.jsxs("h3",{className:"font-bold mb-2 flex items-center gap-2",style:{color:"#818cf8"},children:[d.jsx(qd,{className:"w-4 h-4"})," Pending Requests"]}),d.jsxs("p",{className:"text-sm",style:{color:"#c7d2fe"},children:[ae.pendingRequests," requests awaiting your approval"]}),d.jsx("button",{onClick:()=>u("requests"),className:"mt-2 text-sm font-bold hover:underline",style:{color:"#818cf8"},children:"Review Requests "})]})]}),Ve=()=>d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h3",{className:"text-xl font-bold",style:{color:w.CITRON},children:"Inventory Items"}),d.jsxs("button",{onClick:()=>{H(null),z({category:"General",unit:"pcs"}),Y(!0)},className:"text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2 hover:opacity-90",style:{backgroundColor:w.GAMBOGE},children:[d.jsx(yr,{className:"w-4 h-4"})," Add Item"]})]}),F&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 backdrop-blur-sm",style:{backgroundColor:"#00000080"},children:d.jsxs("div",{className:"rounded-xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",style:{backgroundColor:w.MIDNIGHT_GREEN,border:`1px solid ${w.PERSIAN_GREEN}40`},children:[d.jsx("h3",{className:"font-bold text-lg mb-4",style:{color:w.CITRON},children:K?"Edit Item":"Add New Item"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Item Name *"}),d.jsx("input",{className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:U.name||"",onChange:q=>z({...U,name:q.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Category"}),d.jsx("select",{className:"w-full p-2 border rounded outline-none",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:U.category,onChange:q=>z({...U,category:q.target.value}),children:b$.map(q=>d.jsx("option",{value:q,children:q},q))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Unit"}),d.jsx("input",{className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},placeholder:"e.g., pcs, ml, boxes",value:U.unit||"",onChange:q=>z({...U,unit:q.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Quantity *"}),d.jsx("input",{type:"number",className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:U.quantity||"",onChange:q=>z({...U,quantity:parseInt(q.target.value)||0})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Min Level"}),d.jsx("input",{type:"number",className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:U.minLevel||"",onChange:q=>z({...U,minLevel:parseInt(q.target.value)||0})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Purchase Price ($)"}),d.jsx("input",{type:"number",step:"0.01",className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:U.purchasePrice||"",onChange:q=>z({...U,purchasePrice:parseFloat(q.target.value)||0})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Batch Number"}),d.jsx("input",{className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:U.batchNumber||"",onChange:q=>z({...U,batchNumber:q.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Expiry Date"}),d.jsx("input",{type:"date",className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:U.expiryDate&&U.expiryDate.toDate?U.expiryDate.toDate().toISOString().split("T")[0]:"",onChange:q=>z({...U,expiryDate:q.target.value?je.firestore.Timestamp.fromDate(new Date(q.target.value)):void 0})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Barcode/SKU"}),d.jsx("input",{className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:U.barcode||U.sku||"",onChange:q=>z({...U,barcode:q.target.value})})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Vendor"}),d.jsx("input",{className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:U.vendorName||"",onChange:q=>z({...U,vendorName:q.target.value})})]})]}),d.jsxs("div",{className:"flex justify-end gap-2 border-t pt-4",style:{borderColor:`${w.PERSIAN_GREEN}20`},children:[d.jsx("button",{onClick:()=>Y(!1),className:"px-4 py-2 hover:opacity-80",style:{color:w.TIFFANY_BLUE},children:"Cancel"}),d.jsx("button",{onClick:Ie,className:"text-white px-4 py-2 rounded font-bold hover:opacity-90",style:{backgroundColor:w.GAMBOGE},children:"Save"})]})]})}),d.jsx("div",{className:"rounded-xl border shadow-sm flex-1 overflow-hidden flex flex-col",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}40`},children:d.jsx("div",{className:"overflow-y-auto flex-1 custom-scrollbar",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"border-b sticky top-0 z-10",style:{backgroundColor:`${w.RICH_BLACK}90`,borderColor:`${w.PERSIAN_GREEN}40`,backdropFilter:"blur(4px)"},children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Item Name"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Category"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Stock"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Batch"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Expiry"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Value"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Status"}),d.jsx("th",{className:"p-4 text-right",style:{color:w.TIFFANY_BLUE},children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y",style:{divideColor:`${w.PERSIAN_GREEN}20`},children:f.map(q=>{const me=q.expiryDate&&(q.expiryDate.toDate?q.expiryDate.toDate():new Date(q.expiryDate))<new Date;return d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsxs("td",{className:"p-4 font-bold",style:{color:w.CITRON},children:[q.name,d.jsx("div",{className:"text-xs font-normal",style:{color:w.TIFFANY_BLUE},children:q.vendorName||"No vendor"})]}),d.jsx("td",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:q.category}),d.jsxs("td",{className:"p-4 font-mono font-bold",style:{color:w.CITRON},children:[q.quantity," ",d.jsx("span",{className:"text-xs font-normal",style:{color:w.TIFFANY_BLUE},children:q.unit})]}),d.jsx("td",{className:"p-4 text-xs opacity-70",style:{color:w.TIFFANY_BLUE},children:q.batchNumber||"-"}),d.jsx("td",{className:"p-4 text-xs opacity-70",style:{color:w.TIFFANY_BLUE},children:q.expiryDate?Mn(q.expiryDate):"-"}),d.jsxs("td",{className:"p-4 font-mono",style:{color:w.CITRON},children:["$",((q.purchasePrice||0)*q.quantity).toLocaleString()]}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${me?"bg-red-900/40 text-red-300":q.quantity===0?"bg-slate-700 text-slate-400":q.quantity<q.minLevel?"bg-amber-900/40 text-amber-300":"bg-green-900/40 text-green-300"}`,children:me?"Expired":q.quantity===0?"Out":q.quantity<q.minLevel?"Low":"OK"})}),d.jsx("td",{className:"p-4 text-right",children:d.jsxs("button",{onClick:()=>Q(q),className:"hover:bg-green-900/20 p-2 rounded font-bold text-sm flex items-center gap-1 ml-auto transition-colors",style:{color:"#4ade80"},children:[d.jsx(yr,{className:"w-4 h-4"})," Purchase More"]})})]},q.id)})})]})})})]}),B=()=>{var _e,Ce;const q=a?_:_.filter(ye=>{var Ne;return ye.requesterId===(((Ne=Dt.currentUser)==null?void 0:Ne.uid)||"")}),me=a?_.filter(ye=>ye.status==="pending"):[];return d.jsxs("div",{className:"space-y-6",children:[!a&&d.jsx(FD,{isOpen:!0,onClose:()=>{},userId:((_e=Dt.currentUser)==null?void 0:_e.uid)||"user",userName:((Ce=Dt.currentUser)==null?void 0:Ce.email)||"User",userRole:n}),a&&me.length>0&&d.jsxs("div",{children:[d.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:["Pending Approvals (",me.length,")"]}),d.jsx("div",{className:"space-y-3",children:me.map(ye=>{const Ne=f.find(qe=>qe.id===ye.itemId),ht=Ne?Ne.quantity:0;return d.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsxs("p",{className:"font-bold text-slate-800",children:[ye.itemName," ",d.jsxs("span",{className:"text-sm font-normal text-slate-500",children:["(x",ye.quantity,")"]})]}),d.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Requested by: ",ye.requesterName," (",ye.requesterRole,")"]}),d.jsxs("p",{className:"text-xs text-slate-500",children:["Reason: ",ye.purpose]}),d.jsxs("p",{className:"text-xs text-slate-600 mt-1",children:["Available: ",ht," ",(Ne==null?void 0:Ne.unit)||"units"]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsxs("button",{onClick:()=>ge(ye),className:"bg-green-600 text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-green-700",children:[d.jsx(YE,{className:"w-3 h-3 inline mr-1"})," Approve"]}),d.jsxs("button",{onClick:()=>Ee(ye),className:"bg-red-600 text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-red-700",children:[d.jsx(hh,{className:"w-3 h-3 inline mr-1"})," Reject"]})]})]},ye.id)})})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:a?"All Requests":"My Request History"}),d.jsx("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"bg- slate-50 border-b",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",children:"Date"}),d.jsx("th",{className:"p-4",children:"Item"}),d.jsx("th",{className:"p-4",children:"Qty"}),a&&d.jsx("th",{className:"p-4",children:"Requester"}),d.jsx("th",{className:"p-4",children:"Purpose"}),d.jsx("th",{className:"p-4",children:"Status"})]})}),d.jsx("tbody",{className:"divide-y",children:q.map(ye=>d.jsxs("tr",{className:"hover:bg-slate-50",children:[d.jsx("td",{className:"p-4 text-xs text-slate-500",children:Mn(ye.createdAt)}),d.jsx("td",{className:"p-4 font-bold text-slate-700",children:ye.itemName}),d.jsx("td",{className:"p-4",children:ye.quantity}),a&&d.jsx("td",{className:"p-4 text-slate-600",children:ye.requesterName}),d.jsx("td",{className:"p-4 text-slate-600 text-xs",children:ye.purpose}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${ye.status==="pending"?"bg-blue-100 text-blue-700":ye.status==="released"?"bg-green-100 text-green-700":ye.status==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:ye.status})})]},ye.id))})]})})]})]})};return a?d.jsxs("div",{className:"p-6 h-full flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[d.jsx(Er,{className:"w-6 h-6 text-indigo-600"})," Inventory Management"]}),d.jsx("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[{id:"dashboard",label:"Dashboard",icon:mg},{id:"items",label:"Items",icon:Er},{id:"requests",label:"Requests",icon:qd},{id:"wastage",label:"Wastage",icon:KE}].map(q=>d.jsxs("button",{onClick:()=>u(q.id),className:`px-3 py-1.5 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${l===q.id?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-800"}`,children:[d.jsx(q.icon,{className:"w-4 h-4"})," ",d.jsx("span",{children:q.label})]},q.id))})]}),d.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto",children:[l==="dashboard"&&ke(),l==="items"&&Ve(),l==="requests"&&B(),l==="wastage"&&d.jsx("div",{className:"bg-white p-8 rounded-xl border text-center text-slate-400",children:"Wastage tracking coming soon..."})]})]}):d.jsxs("div",{className:"p-6 h-full",children:[d.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[d.jsx(qd,{className:"w-6 h-6 text-indigo-600"})," Request Inventory"]}),B()]})},O$=({onBack:n})=>{const[e,t]=le.useState([]),[s,i]=le.useState(!1),[a,l]=le.useState({role:"receptionist",status:"active"});le.useEffect(()=>{const m=xe.collection("users").onSnapshot(_=>t(_.docs.map(T=>({id:T.id,...T.data()}))));return()=>m()},[]);const u=async()=>{if(!(!a.username||!a.password))try{await xe.collection("users").add({...a,createdAt:je.firestore.Timestamp.now()}),i(!1),l({role:"receptionist",status:"active"})}catch(m){console.error(m)}},f=async m=>{window.confirm("Remove user?")&&await xe.collection("users").doc(m).delete()};return d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold",style:{color:w.CITRON},children:"User Management"}),d.jsxs("button",{onClick:()=>i(!0),className:"text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2 hover:opacity-90",style:{backgroundColor:w.GAMBOGE},children:[d.jsx(yg,{className:"w-4 h-4"})," Add User"]})]}),s&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 backdrop-blur-sm",style:{backgroundColor:"#00000080"},children:d.jsxs("div",{className:"rounded-xl shadow-2xl p-6 w-full max-w-md",style:{backgroundColor:w.MIDNIGHT_GREEN,border:`1px solid ${w.PERSIAN_GREEN}40`},children:[d.jsx("h3",{className:"font-bold text-lg mb-4",style:{color:w.CITRON},children:"Create New User"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Full Name"}),d.jsx("input",{className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:a.fullName||"",onChange:m=>l({...a,fullName:m.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Username"}),d.jsx("input",{className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:a.username||"",onChange:m=>l({...a,username:m.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Password"}),d.jsx("input",{className:"w-full p-2 border rounded outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},type:"password",value:a.password||"",onChange:m=>l({...a,password:m.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:"Role"}),d.jsx("select",{className:"w-full p-2 border rounded outline-none",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:a.role,onChange:m=>l({...a,role:m.target.value}),children:XE.filter(m=>!m.disabled).map(m=>d.jsx("option",{value:m.id,children:m.label},m.id))})]})]}),d.jsxs("div",{className:"flex justify-end gap-2 mt-6 border-t pt-4",style:{borderColor:`${w.PERSIAN_GREEN}20`},children:[d.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2 hover:opacity-80",style:{color:w.TIFFANY_BLUE},children:"Cancel"}),d.jsx("button",{onClick:u,className:"text-white px-4 py-2 rounded font-bold hover:opacity-90",style:{backgroundColor:w.GAMBOGE},children:"Create User"})]})]})}),d.jsx("div",{className:"rounded-xl shadow-sm border flex-1 overflow-hidden flex flex-col",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}40`},children:d.jsx("div",{className:"overflow-y-auto flex-1 custom-scrollbar",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"border-b sticky top-0 z-10",style:{backgroundColor:`${w.RICH_BLACK}90`,borderColor:`${w.PERSIAN_GREEN}40`,backdropFilter:"blur(4px)"},children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Name"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Username"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Role"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Status"}),d.jsx("th",{className:"p-4 text-right",style:{color:w.TIFFANY_BLUE},children:"Action"})]})}),d.jsx("tbody",{className:"divide-y",style:{divideColor:`${w.PERSIAN_GREEN}20`},children:e.map(m=>d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsx("td",{className:"p-4 font-bold",style:{color:w.CITRON},children:m.fullName}),d.jsx("td",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:m.username}),d.jsx("td",{className:"p-4 capitalize",style:{color:w.TIFFANY_BLUE},children:m.role}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${m.status==="active"?"bg-green-900/40 text-green-300":"bg-slate-700/50 text-slate-400"}`,children:m.status})}),d.jsx("td",{className:"p-4 text-right",children:d.jsx("button",{onClick:()=>f(m.id),className:"text-red-400 hover:bg-red-900/20 p-2 rounded transition-colors",children:d.jsx(Gd,{className:"w-4 h-4"})})})]},m.id))})]})})})]})},F$=({onBack:n})=>{const[e,t]=le.useState([]),[s,i]=le.useState([]),[a,l]=le.useState(!1),[u,f]=le.useState("basic"),{showConfirm:m,showToast:_,showAlert:T}=iu(),x={isActive:!0,category:"General",sampleType:"Blood",parameters:[],inventoryRequirements:[],applyTat:!0,tatHours:24,urgentTatHours:4,gracePeriod:0},[b,k]=le.useState(x);le.useEffect(()=>{let S=null,L=null;try{S=xe.collection("tests").onSnapshot(V=>{t(V.docs.map(O=>({id:O.id,...O.data()})))},V=>{console.error("Error in tests snapshot:",V),t([])}),L=xe.collection("inventory_items").where("status","!=","out_of_stock").onSnapshot(V=>{i(V.docs.map(O=>({id:O.id,...O.data()})))},V=>{console.error("Error in inventory snapshot:",V),i([])})}catch(V){console.error("Error setting up listeners:",V)}return()=>{try{S&&S(),L&&L()}catch(V){console.error("Error cleaning up listeners:",V)}}},[]);const G=async()=>{if(!b.name||!b.code||!b.price){await T("Missing Fields","Please fill in all required fields (Name, Code, Price)");return}try{const S={...b,updatedAt:je.firestore.Timestamp.now()};b.id?await xe.collection("tests").doc(b.id).update(S):await xe.collection("tests").add({...S,createdAt:je.firestore.Timestamp.now()}),l(!1),k(x),f("basic"),_("Test saved successfully","success")}catch(S){console.error("Error saving test:",S),await T("Error","Failed to save test")}},F=S=>{k({...S}),l(!0),f("basic")},Y=async S=>{await m("Delete Test","Are you sure you want to delete this test? This cannot be undone.")&&(await xe.collection("tests").doc(S).delete(),_("Test deleted successfully","success"))},K=async()=>{if(!await m("Load Common Tests","This will add 15 common lab tests to your database. Existing tests will not be affected. Continue?"))return;const L=[{code:"CBC",name:"Complete Blood Count",category:"Hematology",description:"Comprehensive blood cell analysis",isActive:!0,price:800,labCost:400,sampleType:"Blood",turnaroundTime:"4-6 Hours",tatHours:6,applyTat:!0,parameters:[{id:"wbc",name:"White Blood Cells (WBC)",unit:"10/L",type:"numeric",refRanges:[{type:"general",min:4,max:11,criticalMin:2,criticalMax:30}]},{id:"rbc",name:"Red Blood Cells (RBC)",unit:"10/L",type:"numeric",refRanges:[{type:"gender",gender:"male",min:4.5,max:5.9},{type:"gender",gender:"female",min:4.1,max:5.1}]},{id:"hgb",name:"Hemoglobin",unit:"g/dL",type:"numeric",refRanges:[{type:"gender",gender:"male",min:13.5,max:17.5},{type:"gender",gender:"female",min:12,max:15.5}]},{id:"plt",name:"Platelets",unit:"10/L",type:"numeric",refRanges:[{type:"general",min:150,max:400}]}]},{code:"LFT",name:"Liver Function Test",category:"Biochemistry",isActive:!0,price:1500,labCost:750,sampleType:"Serum",turnaroundTime:"6-8 Hours",tatHours:8,applyTat:!0,parameters:[{id:"alt",name:"ALT (SGPT)",unit:"U/L",type:"numeric",refRanges:[{type:"general",min:7,max:56}]},{id:"ast",name:"AST (SGOT)",unit:"U/L",type:"numeric",refRanges:[{type:"general",min:10,max:40}]},{id:"alp",name:"Alkaline Phosphatase",unit:"U/L",type:"numeric",refRanges:[{type:"general",min:44,max:147}]},{id:"bilirubin",name:"Total Bilirubin",unit:"mg/dL",type:"numeric",refRanges:[{type:"general",min:.3,max:1.2}]}]},{code:"RFT",name:"Renal Function Test",category:"Biochemistry",isActive:!0,price:1200,labCost:600,sampleType:"Serum",turnaroundTime:"6-8 Hours",tatHours:8,applyTat:!0,parameters:[{id:"creatinine",name:"Creatinine",unit:"mg/dL",type:"numeric",refRanges:[{type:"general",min:.7,max:1.3}]},{id:"urea",name:"Blood Urea",unit:"mg/dL",type:"numeric",refRanges:[{type:"general",min:7,max:20}]},{id:"uric_acid",name:"Uric Acid",unit:"mg/dL",type:"numeric",refRanges:[{type:"general",min:3.5,max:7.2}]}]},{code:"LIPID",name:"Lipid Profile",category:"Biochemistry",isActive:!0,price:1400,labCost:700,sampleType:"Serum",turnaroundTime:"6-8 Hours",tatHours:8,applyTat:!0,parameters:[{id:"cholesterol",name:"Total Cholesterol",unit:"mg/dL",type:"numeric",refRanges:[{type:"general",min:0,max:200}]},{id:"hdl",name:"HDL Cholesterol",unit:"mg/dL",type:"numeric",refRanges:[{type:"general",min:40,max:60}]},{id:"ldl",name:"LDL Cholesterol",unit:"mg/dL",type:"numeric",refRanges:[{type:"general",min:0,max:100}]},{id:"triglycerides",name:"Triglycerides",unit:"mg/dL",type:"numeric",refRanges:[{type:"general",min:0,max:150}]}]},{code:"FBS",name:"Fasting Blood Sugar",category:"Biochemistry",isActive:!0,price:250,labCost:125,sampleType:"Serum",turnaroundTime:"2-4 Hours",tatHours:4,applyTat:!0,parameters:[{id:"glucose",name:"Glucose (Fasting)",unit:"mg/dL",type:"numeric",refRanges:[{type:"general",min:70,max:100}]}]},{code:"RBS",name:"Random Blood Sugar",category:"Biochemistry",isActive:!0,price:250,labCost:125,sampleType:"Serum",turnaroundTime:"1-2 Hours",tatHours:2,applyTat:!0,parameters:[{id:"glucose_random",name:"Glucose (Random)",unit:"mg/dL",type:"numeric",refRanges:[{type:"general",min:70,max:140}]}]},{code:"HBA1C",name:"HbA1c (Glycated Hemoglobin)",category:"Biochemistry",isActive:!0,price:1800,labCost:900,sampleType:"Blood",turnaroundTime:"24 Hours",tatHours:24,applyTat:!0,parameters:[{id:"hba1c",name:"HbA1c",unit:"%",type:"numeric",refRanges:[{type:"general",min:4,max:5.6}]}]},{code:"TSH",name:"Thyroid Stimulating Hormone",category:"Hormones",isActive:!0,price:1200,labCost:600,sampleType:"Serum",turnaroundTime:"24 Hours",tatHours:24,applyTat:!0,parameters:[{id:"tsh",name:"TSH",unit:"IU/mL",type:"numeric",refRanges:[{type:"general",min:.4,max:4}]}]},{code:"HBSAG",name:"Hepatitis B Surface Antigen",category:"Serology",isActive:!0,price:800,labCost:400,sampleType:"Serum",turnaroundTime:"4-6 Hours",tatHours:6,applyTat:!0,parameters:[{id:"hbsag",name:"HBsAg",unit:"",type:"dropdown",options:["Negative","Positive"],refRanges:[{type:"general",textVal:"Negative"}]}]},{code:"HCV",name:"Hepatitis C Antibody",category:"Serology",isActive:!0,price:1200,labCost:600,sampleType:"Serum",turnaroundTime:"4-6 Hours",tatHours:6,applyTat:!0,parameters:[{id:"anti_hcv",name:"Anti-HCV",unit:"",type:"dropdown",options:["Negative","Positive"],refRanges:[{type:"general",textVal:"Negative"}]}]},{code:"URINE",name:"Urine Routine Examination",category:"Clinical Pathology",isActive:!0,price:400,labCost:200,sampleType:"Urine",turnaroundTime:"2-4 Hours",tatHours:4,applyTat:!0,parameters:[{id:"color",name:"Color",unit:"",type:"text",refRanges:[{type:"general",textVal:"Pale Yellow"}]},{id:"protein",name:"Protein",unit:"",type:"dropdown",options:["Nil","Trace","+","++","+++"],refRanges:[{type:"general",textVal:"Nil"}]},{id:"pus_cells",name:"Pus Cells",unit:"/HPF",type:"text",refRanges:[{type:"general",textVal:"0-5"}]}]}];try{_("info","Adding tests... Please wait");const V=xe.batch();let O=0;for(const M of L){const ae=xe.collection("tests").doc();V.set(ae,{...M,createdAt:je.firestore.Timestamp.now()}),O++}await V.commit(),_("success",`Successfully added ${O} common tests!`)}catch(V){console.error("Error loading tests:",V);const O=(V==null?void 0:V.message)||"Unknown error";T("error",`Failed to load tests: ${O}. 

Please check:
1. Firestore is enabled in Firebase Console
2. Security rules allow writes
3. You have internet connection`)}},H=()=>d.jsx("div",{className:"flex border-b border-slate-200 mb-6 bg-slate-50 rounded-t-xl overflow-hidden",children:[{id:"basic",label:"Basic Info",icon:fg},{id:"pricing",label:"Pricing",icon:Bo},{id:"tat",label:"Turnaround Time",icon:T7},{id:"params",label:"Parameters",icon:Hv},{id:"inventory",label:"Inventory",icon:Er}].map(S=>{const L=S.icon;return d.jsxs("button",{onClick:()=>f(S.id),className:`flex-1 py-3 px-4 flex items-center justify-center gap-2 text-sm font-bold transition-all ${u===S.id?"bg-white text-indigo-600 border-t-2 border-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-700 hover:bg-slate-100"}`,children:[d.jsx(L,{className:"w-4 h-4"})," ",S.label]},S.id)})}),U=()=>d.jsxs("div",{className:"grid grid-cols-2 gap-6 animate-in fade-in",children:[d.jsxs("div",{className:"col-span-2",children:[d.jsxs("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:["Test Name ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",value:b.name||"",onChange:S=>k({...b,name:S.target.value}),placeholder:"e.g. Complete Blood Count"})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:["Test Code ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500 font-mono",value:b.code||"",onChange:S=>k({...b,code:S.target.value.toUpperCase()}),placeholder:"e.g. CBC"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Category"}),d.jsx("input",{className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",value:b.category||"",onChange:S=>k({...b,category:S.target.value}),list:"categories"}),d.jsxs("datalist",{id:"categories",children:[d.jsx("option",{value:"Hematology"}),d.jsx("option",{value:"Biochemistry"}),d.jsx("option",{value:"Serology"}),d.jsx("option",{value:"Microbiology"}),d.jsx("option",{value:"Clinical Pathology"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Sample Type"}),d.jsxs("select",{className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500 bg-white",value:b.sampleType,onChange:S=>k({...b,sampleType:S.target.value}),children:[d.jsx("option",{children:"Blood"}),d.jsx("option",{children:"Serum"}),d.jsx("option",{children:"Plasma"}),d.jsx("option",{children:"Urine"}),d.jsx("option",{children:"Stool"}),d.jsx("option",{children:"Swab"}),d.jsx("option",{children:"Sputum"}),d.jsx("option",{children:"Tissue"}),d.jsx("option",{children:"Other"})]})]}),d.jsx("div",{className:"flex items-center gap-2 pt-6",children:d.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[d.jsx("input",{type:"checkbox",className:"w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500 border-gray-300",checked:b.isActive,onChange:S=>k({...b,isActive:S.target.checked})}),d.jsx("span",{className:"text-sm font-bold text-slate-700",children:"Test is Active"})]})}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Description (Optional)"}),d.jsx("textarea",{className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500 h-20 resize-none",value:b.description||"",onChange:S=>k({...b,description:S.target.value}),placeholder:"Clinical details regarding the test..."})]})]}),z=()=>d.jsxs("div",{className:"grid grid-cols-2 gap-6 animate-in fade-in",children:[d.jsxs("div",{className:"p-4 bg-green-50 rounded-xl border border-green-100 col-span-2 md:col-span-1",children:[d.jsxs("h4",{className:"font-bold text-green-900 mb-4 flex items-center gap-2",children:[d.jsx(Bo,{className:"w-4 h-4"})," Revenue Settings"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsxs("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:["Customer Price ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-2.5 text-slate-400 font-bold",children:"$"}),d.jsx("input",{type:"number",className:"w-full pl-8 p-2.5 border border-slate-200 rounded-lg font-bold text-slate-800",value:b.price||"",onChange:S=>k({...b,price:parseFloat(S.target.value)})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Urgent Fee (Optional)"}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-2.5 text-slate-400 font-bold",children:"$"}),d.jsx("input",{type:"number",className:"w-full pl-8 p-2.5 border border-slate-200 rounded-lg",value:b.urgentPrice||"",onChange:S=>k({...b,urgentPrice:parseFloat(S.target.value)}),placeholder:"0.00"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Home Collection Fee (Optional)"}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-2.5 text-slate-400 font-bold",children:"$"}),d.jsx("input",{type:"number",className:"w-full pl-8 p-2.5 border border-slate-200 rounded-lg",value:b.homeCollectionPrice||"",onChange:S=>k({...b,homeCollectionPrice:parseFloat(S.target.value)}),placeholder:"0.00"})]})]})]})]}),d.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100 col-span-2 md:col-span-1",children:[d.jsxs("h4",{className:"font-bold text-slate-700 mb-4 flex items-center gap-2",children:[d.jsx(UD,{className:"w-4 h-4"})," Cost Analysis"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Lab Cost (Internal)"}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-2.5 text-slate-400 font-bold",children:"$"}),d.jsx("input",{type:"number",className:"w-full pl-8 p-2.5 border border-slate-200 rounded-lg",value:b.labCost||"",onChange:S=>k({...b,labCost:parseFloat(S.target.value)}),placeholder:"0.00"})]}),d.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"Estimated cost of reagents + labor per test."})]}),d.jsx("div",{className:"pt-4 mt-4 border-t border-slate-200",children:d.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[d.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded text-indigo-600 focus:ring-indigo-500 border-gray-300",checked:b.discountAllowed,onChange:S=>k({...b,discountAllowed:S.target.checked})}),d.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Allow Discounts on this test"})]})})]})]})]}),J=()=>d.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[d.jsx("div",{className:"flex items-center gap-4 mb-4",children:d.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-slate-100 px-4 py-2 rounded-lg hover:bg-slate-200 transition-colors",children:[d.jsx("input",{type:"checkbox",className:"w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500 border-gray-300",checked:b.applyTat,onChange:S=>k({...b,applyTat:S.target.checked})}),d.jsx("span",{className:"text-sm font-bold text-slate-700",children:"Enable Turnaround Time (TAT) Tracking"})]})}),b.applyTat&&d.jsxs("div",{className:"grid grid-cols-2 gap-6 p-6 bg-blue-50 rounded-xl border border-blue-100",children:[d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Display Text"}),d.jsx("input",{className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",value:b.turnaroundTime||"",onChange:S=>k({...b,turnaroundTime:S.target.value}),placeholder:"e.g. 24 Hours, Same Day"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Standard TAT (Hours)"}),d.jsx("input",{type:"number",className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",value:b.tatHours||"",onChange:S=>k({...b,tatHours:parseFloat(S.target.value)})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Urgent TAT (Hours)"}),d.jsx("input",{type:"number",className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",value:b.urgentTatHours||"",onChange:S=>k({...b,urgentTatHours:parseFloat(S.target.value)})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Grace Period (Minutes)"}),d.jsx("input",{type:"number",className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",value:b.gracePeriod||"",onChange:S=>k({...b,gracePeriod:parseFloat(S.target.value)}),placeholder:"0"}),d.jsx("p",{className:"text-[10px] text-blue-400 mt-1",children:"Buffer time before marking as delayed."})]})]})]}),P=()=>{var M;const S=(ae,Ie)=>{const Q=[...b.parameters||[]];Ie==="up"&&ae>0?[Q[ae],Q[ae-1]]=[Q[ae-1],Q[ae]]:Ie==="down"&&ae<Q.length-1&&([Q[ae],Q[ae+1]]=[Q[ae+1],Q[ae]]),k({...b,parameters:Q})},L=async ae=>{if(await m("Remove Parameter","Remove this parameter?")){const Q=[...b.parameters||[]];Q.splice(ae,1),k({...b,parameters:Q})}},V=()=>{const ae={id:Math.random().toString(36).substr(2,9),name:"",unit:"",type:"numeric",refRanges:[],isMandatory:!0};k({...b,parameters:[...b.parameters||[],ae]})},O=(ae,Ie)=>{const Q=[...b.parameters||[]];Q[ae]={...Q[ae],...Ie},k({...b,parameters:Q})};return d.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[d.jsxs("div",{className:"flex justify-between items-center bg-indigo-50 p-4 rounded-xl border border-indigo-100",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-indigo-900",children:"Parameter Configuration"}),d.jsx("p",{className:"text-sm text-indigo-700",children:"Define what values need to be entered for this test."})]}),d.jsxs("button",{onClick:V,className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold shadow hover:bg-indigo-700 flex items-center gap-2",children:[d.jsx(yr,{className:"w-4 h-4"})," Add Parameter"]})]}),d.jsxs("div",{className:"space-y-4",children:[(b.parameters||[]).map((ae,Ie)=>{var Q,ge;return d.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm transition-all hover:shadow-md hover:border-indigo-300 group",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("div",{className:"flex flex-col gap-1",children:[d.jsx("button",{onClick:()=>S(Ie,"up"),disabled:Ie===0,className:"p-1 text-slate-400 hover:text-indigo-600 disabled:opacity-30",children:d.jsx(r7,{className:"w-4 h-4 -rotate-45"})}),d.jsx("button",{onClick:()=>S(Ie,"down"),disabled:Ie===(((Q=b.parameters)==null?void 0:Q.length)||0)-1,className:"p-1 text-slate-400 hover:text-indigo-600 disabled:opacity-30",children:d.jsx(n7,{className:"w-4 h-4 -rotate-45"})})]}),d.jsx("div",{className:"w-8 h-8 bg-indigo-100 text-indigo-700 rounded-lg flex items-center justify-center font-bold text-sm",children:Ie+1}),d.jsxs("div",{children:[d.jsx("input",{className:"font-bold text-slate-800 border-none focus:ring-0 p-0 text-lg w-full placeholder-slate-300",value:ae.name,onChange:Ee=>O(Ie,{name:Ee.target.value}),placeholder:"Parameter Name (e.g. Hemoglobin)"}),d.jsxs("div",{className:"flex gap-2 mt-1",children:[d.jsxs("select",{className:"text-xs bg-slate-50 border border-slate-200 rounded px-2 py-1 outline-none focus:border-indigo-500",value:ae.type,onChange:Ee=>O(Ie,{type:Ee.target.value}),children:[d.jsx("option",{value:"numeric",children:"Numeric Value"}),d.jsx("option",{value:"text",children:"Text / String"}),d.jsx("option",{value:"dropdown",children:"Dropdown Options"}),d.jsx("option",{value:"boolean",children:"Yes / No"})]}),d.jsx("input",{className:"text-xs bg-slate-50 border border-slate-200 rounded px-2 py-1 outline-none w-24 focus:border-indigo-500",value:ae.unit,onChange:Ee=>O(Ie,{unit:Ee.target.value}),placeholder:"Unit (e.g. g/dL)"}),d.jsxs("label",{className:"flex items-center gap-1 cursor-pointer bg-slate-50 px-2 rounded border border-slate-200",children:[d.jsx("input",{type:"checkbox",checked:ae.isMandatory,onChange:Ee=>O(Ie,{isMandatory:Ee.target.checked})}),d.jsx("span",{className:"text-xs font-bold text-slate-600",children:"Required"})]})]})]})]}),d.jsx("button",{onClick:()=>L(Ie),className:"text-slate-400 hover:text-red-500 p-2",children:d.jsx(Gd,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"ml-12 pl-4 border-l-2 border-slate-100",children:[d.jsxs("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-2 flex items-center gap-2",children:["Reference Ranges ",d.jsx("span",{className:"bg-slate-100 text-slate-600 px-1.5 py-0.5 rounded-full text-[10px]",children:ae.refRanges.length})]}),ae.type==="dropdown"&&d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Dropdown Options (comma separated)"}),d.jsx("input",{className:"w-full text-sm p-2 border border-slate-200 rounded bg-slate-50",value:((ge=ae.options)==null?void 0:ge.join(", "))||"",onChange:Ee=>O(Ie,{options:Ee.target.value.split(",").map(ke=>ke.trim())}),placeholder:"e.g. Positive, Negative, Indeterminate"})]}),ae.type==="numeric"&&d.jsxs("div",{className:"space-y-2",children:[ae.refRanges.map((Ee,ke)=>d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-200 text-sm grid grid-cols-12 gap-2 items-end",children:[d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 block",children:"Type"}),d.jsxs("select",{className:"w-full bg-white border border-slate-200 rounded px-2 py-1 text-xs",value:Ee.type,onChange:Ve=>{const B=[...ae.refRanges];B[ke].type=Ve.target.value,O(Ie,{refRanges:B})},children:[d.jsx("option",{value:"general",children:"General"}),d.jsx("option",{value:"gender",children:"Gender"}),d.jsx("option",{value:"age",children:"Age"})]})]}),Ee.type!=="general"&&d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 block",children:Ee.type==="gender"?"Gender":"Age (Yrs)"}),Ee.type==="gender"?d.jsxs("select",{className:"w-full bg-white border border-slate-200 rounded px-2 py-1 text-xs",value:Ee.gender,onChange:Ve=>{const B=[...ae.refRanges];B[ke].gender=Ve.target.value,O(Ie,{refRanges:B})},children:[d.jsx("option",{value:"male",children:"Male"}),d.jsx("option",{value:"female",children:"Female"})]}):d.jsxs("div",{className:"flex gap-1",children:[d.jsx("input",{className:"w-full bg-white border rounded px-1 py-1 text-xs",placeholder:"Min",type:"number",value:Ee.ageMin,onChange:Ve=>{const B=[...ae.refRanges];B[ke].ageMin=parseFloat(Ve.target.value),O(Ie,{refRanges:B})}}),d.jsx("input",{className:"w-full bg-white border rounded px-1 py-1 text-xs",placeholder:"Max",type:"number",value:Ee.ageMax,onChange:Ve=>{const B=[...ae.refRanges];B[ke].ageMax=parseFloat(Ve.target.value),O(Ie,{refRanges:B})}})]})]}),d.jsxs("div",{className:"col-span-3",children:[d.jsx("label",{className:"text-[10px] font-bold text-green-600 block",children:"Normal Range"}),d.jsxs("div",{className:"flex gap-1",children:[d.jsx("input",{className:"w-full bg-white border border-green-200 rounded px-2 py-1 text-xs",placeholder:"Min",type:"number",value:Ee.min,onChange:Ve=>{const B=[...ae.refRanges];B[ke].min=parseFloat(Ve.target.value),O(Ie,{refRanges:B})}}),d.jsx("input",{className:"w-full bg-white border border-green-200 rounded px-2 py-1 text-xs",placeholder:"Max",type:"number",value:Ee.max,onChange:Ve=>{const B=[...ae.refRanges];B[ke].max=parseFloat(Ve.target.value),O(Ie,{refRanges:B})}})]})]}),d.jsxs("div",{className:"col-span-3",children:[d.jsx("label",{className:"text-[10px] font-bold text-red-600 block",children:"Critical Range"}),d.jsxs("div",{className:"flex gap-1",children:[d.jsx("input",{className:"w-full bg-white border border-red-200 rounded px-2 py-1 text-xs",placeholder:"< Low",type:"number",value:Ee.criticalMin,onChange:Ve=>{const B=[...ae.refRanges];B[ke].criticalMin=parseFloat(Ve.target.value),O(Ie,{refRanges:B})}}),d.jsx("input",{className:"w-full bg-white border border-red-200 rounded px-2 py-1 text-xs",placeholder:"> High",type:"number",value:Ee.criticalMax,onChange:Ve=>{const B=[...ae.refRanges];B[ke].criticalMax=parseFloat(Ve.target.value),O(Ie,{refRanges:B})}})]})]}),d.jsx("div",{className:"col-span-1",children:d.jsx("button",{onClick:()=>{const Ve=[...ae.refRanges];Ve.splice(ke,1),O(Ie,{refRanges:Ve})},className:"text-slate-400 hover:text-red-500 p-1",children:d.jsx(hh,{className:"w-4 h-4"})})})]},ke)),d.jsxs("button",{onClick:()=>O(Ie,{refRanges:[...ae.refRanges,{type:"general"}]}),className:"text-xs font-bold text-indigo-600 hover:text-indigo-800 flex items-center gap-1 bg-indigo-50 px-3 py-1.5 rounded-lg border border-indigo-100",children:[d.jsx(yr,{className:"w-3 h-3"})," Add Reference Range"]})]})]})]},ae.id)}),((M=b.parameters)==null?void 0:M.length)===0&&d.jsxs("div",{className:"text-center py-10 bg-slate-50 rounded-xl border border-dashed border-slate-300",children:[d.jsx(Hv,{className:"w-10 h-10 text-slate-300 mx-auto mb-3"}),d.jsx("p",{className:"text-slate-500 font-bold",children:"No Parameters Defined"}),d.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Add parameters to define what lab technicians need to test."}),d.jsx("button",{onClick:V,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg font-bold text-sm shadow hover:bg-indigo-700",children:"Add First Parameter"})]})]})]})},C=()=>{var O;const S=()=>{k({...b,inventoryRequirements:[...b.inventoryRequirements||[],{itemId:"",itemName:"",quantity:1}]})},L=(M,ae,Ie)=>{const Q=[...b.inventoryRequirements||[]];if(Q[M]={...Q[M],[ae]:Ie},ae==="itemId"){const ge=s.find(Ee=>Ee.id===Ie);ge&&(Q[M].itemName=ge.name)}k({...b,inventoryRequirements:Q})},V=M=>{const ae=[...b.inventoryRequirements||[]];ae.splice(M,1),k({...b,inventoryRequirements:ae})};return d.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[d.jsxs("div",{className:"flex justify-between items-center bg-orange-50 p-4 rounded-xl border border-orange-100",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-orange-900",children:"Inventory Mapping"}),d.jsx("p",{className:"text-sm text-orange-700",children:"Link inventory items to this test for automatic deduction."})]}),d.jsxs("button",{onClick:S,className:"bg-orange-600 text-white px-4 py-2 rounded-lg font-bold shadow hover:bg-orange-700 flex items-center gap-2",children:[d.jsx(yr,{className:"w-4 h-4"})," Add Item"]})]}),d.jsxs("div",{className:"grid gap-4",children:[(b.inventoryRequirements||[]).map((M,ae)=>{const Ie=s.find(Q=>Q.id===M.itemId);return d.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex items-end gap-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Item Name"}),d.jsxs("select",{className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500",value:M.itemId,onChange:Q=>L(ae,"itemId",Q.target.value),children:[d.jsx("option",{value:"",children:"Select Inventory Item..."}),s.map(Q=>d.jsxs("option",{value:Q.id,children:[Q.name," (",Q.unit,")"]},Q.id))]})]}),d.jsxs("div",{className:"w-32",children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Quantity"}),d.jsx("input",{type:"number",className:"w-full p-2.5 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500 font-bold",value:M.quantity,onChange:Q=>L(ae,"quantity",parseFloat(Q.target.value))})]}),d.jsx("div",{className:"flex-1",children:Ie&&d.jsxs("div",{className:"p-2 bg-slate-50 rounded border border-slate-200",children:[d.jsx("p",{className:"text-xs text-slate-500",children:"Current Stock"}),d.jsxs("p",{className:`font-bold ${Ie.quantity>0?"text-green-600":"text-red-500"}`,children:[Ie.quantity," ",Ie.unit]})]})}),d.jsx("button",{onClick:()=>V(ae),className:"p-3 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:d.jsx(Gd,{className:"w-5 h-5"})})]},ae)}),((O=b.inventoryRequirements)==null?void 0:O.length)===0&&d.jsxs("div",{className:"text-center py-10 bg-slate-50 rounded-xl border border-dashed border-slate-300",children:[d.jsx(Er,{className:"w-10 h-10 text-slate-300 mx-auto mb-3"}),d.jsx("p",{className:"text-slate-500 font-bold",children:"No Inventory Linked"}),d.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Link items like tubes, needles, or reagents to deduct stock automatically."}),d.jsx("button",{onClick:S,className:"px-4 py-2 bg-orange-500 text-white rounded-lg font-bold text-sm shadow hover:bg-orange-600",children:"Link First Item"})]})]})]})};return d.jsxs("div",{className:"p-6 h-full flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Test Catalog Management"}),d.jsx("div",{className:"flex gap-2",children:a?d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>{l(!1),k(x)},className:"px-4 py-2 text-slate-500 font-bold hover:bg-slate-100 rounded-lg",children:"Cancel"}),d.jsxs("button",{onClick:G,className:"bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-indigo-200 hover:bg-indigo-700 transition-all",children:[d.jsx(Z7,{className:"w-4 h-4"})," Save Test"]})]}):d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:K,className:"px-4 py-2 rounded-lg font-bold flex items-center gap-2 shadow transition-all",style:{backgroundColor:w.ALLOY_ORANGE,color:"white"},children:[d.jsx(A7,{className:"w-4 h-4"})," Load Common Tests"]}),d.jsxs("button",{onClick:()=>{l(!0),k(x)},className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2 shadow hover:bg-indigo-700",children:[d.jsx(yr,{className:"w-4 h-4"})," Create New Test"]})]})})]}),a?d.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden flex flex-col",children:[H(),d.jsxs("div",{className:"p-6 flex-1 overflow-y-auto",children:[u==="basic"&&U(),u==="pricing"&&z(),u==="tat"&&J(),u==="params"&&P(),u==="inventory"&&C()]})]}):d.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex-1 overflow-hidden flex flex-col animate-in fade-in",children:d.jsx("div",{className:"overflow-y-auto flex-1",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",children:"Name"}),d.jsx("th",{className:"p-4",children:"Code"}),d.jsx("th",{className:"p-4",children:"Price"}),d.jsx("th",{className:"p-4",children:"Category"}),d.jsx("th",{className:"p-4",children:"Status"}),d.jsx("th",{className:"p-4 text-right",children:"Action"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-50",children:e.map(S=>d.jsxs("tr",{className:"hover:bg-slate-50 group",children:[d.jsx("td",{className:"p-4 font-bold text-slate-800",children:S.name}),d.jsx("td",{className:"p-4 text-xs font-mono text-slate-500",children:S.code}),d.jsxs("td",{className:"p-4 font-bold text-slate-800",children:["$",S.price]}),d.jsx("td",{className:"p-4 text-slate-500",children:S.category}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${S.isActive?"bg-green-100 text-green-700":"bg-slate-100 text-slate-500"}`,children:S.isActive?"Active":"Inactive"})}),d.jsxs("td",{className:"p-4 text-right flex justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[d.jsx("button",{onClick:()=>F(S),className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded",children:d.jsx($7,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>Y(S.id),className:"p-2 text-red-500 hover:bg-red-50 rounded",children:d.jsx(Gd,{className:"w-4 h-4"})})]})]},S.id))})]})})})]})},B$=({onBack:n,onNavigate:e})=>d.jsxs("div",{className:"h-full flex flex-col p-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-6",children:"Admin Finance Control"}),d.jsx("div",{className:"flex-1 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:d.jsx(jD,{})})]}),j$=({onBack:n})=>d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-800",children:"Analytics & Reports"}),d.jsxs("div",{className:"bg-white p-12 text-center rounded-xl border border-slate-200 flex flex-col items-center justify-center flex-1",children:[d.jsx(QE,{className:"w-16 h-16 text-slate-200 mb-4"}),d.jsx("p",{className:"text-slate-500 font-medium",children:"Detailed analytics module is currently under development."}),d.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Please use the Finance or Dashboard views for current summaries."})]})]}),G$=({onBack:n})=>{const[e,t]=le.useState([]);return le.useEffect(()=>{const s=xe.collection("audit_logs").orderBy("timestamp","desc").limit(50).onSnapshot(i=>t(i.docs.map(a=>({id:a.id,...a.data()}))));return()=>s()},[]),d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-800",children:"System Audit Logs"}),d.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex-1 overflow-hidden flex flex-col",children:d.jsx("div",{className:"overflow-y-auto flex-1",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"bg-slate-50 border-b sticky top-0",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",children:"Time"}),d.jsx("th",{className:"p-4",children:"User"}),d.jsx("th",{className:"p-4",children:"Action"}),d.jsx("th",{className:"p-4",children:"Details"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-50",children:e.map(s=>d.jsxs("tr",{className:"hover:bg-slate-50",children:[d.jsx("td",{className:"p-4 text-xs font-mono text-slate-500",children:OD(s.timestamp)}),d.jsx("td",{className:"p-4 font-bold text-slate-800",children:s.userName}),d.jsx("td",{className:"p-4 font-bold text-indigo-600",children:s.action}),d.jsx("td",{className:"p-4 text-slate-600",children:s.details})]},s.id))})]})})})]})},q$=({onBack:n})=>d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-800",children:"System Configuration"}),d.jsxs("div",{className:"bg-white p-8 rounded-xl border border-slate-200 max-w-2xl space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block font-bold text-slate-700 mb-2",children:"Laboratory Name"}),d.jsx("input",{className:"border border-slate-300 p-3 rounded-lg w-full outline-none focus:ring-2 focus:ring-indigo-500",defaultValue:"LabPro Diagnostics"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block font-bold text-slate-700 mb-2",children:"Address"}),d.jsx("input",{className:"border border-slate-300 p-3 rounded-lg w-full outline-none focus:ring-2 focus:ring-indigo-500",defaultValue:"123 Medical Plaza, NY"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block font-bold text-slate-700 mb-2",children:"Contact Phone"}),d.jsx("input",{className:"border border-slate-300 p-3 rounded-lg w-full outline-none focus:ring-2 focus:ring-indigo-500",defaultValue:"+1 (555) 123-4567"})]}),d.jsx("div",{className:"pt-4",children:d.jsx("button",{className:"bg-indigo-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-indigo-700 transition-colors",children:"Save Changes"})})]})]}),H$=({onBack:n})=>{const[e,t]=le.useState("dashboard"),[s,i]=le.useState([]),[a,l]=le.useState(!1),[u,f]=le.useState({todayPatients:0,todayOrders:0,pendingPayments:0,completed:0,todaySales:0}),[m,_]=le.useState([]),[T,x]=le.useState(""),[b,k]=le.useState([]),[G,F]=le.useState([]),[Y,K]=le.useState(null),[H,U]=le.useState(null),[z,J]=le.useState({fullName:"",phone:"",age:"",ageUnit:"Years",gender:"male",address:"",referralType:"self",doctorName:"",clinicName:"",existingId:""}),[P,C]=le.useState([]),[S,L]=le.useState({method:"cash",paidAmount:"",discount:0,discountReason:""}),[V,O]=le.useState(""),[M,ae]=le.useState("All"),[Ie,Q]=le.useState(!1),ge=P.reduce((ee,Re)=>ee+Re.price,0),Ee=Ie?50:0,ke=Math.max(0,ge+Ee-S.discount),Ve=parseFloat(S.paidAmount)||0,B=Math.max(0,ke-Ve);le.useEffect(()=>{L(ee=>({...ee,paidAmount:ke.toString()}))},[ke]),le.useEffect(()=>{const ee=xe.collection("tests").where("isActive","==",!0).onSnapshot(He=>i(He.docs.map(Oe=>({id:Oe.id,...Oe.data()})))),Re=xe.collection("doctors").where("status","==","active").onSnapshot(He=>_(He.docs.map(Oe=>({id:Oe.id,...Oe.data()})))),Ge=new Date;Ge.setHours(0,0,0,0);const We=je.firestore.Timestamp.fromDate(Ge),pt=xe.collection("orders").where("createdAt",">=",We).onSnapshot(He=>{const Oe=He.docs.reduce((en,zs)=>en+(zs.data().totalAmount||0),0);f(en=>({...en,todayOrders:He.size,todaySales:Oe}))});return()=>{ee(),pt(),Re()}},[]),le.useEffect(()=>{const ee=xe.collection("samples").orderBy("createdAt","desc").limit(20).onSnapshot(Re=>{const Ge=Re.docs.map(Oe=>({id:Oe.id,...Oe.data()}));k(Ge);const We=[];Ge.filter(Oe=>Oe.status==="rejected").forEach(Oe=>{We.push({id:Oe.id,text:`Sample rejected for ${Oe.patientName} (${Oe.testName})`,type:"alert"})});const He=Ge.filter(Oe=>Oe.status==="reported").length;He>0&&We.push({id:"reports-ready",text:`${He} recent reports ready for printing.`,type:"info"}),F(We)});return()=>ee()},[]);const q=async(ee=!1)=>{const Re=z.phone.trim();if(!(Re.length<3)){l(!0);try{const Ge=await xe.collection("patients").where("phone",">=",Re).limit(1).get();if(Ge.empty)ee||alert("Patient not found. Please enter details manually.");else{const We=Ge.docs[0].data();let pt="",He="Years";We.dob&&(pt=vp(We.dob).toString()),J(Oe=>({...Oe,fullName:We.fullName,gender:We.gender,address:We.address||"",age:pt,existingId:Ge.docs[0].id})),ee||alert("Patient Found: "+We.fullName)}}catch(Ge){console.error(Ge),ee||alert("Error searching for patient.")}finally{l(!1)}}},me=s.filter(ee=>{const Re=ee.name.toLowerCase().includes(V.toLowerCase())||ee.code.toLowerCase().includes(V.toLowerCase()),Ge=M==="All"||ee.category===M;return Re&&Ge}),_e=["All",...Array.from(new Set(s.map(ee=>ee.category||"General")))],Ce=async()=>{if(!z.fullName||P.length===0){alert("Please enter patient details and select at least one test.");return}l(!0);try{let ee=z.existingId,Re=new Date;if(z.age){const nn=parseInt(z.age);z.ageUnit==="Years"&&Re.setFullYear(Re.getFullYear()-nn),z.ageUnit==="Months"&&Re.setMonth(Re.getMonth()-nn),z.ageUnit==="Days"&&Re.setDate(Re.getDate()-nn)}const Ge=Re.toISOString().split("T")[0],We={fullName:z.fullName,phone:z.phone,gender:z.gender,address:z.address,dob:Ge,updatedAt:je.firestore.Timestamp.now()};ee?await xe.collection("patients").doc(ee).update(We):ee=(await xe.collection("patients").add({...We,createdAt:je.firestore.Timestamp.now()})).id;let pt="Self",He=null,Oe="",en=0;if(z.referralType==="doctor"&&T){const nn=m.find(Ji=>Ji.id===T);nn&&(pt=nn.name,He=nn.id,Oe=nn.phone,en=ke*(nn.commissionRate||0)/100)}else z.referralType==="doctor"&&z.doctorName&&(pt=z.doctorName);const zs=B===0?"paid":Ve>0?"partial":"unpaid",di=await xe.collection("orders").add({patientId:ee,patientName:z.fullName,doctorName:pt,doctorId:He,doctorPhone:Oe,doctorCommission:en,commissionPaid:!1,totalAmount:ke,status:"ordered",paymentStatus:zs,testCount:P.length,isUrgent:Ie,createdAt:je.firestore.Timestamp.now()}),tn=await xe.collection("invoices").add({orderId:di.id,patientName:z.fullName,amount:ke,discount:S.discount,paidAmount:Ve,status:zs,createdAt:je.firestore.Timestamp.now(),payments:Ve>0?[{amount:Ve,method:S.method,date:new Date}]:[]}),hi=xe.batch();P.forEach(nn=>{const Ji=xe.collection("samples").doc();hi.set(Ji,{orderId:di.id,patientId:ee,patientName:z.fullName,patientAge:parseInt(z.age),patientGender:z.gender,patientPhone:z.phone,testId:nn.id,testName:nn.name,sampleType:nn.sampleType,status:"ordered",isUrgent:Ie,doctorName:pt,doctorPhone:Oe,createdAt:je.firestore.Timestamp.now()})}),await hi.commit(),K({invoiceId:tn.id,patientName:z.fullName,patientPhone:z.phone,age:z.age+" "+z.ageUnit,gender:z.gender,date:new Date().toLocaleDateString(),doctor:pt,items:[...P],subtotal:ge,discount:S.discount,total:ke,paid:Ve,due:B,paymentMethod:S.method}),C([]),J({fullName:"",phone:"",age:"",ageUnit:"Years",gender:"male",address:"",referralType:"self",doctorName:"",clinicName:"",existingId:""}),L({method:"cash",paidAmount:"",discount:0,discountReason:""}),x(""),Q(!1)}catch(ee){console.error(ee),alert("Failed to book order.")}finally{l(!1)}},ye=ee=>{let Re="";ee.dob&&(Re=vp(ee.dob).toString()),J({fullName:ee.fullName,phone:ee.phone,age:Re,ageUnit:"Years",gender:ee.gender,address:ee.address||"",referralType:"self",doctorName:"",clinicName:"",existingId:ee.id}),t("new-order")},Ne=()=>d.jsxs("div",{className:"h-full flex flex-col md:flex-row overflow-hidden",style:{backgroundColor:w.MIDNIGHT_GREEN},children:[d.jsxs("div",{className:"w-full md:w-1/3 border-r border-[#0a9396]/20 overflow-y-auto p-6 scrollbar-thin",style:{backgroundColor:w.MIDNIGHT_GREEN},children:[d.jsxs("h3",{className:"font-bold text-lg mb-6 flex items-center gap-2",style:{color:w.CITRON},children:[d.jsx(f$,{className:"w-5 h-5",style:{color:w.GAMBOGE}})," Patient Details"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Phone Number"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(vS,{className:"w-4 h-4 absolute left-3 top-3",style:{color:w.TIFFANY_BLUE}}),d.jsx("input",{type:"tel",value:z.phone,onChange:ee=>J({...z,phone:ee.target.value}),onBlur:()=>q(!0),placeholder:"Search or Enter Phone",className:"w-full pl-9 p-2.5 rounded-lg text-sm focus:ring-2 focus:ring-[#ee9b00] outline-none transition-all",style:{backgroundColor:w.RICH_BLACK,borderColor:"transparent",color:w.CITRON}})]}),d.jsx("button",{onClick:()=>q(),className:"p-2.5 rounded-lg transition-colors hover:opacity-80",style:{backgroundColor:w.PERSIAN_GREEN,color:w.RICH_BLACK},children:d.jsx(jd,{className:"w-4 h-4"})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Full Name"}),d.jsx("input",{value:z.fullName,onChange:ee=>J({...z,fullName:ee.target.value}),placeholder:"Patient Name",className:"w-full p-2.5 rounded-lg text-sm focus:ring-2 focus:ring-[#ee9b00] outline-none",style:{backgroundColor:w.RICH_BLACK,borderColor:"transparent",color:w.CITRON}})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Age"}),d.jsxs("div",{className:"flex",children:[d.jsx("input",{type:"number",value:z.age,onChange:ee=>J({...z,age:ee.target.value}),className:"w-full p-2.5 rounded-l-lg text-sm focus:ring-2 focus:ring-[#ee9b00] outline-none",style:{backgroundColor:w.RICH_BLACK,borderColor:"transparent",color:w.CITRON}}),d.jsxs("select",{value:z.ageUnit,onChange:ee=>J({...z,ageUnit:ee.target.value}),className:"rounded-r-lg text-xs px-2 outline-none font-medium",style:{backgroundColor:w.RICH_BLACK,borderColor:"transparent",color:w.TIFFANY_BLUE},children:[d.jsx("option",{children:"Years"}),d.jsx("option",{children:"Months"}),d.jsx("option",{children:"Days"})]})]})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Gender"}),d.jsxs("select",{value:z.gender,onChange:ee=>J({...z,gender:ee.target.value}),className:"w-full p-2.5 rounded-lg text-sm focus:ring-2 focus:ring-[#ee9b00] outline-none",style:{backgroundColor:w.RICH_BLACK,borderColor:"transparent",color:w.CITRON},children:[d.jsx("option",{value:"male",children:"Male"}),d.jsx("option",{value:"female",children:"Female"}),d.jsx("option",{value:"other",children:"Other"})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Referral By"}),d.jsxs("div",{className:"flex p-1 rounded-lg mb-2",style:{backgroundColor:w.RICH_BLACK},children:[d.jsx("button",{onClick:()=>J({...z,referralType:"self"}),className:`flex-1 py-1.5 text-xs font-bold rounded-md transition-all ${z.referralType==="self"?"shadow-sm":"opacity-50"}`,style:{backgroundColor:z.referralType==="self"?w.MIDNIGHT_GREEN:"transparent",color:z.referralType==="self"?w.CITRON:w.TIFFANY_BLUE},children:"Self"}),d.jsx("button",{onClick:()=>J({...z,referralType:"doctor"}),className:`flex-1 py-1.5 text-xs font-bold rounded-md transition-all ${z.referralType==="doctor"?"shadow-sm":"opacity-50"}`,style:{backgroundColor:z.referralType==="doctor"?w.MIDNIGHT_GREEN:"transparent",color:z.referralType==="doctor"?w.CITRON:w.TIFFANY_BLUE},children:"Doctor"})]}),z.referralType==="doctor"&&d.jsxs("div",{className:"animate-in fade-in slide-in-from-top-1 space-y-2",children:[d.jsxs("select",{value:T,onChange:ee=>{x(ee.target.value),ee.target.value&&J({...z,doctorName:""})},className:"w-full p-2.5 rounded-lg text-sm outline-none",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON},children:[d.jsx("option",{value:"",children:"-- Select Registered Doctor --"}),m.map(ee=>d.jsxs("option",{value:ee.id,children:[ee.name," (",ee.clinic,")"]},ee.id))]}),d.jsx("p",{className:"text-center text-xs font-bold",style:{color:w.TIFFANY_BLUE},children:"- OR -"}),d.jsx("input",{value:z.doctorName,onChange:ee=>{J({...z,doctorName:ee.target.value}),x("")},placeholder:"Enter Manual Name",className:"w-full p-2.5 rounded-lg text-sm focus:ring-2 focus:ring-[#ee9b00] outline-none",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON}})]})]})]}),d.jsxs("div",{className:"mt-8 pt-6 border-t border-[#0a9396]/20",children:[d.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2",style:{color:w.CITRON},children:[d.jsx(I7,{className:"w-5 h-5",style:{color:w.GAMBOGE}})," Payment"]}),d.jsxs("div",{className:"p-4 rounded-xl space-y-3",style:{backgroundColor:w.RICH_BLACK,border:`1px solid ${w.MIDNIGHT_GREEN}`},children:[d.jsxs("div",{className:"flex justify-between text-sm",style:{color:w.TIFFANY_BLUE},children:[d.jsxs("span",{children:["Subtotal (",P.length," tests)"]}),d.jsxs("span",{className:"font-mono font-bold",style:{color:w.CITRON},children:["$",ge]})]}),d.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-dashed border-slate-200",children:[d.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:Ie,onChange:ee=>Q(ee.target.checked),className:"w-4 h-4 text-red-600 border-red-300 rounded focus:ring-red-500"}),d.jsxs("span",{className:"text-sm font-bold text-red-600 flex items-center gap-1",children:[d.jsx(_$,{className:"w-4 h-4 fill-current"})," Urgent Processing"]})]}),d.jsxs("span",{className:"font-mono font-bold text-red-600",children:["+",Ee]})]}),d.jsxs("div",{className:"flex justify-between items-center text-sm mb-2",style:{color:w.TIFFANY_BLUE},children:[d.jsx("span",{children:"Discount"}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("span",{className:"font-bold opacity-50",children:"-"}),d.jsx("input",{type:"number",value:S.discount,onChange:ee=>L({...S,discount:parseFloat(ee.target.value)||0}),className:"w-16 p-1 text-right border rounded font-mono text-xs outline-none focus:ring-1 focus:ring-[#ee9b00]",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:w.PERSIAN_GREEN,color:w.CITRON}})]})]}),d.jsxs("div",{className:"flex justify-between items-center text-lg font-bold pt-3 border-t border-dashed border-slate-700",style:{color:w.GAMBOGE},children:[d.jsx("span",{children:"Total Payable"}),d.jsxs("span",{children:["$",ke]})]})]}),d.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Amount Paid"}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-2.5 font-bold opacity-50",style:{color:w.TIFFANY_BLUE},children:"$"}),d.jsx("input",{type:"number",value:S.paidAmount,onChange:ee=>L({...S,paidAmount:ee.target.value}),className:"w-full pl-6 pr-2 py-2 rounded-lg text-sm font-bold focus:ring-2 focus:ring-[#ee9b00] outline-none",style:{backgroundColor:w.RICH_BLACK,borderColor:"transparent",color:w.CITRON}})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Method"}),d.jsxs("select",{value:S.method,onChange:ee=>L({...S,method:ee.target.value}),className:"w-full p-2 rounded-lg text-sm outline-none",style:{backgroundColor:w.RICH_BLACK,borderColor:"transparent",color:w.CITRON},children:[d.jsx("option",{value:"cash",children:"Cash"}),d.jsx("option",{value:"card",children:"Card"}),d.jsx("option",{value:"upi",children:"UPI/Online"})]})]})]}),d.jsxs("div",{className:"mt-6",children:[d.jsxs("button",{onClick:Ce,disabled:a||P.length===0||!z.fullName,className:"w-full py-3.5 rounded-xl font-bold shadow-lg disabled:opacity-50 disabled:shadow-none transition-all flex justify-center items-center gap-2",style:{backgroundColor:w.GAMBOGE,color:w.RICH_BLACK},children:[a?d.jsx(nl,{className:"w-5 h-5 animate-spin"}):d.jsx(oi,{className:"w-5 h-5"})," Confirm Order"]}),P.length===0&&d.jsx("p",{className:"text-xs text-center mt-2 opacity-50",style:{color:w.TIFFANY_BLUE},children:"Add tests to proceed"})]})]})]}),d.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",style:{backgroundColor:w.RICH_BLACK},children:[d.jsx("div",{className:"p-4 border-b border-[#0a9396]/20 shadow-sm z-10",style:{backgroundColor:w.MIDNIGHT_GREEN},children:d.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-center",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-lg",style:{color:w.CITRON},children:"Test Catalog"}),d.jsxs("p",{className:"text-xs opacity-70",style:{color:w.TIFFANY_BLUE},children:[P.length," tests selected"]})]}),d.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[d.jsxs("div",{className:"relative flex-1 sm:w-64",children:[d.jsx(jd,{className:"w-4 h-4 absolute left-3 top-2.5 opacity-50",style:{color:w.TIFFANY_BLUE}}),d.jsx("input",{value:V,onChange:ee=>O(ee.target.value),placeholder:"Search test name or code...",className:"w-full pl-9 pr-4 py-2 rounded-lg text-sm focus:ring-2 focus:ring-[#ee9b00] outline-none",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON}})]}),d.jsx("select",{value:M,onChange:ee=>ae(ee.target.value),className:"p-2 rounded-lg text-sm outline-none max-w-[140px]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON},children:_e.map(ee=>d.jsx("option",{value:ee,children:ee},ee))})]})]})}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:me.map(ee=>{const Re=P.some(Ge=>Ge.id===ee.id);return d.jsxs("div",{onClick:()=>{C(Re?P.filter(Ge=>Ge.id!==ee.id):[...P,ee])},className:`p-4 rounded-xl border cursor-pointer transition-all group ${Re?"ring-1 ring-[#0a9396]":"hover:border-[#0a9396]/50 hover:shadow-md"}`,style:{backgroundColor:Re?w.MIDNIGHT_GREEN:w.RICH_BLACK,borderColor:Re?w.PERSIAN_GREEN:`${w.PERSIAN_GREEN}30`},children:[d.jsxs("div",{className:"flex justify-between items-start mb-2",children:[d.jsx("h4",{className:"font-bold text-sm line-clamp-2 leading-tight pr-2",style:{color:w.CITRON},children:ee.name}),d.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center shrink-0 transition-colors ${Re?"":"bg-transparent"}`,style:{borderColor:w.TIFFANY_BLUE,backgroundColor:Re?w.PERSIAN_GREEN:"transparent"},children:Re&&d.jsx(YE,{className:"w-3 h-3 text-white"})})]}),d.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[d.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider px-1.5 py-0.5 rounded",style:{backgroundColor:`${w.PERSIAN_GREEN}20`,color:w.TIFFANY_BLUE},children:ee.code}),d.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider px-1.5 py-0.5 rounded",style:{backgroundColor:`${w.PERSIAN_GREEN}20`,color:w.TIFFANY_BLUE},children:ee.sampleType})]}),d.jsxs("div",{className:"flex justify-between items-end border-t pt-2 mt-auto",style:{borderColor:`${w.PERSIAN_GREEN}20`},children:[d.jsx("span",{className:"text-[10px] font-medium opacity-50",style:{color:w.TIFFANY_BLUE},children:ee.category}),d.jsxs("span",{className:"font-bold",style:{color:w.GAMBOGE},children:["$",ee.price]})]})]},ee.id)})}),me.length===0&&d.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-slate-400",children:[d.jsx(fg,{className:"w-12 h-12 mb-3 opacity-20"}),d.jsx("p",{style:{color:w.TIFFANY_BLUE},children:"No tests found matching your search."})]})]})]})]}),ht=()=>d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-in fade-in p-6",children:[d.jsxs("div",{className:"lg:col-span-3 grid grid-cols-1 md:grid-cols-4 gap-4",children:[d.jsxs("div",{className:"p-5 rounded-xl shadow-sm flex items-center justify-between",style:{backgroundColor:w.MIDNIGHT_GREEN,border:`1px solid ${w.PERSIAN_GREEN}30`},children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Today's Orders"}),d.jsx("p",{className:"text-2xl font-bold",style:{color:w.CITRON},children:u.todayOrders})]}),d.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:`${w.PERSIAN_GREEN}20`,color:w.PERSIAN_GREEN},children:d.jsx(JE,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"p-5 rounded-xl shadow-sm flex items-center justify-between",style:{backgroundColor:w.MIDNIGHT_GREEN,border:`1px solid ${w.PERSIAN_GREEN}30`},children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Pending Dues"}),d.jsx("p",{className:"text-2xl font-bold",style:{color:w.ALLOY_ORANGE},children:"3"})]}),d.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:`${w.ALLOY_ORANGE}20`,color:w.ALLOY_ORANGE},children:d.jsx(KE,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"p-5 rounded-xl shadow-sm flex items-center justify-between",style:{backgroundColor:w.MIDNIGHT_GREEN,border:`1px solid ${w.PERSIAN_GREEN}30`},children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Completed"}),d.jsx("p",{className:"text-2xl font-bold",style:{color:"#4ade80"},children:"12"})]}),d.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-green-900/30 text-green-400",children:d.jsx(oi,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"p-5 rounded-xl shadow-sm flex items-center justify-between",style:{backgroundColor:w.MIDNIGHT_GREEN,border:`1px solid ${w.PERSIAN_GREEN}30`},children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Revenue Today"}),d.jsxs("p",{className:"text-2xl font-bold",style:{color:w.CITRON},children:["$",u.todaySales.toLocaleString()]})]}),d.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:`${w.GAMBOGE}20`,color:w.GAMBOGE},children:d.jsx(Bo,{className:"w-5 h-5"})})]})]}),d.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[d.jsxs("button",{onClick:()=>t("new-order"),className:"p-6 rounded-xl shadow-lg transition-all text-left group hover:scale-[1.02]",style:{backgroundColor:w.GAMBOGE},children:[d.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center mb-4",children:d.jsx(yr,{className:"w-6 h-6 text-white"})}),d.jsx("h3",{className:"font-bold text-lg text-white",children:"Book New Order"}),d.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Register patient & tests"})]}),d.jsxs("button",{onClick:()=>t("reports"),className:"p-6 rounded-xl border transition-all text-left group hover:border-[#0a9396]/50",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}30`},children:[d.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center mb-4",style:{backgroundColor:`${w.PERSIAN_GREEN}20`},children:d.jsx(Oh,{className:"w-6 h-6",style:{color:w.PERSIAN_GREEN}})}),d.jsx("h3",{className:"font-bold text-lg",style:{color:w.CITRON},children:"Print Reports"}),d.jsx("p",{className:"text-sm mt-1 opacity-70",style:{color:w.TIFFANY_BLUE},children:"View & Print Results"})]}),d.jsxs("button",{onClick:()=>t("search-patients"),className:"p-6 rounded-xl border transition-all text-left group hover:border-[#0a9396]/50",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}30`},children:[d.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center mb-4",style:{backgroundColor:`${w.ALLOY_ORANGE}20`},children:d.jsx(jd,{className:"w-6 h-6",style:{color:w.ALLOY_ORANGE}})}),d.jsx("h3",{className:"font-bold text-lg",style:{color:w.CITRON},children:"Patient Search"}),d.jsx("p",{className:"text-sm mt-1 opacity-70",style:{color:w.TIFFANY_BLUE},children:"History & records"})]})]}),d.jsxs("div",{className:"p-5 rounded-xl border shadow-sm",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}30`},children:[d.jsxs("h3",{className:"font-bold mb-4 flex items-center gap-2",style:{color:w.CITRON},children:[d.jsx($E,{className:"w-5 h-5",style:{color:w.GAMBOGE}})," Live Test Tracker"]}),d.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto custom-scrollbar",children:[b.map(ee=>{let Re=`bg-[${w.RICH_BLACK}] text-[${w.TIFFANY_BLUE}] border border-[#0a9396]/20`,Ge=ee.status;const We=(pt,He)=>{if(!pt)return"--";const Oe=pt.toDate?pt.toDate():new Date(pt);if(!He&&Oe.status==="reported")return"--";const en=He?He.toDate?He.toDate():new Date(He):new Date,zs=Math.max(0,en.getTime()-Oe.getTime()),di=Math.floor(zs/36e5),tn=Math.floor(zs%36e5/6e4);return di>0?`${di}h ${tn}m`:`${tn}m`};return ee.status==="ordered"?(Ge="Pending Collection",Re="bg-gray-100/10 text-gray-300 border border-gray-500/30"):ee.status==="collected"?(Ge="In Lab / Analyzing",Re="bg-[#0a9396]/10 text-[#0a9396] border border-[#0a9396]/30"):ee.status==="reported"?(Ge="Ready",Re="bg-green-500/10 text-green-400 border border-green-500/30"):ee.status==="rejected"&&(Ge="Rejected",Re="bg-red-500/10 text-red-400 border border-red-500/30"),d.jsx("div",{className:"p-3 rounded-lg transition-colors border-b last:border-0 group/row",style:{borderColor:`${w.PERSIAN_GREEN}20`,backgroundColor:"transparent"},children:d.jsxs("div",{className:"flex gap-4 items-start",children:[d.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-xs shrink-0 mt-1",style:{backgroundColor:`${w.PERSIAN_GREEN}20`,color:w.TIFFANY_BLUE},children:ee.patientName.slice(0,2).toUpperCase()}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-bold truncate",style:{color:w.CITRON},children:ee.patientName}),d.jsx("p",{className:"text-xs truncate",style:{color:w.TIFFANY_BLUE},children:ee.testName})]}),d.jsx("span",{className:`text-[10px] uppercase font-bold px-2 py-1 rounded-full whitespace-nowrap ${Re}`,children:Ge})]}),d.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[10px] font-mono p-1.5 rounded border",style:{backgroundColor:w.RICH_BLACK,borderColor:`${w.PERSIAN_GREEN}20`,color:w.TIFFANY_BLUE},children:[d.jsxs("span",{title:"Booking Time",children:[" ",OD(ee.createdAt)]}),ee.collectedAt&&d.jsxs("span",{title:"Time in Collection",children:["  ",We(ee.createdAt,ee.collectedAt)]}),ee.analyzedAt&&d.jsxs("span",{title:"Time in Analysis",children:["  ",We(ee.collectedAt,ee.analyzedAt)]}),ee.reportedAt&&d.jsxs("span",{title:"Time in Approval",children:["  ",We(ee.analyzedAt,ee.reportedAt)]}),ee.reportedAt&&d.jsxs("span",{className:"font-bold ml-auto",style:{color:w.GAMBOGE},title:"Total Turnaround Time",children:["Total: ",We(ee.createdAt,ee.reportedAt)]})]})]})]})},ee.id)}),b.length===0&&d.jsx("p",{className:"text-center text-sm py-4 opacity-50",style:{color:w.TIFFANY_BLUE},children:"No recent test activity."})]})]})]}),d.jsx("div",{className:"space-y-6",children:d.jsxs("div",{className:"p-5 rounded-xl border",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}30`},children:[d.jsxs("h3",{className:"font-bold mb-2 flex items-center gap-2",style:{color:w.CITRON},children:[d.jsx(MD,{className:"w-4 h-4",style:{color:w.GAMBOGE}})," Notifications"]}),d.jsx("div",{className:"space-y-3",children:G.length>0?G.map((ee,Re)=>d.jsxs("div",{className:`flex gap-2 items-start text-sm p-2 rounded border ${ee.type==="alert"?"bg-red-900/10 text-red-200 border-red-500/20":""}`,style:ee.type!=="alert"?{backgroundColor:`${w.RICH_BLACK}`,color:w.TIFFANY_BLUE,borderColor:`${w.PERSIAN_GREEN}20`}:{},children:[ee.type==="alert"?d.jsx(fh,{className:"w-4 h-4 mt-0.5 shrink-0 text-red-400"}):d.jsx(oi,{className:"w-4 h-4 mt-0.5 shrink-0",style:{color:w.PERSIAN_GREEN}}),d.jsx("span",{className:"leading-snug",children:ee.text})]},ee.id||Re)):d.jsx("p",{className:"text-xs italic opacity-50",style:{color:w.TIFFANY_BLUE},children:"No new notifications."})})]})})]}),[qe,at]=le.useState([]);le.useEffect(()=>{const ee=xe.collection("samples").where("isCritical","==",!0).orderBy("createdAt","desc").limit(50).onSnapshot(Ge=>at(Ge.docs.map(We=>({id:We.id,...We.data()})))),Re=xe.collection("notifications").where("targetRole","==","reception").orderBy("createdAt","desc").limit(20).onSnapshot(Ge=>{F(Ge.docs.map(We=>({id:We.id,...We.data()})))});return()=>{ee(),Re()}},[]);const _n=async ee=>{var We,pt;const Re=prompt("Enter Doctor Name informed:",ee.doctorName||"");if(!Re)return;const Ge=prompt("Communication Method (Call/SMS/Email):","Call");try{await xe.collection("critical_logs").add({sampleId:ee.id,patientName:ee.patientName,testName:ee.testName,criticalValue:"Refer to Report",reportedBy:((We=Dt.currentUser)==null?void 0:We.email)||"Receptionist",reportedTo:Re,method:Ge,timestamp:je.firestore.Timestamp.now()}),await xe.collection("samples").doc(ee.id).update({criticalReported:!0,criticalReportedAt:je.firestore.Timestamp.now(),criticalReportedBy:(pt=Dt.currentUser)==null?void 0:pt.email}),alert("Marked as Reported.")}catch(He){console.error(He),alert("Failed to log action.")}},On=async()=>{const ee=await xe.collection("critical_logs").orderBy("timestamp","desc").limit(100).get(),Re=[["Date","Patient","Test","Reported To","Method","Staff"]];ee.forEach(He=>{var en;const Oe=He.data();Re.push([((en=Oe.timestamp)==null?void 0:en.toDate().toLocaleString())||"",Oe.patientName,Oe.testName,Oe.reportedTo,Oe.method,Oe.reportedBy])});const Ge="data:text/csv;charset=utf-8,"+Re.map(He=>He.join(",")).join(`
`),We=encodeURI(Ge),pt=document.createElement("a");pt.setAttribute("href",We),pt.setAttribute("download","critical_communication_log.csv"),document.body.appendChild(pt),pt.click()},ds=()=>d.jsxs("div",{className:"h-full flex flex-col p-6",style:{backgroundColor:`${w.RICH_BLACK}`},children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{children:[d.jsxs("h3",{className:"text-2xl font-bold flex items-center gap-2",style:{color:"#f87171"},children:[d.jsx(fh,{className:"w-8 h-8"})," Critical Results Management"]}),d.jsx("p",{style:{color:"#fca5a5"},children:"Urgent action required for these patients."})]}),d.jsxs("button",{onClick:On,className:"border px-4 py-2 rounded-lg font-bold flex items-center gap-2 transition-colors hover:bg-red-900/20",style:{backgroundColor:"transparent",borderColor:"#ef4444",color:"#fca5a5"},children:[d.jsx(S7,{className:"w-4 h-4"})," Download Log"]})]}),d.jsx("div",{className:"flex-1 overflow-y-auto rounded-xl shadow border",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:"#ef4444"},children:d.jsxs("table",{className:"w-full text-left",children:[d.jsx("thead",{className:"border-b",style:{backgroundColor:"#7f1d1d20",borderColor:"#ef444440"},children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",style:{color:"#fca5a5"},children:"Date/Time"}),d.jsx("th",{className:"p-4",style:{color:"#fca5a5"},children:"Patient"}),d.jsx("th",{className:"p-4",style:{color:"#fca5a5"},children:"Contact"}),d.jsx("th",{className:"p-4",style:{color:"#fca5a5"},children:"Test"}),d.jsx("th",{className:"p-4",style:{color:"#fca5a5"},children:"Status"}),d.jsx("th",{className:"p-4 text-right",style:{color:"#fca5a5"},children:"Action"})]})}),d.jsxs("tbody",{className:"divide-y",style:{divideColor:"#ef444420"},children:[qe.map(ee=>{const Re=ee.doctorName&&ee.doctorName!=="Self",Ge=Re?`Dr. ${ee.doctorName}`:"Patient",We=Re?ee.doctorPhone:ee.patientPhone;return d.jsxs("tr",{className:"hover:bg-red-900/10 transition-colors",children:[d.jsx("td",{className:"p-4 text-sm font-medium opacity-70",style:{color:w.TIFFANY_BLUE},children:Mn(ee.analyzedAt||ee.createdAt)}),d.jsxs("td",{className:"p-4 font-bold",style:{color:w.CITRON},children:[ee.patientName,d.jsxs("div",{className:"text-xs font-normal opacity-70",style:{color:w.TIFFANY_BLUE},children:[ee.patientAge,"Y / ",ee.patientGender]})]}),d.jsxs("td",{className:"p-4 text-sm",children:[d.jsx("div",{className:"font-bold",style:{color:w.CITRON},children:Ge}),d.jsxs("div",{className:"text-xs flex items-center gap-1 opacity-70",style:{color:w.TIFFANY_BLUE},children:[d.jsx(vS,{className:"w-3 h-3"})," ",We||"No Phone"]})]}),d.jsxs("td",{className:"p-4",style:{color:w.CITRON},children:[ee.testName," ",ee.isUrgent&&d.jsx("span",{className:"bg-red-600 text-white text-[10px] px-1 rounded uppercase font-bold ml-1",children:"URGENT"})]}),d.jsx("td",{className:"p-4",children:ee.criticalReported?d.jsxs("span",{className:"bg-green-900/30 text-green-400 px-2 py-1 rounded text-xs font-bold flex items-center gap-1 w-fit",children:[d.jsx(oi,{className:"w-3 h-3"})," Reported"]}):d.jsx("span",{className:"bg-red-900/30 text-red-400 px-2 py-1 rounded text-xs font-bold animate-pulse",children:"PENDING ACTION"})}),d.jsxs("td",{className:"p-4 text-right",children:[!ee.criticalReported&&d.jsx("button",{onClick:()=>_n(ee),className:"bg-red-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-red-700 shadow-sm shadow-red-900/50",children:"Mark Reported"}),ee.criticalReported&&d.jsxs("span",{className:"text-xs italic opacity-50",style:{color:w.TIFFANY_BLUE},children:["By ",ee.criticalReportedBy]})]})]},ee.id)}),qe.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"p-8 text-center opacity-50",style:{color:w.TIFFANY_BLUE},children:"No critical results found."})})]})]})})]});return d.jsxs("div",{className:"h-full flex flex-col",style:{backgroundColor:w.RICH_BLACK},children:[Y&&d.jsx(C$,{data:Y,onClose:()=>K(null)}),H&&d.jsx(BD,{data:H,onClose:()=>U(null)}),d.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-b shadow-sm z-30 shrink-0",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}30`},children:[d.jsxs("div",{className:"flex items-center gap-4",children:[n&&d.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-white/10",style:{color:w.CITRON},children:d.jsx(DD,{className:"w-5 h-5 rotate-180"})}),d.jsx("h2",{className:"text-2xl font-bold",style:{color:w.CITRON},children:"Reception Desk"}),d.jsx("div",{className:"hidden md:flex p-1 rounded-lg",style:{backgroundColor:w.RICH_BLACK},children:["dashboard","new-order","history","reports","critical-reports","search-patients"].map(ee=>d.jsx("button",{onClick:()=>t(ee),className:`px-4 py-1.5 rounded-md text-sm font-bold capitalize transition-all ${e===ee?"shadow-sm":"hover:opacity-80"}`,style:{backgroundColor:e===ee?w.GAMBOGE:"transparent",color:e===ee?w.RICH_BLACK:w.TIFFANY_BLUE},children:ee.replace("-"," ")},ee))})]}),e==="dashboard"&&d.jsxs("button",{onClick:()=>t("new-order"),className:"px-4 py-2 rounded-lg flex items-center gap-2 font-bold shadow hover:opacity-90 transition-opacity",style:{backgroundColor:w.GAMBOGE,color:w.RICH_BLACK},children:[d.jsx(yr,{className:"w-4 h-4"})," New Order"]})]}),d.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden relative",children:[e==="dashboard"&&d.jsx("div",{className:"overflow-y-auto h-full pb-20 custom-scrollbar",children:ht()}),e==="new-order"&&Ne(),e==="history"&&d.jsx("div",{className:"overflow-y-auto h-full p-6 pb-20 custom-scrollbar",children:d.jsx(M$,{})}),e==="reports"&&d.jsx("div",{className:"overflow-y-auto h-full p-6 pb-20 custom-scrollbar",children:d.jsx(k$,{onPrint:ee=>U(ee)})}),e==="critical-reports"&&ds(),e==="search-patients"&&d.jsx(V$,{onSelect:ye})]})]})},z$=()=>{const[n,e]=le.useState([]),[t,s]=le.useState([]),[i,a]=le.useState(null),[l,u]=le.useState([]);le.useEffect(()=>{const T=xe.collection("samples").where("status","==","ordered").onSnapshot(b=>e(b.docs.map(k=>({id:k.id,...k.data()})))),x=xe.collection("inventory_items").where("status","!=","out_of_stock").onSnapshot(b=>s(b.docs.map(k=>({id:k.id,...k.data()}))));return()=>{T(),x()}},[]);const f=async T=>{a(T),u([]);try{const x=await xe.collection("tests").doc(T.testId).get();if(x.exists){const b=x.data();b.inventoryRequirements&&u(b.inventoryRequirements.map(k=>({itemId:k.itemId,itemName:k.itemName,quantity:k.quantity})))}}catch(x){console.error("Error fetching test defaults",x)}},m=async()=>{var T,x;if(i){console.log("[PHLEBOTOMY] Starting collection confirmation"),console.log("[PHLEBOTOMY] Sample:",i.testName),console.log("[PHLEBOTOMY] Consumed items count:",l.length),console.log("[PHLEBOTOMY] Consumed items:",l),l.length===0&&(console.warn("[PHLEBOTOMY] WARNING: No inventory items to deduct!"),alert("Warning: No inventory items selected. Collection will proceed without deducting inventory."));try{const b=xe.batch(),k=w$(i.orderId,Math.floor(Math.random()*100)),G=xe.collection("samples").doc(i.id);b.update(G,{status:"collected",collectedAt:je.firestore.Timestamp.now(),sampleLabelId:k,collectorName:((T=Dt.currentUser)==null?void 0:T.email)||"Phlebotomist",notes:(x=i.notes)!=null&&x.includes("RECOLLECTION")?`Recollected after rejection. ${i.notes}`:""});let F=0;l.forEach(Y=>{var K;if(console.log("[PHLEBOTOMY] Processing item:",Y.itemName,"qty:",Y.quantity),Y.quantity>0){const H=t.find(U=>U.id===Y.itemId);if(H){console.log("[PHLEBOTOMY] Found inventory item:",H.name,"current qty:",H.quantity);const U=xe.collection("inventory_items").doc(Y.itemId);b.update(U,{quantity:je.firestore.FieldValue.increment(-Y.quantity)});const z=(H.purchasePrice||0)*Y.quantity,J=xe.collection("inventory_transactions").doc();b.set(J,{itemId:Y.itemId,itemName:Y.itemName,type:"deduction",quantity:-Y.quantity,cost:z,performedBy:((K=Dt.currentUser)==null?void 0:K.uid)||"sys",reason:`Sample Collection: ${i.testName}`,relatedSampleId:i.id,relatedTestId:i.testId,timestamp:je.firestore.Timestamp.now()}),F++,console.log("[PHLEBOTOMY] Added deduction to batch for:",Y.itemName)}else console.error("[PHLEBOTOMY] ERROR: Inventory item not found in database:",Y.itemId)}else console.warn("[PHLEBOTOMY] Skipping item with zero quantity:",Y.itemName)}),console.log("[PHLEBOTOMY] Total items to deduct:",F),console.log("[PHLEBOTOMY] Committing batch..."),await b.commit(),console.log("[PHLEBOTOMY]  Batch committed successfully!"),console.log("[PHLEBOTOMY] Collection completed, inventory updated"),a(null)}catch(b){console.error("[PHLEBOTOMY]  Collection failed:",b),console.error("[PHLEBOTOMY] Error details:",b instanceof Error?b.message:String(b)),alert("Failed to confirm collection. Error: "+(b instanceof Error?b.message:String(b)))}}},_=()=>i?d.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:d.jsxs("div",{className:"rounded-xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",style:{backgroundColor:w.RICH_BLACK,border:`1px solid ${w.PERSIAN_GREEN}40`},children:[d.jsxs("div",{className:"p-5 border-b flex justify-between items-center",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsx("h3",{className:"font-bold text-lg",style:{color:w.CITRON},children:"Confirm Collection"}),d.jsx("button",{onClick:()=>a(null),children:d.jsx(Fh,{className:"w-5 h-5 opacity-70 hover:opacity-100",style:{color:w.TIFFANY_BLUE}})})]}),d.jsxs("div",{className:"p-6 overflow-y-auto space-y-6",children:[d.jsxs("div",{className:"p-3 rounded border",style:{backgroundColor:`${w.PERSIAN_GREEN}20`,borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsx("p",{className:"font-bold",style:{color:w.CITRON},children:i.patientName}),d.jsxs("p",{className:"text-sm",style:{color:w.TIFFANY_BLUE},children:[i.testName," (",i.sampleType,")"]})]}),d.jsxs("div",{children:[d.jsxs("h4",{className:"font-bold text-sm mb-2 flex items-center gap-2",style:{color:w.CITRON},children:[d.jsx(Er,{className:"w-4 h-4"})," Consumables Used"]}),d.jsxs("div",{className:"space-y-2 mb-4",children:[l.map((T,x)=>d.jsxs("div",{className:"flex items-center gap-2 p-2 rounded border",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}20`},children:[d.jsx("span",{className:"flex-1 text-sm font-medium",style:{color:w.TIFFANY_BLUE},children:T.itemName}),d.jsx("input",{type:"number",className:"w-16 p-1 border rounded text-right text-sm outline-none focus:ring-1 focus:ring-[#ee9b00]",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:T.quantity,onChange:b=>{const k=[...l];k[x].quantity=parseFloat(b.target.value),u(k)}}),d.jsx("button",{onClick:()=>{const b=[...l];b.splice(x,1),u(b)},className:"text-red-400 hover:bg-red-900/20 p-1 rounded",children:d.jsx(Gd,{className:"w-4 h-4"})})]},x)),l.length===0&&d.jsx("p",{className:"text-xs italic",style:{color:w.TIFFANY_BLUE},children:"No items selected."})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsxs("select",{id:"phleb-inv-select",className:"flex-1 p-2 border rounded text-sm outline-none",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsx("option",{value:"",children:"Select Item..."}),t.map(T=>d.jsxs("option",{value:T.id,children:[T.name," (",T.quantity,")"]},T.id))]}),d.jsx("button",{onClick:()=>{const T=document.getElementById("phleb-inv-select"),x=t.find(b=>b.id===T.value);x&&u([...l,{itemId:x.id,itemName:x.name,quantity:1}])},className:"px-3 py-2 rounded text-sm font-bold shadow-md hover:opacity-90 transition-opacity",style:{backgroundColor:w.MIDNIGHT_GREEN,color:w.CITRON},children:"Add"})]})]})]}),d.jsxs("div",{className:"p-5 border-t flex justify-end gap-3",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 font-bold text-sm",style:{color:w.TIFFANY_BLUE},children:"Cancel"}),d.jsxs("button",{onClick:m,className:"text-white px-6 py-2 rounded-lg font-bold shadow-lg flex items-center gap-2 hover:opacity-90 transition-opacity",style:{backgroundColor:w.GAMBOGE,color:w.RICH_BLACK},children:[d.jsx(W7,{className:"w-4 h-4"})," Confirm & Print Label"]})]})]})}):null;return d.jsxs("div",{className:"p-6 space-y-6 h-full flex flex-col",children:[_(),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",style:{color:w.CITRON},children:[d.jsx(gg,{className:"w-6 h-6",style:{color:w.GAMBOGE}})," Sample Collection"]}),d.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-bold",style:{backgroundColor:`${w.GAMBOGE}20`,color:w.GAMBOGE},children:[n.length," Pending"]})]}),d.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[n.map(T=>d.jsxs("div",{className:"p-5 rounded-xl border shadow-sm hover:shadow-md transition-all group hover:-translate-y-1",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold transition-colors",style:{backgroundColor:`${w.PERSIAN_GREEN}20`,color:w.TIFFANY_BLUE},children:T.patientName.substring(0,2).toUpperCase()}),d.jsx("span",{className:"text-[10px] px-2 py-1 rounded font-bold uppercase tracking-wider",style:{backgroundColor:`${w.RICH_BLACK}50`,color:w.TIFFANY_BLUE},children:T.sampleType})]}),d.jsx("h4",{className:"font-bold truncate",title:T.patientName,style:{color:w.CITRON},children:T.patientName}),d.jsxs("p",{className:"text-sm mb-4 truncate",title:T.testName,style:{color:w.TIFFANY_BLUE},children:[T.testName," ",T.isUrgent&&d.jsx("span",{className:"bg-red-600 text-white text-[10px] px-1.5 py-0.5 rounded font-bold uppercase ml-2 animate-pulse",children:"Urgent"})]}),T.notes&&T.notes.includes("RECOLLECTION")&&d.jsxs("div",{className:"mb-4 p-2 rounded text-xs font-bold border",style:{backgroundColor:"#7f1d1d20",color:"#fca5a5",borderColor:"#ef444440"},children:[" ",T.notes]}),d.jsx("div",{className:"pt-4 border-t",style:{borderColor:`${w.PERSIAN_GREEN}20`},children:d.jsxs("button",{onClick:()=>f(T),className:"w-full py-2.5 rounded-lg font-bold text-sm transition-colors shadow-sm flex items-center justify-center gap-2 hover:opacity-90",style:{backgroundColor:w.PERSIAN_GREEN,color:w.RICH_BLACK},children:[d.jsx(oi,{className:"w-4 h-4"})," Start Collection"]})})]},T.id)),n.length===0&&d.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center h-64 rounded-xl border border-dashed",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}30`,color:w.TIFFANY_BLUE},children:[d.jsx(oi,{className:"w-12 h-12 mb-2 opacity-20"}),d.jsx("p",{children:"All samples collected."})]})]})})]})},$$=()=>{const[n,e]=le.useState([]),[t,s]=le.useState({}),[i,a]=le.useState(null),[l,u]=le.useState({}),{showToast:f,showAlert:m,showConfirm:_}=iu();le.useEffect(()=>{const F=xe.collection("samples").where("status","in",["collected","analyzing"]).onSnapshot(K=>e(K.docs.map(H=>({id:H.id,...H.data()})))),Y=xe.collection("tests").onSnapshot(K=>{const H={};K.docs.forEach(U=>{H[U.id]={id:U.id,...U.data()}}),s(H)});return()=>{F(),Y()}},[]);const T=(F,Y,K,H)=>{let U=Y.find(z=>z.type==="age"&&H>=(z.ageMin||0)&&H<=(z.ageMax||150));return U||(U=Y.find(z=>z.type==="gender"&&z.gender===K)),U||(U=Y.find(z=>z.type==="general")),U?U.criticalMin!==void 0&&F<=U.criticalMin?"CL":U.criticalMax!==void 0&&F>=U.criticalMax?"CH":U.min!==void 0&&F<U.min?"L":U.max!==void 0&&F>U.max?"H":"N":"N"},x=F=>{a(F);const Y={},K=t[F.testId];F.results?u(F.results):K&&K.parameters?(K.parameters.forEach(H=>{Y[H.name]={value:"",flag:"N",unit:H.unit}}),u(Y)):u({})},b=(F,Y,K)=>{let H="N";if(K.type==="numeric"&&Y!==""){const U=parseFloat(Y);H=T(U,K.refRanges,(i==null?void 0:i.patientGender)||"male",(i==null?void 0:i.patientAge)||30)}u(U=>({...U,[F]:{value:Y,flag:H,unit:K.unit}}))},k=async()=>{if(!i)return;const F=[],Y=[],K=l,H=t[i.testId];if(H&&H.parameters&&H.parameters.forEach(U=>{const z=K[U.name];if(z&&z.value&&U.type==="numeric"){(z.flag==="CL"||z.flag==="CH")&&F.push(`${U.name} (${z.value} ${U.unit})`);const J=parseFloat(z.value);let P=U.refRanges.find(C=>C.type==="age"&&(i.patientAge||30)>=(C.ageMin||0)&&(i.patientAge||30)<=(C.ageMax||150));P||(P=U.refRanges.find(C=>C.type==="gender"&&C.gender===(i.patientGender||"male"))),P||(P=U.refRanges.find(C=>C.type==="general")),P&&(P.safeMin!==void 0&&J<P.safeMin||P.safeMax!==void 0&&J>P.safeMax)&&Y.push(`${U.name} (Value: ${J}, Safe: ${P.safeMin}-${P.safeMax})`)}}),!(Y.length>0&&!await _(`The following results are outside the SAFE RANGE (Panic Values): 
${Y.join(`
`)}

Do you want to proceed with these values?`,{title:"Safe Range Violation",confirmText:"Confirm & Save",type:"danger"}))){if(F.length>0){m("warning",`CRITICAL VALUES DETECTED:
${F.join(`
`)}

Please notify the responsible doctor immediately.`,"Critical Result Alert");try{xe.collection("notifications").add({text:`CRITICAL RESULT: ${i.patientName} - ${i.testName}. Values: ${F.join(", ")}`,type:"alert",targetRole:"reception",createdAt:je.firestore.Timestamp.now(),read:!1,linkSampleId:i.id})}catch(U){console.error("Failed to send notification",U)}}try{await xe.collection("samples").doc(i.id).update({status:"review",results:l,analyzedAt:je.firestore.Timestamp.now(),isCritical:F.length>0,notes:F.length>0?(i.notes?i.notes+`
`:"")+`Critical Values: ${F.join(", ")}`:i.notes}),a(null),f("Results submitted for review","success")}catch(U){console.error("Save results failed:",U),alert("Error saving results: "+(U instanceof Error?U.message:String(U)))}}},G=()=>{var Y;if(!i)return null;const F=t[i.testId];return F?d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 backdrop-blur-sm",style:{backgroundColor:"#00000080"},children:d.jsxs("div",{className:"rounded-xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",style:{backgroundColor:w.MIDNIGHT_GREEN,border:`1px solid ${w.PERSIAN_GREEN}40`},children:[d.jsxs("div",{className:"p-5 border-b flex justify-between items-center",style:{borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsxs("div",{style:{color:w.CITRON},children:[d.jsx("h3",{className:"font-bold text-lg",children:"Enter Results"}),d.jsx("p",{className:"text-xs font-bold uppercase",style:{color:w.TIFFANY_BLUE},children:i.testName})]}),d.jsx("button",{onClick:()=>a(null),className:"p-2 rounded-full hover:bg-white/10",style:{color:w.TIFFANY_BLUE},children:d.jsx(Fh,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-6",children:[d.jsxs("div",{className:"p-3 rounded-lg border mb-4",style:{backgroundColor:`${w.PERSIAN_GREEN}20`,borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsxs("p",{className:"text-xs font-bold",style:{color:w.CITRON},children:["Sample ID: ",d.jsx("span",{className:"font-mono",children:i.sampleLabelId})]}),d.jsxs("p",{className:"text-xs",style:{color:w.TIFFANY_BLUE},children:["Patient: ",i.patientName," (",i.patientAge," / ",i.patientGender,")"]})]}),!F.parameters||F.parameters.length===0?d.jsxs("div",{className:"text-center py-4",children:[d.jsx("p",{className:"mb-2",style:{color:w.TIFFANY_BLUE},children:"No specific parameters defined."}),d.jsx("textarea",{className:"w-full border rounded p-2 outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,borderColor:`${w.PERSIAN_GREEN}40`,color:w.CITRON},placeholder:"Enter general result text...",value:((Y=l.main)==null?void 0:Y.value)||"",onChange:K=>u({...l,main:{value:K.target.value,flag:"N",unit:""}})})]}):F.parameters.map(K=>{const H=l[K.name]||{value:"",flag:"N",unit:K.unit},U={N:"opacity-50",L:"text-amber-400",H:"text-amber-400",CL:"text-red-400",CH:"text-red-400"}[H.flag],z={N:"Normal",L:"Low",H:"High",CL:"Critical Low",CH:"Critical High"}[H.flag];return d.jsxs("div",{className:"p-3 rounded-lg border",style:{backgroundColor:`${w.RICH_BLACK}50`,borderColor:`${w.PERSIAN_GREEN}20`},children:[d.jsxs("div",{className:"flex justify-between mb-1",children:[d.jsx("label",{className:"text-sm font-bold",style:{color:w.CITRON},children:K.name}),d.jsx("span",{className:"text-xs font-mono",style:{color:w.TIFFANY_BLUE},children:K.unit})]}),K.type==="dropdown"&&K.options?d.jsxs("select",{className:"w-full p-2 border rounded-lg outline-none",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON,borderColor:`${w.PERSIAN_GREEN}40`},value:H.value,onChange:J=>b(K.name,J.target.value,K),children:[d.jsx("option",{value:"",children:"Select..."}),K.options.map(J=>d.jsx("option",{value:J,children:J},J))]}):d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:K.type==="numeric"?"number":"text",className:"w-full p-2 border rounded-lg outline-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:H.flag.startsWith("C")?"#7f1d1d40":H.flag!=="N"?"#78350f40":w.RICH_BLACK,color:w.CITRON,borderColor:H.flag.startsWith("C")?"#ef4444":H.flag!=="N"?"#f59e0b":`${w.PERSIAN_GREEN}40`},placeholder:`Enter ${K.name}`,value:H.value,onChange:J=>b(K.name,J.target.value,K)}),K.type==="numeric"&&H.value&&d.jsx("span",{className:`absolute right-3 top-2.5 text-xs font-bold ${U}`,style:H.flag==="N"?{color:w.TIFFANY_BLUE}:{},children:z})]}),K.type==="numeric"&&d.jsx("div",{className:"mt-1 flex gap-2 text-[10px] overflow-x-auto custom-scrollbar",style:{color:w.TIFFANY_BLUE},children:K.refRanges.map((J,P)=>d.jsxs("span",{className:"whitespace-nowrap border px-1 rounded",style:{borderColor:`${w.PERSIAN_GREEN}30`,backgroundColor:`${w.RICH_BLACK}80`},children:[J.type,": ",J.min,"-",J.max]},P))})]},K.id)})]}),d.jsxs("div",{className:"p-5 border-t flex justify-end gap-3",style:{borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 font-bold text-sm hover:opacity-80",style:{color:w.TIFFANY_BLUE},children:"Cancel"}),d.jsx("button",{onClick:k,className:"px-6 py-2 text-white rounded-lg font-bold text-sm hover:opacity-90 shadow-lg transition-opacity",style:{backgroundColor:w.GAMBOGE,color:w.RICH_BLACK},children:"Save & Submit"})]})]})}):d.jsxs("div",{className:"p-4 text-center",style:{color:w.CITRON},children:[d.jsx("p",{children:"Test definition not found."}),d.jsx("button",{onClick:()=>a(null),children:"Close"})]})};return d.jsxs("div",{className:"p-6 space-y-6 h-full flex flex-col",children:[G(),d.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",style:{color:w.CITRON},children:[d.jsx(pg,{className:"w-6 h-6",style:{color:w.GAMBOGE}})," Lab Processing"]}),d.jsx("div",{className:"flex-1 rounded-xl border shadow-sm overflow-hidden flex flex-col",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}40`},children:d.jsx("div",{className:"overflow-y-auto custom-scrollbar",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"border-b sticky top-0 z-10",style:{backgroundColor:`${w.RICH_BLACK}90`,borderColor:`${w.PERSIAN_GREEN}40`,backdropFilter:"blur(4px)"},children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Sample ID"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Test"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Patient"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Status"}),d.jsx("th",{className:"p-4 text-right",style:{color:w.TIFFANY_BLUE},children:"Action"})]})}),d.jsxs("tbody",{className:"divide-y",style:{divideColor:`${w.PERSIAN_GREEN}20`},children:[n.map(F=>d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsx("td",{className:"p-4 font-mono font-bold",style:{color:w.CITRON},children:F.sampleLabelId||"---"}),d.jsxs("td",{className:"p-4 font-bold",style:{color:w.CITRON},children:[F.testName," ",F.isUrgent&&d.jsx("span",{className:"bg-red-600 text-white text-[10px] px-1.5 py-0.5 rounded font-bold uppercase ml-2 animate-pulse",children:"Urgent"})]}),d.jsx("td",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:F.patientName}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider",style:{backgroundColor:`${w.PERSIAN_GREEN}20`,color:w.PERSIAN_GREEN},children:F.status})}),d.jsx("td",{className:"p-4 text-right",children:d.jsx("button",{onClick:()=>x(F),className:"px-3 py-1.5 rounded-lg text-xs font-bold hover:opacity-80 transition-opacity",style:{backgroundColor:w.PERSIAN_GREEN,color:w.RICH_BLACK},children:"Enter Results"})})]},F.id)),n.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"p-8 text-center italic opacity-60",style:{color:w.TIFFANY_BLUE},children:"No samples to process."})})]})]})})})]})},Y$=()=>{const[n,e]=le.useState("review"),[t,s]=le.useState([]),[i,a]=le.useState([]),[l,u]=le.useState(null),[f,m]=le.useState(!1),[_,T]=le.useState(""),[x,b]=le.useState(""),[k,G]=le.useState(!1),[F,Y]=le.useState(null);le.useEffect(()=>{const C=xe.collection("samples").where("status","==","review").onSnapshot(L=>s(L.docs.map(V=>({id:V.id,...V.data()})))),S=xe.collection("samples").where("status","in",["ordered","collected","analyzing"]).onSnapshot(L=>a(L.docs.map(V=>({id:V.id,...V.data()}))));return()=>{C(),S()}},[]);const K=C=>{u(C),T(C.pathologistRemarks||""),b(C.conclusion||"")},H=()=>{u(null),T(""),b("")},U=async()=>{var C;if(l){m(!0);try{await xe.collection("samples").doc(l.id).update({status:"reported",verifiedBy:((C=Dt.currentUser)==null?void 0:C.email)||"Pathologist",reportedAt:je.firestore.Timestamp.now(),pathologistRemarks:_,conclusion:x}),H()}catch(S){console.error(S)}finally{m(!1)}}},z=async()=>{if(l&&window.confirm("Reject this result and send back to Technician?")){m(!0);try{await xe.collection("samples").doc(l.id).update({status:"analyzing",notes:"Result rejected by Pathologist. Please re-run."}),H()}catch(C){console.error(C)}finally{m(!1)}}},J=async()=>{if(l){G(!0);try{const C=new K8({apiKey:"PLACEHOLDER_API_KEY"}),S=Object.entries(l.results||{}).map(([M,ae])=>{const Ie=typeof ae=="object"?ae.value:ae,Q=typeof ae=="object"?ae.unit:"",ge=typeof ae=="object"?ae.flag:"N";return`${M}: ${Ie} ${Q} (Flag: ${ge})`}).join(", "),L=`Act as a clinical pathologist. Analyze the following lab results for test "${l.testName}". Results: ${S}. Patient Age: ${l.patientAge}, Gender: ${l.patientGender}. Provide a professional, concise medical conclusion (max 3 sentences) and a separate short remark if necessary. Format: JSON with keys "conclusion" and "remark".`,O=(await C.models.generateContent({model:"gemini-2.5-flash",contents:L})).response.text();try{const M=O.replace(/```json/g,"").replace(/```/g,"").trim(),ae=JSON.parse(M);ae.conclusion&&b(ae.conclusion),ae.remark&&T(ae.remark)}catch{b(O)}}catch(C){console.error("AI Error:",C),alert("AI Generation failed. Please try again or type manually.")}finally{G(!1)}}},P=()=>{l&&Y({...l,pathologistRemarks:_,conclusion:x})};return d.jsxs("div",{className:"p-6 space-y-6 h-full flex flex-col",children:[F&&d.jsx(BD,{data:F,onClose:()=>Y(null)}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",style:{color:w.CITRON},children:[d.jsx(hg,{className:"w-6 h-6",style:{color:w.GAMBOGE}})," Pathologist Verification"]}),d.jsxs("div",{className:"p-1 rounded-lg flex gap-1",style:{backgroundColor:w.MIDNIGHT_GREEN},children:[d.jsxs("button",{onClick:()=>e("review"),className:`px-4 py-1.5 text-sm font-bold rounded-md transition-all ${n==="review"?"shadow-sm":"hover:opacity-80"}`,style:{backgroundColor:n==="review"?w.GAMBOGE:"transparent",color:n==="review"?w.RICH_BLACK:w.TIFFANY_BLUE},children:["Pending Review (",t.length,")"]}),d.jsxs("button",{onClick:()=>e("upcoming"),className:`px-4 py-1.5 text-sm font-bold rounded-md transition-all ${n==="upcoming"?"shadow-sm":"hover:opacity-80"}`,style:{backgroundColor:n==="upcoming"?w.GAMBOGE:"transparent",color:n==="upcoming"?w.RICH_BLACK:w.TIFFANY_BLUE},children:["Upcoming Work (",i.length,")"]})]})]}),d.jsx("div",{className:"flex-1 rounded-xl border shadow-sm overflow-hidden flex flex-col",style:{backgroundColor:w.MIDNIGHT_GREEN,borderColor:`${w.PERSIAN_GREEN}40`},children:d.jsx("div",{className:"overflow-y-auto custom-scrollbar",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"border-b sticky top-0 z-10",style:{backgroundColor:`${w.RICH_BLACK}90`,borderColor:`${w.PERSIAN_GREEN}40`,backdropFilter:"blur(4px)"},children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Sample ID"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Patient"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Test"}),d.jsx("th",{className:"p-4",style:{color:w.TIFFANY_BLUE},children:"Status"}),d.jsx("th",{className:"p-4 text-right",style:{color:w.TIFFANY_BLUE},children:"Action"})]})}),d.jsxs("tbody",{className:"divide-y",style:{divideColor:`${w.PERSIAN_GREEN}20`},children:[(n==="review"?t:i).map(C=>{const S=C.isCritical||C.results&&Object.values(C.results).some(L=>L.flag==="CL"||L.flag==="CH");return d.jsxs("tr",{className:`group transition-colors ${S?"border-l-4 border-l-red-500":"hover:bg-white/5"}`,style:S?{backgroundColor:"#7f1d1d40"}:{},children:[d.jsx("td",{className:"p-4 font-mono text-xs",style:{color:w.TIFFANY_BLUE},children:C.sampleLabelId||C.id.slice(0,6)}),d.jsx("td",{className:"p-4 font-bold",style:{color:w.CITRON},children:C.patientName}),d.jsxs("td",{className:"p-4",children:[d.jsxs("div",{className:"font-bold flex items-center gap-2",style:{color:w.CITRON},children:[C.testName,S&&d.jsx("span",{className:"bg-red-600 text-white text-[10px] px-1.5 py-0.5 rounded font-bold uppercase animate-pulse shadow-sm shadow-red-900/50",children:"Critical"}),C.isUrgent&&d.jsx("span",{className:"bg-red-600 text-white text-[10px] px-1.5 py-0.5 rounded font-bold uppercase shadow-sm shadow-red-900/50",children:"Urgent"})]}),d.jsx("p",{className:"text-xs",style:{color:w.TIFFANY_BLUE},children:C.sampleType})]}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"px-2 py-1 rounded text-[10px] font-bold uppercase",style:C.status==="review"?{backgroundColor:"#f59e0b30",color:"#fbbf24"}:{backgroundColor:`${w.RICH_BLACK}50`,color:w.TIFFANY_BLUE},children:C.status==="review"?"Waiting Approval":C.status})}),d.jsx("td",{className:"p-4 text-right",children:n==="review"&&d.jsx("button",{onClick:()=>K(C),className:"px-3 py-1.5 rounded-lg text-xs font-bold hover:opacity-80 transition-opacity",style:{backgroundColor:w.PERSIAN_GREEN,color:w.RICH_BLACK},children:"Review & Approve"})})]},C.id)}),(n==="review"?t:i).length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"p-10 text-center opacity-60",style:{color:w.TIFFANY_BLUE},children:"No samples found."})})]})]})})}),l&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 backdrop-blur-sm",style:{backgroundColor:"#00000080"},children:d.jsxs("div",{className:"rounded-xl shadow-2xl w-full max-w-4xl h-[90vh] flex flex-col overflow-hidden",style:{backgroundColor:w.MIDNIGHT_GREEN,border:`1px solid ${w.PERSIAN_GREEN}40`},children:[d.jsxs("div",{className:"flex justify-between items-center p-6 border-b",style:{borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold",style:{color:w.CITRON},children:"Review Sample Result"}),d.jsxs("p",{className:"text-sm",style:{color:w.TIFFANY_BLUE},children:[l.sampleLabelId,"  ",l.patientName]})]}),d.jsx("button",{onClick:H,className:"p-2 rounded-full hover:bg-white/10",style:{color:w.TIFFANY_BLUE},children:d.jsx(Fh,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-6 grid grid-cols-1 md:grid-cols-2 gap-8 custom-scrollbar",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"p-4 rounded-lg border",style:{backgroundColor:`${w.RICH_BLACK}50`,borderColor:`${w.PERSIAN_GREEN}20`},children:[d.jsxs("h4",{className:"font-bold mb-4 flex items-center gap-2",style:{color:w.CITRON},children:[d.jsx(Hv,{className:"w-4 h-4"})," Technical Results"]}),d.jsx("table",{className:"w-full text-sm",children:d.jsx("tbody",{className:"divide-y border-t",style:{divideColor:`${w.PERSIAN_GREEN}20`,borderColor:`${w.PERSIAN_GREEN}20`},children:l.results&&Object.entries(l.results).map(([C,S])=>{const L=typeof S=="object"?S.value:S,V=typeof S=="object"?S.unit:"",O=typeof S=="object"?S.flag:"N";return d.jsxs("tr",{children:[d.jsx("td",{className:"py-2 font-medium",style:{color:w.TIFFANY_BLUE},children:C}),d.jsxs("td",{className:"py-2 text-right font-bold",style:{color:w.CITRON},children:[L," ",d.jsx("span",{className:"text-xs font-normal opacity-70",style:{color:w.TIFFANY_BLUE},children:V}),O!=="N"&&d.jsx("span",{className:`ml-2 text-[10px] uppercase font-bold ${O.startsWith("C")?"text-red-400":"text-amber-400"}`,children:O})]})]},C)})})})]}),d.jsxs("div",{className:"text-xs space-y-1",style:{color:w.TIFFANY_BLUE},children:[d.jsxs("p",{children:["Patient ID: ",l.patientId]}),d.jsxs("p",{children:["Age/Gender: ",l.patientAge,"/",l.patientGender]}),d.jsxs("p",{children:["Collected: ",Mn(l.collectedAt)]})]})]}),d.jsxs("div",{className:"space-y-4 flex flex-col h-full",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h4",{className:"font-bold",style:{color:w.CITRON},children:"Clinical Evaluation"}),d.jsxs("button",{onClick:J,disabled:k,className:"text-xs px-2 py-1 rounded border font-bold flex items-center gap-1 hover:opacity-80 transition-opacity",style:{backgroundColor:"#6d28d930",color:"#c4b5fd",borderColor:"#8b5cf640"},children:[k?d.jsx(nl,{className:"w-3 h-3 animate-spin"}):d.jsx(i$,{className:"w-3 h-3"})," Auto-Generate"]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Conclusion / Impression"}),d.jsx("textarea",{className:"w-full p-3 border rounded-lg text-sm outline-none h-24 resize-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,borderColor:`${w.PERSIAN_GREEN}40`,color:w.CITRON},placeholder:"Enter medical conclusion...",value:x,onChange:C=>b(C.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold uppercase mb-1",style:{color:w.TIFFANY_BLUE},children:"Remarks (Optional)"}),d.jsx("textarea",{className:"w-full p-3 border rounded-lg text-sm outline-none h-20 resize-none focus:ring-1 focus:ring-[#00b4d8]",style:{backgroundColor:w.RICH_BLACK,borderColor:`${w.PERSIAN_GREEN}40`,color:w.CITRON},placeholder:"Any additional notes...",value:_,onChange:C=>T(C.target.value)})]}),d.jsxs("div",{className:"mt-auto pt-6 border-t flex gap-3 justify-end",style:{borderColor:`${w.PERSIAN_GREEN}40`},children:[d.jsx("button",{onClick:z,disabled:f,className:"px-4 py-2 border rounded-lg font-bold text-sm hover:bg-red-900/20 transition-colors",style:{borderColor:"#ef4444",color:"#fca5a5"},children:"Reject"}),d.jsxs("button",{onClick:P,className:"px-4 py-2 border rounded-lg font-bold text-sm hover:bg-white/5 flex items-center gap-2 transition-colors",style:{borderColor:`${w.PERSIAN_GREEN}40`,color:w.TIFFANY_BLUE},children:[d.jsx(R7,{className:"w-4 h-4"})," Preview Report"]}),d.jsxs("button",{onClick:U,disabled:f,className:"px-6 py-2 text-white rounded-lg font-bold text-sm hover:opacity-90 shadow-lg flex items-center gap-2 transition-opacity",style:{backgroundColor:"#16a34a",color:"white"},children:[f?d.jsx(nl,{className:"w-4 h-4 animate-spin"}):d.jsx(oi,{className:"w-4 h-4"})," Approve & Publish"]})]})]})]})]})})]})},GD=$v.createContext(null),iu=()=>{const n=$v.useContext(GD);if(!n)throw new Error("useDialog must be used within DialogProvider");return n},K$=()=>{var L;const[n,e]=le.useState(null),[t,s]=le.useState(null),[i,a]=le.useState("dashboard"),[l,u]=le.useState(!0),[f,m]=le.useState(!1),[_,T]=le.useState({isOpen:!1,type:"info",message:""}),[x,b]=le.useState({isOpen:!1,message:"",onConfirm:()=>{},onCancel:()=>{}}),[k,G]=le.useState({isOpen:!1,message:"",defaultValue:"",onConfirm:()=>{},onCancel:()=>{}}),[F,Y]=le.useState([]),K=(V,O,M)=>{T({isOpen:!0,type:V,message:O,title:M})},H=(V,O)=>new Promise(M=>{b({isOpen:!0,message:V,title:O==null?void 0:O.title,confirmText:O==null?void 0:O.confirmText,cancelText:O==null?void 0:O.cancelText,type:O==null?void 0:O.type,onConfirm:()=>{b(ae=>({...ae,isOpen:!1})),M(!0)},onCancel:()=>{b(ae=>({...ae,isOpen:!1})),M(!1)}})}),U=(V,O)=>new Promise(M=>{G({isOpen:!0,message:V,title:O==null?void 0:O.title,defaultValue:(O==null?void 0:O.defaultValue)||"",placeholder:O==null?void 0:O.placeholder,onConfirm:ae=>{G(Ie=>({...Ie,isOpen:!1})),M(ae)},onCancel:()=>{G(ae=>({...ae,isOpen:!1})),M(null)}})}),z=(V,O)=>{const M=Date.now().toString()+Math.random().toString(36);Y(ae=>[...ae,{id:M,type:V,message:O}]),setTimeout(()=>{Y(ae=>ae.filter(Ie=>Ie.id!==M))},4e3)},J=V=>{Y(O=>O.filter(M=>M.id!==V))},P={showAlert:K,showConfirm:H,showPrompt:U,showToast:z};le.useEffect(()=>{const V=Dt.onAuthStateChanged(O=>{var M;if(!O)e(null),s(null);else{e(O);const ae=localStorage.getItem("labpro_role"),Ie=localStorage.getItem("labpro_view");ae&&XE.some(Q=>Q.id===ae)?(s(ae),Ie&&((M=q_[ae])!=null&&M.includes(Ie))&&a(Ie)):s(null)}u(!1)});return()=>V()},[]);const C=(V,O)=>{s(V),e(O),a("dashboard"),localStorage.setItem("labpro_role",V),localStorage.setItem("labpro_view","dashboard")},S=()=>{Dt.signOut(),localStorage.removeItem("labpro_role"),localStorage.removeItem("labpro_view"),e(null),s(null),a("dashboard")};return le.useEffect(()=>{t&&i&&localStorage.setItem("labpro_view",i)},[i,t]),l?d.jsx("div",{className:"h-screen w-full flex items-center justify-center bg-slate-50",children:d.jsx(nl,{className:"w-8 h-8 text-indigo-600 animate-spin"})}):!n||!t?d.jsx(R$,{onLoginSuccess:C}):d.jsxs(GD.Provider,{value:P,children:[d.jsx(T$,{isOpen:_.isOpen,type:_.type,title:_.title,message:_.message,onClose:()=>T(V=>({...V,isOpen:!1}))}),d.jsx(x$,{isOpen:x.isOpen,title:x.title,message:x.message,confirmText:x.confirmText,cancelText:x.cancelText,type:x.type,onConfirm:x.onConfirm,onCancel:x.onCancel}),d.jsx(I$,{isOpen:k.isOpen,title:k.title,message:k.message,defaultValue:k.defaultValue,placeholder:k.placeholder,onConfirm:k.onConfirm,onCancel:k.onCancel}),d.jsx(E$,{toasts:F,onClose:J}),d.jsxs("div",{className:"flex flex-col h-screen w-full font-sans overflow-hidden transition-colors duration-500",style:{backgroundColor:w.RICH_BLACK,color:w.CITRON},children:[d.jsx(FD,{isOpen:f,onClose:()=>m(!1),userId:n.uid,userName:n.username||n.email||"User",userRole:t}),d.jsx(v$,{activeTab:i,onNavigate:a,user:n,onLogout:S}),d.jsx("main",{className:"flex-1 h-full overflow-hidden relative flex flex-col",children:d.jsxs("div",{className:"flex-1 overflow-auto p-0 relative custom-scrollbar",children:[i==="dashboard"&&d.jsx("div",{className:"p-8 h-full overflow-y-auto",children:d.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsxs("h2",{className:"text-3xl font-bold tracking-tight",style:{color:w.TIFFANY_BLUE},children:["Welcome back, ",d.jsx("span",{style:{color:w.GAMBOGE},children:n.username||"User"})]}),d.jsx("p",{className:"opacity-60 mt-1",children:"Select a workspace to begin."})]}),d.jsx("div",{className:"flex gap-4",children:d.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-5 py-2.5 rounded-xl font-bold transition-all hover:scale-105 shadow-lg",style:{backgroundColor:w.MIDNIGHT_GREEN,color:w.TIFFANY_BLUE},children:[d.jsx(qd,{className:"w-5 h-5"})," Request Stock"]})})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:(L=q_[t])==null?void 0:L.map(V=>{if(V.startsWith("admin_"))return null;const M={dashboard:mg,reception:JE,collection:gg,lab_tech:pg,lab_path:hg,finance:Bo,inventory:Er}[V]||oi,ae=V.replace("_"," ");return d.jsxs("button",{onClick:()=>a(V),className:"p-6 rounded-2xl flex flex-col items-start gap-4 transition-all hover:-translate-y-1 hover:shadow-2xl group border border-transparent text-left relative overflow-hidden",style:{backgroundColor:w.MIDNIGHT_GREEN},children:[d.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -mr-10 -mt-10 blur-2xl transition-all group-hover:bg-white/10"}),d.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg",style:{backgroundColor:w.PERSIAN_GREEN},children:d.jsx(M,{className:"w-8 h-8 text-white"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold capitalize",style:{color:w.CITRON},children:ae}),d.jsx("p",{className:"text-xs font-medium mt-1 opacity-60",style:{color:w.TIFFANY_BLUE},children:"Access module"})]}),d.jsx("div",{className:"mt-auto pt-4 w-full flex justify-end",children:d.jsx("div",{className:"p-2 rounded-full bg-black/20 group-hover:bg-black/30 transition-colors",children:d.jsx(DD,{className:"w-5 h-5 text-white/50 group-hover:text-white"})})})]},V)})}),(t==="admin"||t==="inventory_manager")&&d.jsxs("div",{className:"pt-8 border-t border-[#0a9396]/20",children:[d.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center gap-2",style:{color:w.GAMBOGE},children:[d.jsx(jm,{className:"w-6 h-6"})," Administration"]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:q_[t].filter(V=>V.startsWith("admin_")).map(V=>{const M={admin_users:WE,admin_tests:L7,admin_finance:Bo,admin_reports:QE,admin_logs:LD,admin_settings:jm}[V]||jm;return d.jsxs("button",{onClick:()=>a(V),className:"p-4 rounded-xl flex items-center gap-3 transition-colors hover:bg-white/5 border border-transparent hover:border-[#0a9396]/30 text-left",children:[d.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-[#0a9396]/10",children:d.jsx(M,{className:"w-5 h-5",style:{color:w.PERSIAN_GREEN}})}),d.jsx("span",{className:"font-bold text-sm",style:{color:w.TIFFANY_BLUE},children:V.replace("admin_","").replace(/_/g," ")})]},V)})})]})]})}),i==="patients"&&d.jsx("div",{className:"p-6",children:d.jsx(L$,{})}),i==="reception"&&d.jsx(H$,{onBack:()=>a("dashboard")}),i==="collection"&&d.jsx(z$,{}),i==="lab_tech"&&d.jsx($$,{}),i==="lab_path"&&d.jsx(Y$,{}),i==="inventory"&&d.jsx(U$,{role:t}),i==="finance"&&d.jsx(jD,{}),i==="admin_users"&&d.jsx("div",{className:"p-6",children:d.jsx(O$,{onBack:()=>a("dashboard")})}),i==="admin_tests"&&d.jsx("div",{className:"h-full",children:d.jsx(F$,{onBack:()=>a("dashboard")})}),i==="admin_finance"&&d.jsx("div",{className:"p-6",children:d.jsx(B$,{onBack:()=>a("dashboard")})}),i==="admin_reports"&&d.jsx("div",{className:"p-6",children:d.jsx(j$,{onBack:()=>a("dashboard")})}),i==="admin_logs"&&d.jsx("div",{className:"p-6",children:d.jsx(G$,{onBack:()=>a("dashboard")})}),i==="admin_settings"&&d.jsx("div",{className:"p-6",children:d.jsx(q$,{onBack:()=>a("dashboard")})})]})})]})]})},qD=document.getElementById("root");if(!qD)throw new Error("Could not find root element to mount to");const J$=R2.createRoot(qD);J$.render(d.jsx($v.StrictMode,{children:d.jsx(K$,{})}));
